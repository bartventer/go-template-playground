import{g as q,a as C,$ as j,r as _,h as F,s as G,c as V,d as Z,e as J}from"./monaco-editor-esm-vs-base-browser-dom-CW6twH0t.js";import{b as K,D,S as Q}from"./monaco-editor-esm-vs-base-browser-DUVYE87s.js";import{S as Y}from"./monaco-editor-esm-vs-base-browser-keyboardEvent-PZwKEW7u.js";import{r as X}from"./monaco-editor-esm-vs-base-browser-ui-vl4ek12j.js";import{D as z,q as B,r as M,s as E,j as ee,u as te,v as re,w as x,x as ne,y as U,U as y,z as m,B as N,G as v,H as ae,o as se,J as H,L as ie,F as oe,t as ce,N as le,O as ue,P as de}from"./monaco-editor-esm-vs-base-YIFfhEJQ.js";const I=Object.freeze({image:({href:e,title:t,text:a})=>{let r=[],c=[];return e&&({href:e,dimensions:r}=ae(e),c.push(`src="${v(e)}"`)),a&&c.push(`alt="${v(a)}"`),t&&c.push(`title="${v(t)}"`),r.length&&(c=c.concat(r)),"<img "+c.join(" ")+">"},paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>`},link({href:e,title:t,tokens:a}){let r=this.parser.parseInline(a);return typeof e!="string"?"":(e===r&&(r=N(r)),t=typeof t=="string"?v(N(t)):"",e=N(e),e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${e}" title="${t||e}" draggable="false">${r}</a>`)}});function ze(e,t={},a={}){const r=new z;let c=!1;const s=K(t),i=function(n){let o;try{o=le(decodeURIComponent(n))}catch{}return o?(o=ue(o,u=>{if(e.uris&&e.uris[u])return y.revive(e.uris[u])}),encodeURIComponent(JSON.stringify(o))):n},d=function(n,o){const u=e.uris&&e.uris[n];let l=y.revive(u);return o?n.startsWith(m.data+":")?n:(l||(l=y.parse(n)),oe.uriToBrowserUri(l).toString(!0)):!l||y.parse(n).toString()===l.toString()?n:(l.query&&(l=l.with({query:i(l.query)})),l.toString())},p=new B;p.image=I.image,p.link=I.link,p.paragraph=I.paragraph;const k=[],h=[];if(t.codeBlockRendererSync?p.code=({text:n,lang:o})=>{const u=M.nextId(),l=t.codeBlockRendererSync(P(o),n);return h.push([u,l]),`<div class="code" data-code="${u}">${E(n)}</div>`}:t.codeBlockRenderer&&(p.code=({text:n,lang:o})=>{const u=M.nextId(),l=t.codeBlockRenderer(P(o),n);return k.push(l.then(f=>[u,f])),`<div class="code" data-code="${u}">${E(n)}</div>`}),t.actionHandler){const n=function(l){let f=l.target;if(!(f.tagName!=="A"&&(f=f.parentElement,!f||f.tagName!=="A")))try{let b=f.dataset.href;b&&(e.baseUri&&(b=L(y.from(e.baseUri),b)),t.actionHandler.callback(b,l))}catch(b){se(b)}finally{l.preventDefault()}},o=t.actionHandler.disposables.add(new D(s,"click")),u=t.actionHandler.disposables.add(new D(s,"auxclick"));t.actionHandler.disposables.add(ee.any(o.event,u.event)(l=>{const f=new Q(q(s),l);!f.leftButton&&!f.middleButton||n(f)})),t.actionHandler.disposables.add(C(s,"keydown",l=>{const f=new Y(l);!f.equals(10)&&!f.equals(3)||n(f)}))}e.supportHtml||(p.html=({text:n})=>{var u;return(u=t.sanitizerOptions)!=null&&u.replaceWithPlaintext?E(n):(e.isTrusted?n.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?n:""}),a.renderer=p;let g=e.value??"";g.length>1e5&&(g=`${g.substr(0,1e5)}…`),e.supportThemeIcons&&(g=te(g));let T;if(t.fillInIncompleteTokens){const n={...re,...a},o=x(g,n),u=ve(o);T=ne(u,n)}else T=U(g,{...a,async:!1});e.supportThemeIcons&&(T=X(T).map(o=>typeof o=="string"?o:o.outerHTML).join(""));const A=new DOMParser().parseFromString(R({isTrusted:e.isTrusted,...t.sanitizerOptions},T),"text/html");if(A.body.querySelectorAll("img, audio, video, source").forEach(n=>{const o=n.getAttribute("src");if(o){let u=o;try{e.baseUri&&(u=L(y.from(e.baseUri),u))}catch{}if(n.setAttribute("src",d(u,!0)),t.remoteImageIsAllowed){const l=y.parse(u);l.scheme!==m.file&&l.scheme!==m.data&&!t.remoteImageIsAllowed(l)&&n.replaceWith(j("",void 0,n.outerHTML))}}}),A.body.querySelectorAll("a").forEach(n=>{const o=n.getAttribute("href");if(n.setAttribute("href",""),!o||/^data:|javascript:/i.test(o)||/^command:/i.test(o)&&!e.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(o))n.replaceWith(...n.childNodes);else{let u=d(o,!1);e.baseUri&&(u=L(y.from(e.baseUri),o)),n.dataset.href=u}}),s.innerHTML=R({isTrusted:e.isTrusted,...t.sanitizerOptions},A.body.innerHTML),k.length>0)Promise.all(k).then(n=>{var l;if(c)return;const o=new Map(n),u=s.querySelectorAll("div[data-code]");for(const f of u){const b=o.get(f.dataset.code??"");b&&_(f,b)}(l=t.asyncRenderCallback)==null||l.call(t)});else if(h.length>0){const n=new Map(h),o=s.querySelectorAll("div[data-code]");for(const u of o){const l=n.get(u.dataset.code??"");l&&_(u,l)}}if(t.asyncRenderCallback)for(const n of s.getElementsByTagName("img")){const o=r.add(C(n,"load",()=>{o.dispose(),t.asyncRenderCallback()}))}return{element:s,dispose:()=>{c=!0,r.dispose()}}}function P(e){if(!e)return"";const t=e.split(/[\s+|:|,|\{|\?]/,1);return t.length?t[0]:e}function L(e,t){return/^\w[\w\d+.-]*:/.test(t)?t:e.path.endsWith("/")?H(e,t).toString():H(ie(e),t).toString()}const fe=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function R(e,t){const{config:a,allowedSchemes:r}=me(e),c=new z;c.add(O("uponSanitizeAttribute",(s,i)=>{var d;if(i.attrName==="style"||i.attrName==="class"){if(s.tagName==="SPAN"){if(i.attrName==="style"){i.keepAttr=/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z]+)+\));)?(border-radius:[0-9]+px;)?$/.test(i.attrValue);return}else if(i.attrName==="class"){i.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(i.attrValue);return}}i.keepAttr=!1;return}else if(s.tagName==="INPUT"&&((d=s.attributes.getNamedItem("type"))==null?void 0:d.value)==="checkbox"){if(i.attrName==="type"&&i.attrValue==="checkbox"||i.attrName==="disabled"||i.attrName==="checked"){i.keepAttr=!0;return}i.keepAttr=!1}})),c.add(O("uponSanitizeElement",(s,i)=>{var d;if(i.tagName==="input"&&(((d=s.attributes.getNamedItem("type"))==null?void 0:d.value)==="checkbox"?s.setAttribute("disabled",""):e.replaceWithPlaintext||s.remove()),e.replaceWithPlaintext&&!i.allowedTags[i.tagName]&&i.tagName!=="body"&&s.parentElement){let p,k;if(i.tagName==="#comment")p=`<!--${s.textContent}-->`;else{const $=fe.includes(i.tagName),A=s.attributes.length?" "+Array.from(s.attributes).map(n=>`${n.name}="${n.value}"`).join(" "):"";p=`<${i.tagName}${A}>`,$||(k=`</${i.tagName}>`)}const h=document.createDocumentFragment(),g=s.parentElement.ownerDocument.createTextNode(p);h.appendChild(g);const T=k?s.parentElement.ownerDocument.createTextNode(k):void 0;for(;s.firstChild;)h.appendChild(s.firstChild);T&&h.appendChild(T),s.nodeType===Node.COMMENT_NODE?s.parentElement.insertBefore(h,s):s.parentElement.replaceChild(h,s)}})),c.add(F(r));try{return G(t,{...a,RETURN_TRUSTED_TYPE:!0})}finally{c.dispose()}}const pe=["align","autoplay","alt","checked","class","colspan","controls","data-code","data-href","disabled","draggable","height","href","loop","muted","playsinline","poster","rowspan","src","style","target","title","type","width","start"];function me(e){const t=[m.http,m.https,m.mailto,m.data,m.file,m.vscodeFileResource,m.vscodeRemote,m.vscodeRemoteResource];return e.isTrusted&&t.push(m.command),{config:{ALLOWED_TAGS:e.allowedTags??[...V],ALLOWED_ATTR:pe,ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:t}}function Be(e){return typeof e=="string"?e:he(e)}function he(e,t){let a=e.value??"";a.length>1e5&&(a=`${a.substr(0,1e5)}…`);const r=U(a,{async:!1,renderer:Te.value}).replace(/&(#\d+|[a-zA-Z]+);/g,c=>ge.get(c)??c);return R({isTrusted:!1},r).toString()}const ge=new Map([["&quot;",'"'],["&nbsp;"," "],["&amp;","&"],["&#39;","'"],["&lt;","<"],["&gt;",">"]]);function be(){const e=new B;return e.code=({text:t})=>t,e.blockquote=({text:t})=>t+`
`,e.html=t=>"",e.heading=function({tokens:t}){return this.parser.parseInline(t)+`
`},e.hr=()=>"",e.list=function({items:t}){return t.map(a=>this.listitem(a)).join(`
`)+`
`},e.listitem=({text:t})=>t+`
`,e.paragraph=function({tokens:t}){return this.parser.parseInline(t)+`
`},e.table=function({header:t,rows:a}){return t.map(r=>this.tablecell(r)).join(" ")+`
`+a.map(r=>r.map(c=>this.tablecell(c)).join(" ")).join(`
`)+`
`},e.tablerow=({text:t})=>t,e.tablecell=function({tokens:t}){return this.parser.parseInline(t)},e.strong=({text:t})=>t,e.em=({text:t})=>t,e.codespan=({text:t})=>t,e.br=t=>`
`,e.del=({text:t})=>t,e.image=t=>"",e.text=({text:t})=>t,e.link=({text:t})=>t,e}const Te=new de(e=>be());function S(e){let t="";return e.forEach(a=>{t+=a.raw}),t}function W(e){var t,a;if(e.tokens)for(let r=e.tokens.length-1;r>=0;r--){const c=e.tokens[r];if(c.type==="text"){const s=c.raw.split(`
`),i=s[s.length-1];if(i.includes("`"))return xe(e);if(i.includes("**"))return $e(e);if(i.match(/\*\w/))return Ee(e);if(i.match(/(^|\s)__\w/))return Ce(e);if(i.match(/(^|\s)_\w/))return Ne(e);if(ye(i)||we(i)&&e.tokens.slice(0,r).some(d=>d.type==="text"&&d.raw.match(/\[[^\]]*$/))){const d=e.tokens.slice(r+1);return((t=d[0])==null?void 0:t.type)==="link"&&((a=d[1])==null?void 0:a.type)==="text"&&d[1].raw.match(/^ *"[^"]*$/)||i.match(/^[^"]* +"[^"]*$/)?Le(e):Ie(e)}else if(i.match(/(^|\s)\[\w*/))return Re(e)}}}function ye(e){return!!e.match(/(^|\s)\[.*\]\(\w*/)}function we(e){return!!e.match(/^[^\[]*\]\([^\)]*$/)}function ke(e){var p;const t=e.items[e.items.length-1],a=t.tokens?t.tokens[t.tokens.length-1]:void 0;let r;if((a==null?void 0:a.type)==="text"&&!("inRawBlock"in t)&&(r=W(a)),!r||r.type!=="paragraph")return;const c=S(e.items.slice(0,-1)),s=(p=t.raw.match(/^(\s*(-|\d+\.|\*) +)/))==null?void 0:p[0];if(!s)return;const i=s+S(t.tokens.slice(0,-1))+r.raw,d=x(c+i)[0];if(d.type==="list")return d}const Ae=3;function ve(e){for(let t=0;t<Ae;t++){const a=Se(e);if(a)e=a;else break}return e}function Se(e){let t,a;for(t=0;t<e.length;t++){const r=e[t];if(r.type==="paragraph"&&r.raw.match(/(\n|^)\|/)){a=_e(e.slice(t));break}if(t===e.length-1&&r.type==="list"){const c=ke(r);if(c){a=[c];break}}if(t===e.length-1&&r.type==="paragraph"){const c=W(r);if(c){a=[c];break}}}if(a){const r=[...e.slice(0,t),...a];return r.links=e.links,r}return null}function xe(e){return w(e,"`")}function Ee(e){return w(e,"*")}function Ne(e){return w(e,"_")}function Ie(e){return w(e,")")}function Le(e){return w(e,'")')}function Re(e){return w(e,"](https://microsoft.com)")}function $e(e){return w(e,"**")}function Ce(e){return w(e,"__")}function w(e,t){const a=S(Array.isArray(e)?e:[e]);return x(a+t)[0]}function _e(e){const t=S(e),a=t.split(`
`);let r,c=!1;for(let s=0;s<a.length;s++){const i=a[s].trim();if(typeof r>"u"&&i.match(/^\s*\|/)){const d=i.match(/(\|[^\|]+)(?=\||$)/g);d&&(r=d.length)}else if(typeof r=="number")if(i.match(/^\s*\|/)){if(s!==a.length-1)return;c=!0}else return}if(typeof r=="number"&&r>0){const s=c?a.slice(0,-1).join(`
`):t,i=!!s.match(/\|\s*$/),d=s+(i?"":"|")+`
|${" --- |".repeat(r)}`;return x(d)}}function O(e,t){return Z(e,t),ce(()=>J(e))}export{Be as a,ze as r};
//# sourceMappingURL=monaco-editor-esm-vs-base-browser-markdownRenderer-BB65ORmS.js.map
