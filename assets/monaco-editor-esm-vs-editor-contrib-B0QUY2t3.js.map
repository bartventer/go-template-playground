{"version":3,"file":"monaco-editor-esm-vs-editor-contrib-B0QUY2t3.js","sources":["../../../node_modules/monaco-editor/esm/vs/editor/contrib/editorState/browser/keybindingCancellation.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/editorState/browser/editorState.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/formattingEdit.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/format.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/anchorSelect/browser/anchorSelect.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/bracketMatching/browser/bracketMatching.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/browser/moveCaretCommand.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/browser/caretOperations.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/browser/transpose.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/dropOrPasteInto/browser/defaultProviders.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetParser.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/dropOrPasteInto/browser/edit.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineProgress/browser/inlineProgress.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/message/browser/messageController.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/dropOrPasteInto/browser/postEditWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/dropOrPasteInto/browser/copyPasteController.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/clipboard/browser/clipboard.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/common/types.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeAction.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionKeybindingResolver.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/symbolIcons/browser/symbolIcons.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionMenu.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/lightBulbWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionModel.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionController.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionCommands.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionContributions.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/codelens/browser/codelens.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/codelens/browser/codeLensCache.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/codelens/browser/codelensWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/codelens/browser/codelensController.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/defaultDocumentColorProvider.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/color.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/colorDetector.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/colorPickerModel.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/colorPickerWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverTypes.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/colorHoverParticipant.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverActionIds.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/controller/commandIds.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/hintsWidget/inlineCompletionsHintsWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverUtils.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverOperation.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/resizableContentWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/contentHoverWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/contentHoverComputer.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/contentHoverTypes.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/contentHoverStatusBar.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/getHover.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/markdownHoverParticipant.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/clickLinkGesture.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHints.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/zoneWidget/browser/zoneWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/peekView/browser/peekView.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/referencesModel.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesTree.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesController.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/symbolNavigation.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToSymbol.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToCommands.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHintsLocations.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHintsController.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHintsHover.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/contentHoverRendered.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/contentHoverWidgetWrapper.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/contentHoverController2.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/colorContributions.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/standaloneColorPickerWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/standaloneColorPickerActions.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/comment/browser/blockCommentCommand.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/comment/browser/lineCommentCommand.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/comment/browser/comment.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/contextmenu/browser/contextmenu.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/cursorUndo/browser/cursorUndo.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/dnd/browser/dragAndDropCommand.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/dnd/browser/dnd.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/dropOrPasteInto/browser/copyPasteContribution.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/dropOrPasteInto/browser/dropIntoEditorController.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/dropOrPasteInto/browser/dropIntoEditorContribution.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findDecorations.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/replaceAllCommand.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/replacePattern.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findModel.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findOptionsWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findState.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findController.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/foldingRanges.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/foldingModel.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/hiddenRangeModel.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/indentRangeProvider.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/foldingDecorations.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/syntaxRangeProvider.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/folding.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/fontZoom/browser/fontZoom.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/formatActions.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/documentSymbols/browser/outlineModel.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/documentSymbols/browser/documentSymbols.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/controller/inlineCompletionContextKeys.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/model/ghostText.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/utils.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/view/ghostTextView.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/model/provideInlineCompletions.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/model/singleTextEdit.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/model/inlineCompletionsSource.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggest.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetVariables.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetSession.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetController2.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/model/inlineCompletionsModel.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestMemory.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/wordContextKey.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestAlternatives.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestCommitCharacters.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/browser/bracketSelections.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/wordDistance.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/completionModel.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestModel.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestOvertypingCapturer.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidgetStatus.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidgetDetails.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidgetRenderer.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestController.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/model/suggestWidgetAdaptor.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/controller/inlineCompletionsController.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/controller/commands.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/hintsWidget/hoverParticipant.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/inlineCompletionsAccessibleView.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/inlineCompletions.contribution.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/markerNavigationService.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/gotoErrorWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/gotoError.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverActions.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/markerHoverParticipant.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/marginHoverComputer.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/marginHoverWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/marginHoverController.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverAccessibleViews.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverContribution.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/indentation/common/indentUtils.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/indentation/common/indentation.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/indentation/browser/indentation.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHintsContribution.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inPlaceReplace/browser/inPlaceReplaceCommand.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inPlaceReplace/browser/inPlaceReplace.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/lineSelection/browser/lineSelection.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/browser/copyLinesCommand.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/browser/moveLinesCommand.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/browser/sortLinesCommand.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/browser/linesOperations.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/linkedEditing/browser/linkedEditing.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/links/browser/getLinks.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/links/browser/links.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/longLinesHelper/browser/longLinesHelper.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/wordHighlighter/browser/highlightDecorations.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/multicursor/browser/multicursor.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdit/browser/commandIds.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdit/browser/ghostTextWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdit/browser/inlineEditHintsWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdit/browser/inlineEditSideBySideWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdit/browser/inlineEditController.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdit/browser/commands.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdit/browser/inlineEdit.contribution.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdits/browser/consts.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/placeholderText/browser/placeholderTextContribution.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdits/browser/inlineEditsWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdits/browser/inlineEditsModel.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdits/browser/inlineEditsController.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdits/browser/commands.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdits/browser/inlineEdits.contribution.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/browser/provideSignatureHelp.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/browser/parameterHintsModel.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/browser/parameterHintsWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/browser/parameterHints.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/placeholderText/browser/placeholderText.contribution.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/rename/browser/renameWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/rename/browser/rename.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/sectionHeaders/browser/sectionHeaders.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/semanticTokens/common/getSemanticTokens.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/semanticTokens/common/semanticTokensConfig.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/semanticTokens/browser/documentSemanticTokens.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/semanticTokens/browser/viewportSemanticTokens.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/browser/wordSelections.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/browser/smartSelect.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollWidget.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollElement.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollModelProvider.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollProvider.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollController.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollActions.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollContribution.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestInlineCompletions.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/tokenization/browser/tokenization.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/toggleTabFocusMode/browser/toggleTabFocusMode.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/unicodeHighlighter/browser/bannerController.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/unicodeHighlighter/browser/unicodeHighlighter.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/unusualLineTerminators/browser/unusualLineTerminators.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/wordHighlighter/browser/textualHighlightProvider.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/wordHighlighter/browser/wordHighlighter.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/wordOperations/browser/wordOperations.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/wordPartOperations/browser/wordPartOperations.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/readOnlyMessage/browser/contribution.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/diffEditorBreadcrumbs/browser/contribution.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/editorNavigationQuickAccess.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/gotoLineQuickAccess.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/gotoSymbolQuickAccess.js","../../../node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/commandsQuickAccess.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorCommand, registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { localize } from '../../../../nls.js';\nconst IEditorCancellationTokens = createDecorator('IEditorCancelService');\nconst ctxCancellableOperation = new RawContextKey('cancellableOperation', false, localize('cancellableOperation', 'Whether the editor runs a cancellable operation, e.g. like \\'Peek References\\''));\nregisterSingleton(IEditorCancellationTokens, class {\n    constructor() {\n        this._tokens = new WeakMap();\n    }\n    add(editor, cts) {\n        let data = this._tokens.get(editor);\n        if (!data) {\n            data = editor.invokeWithinContext(accessor => {\n                const key = ctxCancellableOperation.bindTo(accessor.get(IContextKeyService));\n                const tokens = new LinkedList();\n                return { key, tokens };\n            });\n            this._tokens.set(editor, data);\n        }\n        let removeFn;\n        data.key.set(true);\n        removeFn = data.tokens.push(cts);\n        return () => {\n            // remove w/o cancellation\n            if (removeFn) {\n                removeFn();\n                data.key.set(!data.tokens.isEmpty());\n                removeFn = undefined;\n            }\n        };\n    }\n    cancel(editor) {\n        const data = this._tokens.get(editor);\n        if (!data) {\n            return;\n        }\n        // remove with cancellation\n        const cts = data.tokens.pop();\n        if (cts) {\n            cts.cancel();\n            data.key.set(!data.tokens.isEmpty());\n        }\n    }\n}, 1 /* InstantiationType.Delayed */);\nexport class EditorKeybindingCancellationTokenSource extends CancellationTokenSource {\n    constructor(editor, parent) {\n        super(parent);\n        this.editor = editor;\n        this._unregister = editor.invokeWithinContext(accessor => accessor.get(IEditorCancellationTokens).add(editor, this));\n    }\n    dispose() {\n        this._unregister();\n        super.dispose();\n    }\n}\nregisterEditorCommand(new class extends EditorCommand {\n    constructor() {\n        super({\n            id: 'editor.cancelOperation',\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */,\n                primary: 9 /* KeyCode.Escape */\n            },\n            precondition: ctxCancellableOperation\n        });\n    }\n    runEditorCommand(accessor, editor) {\n        accessor.get(IEditorCancellationTokens).cancel(editor);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as strings from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorKeybindingCancellationTokenSource } from './keybindingCancellation.js';\nexport class EditorState {\n    constructor(editor, flags) {\n        this.flags = flags;\n        if ((this.flags & 1 /* CodeEditorStateFlag.Value */) !== 0) {\n            const model = editor.getModel();\n            this.modelVersionId = model ? strings.format('{0}#{1}', model.uri.toString(), model.getVersionId()) : null;\n        }\n        else {\n            this.modelVersionId = null;\n        }\n        if ((this.flags & 4 /* CodeEditorStateFlag.Position */) !== 0) {\n            this.position = editor.getPosition();\n        }\n        else {\n            this.position = null;\n        }\n        if ((this.flags & 2 /* CodeEditorStateFlag.Selection */) !== 0) {\n            this.selection = editor.getSelection();\n        }\n        else {\n            this.selection = null;\n        }\n        if ((this.flags & 8 /* CodeEditorStateFlag.Scroll */) !== 0) {\n            this.scrollLeft = editor.getScrollLeft();\n            this.scrollTop = editor.getScrollTop();\n        }\n        else {\n            this.scrollLeft = -1;\n            this.scrollTop = -1;\n        }\n    }\n    _equals(other) {\n        if (!(other instanceof EditorState)) {\n            return false;\n        }\n        const state = other;\n        if (this.modelVersionId !== state.modelVersionId) {\n            return false;\n        }\n        if (this.scrollLeft !== state.scrollLeft || this.scrollTop !== state.scrollTop) {\n            return false;\n        }\n        if (!this.position && state.position || this.position && !state.position || this.position && state.position && !this.position.equals(state.position)) {\n            return false;\n        }\n        if (!this.selection && state.selection || this.selection && !state.selection || this.selection && state.selection && !this.selection.equalsRange(state.selection)) {\n            return false;\n        }\n        return true;\n    }\n    validate(editor) {\n        return this._equals(new EditorState(editor, this.flags));\n    }\n}\n/**\n * A cancellation token source that cancels when the editor changes as expressed\n * by the provided flags\n * @param range If provided, changes in position and selection within this range will not trigger cancellation\n */\nexport class EditorStateCancellationTokenSource extends EditorKeybindingCancellationTokenSource {\n    constructor(editor, flags, range, parent) {\n        super(editor, parent);\n        this._listener = new DisposableStore();\n        if (flags & 4 /* CodeEditorStateFlag.Position */) {\n            this._listener.add(editor.onDidChangeCursorPosition(e => {\n                if (!range || !Range.containsPosition(range, e.position)) {\n                    this.cancel();\n                }\n            }));\n        }\n        if (flags & 2 /* CodeEditorStateFlag.Selection */) {\n            this._listener.add(editor.onDidChangeCursorSelection(e => {\n                if (!range || !Range.containsRange(range, e.selection)) {\n                    this.cancel();\n                }\n            }));\n        }\n        if (flags & 8 /* CodeEditorStateFlag.Scroll */) {\n            this._listener.add(editor.onDidScrollChange(_ => this.cancel()));\n        }\n        if (flags & 1 /* CodeEditorStateFlag.Value */) {\n            this._listener.add(editor.onDidChangeModel(_ => this.cancel()));\n            this._listener.add(editor.onDidChangeModelContent(_ => this.cancel()));\n        }\n    }\n    dispose() {\n        this._listener.dispose();\n        super.dispose();\n    }\n}\n/**\n * A cancellation token source that cancels when the provided model changes\n */\nexport class TextModelCancellationTokenSource extends CancellationTokenSource {\n    constructor(model, parent) {\n        super(parent);\n        this._listener = model.onDidChangeContent(() => this.cancel());\n    }\n    dispose() {\n        this._listener.dispose();\n        super.dispose();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nexport class FormattingEdit {\n    static _handleEolEdits(editor, edits) {\n        let newEol = undefined;\n        const singleEdits = [];\n        for (const edit of edits) {\n            if (typeof edit.eol === 'number') {\n                newEol = edit.eol;\n            }\n            if (edit.range && typeof edit.text === 'string') {\n                singleEdits.push(edit);\n            }\n        }\n        if (typeof newEol === 'number') {\n            if (editor.hasModel()) {\n                editor.getModel().pushEOL(newEol);\n            }\n        }\n        return singleEdits;\n    }\n    static _isFullModelReplaceEdit(editor, edit) {\n        if (!editor.hasModel()) {\n            return false;\n        }\n        const model = editor.getModel();\n        const editRange = model.validateRange(edit.range);\n        const fullModelRange = model.getFullModelRange();\n        return fullModelRange.equalsRange(editRange);\n    }\n    static execute(editor, _edits, addUndoStops) {\n        if (addUndoStops) {\n            editor.pushUndoStop();\n        }\n        const scrollState = StableEditorScrollState.capture(editor);\n        const edits = FormattingEdit._handleEolEdits(editor, _edits);\n        if (edits.length === 1 && FormattingEdit._isFullModelReplaceEdit(editor, edits[0])) {\n            // We use replace semantics and hope that markers stay put...\n            editor.executeEdits('formatEditsCommand', edits.map(edit => EditOperation.replace(Range.lift(edit.range), edit.text)));\n        }\n        else {\n            editor.executeEdits('formatEditsCommand', edits.map(edit => EditOperation.replaceMove(Range.lift(edit.range), edit.text)));\n        }\n        if (addUndoStops) {\n            editor.pushUndoStop();\n        }\n        scrollState.restoreRelativeVerticalPositionOfCursor(editor);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { asArray, isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource, TextModelCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { FormattingEdit } from './formattingEdit.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ExtensionIdentifierSet } from '../../../../platform/extensions/common/extensions.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { AccessibilitySignal, IAccessibilitySignalService } from '../../../../platform/accessibilitySignal/browser/accessibilitySignalService.js';\nexport function getRealAndSyntheticDocumentFormattersOrdered(documentFormattingEditProvider, documentRangeFormattingEditProvider, model) {\n    const result = [];\n    const seen = new ExtensionIdentifierSet();\n    // (1) add all document formatter\n    const docFormatter = documentFormattingEditProvider.ordered(model);\n    for (const formatter of docFormatter) {\n        result.push(formatter);\n        if (formatter.extensionId) {\n            seen.add(formatter.extensionId);\n        }\n    }\n    // (2) add all range formatter as document formatter (unless the same extension already did that)\n    const rangeFormatter = documentRangeFormattingEditProvider.ordered(model);\n    for (const formatter of rangeFormatter) {\n        if (formatter.extensionId) {\n            if (seen.has(formatter.extensionId)) {\n                continue;\n            }\n            seen.add(formatter.extensionId);\n        }\n        result.push({\n            displayName: formatter.displayName,\n            extensionId: formatter.extensionId,\n            provideDocumentFormattingEdits(model, options, token) {\n                return formatter.provideDocumentRangeFormattingEdits(model, model.getFullModelRange(), options, token);\n            }\n        });\n    }\n    return result;\n}\nexport class FormattingConflicts {\n    static { this._selectors = new LinkedList(); }\n    static setFormatterSelector(selector) {\n        const remove = FormattingConflicts._selectors.unshift(selector);\n        return { dispose: remove };\n    }\n    static async select(formatter, document, mode, kind) {\n        if (formatter.length === 0) {\n            return undefined;\n        }\n        const selector = Iterable.first(FormattingConflicts._selectors);\n        if (selector) {\n            return await selector(formatter, document, mode, kind);\n        }\n        return undefined;\n    }\n}\nexport async function formatDocumentRangesWithSelectedProvider(accessor, editorOrModel, rangeOrRanges, mode, progress, token, userGesture) {\n    const instaService = accessor.get(IInstantiationService);\n    const { documentRangeFormattingEditProvider: documentRangeFormattingEditProviderRegistry } = accessor.get(ILanguageFeaturesService);\n    const model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\n    const provider = documentRangeFormattingEditProviderRegistry.ordered(model);\n    const selected = await FormattingConflicts.select(provider, model, mode, 2 /* FormattingKind.Selection */);\n    if (selected) {\n        progress.report(selected);\n        await instaService.invokeFunction(formatDocumentRangesWithProvider, selected, editorOrModel, rangeOrRanges, token, userGesture);\n    }\n}\nexport async function formatDocumentRangesWithProvider(accessor, provider, editorOrModel, rangeOrRanges, token, userGesture) {\n    const workerService = accessor.get(IEditorWorkerService);\n    const logService = accessor.get(ILogService);\n    const accessibilitySignalService = accessor.get(IAccessibilitySignalService);\n    let model;\n    let cts;\n    if (isCodeEditor(editorOrModel)) {\n        model = editorOrModel.getModel();\n        cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */, undefined, token);\n    }\n    else {\n        model = editorOrModel;\n        cts = new TextModelCancellationTokenSource(editorOrModel, token);\n    }\n    // make sure that ranges don't overlap nor touch each other\n    const ranges = [];\n    let len = 0;\n    for (const range of asArray(rangeOrRanges).sort(Range.compareRangesUsingStarts)) {\n        if (len > 0 && Range.areIntersectingOrTouching(ranges[len - 1], range)) {\n            ranges[len - 1] = Range.fromPositions(ranges[len - 1].getStartPosition(), range.getEndPosition());\n        }\n        else {\n            len = ranges.push(range);\n        }\n    }\n    const computeEdits = async (range) => {\n        logService.trace(`[format][provideDocumentRangeFormattingEdits] (request)`, provider.extensionId?.value, range);\n        const result = (await provider.provideDocumentRangeFormattingEdits(model, range, model.getFormattingOptions(), cts.token)) || [];\n        logService.trace(`[format][provideDocumentRangeFormattingEdits] (response)`, provider.extensionId?.value, result);\n        return result;\n    };\n    const hasIntersectingEdit = (a, b) => {\n        if (!a.length || !b.length) {\n            return false;\n        }\n        // quick exit if the list of ranges are completely unrelated [O(n)]\n        const mergedA = a.reduce((acc, val) => { return Range.plusRange(acc, val.range); }, a[0].range);\n        if (!b.some(x => { return Range.intersectRanges(mergedA, x.range); })) {\n            return false;\n        }\n        // fallback to a complete check [O(n^2)]\n        for (const edit of a) {\n            for (const otherEdit of b) {\n                if (Range.intersectRanges(edit.range, otherEdit.range)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    const allEdits = [];\n    const rawEditsList = [];\n    try {\n        if (typeof provider.provideDocumentRangesFormattingEdits === 'function') {\n            logService.trace(`[format][provideDocumentRangeFormattingEdits] (request)`, provider.extensionId?.value, ranges);\n            const result = (await provider.provideDocumentRangesFormattingEdits(model, ranges, model.getFormattingOptions(), cts.token)) || [];\n            logService.trace(`[format][provideDocumentRangeFormattingEdits] (response)`, provider.extensionId?.value, result);\n            rawEditsList.push(result);\n        }\n        else {\n            for (const range of ranges) {\n                if (cts.token.isCancellationRequested) {\n                    return true;\n                }\n                rawEditsList.push(await computeEdits(range));\n            }\n            for (let i = 0; i < ranges.length; ++i) {\n                for (let j = i + 1; j < ranges.length; ++j) {\n                    if (cts.token.isCancellationRequested) {\n                        return true;\n                    }\n                    if (hasIntersectingEdit(rawEditsList[i], rawEditsList[j])) {\n                        // Merge ranges i and j into a single range, recompute the associated edits\n                        const mergedRange = Range.plusRange(ranges[i], ranges[j]);\n                        const edits = await computeEdits(mergedRange);\n                        ranges.splice(j, 1);\n                        ranges.splice(i, 1);\n                        ranges.push(mergedRange);\n                        rawEditsList.splice(j, 1);\n                        rawEditsList.splice(i, 1);\n                        rawEditsList.push(edits);\n                        // Restart scanning\n                        i = 0;\n                        j = 0;\n                    }\n                }\n            }\n        }\n        for (const rawEdits of rawEditsList) {\n            if (cts.token.isCancellationRequested) {\n                return true;\n            }\n            const minimalEdits = await workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n            if (minimalEdits) {\n                allEdits.push(...minimalEdits);\n            }\n        }\n    }\n    finally {\n        cts.dispose();\n    }\n    if (allEdits.length === 0) {\n        return false;\n    }\n    if (isCodeEditor(editorOrModel)) {\n        // use editor to apply edits\n        FormattingEdit.execute(editorOrModel, allEdits, true);\n        editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* ScrollType.Immediate */);\n    }\n    else {\n        // use model to apply edits\n        const [{ range }] = allEdits;\n        const initialSelection = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\n        model.pushEditOperations([initialSelection], allEdits.map(edit => {\n            return {\n                text: edit.text,\n                range: Range.lift(edit.range),\n                forceMoveMarkers: true\n            };\n        }), undoEdits => {\n            for (const { range } of undoEdits) {\n                if (Range.areIntersectingOrTouching(range, initialSelection)) {\n                    return [new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn)];\n                }\n            }\n            return null;\n        });\n    }\n    accessibilitySignalService.playSignal(AccessibilitySignal.format, { userGesture });\n    return true;\n}\nexport async function formatDocumentWithSelectedProvider(accessor, editorOrModel, mode, progress, token, userGesture) {\n    const instaService = accessor.get(IInstantiationService);\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\n    const provider = getRealAndSyntheticDocumentFormattersOrdered(languageFeaturesService.documentFormattingEditProvider, languageFeaturesService.documentRangeFormattingEditProvider, model);\n    const selected = await FormattingConflicts.select(provider, model, mode, 1 /* FormattingKind.File */);\n    if (selected) {\n        progress.report(selected);\n        await instaService.invokeFunction(formatDocumentWithProvider, selected, editorOrModel, mode, token, userGesture);\n    }\n}\nexport async function formatDocumentWithProvider(accessor, provider, editorOrModel, mode, token, userGesture) {\n    const workerService = accessor.get(IEditorWorkerService);\n    const accessibilitySignalService = accessor.get(IAccessibilitySignalService);\n    let model;\n    let cts;\n    if (isCodeEditor(editorOrModel)) {\n        model = editorOrModel.getModel();\n        cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */, undefined, token);\n    }\n    else {\n        model = editorOrModel;\n        cts = new TextModelCancellationTokenSource(editorOrModel, token);\n    }\n    let edits;\n    try {\n        const rawEdits = await provider.provideDocumentFormattingEdits(model, model.getFormattingOptions(), cts.token);\n        edits = await workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n        if (cts.token.isCancellationRequested) {\n            return true;\n        }\n    }\n    finally {\n        cts.dispose();\n    }\n    if (!edits || edits.length === 0) {\n        return false;\n    }\n    if (isCodeEditor(editorOrModel)) {\n        // use editor to apply edits\n        FormattingEdit.execute(editorOrModel, edits, mode !== 2 /* FormattingMode.Silent */);\n        if (mode !== 2 /* FormattingMode.Silent */) {\n            editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* ScrollType.Immediate */);\n        }\n    }\n    else {\n        // use model to apply edits\n        const [{ range }] = edits;\n        const initialSelection = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\n        model.pushEditOperations([initialSelection], edits.map(edit => {\n            return {\n                text: edit.text,\n                range: Range.lift(edit.range),\n                forceMoveMarkers: true\n            };\n        }), undoEdits => {\n            for (const { range } of undoEdits) {\n                if (Range.areIntersectingOrTouching(range, initialSelection)) {\n                    return [new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn)];\n                }\n            }\n            return null;\n        });\n    }\n    accessibilitySignalService.playSignal(AccessibilitySignal.format, { userGesture });\n    return true;\n}\nexport async function getDocumentRangeFormattingEditsUntilResult(workerService, languageFeaturesService, model, range, options, token) {\n    const providers = languageFeaturesService.documentRangeFormattingEditProvider.ordered(model);\n    for (const provider of providers) {\n        const rawEdits = await Promise.resolve(provider.provideDocumentRangeFormattingEdits(model, range, options, token)).catch(onUnexpectedExternalError);\n        if (isNonEmptyArray(rawEdits)) {\n            return await workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n        }\n    }\n    return undefined;\n}\nexport async function getDocumentFormattingEditsUntilResult(workerService, languageFeaturesService, model, options, token) {\n    const providers = getRealAndSyntheticDocumentFormattersOrdered(languageFeaturesService.documentFormattingEditProvider, languageFeaturesService.documentRangeFormattingEditProvider, model);\n    for (const provider of providers) {\n        const rawEdits = await Promise.resolve(provider.provideDocumentFormattingEdits(model, options, token)).catch(onUnexpectedExternalError);\n        if (isNonEmptyArray(rawEdits)) {\n            return await workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n        }\n    }\n    return undefined;\n}\nexport function getOnTypeFormattingEdits(workerService, languageFeaturesService, model, position, ch, options, token) {\n    const providers = languageFeaturesService.onTypeFormattingEditProvider.ordered(model);\n    if (providers.length === 0) {\n        return Promise.resolve(undefined);\n    }\n    if (providers[0].autoFormatTriggerCharacters.indexOf(ch) < 0) {\n        return Promise.resolve(undefined);\n    }\n    return Promise.resolve(providers[0].provideOnTypeFormattingEdits(model, position, ch, options, token)).catch(onUnexpectedExternalError).then(edits => {\n        return workerService.computeMoreMinimalEdits(model.uri, edits);\n    });\n}\nCommandsRegistry.registerCommand('_executeFormatRangeProvider', async function (accessor, ...args) {\n    const [resource, range, options] = args;\n    assertType(URI.isUri(resource));\n    assertType(Range.isIRange(range));\n    const resolverService = accessor.get(ITextModelService);\n    const workerService = accessor.get(IEditorWorkerService);\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const reference = await resolverService.createModelReference(resource);\n    try {\n        return getDocumentRangeFormattingEditsUntilResult(workerService, languageFeaturesService, reference.object.textEditorModel, Range.lift(range), options, CancellationToken.None);\n    }\n    finally {\n        reference.dispose();\n    }\n});\nCommandsRegistry.registerCommand('_executeFormatDocumentProvider', async function (accessor, ...args) {\n    const [resource, options] = args;\n    assertType(URI.isUri(resource));\n    const resolverService = accessor.get(ITextModelService);\n    const workerService = accessor.get(IEditorWorkerService);\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const reference = await resolverService.createModelReference(resource);\n    try {\n        return getDocumentFormattingEditsUntilResult(workerService, languageFeaturesService, reference.object.textEditorModel, options, CancellationToken.None);\n    }\n    finally {\n        reference.dispose();\n    }\n});\nCommandsRegistry.registerCommand('_executeFormatOnTypeProvider', async function (accessor, ...args) {\n    const [resource, position, ch, options] = args;\n    assertType(URI.isUri(resource));\n    assertType(Position.isIPosition(position));\n    assertType(typeof ch === 'string');\n    const resolverService = accessor.get(ITextModelService);\n    const workerService = accessor.get(IEditorWorkerService);\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const reference = await resolverService.createModelReference(resource);\n    try {\n        return getOnTypeFormattingEdits(workerService, languageFeaturesService, reference.object.textEditorModel, Position.lift(position), ch, options, CancellationToken.None);\n    }\n    finally {\n        reference.dispose();\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SelectionAnchorController_1;\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport './anchorSelect.css';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nexport const SelectionAnchorSet = new RawContextKey('selectionAnchorSet', false);\nlet SelectionAnchorController = class SelectionAnchorController {\n    static { SelectionAnchorController_1 = this; }\n    static { this.ID = 'editor.contrib.selectionAnchorController'; }\n    static get(editor) {\n        return editor.getContribution(SelectionAnchorController_1.ID);\n    }\n    constructor(editor, contextKeyService) {\n        this.editor = editor;\n        this.selectionAnchorSetContextKey = SelectionAnchorSet.bindTo(contextKeyService);\n        this.modelChangeListener = editor.onDidChangeModel(() => this.selectionAnchorSetContextKey.reset());\n    }\n    setSelectionAnchor() {\n        if (this.editor.hasModel()) {\n            const position = this.editor.getPosition();\n            this.editor.changeDecorations((accessor) => {\n                if (this.decorationId) {\n                    accessor.removeDecoration(this.decorationId);\n                }\n                this.decorationId = accessor.addDecoration(Selection.fromPositions(position, position), {\n                    description: 'selection-anchor',\n                    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n                    hoverMessage: new MarkdownString().appendText(localize('selectionAnchor', \"Selection Anchor\")),\n                    className: 'selection-anchor'\n                });\n            });\n            this.selectionAnchorSetContextKey.set(!!this.decorationId);\n            alert(localize('anchorSet', \"Anchor set at {0}:{1}\", position.lineNumber, position.column));\n        }\n    }\n    goToSelectionAnchor() {\n        if (this.editor.hasModel() && this.decorationId) {\n            const anchorPosition = this.editor.getModel().getDecorationRange(this.decorationId);\n            if (anchorPosition) {\n                this.editor.setPosition(anchorPosition.getStartPosition());\n            }\n        }\n    }\n    selectFromAnchorToCursor() {\n        if (this.editor.hasModel() && this.decorationId) {\n            const start = this.editor.getModel().getDecorationRange(this.decorationId);\n            if (start) {\n                const end = this.editor.getPosition();\n                this.editor.setSelection(Selection.fromPositions(start.getStartPosition(), end));\n                this.cancelSelectionAnchor();\n            }\n        }\n    }\n    cancelSelectionAnchor() {\n        if (this.decorationId) {\n            const decorationId = this.decorationId;\n            this.editor.changeDecorations((accessor) => {\n                accessor.removeDecoration(decorationId);\n                this.decorationId = undefined;\n            });\n            this.selectionAnchorSetContextKey.set(false);\n        }\n    }\n    dispose() {\n        this.cancelSelectionAnchor();\n        this.modelChangeListener.dispose();\n    }\n};\nSelectionAnchorController = SelectionAnchorController_1 = __decorate([\n    __param(1, IContextKeyService)\n], SelectionAnchorController);\nclass SetSelectionAnchor extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.setSelectionAnchor',\n            label: localize('setSelectionAnchor', \"Set Selection Anchor\"),\n            alias: 'Set Selection Anchor',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 32 /* KeyCode.KeyB */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    async run(_accessor, editor) {\n        SelectionAnchorController.get(editor)?.setSelectionAnchor();\n    }\n}\nclass GoToSelectionAnchor extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.goToSelectionAnchor',\n            label: localize('goToSelectionAnchor', \"Go to Selection Anchor\"),\n            alias: 'Go to Selection Anchor',\n            precondition: SelectionAnchorSet,\n        });\n    }\n    async run(_accessor, editor) {\n        SelectionAnchorController.get(editor)?.goToSelectionAnchor();\n    }\n}\nclass SelectFromAnchorToCursor extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.selectFromAnchorToCursor',\n            label: localize('selectFromAnchorToCursor', \"Select from Anchor to Cursor\"),\n            alias: 'Select from Anchor to Cursor',\n            precondition: SelectionAnchorSet,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    async run(_accessor, editor) {\n        SelectionAnchorController.get(editor)?.selectFromAnchorToCursor();\n    }\n}\nclass CancelSelectionAnchor extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.cancelSelectionAnchor',\n            label: localize('cancelSelectionAnchor', \"Cancel Selection Anchor\"),\n            alias: 'Cancel Selection Anchor',\n            precondition: SelectionAnchorSet,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 9 /* KeyCode.Escape */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    async run(_accessor, editor) {\n        SelectionAnchorController.get(editor)?.cancelSelectionAnchor();\n    }\n}\nregisterEditorContribution(SelectionAnchorController.ID, SelectionAnchorController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(SetSelectionAnchor);\nregisterEditorAction(GoToSelectionAnchor);\nregisterEditorAction(SelectFromAnchorToCursor);\nregisterEditorAction(CancelSelectionAnchor);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport './bracketMatching.css';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { OverviewRulerLane } from '../../../common/model.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId, MenuRegistry } from '../../../../platform/actions/common/actions.js';\nimport { registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nconst overviewRulerBracketMatchForeground = registerColor('editorOverviewRuler.bracketMatchForeground', '#A0A0A0', nls.localize('overviewRulerBracketMatchForeground', 'Overview ruler marker color for matching brackets.'));\nclass JumpToBracketAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.jumpToBracket',\n            label: nls.localize('smartSelect.jumpBracket', \"Go to Bracket\"),\n            alias: 'Go to Bracket',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 93 /* KeyCode.Backslash */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        BracketMatchingController.get(editor)?.jumpToBracket();\n    }\n}\nclass SelectToBracketAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.selectToBracket',\n            label: nls.localize('smartSelect.selectToBracket', \"Select to Bracket\"),\n            alias: 'Select to Bracket',\n            precondition: undefined,\n            metadata: {\n                description: nls.localize2('smartSelect.selectToBracketDescription', \"Select the text inside and including the brackets or curly braces\"),\n                args: [{\n                        name: 'args',\n                        schema: {\n                            type: 'object',\n                            properties: {\n                                'selectBrackets': {\n                                    type: 'boolean',\n                                    default: true\n                                }\n                            },\n                        }\n                    }]\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        let selectBrackets = true;\n        if (args && args.selectBrackets === false) {\n            selectBrackets = false;\n        }\n        BracketMatchingController.get(editor)?.selectToBracket(selectBrackets);\n    }\n}\nclass RemoveBracketsAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.removeBrackets',\n            label: nls.localize('smartSelect.removeBrackets', \"Remove Brackets\"),\n            alias: 'Remove Brackets',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 1 /* KeyCode.Backspace */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        BracketMatchingController.get(editor)?.removeBrackets(this.id);\n    }\n}\nclass BracketsData {\n    constructor(position, brackets, options) {\n        this.position = position;\n        this.brackets = brackets;\n        this.options = options;\n    }\n}\nexport class BracketMatchingController extends Disposable {\n    static { this.ID = 'editor.contrib.bracketMatchingController'; }\n    static get(editor) {\n        return editor.getContribution(BracketMatchingController.ID);\n    }\n    constructor(editor) {\n        super();\n        this._editor = editor;\n        this._lastBracketsData = [];\n        this._lastVersionId = 0;\n        this._decorations = this._editor.createDecorationsCollection();\n        this._updateBracketsSoon = this._register(new RunOnceScheduler(() => this._updateBrackets(), 50));\n        this._matchBrackets = this._editor.getOption(72 /* EditorOption.matchBrackets */);\n        this._updateBracketsSoon.schedule();\n        this._register(editor.onDidChangeCursorPosition((e) => {\n            if (this._matchBrackets === 'never') {\n                // Early exit if nothing needs to be done!\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\n                return;\n            }\n            this._updateBracketsSoon.schedule();\n        }));\n        this._register(editor.onDidChangeModelContent((e) => {\n            this._updateBracketsSoon.schedule();\n        }));\n        this._register(editor.onDidChangeModel((e) => {\n            this._lastBracketsData = [];\n            this._updateBracketsSoon.schedule();\n        }));\n        this._register(editor.onDidChangeModelLanguageConfiguration((e) => {\n            this._lastBracketsData = [];\n            this._updateBracketsSoon.schedule();\n        }));\n        this._register(editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(72 /* EditorOption.matchBrackets */)) {\n                this._matchBrackets = this._editor.getOption(72 /* EditorOption.matchBrackets */);\n                this._decorations.clear();\n                this._lastBracketsData = [];\n                this._lastVersionId = 0;\n                this._updateBracketsSoon.schedule();\n            }\n        }));\n        this._register(editor.onDidBlurEditorWidget(() => {\n            this._updateBracketsSoon.schedule();\n        }));\n        this._register(editor.onDidFocusEditorWidget(() => {\n            this._updateBracketsSoon.schedule();\n        }));\n    }\n    jumpToBracket() {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const newSelections = this._editor.getSelections().map(selection => {\n            const position = selection.getStartPosition();\n            // find matching brackets if position is on a bracket\n            const brackets = model.bracketPairs.matchBracket(position);\n            let newCursorPosition = null;\n            if (brackets) {\n                if (brackets[0].containsPosition(position) && !brackets[1].containsPosition(position)) {\n                    newCursorPosition = brackets[1].getStartPosition();\n                }\n                else if (brackets[1].containsPosition(position)) {\n                    newCursorPosition = brackets[0].getStartPosition();\n                }\n            }\n            else {\n                // find the enclosing brackets if the position isn't on a matching bracket\n                const enclosingBrackets = model.bracketPairs.findEnclosingBrackets(position);\n                if (enclosingBrackets) {\n                    newCursorPosition = enclosingBrackets[1].getStartPosition();\n                }\n                else {\n                    // no enclosing brackets, try the very first next bracket\n                    const nextBracket = model.bracketPairs.findNextBracket(position);\n                    if (nextBracket && nextBracket.range) {\n                        newCursorPosition = nextBracket.range.getStartPosition();\n                    }\n                }\n            }\n            if (newCursorPosition) {\n                return new Selection(newCursorPosition.lineNumber, newCursorPosition.column, newCursorPosition.lineNumber, newCursorPosition.column);\n            }\n            return new Selection(position.lineNumber, position.column, position.lineNumber, position.column);\n        });\n        this._editor.setSelections(newSelections);\n        this._editor.revealRange(newSelections[0]);\n    }\n    selectToBracket(selectBrackets) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const newSelections = [];\n        this._editor.getSelections().forEach(selection => {\n            const position = selection.getStartPosition();\n            let brackets = model.bracketPairs.matchBracket(position);\n            if (!brackets) {\n                brackets = model.bracketPairs.findEnclosingBrackets(position);\n                if (!brackets) {\n                    const nextBracket = model.bracketPairs.findNextBracket(position);\n                    if (nextBracket && nextBracket.range) {\n                        brackets = model.bracketPairs.matchBracket(nextBracket.range.getStartPosition());\n                    }\n                }\n            }\n            let selectFrom = null;\n            let selectTo = null;\n            if (brackets) {\n                brackets.sort(Range.compareRangesUsingStarts);\n                const [open, close] = brackets;\n                selectFrom = selectBrackets ? open.getStartPosition() : open.getEndPosition();\n                selectTo = selectBrackets ? close.getEndPosition() : close.getStartPosition();\n                if (close.containsPosition(position)) {\n                    // select backwards if the cursor was on the closing bracket\n                    const tmp = selectFrom;\n                    selectFrom = selectTo;\n                    selectTo = tmp;\n                }\n            }\n            if (selectFrom && selectTo) {\n                newSelections.push(new Selection(selectFrom.lineNumber, selectFrom.column, selectTo.lineNumber, selectTo.column));\n            }\n        });\n        if (newSelections.length > 0) {\n            this._editor.setSelections(newSelections);\n            this._editor.revealRange(newSelections[0]);\n        }\n    }\n    removeBrackets(editSource) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        this._editor.getSelections().forEach((selection) => {\n            const position = selection.getPosition();\n            let brackets = model.bracketPairs.matchBracket(position);\n            if (!brackets) {\n                brackets = model.bracketPairs.findEnclosingBrackets(position);\n            }\n            if (brackets) {\n                this._editor.pushUndoStop();\n                this._editor.executeEdits(editSource, [\n                    { range: brackets[0], text: '' },\n                    { range: brackets[1], text: '' }\n                ]);\n                this._editor.pushUndoStop();\n            }\n        });\n    }\n    static { this._DECORATION_OPTIONS_WITH_OVERVIEW_RULER = ModelDecorationOptions.register({\n        description: 'bracket-match-overview',\n        stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n        className: 'bracket-match',\n        overviewRuler: {\n            color: themeColorFromId(overviewRulerBracketMatchForeground),\n            position: OverviewRulerLane.Center\n        }\n    }); }\n    static { this._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER = ModelDecorationOptions.register({\n        description: 'bracket-match-no-overview',\n        stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n        className: 'bracket-match'\n    }); }\n    _updateBrackets() {\n        if (this._matchBrackets === 'never') {\n            return;\n        }\n        this._recomputeBrackets();\n        const newDecorations = [];\n        let newDecorationsLen = 0;\n        for (const bracketData of this._lastBracketsData) {\n            const brackets = bracketData.brackets;\n            if (brackets) {\n                newDecorations[newDecorationsLen++] = { range: brackets[0], options: bracketData.options };\n                newDecorations[newDecorationsLen++] = { range: brackets[1], options: bracketData.options };\n            }\n        }\n        this._decorations.set(newDecorations);\n    }\n    _recomputeBrackets() {\n        if (!this._editor.hasModel() || !this._editor.hasWidgetFocus()) {\n            // no model or no focus => no brackets!\n            this._lastBracketsData = [];\n            this._lastVersionId = 0;\n            return;\n        }\n        const selections = this._editor.getSelections();\n        if (selections.length > 100) {\n            // no bracket matching for high numbers of selections\n            this._lastBracketsData = [];\n            this._lastVersionId = 0;\n            return;\n        }\n        const model = this._editor.getModel();\n        const versionId = model.getVersionId();\n        let previousData = [];\n        if (this._lastVersionId === versionId) {\n            // use the previous data only if the model is at the same version id\n            previousData = this._lastBracketsData;\n        }\n        const positions = [];\n        let positionsLen = 0;\n        for (let i = 0, len = selections.length; i < len; i++) {\n            const selection = selections[i];\n            if (selection.isEmpty()) {\n                // will bracket match a cursor only if the selection is collapsed\n                positions[positionsLen++] = selection.getStartPosition();\n            }\n        }\n        // sort positions for `previousData` cache hits\n        if (positions.length > 1) {\n            positions.sort(Position.compare);\n        }\n        const newData = [];\n        let newDataLen = 0;\n        let previousIndex = 0;\n        const previousLen = previousData.length;\n        for (let i = 0, len = positions.length; i < len; i++) {\n            const position = positions[i];\n            while (previousIndex < previousLen && previousData[previousIndex].position.isBefore(position)) {\n                previousIndex++;\n            }\n            if (previousIndex < previousLen && previousData[previousIndex].position.equals(position)) {\n                newData[newDataLen++] = previousData[previousIndex];\n            }\n            else {\n                let brackets = model.bracketPairs.matchBracket(position, 20 /* give at most 20ms to compute */);\n                let options = BracketMatchingController._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;\n                if (!brackets && this._matchBrackets === 'always') {\n                    brackets = model.bracketPairs.findEnclosingBrackets(position, 20 /* give at most 20ms to compute */);\n                    options = BracketMatchingController._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER;\n                }\n                newData[newDataLen++] = new BracketsData(position, brackets, options);\n            }\n        }\n        this._lastBracketsData = newData;\n        this._lastVersionId = versionId;\n    }\n}\nregisterEditorContribution(BracketMatchingController.ID, BracketMatchingController, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nregisterEditorAction(SelectToBracketAction);\nregisterEditorAction(JumpToBracketAction);\nregisterEditorAction(RemoveBracketsAction);\n// Go to menu\nMenuRegistry.appendMenuItem(MenuId.MenubarGoMenu, {\n    group: '5_infile_nav',\n    command: {\n        id: 'editor.action.jumpToBracket',\n        title: nls.localize({ key: 'miGoToBracket', comment: ['&& denotes a mnemonic'] }, \"Go to &&Bracket\")\n    },\n    order: 2\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nexport class MoveCaretCommand {\n    constructor(selection, isMovingLeft) {\n        this._selection = selection;\n        this._isMovingLeft = isMovingLeft;\n    }\n    getEditOperations(model, builder) {\n        if (this._selection.startLineNumber !== this._selection.endLineNumber || this._selection.isEmpty()) {\n            return;\n        }\n        const lineNumber = this._selection.startLineNumber;\n        const startColumn = this._selection.startColumn;\n        const endColumn = this._selection.endColumn;\n        if (this._isMovingLeft && startColumn === 1) {\n            return;\n        }\n        if (!this._isMovingLeft && endColumn === model.getLineMaxColumn(lineNumber)) {\n            return;\n        }\n        if (this._isMovingLeft) {\n            const rangeBefore = new Range(lineNumber, startColumn - 1, lineNumber, startColumn);\n            const charBefore = model.getValueInRange(rangeBefore);\n            builder.addEditOperation(rangeBefore, null);\n            builder.addEditOperation(new Range(lineNumber, endColumn, lineNumber, endColumn), charBefore);\n        }\n        else {\n            const rangeAfter = new Range(lineNumber, endColumn, lineNumber, endColumn + 1);\n            const charAfter = model.getValueInRange(rangeAfter);\n            builder.addEditOperation(rangeAfter, null);\n            builder.addEditOperation(new Range(lineNumber, startColumn, lineNumber, startColumn), charAfter);\n        }\n    }\n    computeCursorState(model, helper) {\n        if (this._isMovingLeft) {\n            return new Selection(this._selection.startLineNumber, this._selection.startColumn - 1, this._selection.endLineNumber, this._selection.endColumn - 1);\n        }\n        else {\n            return new Selection(this._selection.startLineNumber, this._selection.startColumn + 1, this._selection.endLineNumber, this._selection.endColumn + 1);\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { MoveCaretCommand } from './moveCaretCommand.js';\nimport * as nls from '../../../../nls.js';\nclass MoveCaretAction extends EditorAction {\n    constructor(left, opts) {\n        super(opts);\n        this.left = left;\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const commands = [];\n        const selections = editor.getSelections();\n        for (const selection of selections) {\n            commands.push(new MoveCaretCommand(selection, this.left));\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nclass MoveCaretLeftAction extends MoveCaretAction {\n    constructor() {\n        super(true, {\n            id: 'editor.action.moveCarretLeftAction',\n            label: nls.localize('caret.moveLeft', \"Move Selected Text Left\"),\n            alias: 'Move Selected Text Left',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nclass MoveCaretRightAction extends MoveCaretAction {\n    constructor() {\n        super(false, {\n            id: 'editor.action.moveCarretRightAction',\n            label: nls.localize('caret.moveRight', \"Move Selected Text Right\"),\n            alias: 'Move Selected Text Right',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nregisterEditorAction(MoveCaretLeftAction);\nregisterEditorAction(MoveCaretRightAction);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { ReplaceCommand } from '../../../common/commands/replaceCommand.js';\nimport { MoveOperations } from '../../../common/cursor/cursorMoveOperations.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport * as nls from '../../../../nls.js';\nclass TransposeLettersAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.transposeLetters',\n            label: nls.localize('transposeLetters.label', \"Transpose Letters\"),\n            alias: 'Transpose Letters',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: {\n                    primary: 256 /* KeyMod.WinCtrl */ | 50 /* KeyCode.KeyT */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const model = editor.getModel();\n        const commands = [];\n        const selections = editor.getSelections();\n        for (const selection of selections) {\n            if (!selection.isEmpty()) {\n                continue;\n            }\n            const lineNumber = selection.startLineNumber;\n            const column = selection.startColumn;\n            const lastColumn = model.getLineMaxColumn(lineNumber);\n            if (lineNumber === 1 && (column === 1 || (column === 2 && lastColumn === 2))) {\n                // at beginning of file, nothing to do\n                continue;\n            }\n            // handle special case: when at end of line, transpose left two chars\n            // otherwise, transpose left and right chars\n            const endPosition = (column === lastColumn) ?\n                selection.getPosition() :\n                MoveOperations.rightPosition(model, selection.getPosition().lineNumber, selection.getPosition().column);\n            const middlePosition = MoveOperations.leftPosition(model, endPosition);\n            const beginPosition = MoveOperations.leftPosition(model, middlePosition);\n            const leftChar = model.getValueInRange(Range.fromPositions(beginPosition, middlePosition));\n            const rightChar = model.getValueInRange(Range.fromPositions(middlePosition, endPosition));\n            const replaceRange = Range.fromPositions(beginPosition, endPosition);\n            commands.push(new ReplaceCommand(replaceRange, rightChar + leftChar));\n        }\n        if (commands.length > 0) {\n            editor.pushUndoStop();\n            editor.executeCommands(this.id, commands);\n            editor.pushUndoStop();\n        }\n    }\n}\nregisterEditorAction(TransposeLettersAction);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { UriList } from '../../../../base/common/dataTransfer.js';\nimport { HierarchicalKind } from '../../../../base/common/hierarchicalKind.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Mimes } from '../../../../base/common/mime.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { relativePath } from '../../../../base/common/resources.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { DocumentPasteTriggerKind } from '../../../common/languages.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { localize } from '../../../../nls.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nclass SimplePasteAndDropProvider {\n    async provideDocumentPasteEdits(_model, _ranges, dataTransfer, context, token) {\n        const edit = await this.getEdit(dataTransfer, token);\n        if (!edit) {\n            return undefined;\n        }\n        return {\n            edits: [{ insertText: edit.insertText, title: edit.title, kind: edit.kind, handledMimeType: edit.handledMimeType, yieldTo: edit.yieldTo }],\n            dispose() { },\n        };\n    }\n    async provideDocumentDropEdits(_model, _position, dataTransfer, token) {\n        const edit = await this.getEdit(dataTransfer, token);\n        if (!edit) {\n            return;\n        }\n        return {\n            edits: [{ insertText: edit.insertText, title: edit.title, kind: edit.kind, handledMimeType: edit.handledMimeType, yieldTo: edit.yieldTo }],\n            dispose() { },\n        };\n    }\n}\nexport class DefaultTextPasteOrDropEditProvider extends SimplePasteAndDropProvider {\n    constructor() {\n        super(...arguments);\n        this.kind = DefaultTextPasteOrDropEditProvider.kind;\n        this.dropMimeTypes = [Mimes.text];\n        this.pasteMimeTypes = [Mimes.text];\n    }\n    static { this.id = 'text'; }\n    static { this.kind = new HierarchicalKind('text.plain'); }\n    async getEdit(dataTransfer, _token) {\n        const textEntry = dataTransfer.get(Mimes.text);\n        if (!textEntry) {\n            return;\n        }\n        // Suppress if there's also a uriList entry.\n        // Typically the uri-list contains the same text as the text entry so showing both is confusing.\n        if (dataTransfer.has(Mimes.uriList)) {\n            return;\n        }\n        const insertText = await textEntry.asString();\n        return {\n            handledMimeType: Mimes.text,\n            title: localize('text.label', \"Insert Plain Text\"),\n            insertText,\n            kind: this.kind,\n        };\n    }\n}\nclass PathProvider extends SimplePasteAndDropProvider {\n    constructor() {\n        super(...arguments);\n        this.kind = new HierarchicalKind('uri.absolute');\n        this.dropMimeTypes = [Mimes.uriList];\n        this.pasteMimeTypes = [Mimes.uriList];\n    }\n    async getEdit(dataTransfer, token) {\n        const entries = await extractUriList(dataTransfer);\n        if (!entries.length || token.isCancellationRequested) {\n            return;\n        }\n        let uriCount = 0;\n        const insertText = entries\n            .map(({ uri, originalText }) => {\n            if (uri.scheme === Schemas.file) {\n                return uri.fsPath;\n            }\n            else {\n                uriCount++;\n                return originalText;\n            }\n        })\n            .join(' ');\n        let label;\n        if (uriCount > 0) {\n            // Dropping at least one generic uri (such as https) so use most generic label\n            label = entries.length > 1\n                ? localize('defaultDropProvider.uriList.uris', \"Insert Uris\")\n                : localize('defaultDropProvider.uriList.uri', \"Insert Uri\");\n        }\n        else {\n            // All the paths are file paths\n            label = entries.length > 1\n                ? localize('defaultDropProvider.uriList.paths', \"Insert Paths\")\n                : localize('defaultDropProvider.uriList.path', \"Insert Path\");\n        }\n        return {\n            handledMimeType: Mimes.uriList,\n            insertText,\n            title: label,\n            kind: this.kind,\n        };\n    }\n}\nlet RelativePathProvider = class RelativePathProvider extends SimplePasteAndDropProvider {\n    constructor(_workspaceContextService) {\n        super();\n        this._workspaceContextService = _workspaceContextService;\n        this.kind = new HierarchicalKind('uri.relative');\n        this.dropMimeTypes = [Mimes.uriList];\n        this.pasteMimeTypes = [Mimes.uriList];\n    }\n    async getEdit(dataTransfer, token) {\n        const entries = await extractUriList(dataTransfer);\n        if (!entries.length || token.isCancellationRequested) {\n            return;\n        }\n        const relativeUris = coalesce(entries.map(({ uri }) => {\n            const root = this._workspaceContextService.getWorkspaceFolder(uri);\n            return root ? relativePath(root.uri, uri) : undefined;\n        }));\n        if (!relativeUris.length) {\n            return;\n        }\n        return {\n            handledMimeType: Mimes.uriList,\n            insertText: relativeUris.join(' '),\n            title: entries.length > 1\n                ? localize('defaultDropProvider.uriList.relativePaths', \"Insert Relative Paths\")\n                : localize('defaultDropProvider.uriList.relativePath', \"Insert Relative Path\"),\n            kind: this.kind,\n        };\n    }\n};\nRelativePathProvider = __decorate([\n    __param(0, IWorkspaceContextService)\n], RelativePathProvider);\nclass PasteHtmlProvider {\n    constructor() {\n        this.kind = new HierarchicalKind('html');\n        this.pasteMimeTypes = ['text/html'];\n        this._yieldTo = [{ mimeType: Mimes.text }];\n    }\n    async provideDocumentPasteEdits(_model, _ranges, dataTransfer, context, token) {\n        if (context.triggerKind !== DocumentPasteTriggerKind.PasteAs && !context.only?.contains(this.kind)) {\n            return;\n        }\n        const entry = dataTransfer.get('text/html');\n        const htmlText = await entry?.asString();\n        if (!htmlText || token.isCancellationRequested) {\n            return;\n        }\n        return {\n            dispose() { },\n            edits: [{\n                    insertText: htmlText,\n                    yieldTo: this._yieldTo,\n                    title: localize('pasteHtmlLabel', 'Insert HTML'),\n                    kind: this.kind,\n                }],\n        };\n    }\n}\nasync function extractUriList(dataTransfer) {\n    const urlListEntry = dataTransfer.get(Mimes.uriList);\n    if (!urlListEntry) {\n        return [];\n    }\n    const strUriList = await urlListEntry.asString();\n    const entries = [];\n    for (const entry of UriList.parse(strUriList)) {\n        try {\n            entries.push({ uri: URI.parse(entry), originalText: entry });\n        }\n        catch {\n            // noop\n        }\n    }\n    return entries;\n}\nlet DefaultDropProvidersFeature = class DefaultDropProvidersFeature extends Disposable {\n    constructor(languageFeaturesService, workspaceContextService) {\n        super();\n        this._register(languageFeaturesService.documentDropEditProvider.register('*', new DefaultTextPasteOrDropEditProvider()));\n        this._register(languageFeaturesService.documentDropEditProvider.register('*', new PathProvider()));\n        this._register(languageFeaturesService.documentDropEditProvider.register('*', new RelativePathProvider(workspaceContextService)));\n    }\n};\nDefaultDropProvidersFeature = __decorate([\n    __param(0, ILanguageFeaturesService),\n    __param(1, IWorkspaceContextService)\n], DefaultDropProvidersFeature);\nexport { DefaultDropProvidersFeature };\nlet DefaultPasteProvidersFeature = class DefaultPasteProvidersFeature extends Disposable {\n    constructor(languageFeaturesService, workspaceContextService) {\n        super();\n        this._register(languageFeaturesService.documentPasteEditProvider.register('*', new DefaultTextPasteOrDropEditProvider()));\n        this._register(languageFeaturesService.documentPasteEditProvider.register('*', new PathProvider()));\n        this._register(languageFeaturesService.documentPasteEditProvider.register('*', new RelativePathProvider(workspaceContextService)));\n        this._register(languageFeaturesService.documentPasteEditProvider.register('*', new PasteHtmlProvider()));\n    }\n};\nDefaultPasteProvidersFeature = __decorate([\n    __param(0, ILanguageFeaturesService),\n    __param(1, IWorkspaceContextService)\n], DefaultPasteProvidersFeature);\nexport { DefaultPasteProvidersFeature };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class Scanner {\n    constructor() {\n        this.value = '';\n        this.pos = 0;\n    }\n    static { this._table = {\n        [36 /* CharCode.DollarSign */]: 0 /* TokenType.Dollar */,\n        [58 /* CharCode.Colon */]: 1 /* TokenType.Colon */,\n        [44 /* CharCode.Comma */]: 2 /* TokenType.Comma */,\n        [123 /* CharCode.OpenCurlyBrace */]: 3 /* TokenType.CurlyOpen */,\n        [125 /* CharCode.CloseCurlyBrace */]: 4 /* TokenType.CurlyClose */,\n        [92 /* CharCode.Backslash */]: 5 /* TokenType.Backslash */,\n        [47 /* CharCode.Slash */]: 6 /* TokenType.Forwardslash */,\n        [124 /* CharCode.Pipe */]: 7 /* TokenType.Pipe */,\n        [43 /* CharCode.Plus */]: 11 /* TokenType.Plus */,\n        [45 /* CharCode.Dash */]: 12 /* TokenType.Dash */,\n        [63 /* CharCode.QuestionMark */]: 13 /* TokenType.QuestionMark */,\n    }; }\n    static isDigitCharacter(ch) {\n        return ch >= 48 /* CharCode.Digit0 */ && ch <= 57 /* CharCode.Digit9 */;\n    }\n    static isVariableCharacter(ch) {\n        return ch === 95 /* CharCode.Underline */\n            || (ch >= 97 /* CharCode.a */ && ch <= 122 /* CharCode.z */)\n            || (ch >= 65 /* CharCode.A */ && ch <= 90 /* CharCode.Z */);\n    }\n    text(value) {\n        this.value = value;\n        this.pos = 0;\n    }\n    tokenText(token) {\n        return this.value.substr(token.pos, token.len);\n    }\n    next() {\n        if (this.pos >= this.value.length) {\n            return { type: 14 /* TokenType.EOF */, pos: this.pos, len: 0 };\n        }\n        const pos = this.pos;\n        let len = 0;\n        let ch = this.value.charCodeAt(pos);\n        let type;\n        // static types\n        type = Scanner._table[ch];\n        if (typeof type === 'number') {\n            this.pos += 1;\n            return { type, pos, len: 1 };\n        }\n        // number\n        if (Scanner.isDigitCharacter(ch)) {\n            type = 8 /* TokenType.Int */;\n            do {\n                len += 1;\n                ch = this.value.charCodeAt(pos + len);\n            } while (Scanner.isDigitCharacter(ch));\n            this.pos += len;\n            return { type, pos, len };\n        }\n        // variable name\n        if (Scanner.isVariableCharacter(ch)) {\n            type = 9 /* TokenType.VariableName */;\n            do {\n                ch = this.value.charCodeAt(pos + (++len));\n            } while (Scanner.isVariableCharacter(ch) || Scanner.isDigitCharacter(ch));\n            this.pos += len;\n            return { type, pos, len };\n        }\n        // format\n        type = 10 /* TokenType.Format */;\n        do {\n            len += 1;\n            ch = this.value.charCodeAt(pos + len);\n        } while (!isNaN(ch)\n            && typeof Scanner._table[ch] === 'undefined' // not static token\n            && !Scanner.isDigitCharacter(ch) // not number\n            && !Scanner.isVariableCharacter(ch) // not variable\n        );\n        this.pos += len;\n        return { type, pos, len };\n    }\n}\nexport class Marker {\n    constructor() {\n        this._children = [];\n    }\n    appendChild(child) {\n        if (child instanceof Text && this._children[this._children.length - 1] instanceof Text) {\n            // this and previous child are text -> merge them\n            this._children[this._children.length - 1].value += child.value;\n        }\n        else {\n            // normal adoption of child\n            child.parent = this;\n            this._children.push(child);\n        }\n        return this;\n    }\n    replace(child, others) {\n        const { parent } = child;\n        const idx = parent.children.indexOf(child);\n        const newChildren = parent.children.slice(0);\n        newChildren.splice(idx, 1, ...others);\n        parent._children = newChildren;\n        (function _fixParent(children, parent) {\n            for (const child of children) {\n                child.parent = parent;\n                _fixParent(child.children, child);\n            }\n        })(others, parent);\n    }\n    get children() {\n        return this._children;\n    }\n    get rightMostDescendant() {\n        if (this._children.length > 0) {\n            return this._children[this._children.length - 1].rightMostDescendant;\n        }\n        return this;\n    }\n    get snippet() {\n        let candidate = this;\n        while (true) {\n            if (!candidate) {\n                return undefined;\n            }\n            if (candidate instanceof TextmateSnippet) {\n                return candidate;\n            }\n            candidate = candidate.parent;\n        }\n    }\n    toString() {\n        return this.children.reduce((prev, cur) => prev + cur.toString(), '');\n    }\n    len() {\n        return 0;\n    }\n}\nexport class Text extends Marker {\n    constructor(value) {\n        super();\n        this.value = value;\n    }\n    toString() {\n        return this.value;\n    }\n    len() {\n        return this.value.length;\n    }\n    clone() {\n        return new Text(this.value);\n    }\n}\nexport class TransformableMarker extends Marker {\n}\nexport class Placeholder extends TransformableMarker {\n    static compareByIndex(a, b) {\n        if (a.index === b.index) {\n            return 0;\n        }\n        else if (a.isFinalTabstop) {\n            return 1;\n        }\n        else if (b.isFinalTabstop) {\n            return -1;\n        }\n        else if (a.index < b.index) {\n            return -1;\n        }\n        else if (a.index > b.index) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    constructor(index) {\n        super();\n        this.index = index;\n    }\n    get isFinalTabstop() {\n        return this.index === 0;\n    }\n    get choice() {\n        return this._children.length === 1 && this._children[0] instanceof Choice\n            ? this._children[0]\n            : undefined;\n    }\n    clone() {\n        const ret = new Placeholder(this.index);\n        if (this.transform) {\n            ret.transform = this.transform.clone();\n        }\n        ret._children = this.children.map(child => child.clone());\n        return ret;\n    }\n}\nexport class Choice extends Marker {\n    constructor() {\n        super(...arguments);\n        this.options = [];\n    }\n    appendChild(marker) {\n        if (marker instanceof Text) {\n            marker.parent = this;\n            this.options.push(marker);\n        }\n        return this;\n    }\n    toString() {\n        return this.options[0].value;\n    }\n    len() {\n        return this.options[0].len();\n    }\n    clone() {\n        const ret = new Choice();\n        this.options.forEach(ret.appendChild, ret);\n        return ret;\n    }\n}\nexport class Transform extends Marker {\n    constructor() {\n        super(...arguments);\n        this.regexp = new RegExp('');\n    }\n    resolve(value) {\n        const _this = this;\n        let didMatch = false;\n        let ret = value.replace(this.regexp, function () {\n            didMatch = true;\n            return _this._replace(Array.prototype.slice.call(arguments, 0, -2));\n        });\n        // when the regex didn't match and when the transform has\n        // else branches, then run those\n        if (!didMatch && this._children.some(child => child instanceof FormatString && Boolean(child.elseValue))) {\n            ret = this._replace([]);\n        }\n        return ret;\n    }\n    _replace(groups) {\n        let ret = '';\n        for (const marker of this._children) {\n            if (marker instanceof FormatString) {\n                let value = groups[marker.index] || '';\n                value = marker.resolve(value);\n                ret += value;\n            }\n            else {\n                ret += marker.toString();\n            }\n        }\n        return ret;\n    }\n    toString() {\n        return '';\n    }\n    clone() {\n        const ret = new Transform();\n        ret.regexp = new RegExp(this.regexp.source, '' + (this.regexp.ignoreCase ? 'i' : '') + (this.regexp.global ? 'g' : ''));\n        ret._children = this.children.map(child => child.clone());\n        return ret;\n    }\n}\nexport class FormatString extends Marker {\n    constructor(index, shorthandName, ifValue, elseValue) {\n        super();\n        this.index = index;\n        this.shorthandName = shorthandName;\n        this.ifValue = ifValue;\n        this.elseValue = elseValue;\n    }\n    resolve(value) {\n        if (this.shorthandName === 'upcase') {\n            return !value ? '' : value.toLocaleUpperCase();\n        }\n        else if (this.shorthandName === 'downcase') {\n            return !value ? '' : value.toLocaleLowerCase();\n        }\n        else if (this.shorthandName === 'capitalize') {\n            return !value ? '' : (value[0].toLocaleUpperCase() + value.substr(1));\n        }\n        else if (this.shorthandName === 'pascalcase') {\n            return !value ? '' : this._toPascalCase(value);\n        }\n        else if (this.shorthandName === 'camelcase') {\n            return !value ? '' : this._toCamelCase(value);\n        }\n        else if (Boolean(value) && typeof this.ifValue === 'string') {\n            return this.ifValue;\n        }\n        else if (!Boolean(value) && typeof this.elseValue === 'string') {\n            return this.elseValue;\n        }\n        else {\n            return value || '';\n        }\n    }\n    _toPascalCase(value) {\n        const match = value.match(/[a-z0-9]+/gi);\n        if (!match) {\n            return value;\n        }\n        return match.map(word => {\n            return word.charAt(0).toUpperCase() + word.substr(1);\n        })\n            .join('');\n    }\n    _toCamelCase(value) {\n        const match = value.match(/[a-z0-9]+/gi);\n        if (!match) {\n            return value;\n        }\n        return match.map((word, index) => {\n            if (index === 0) {\n                return word.charAt(0).toLowerCase() + word.substr(1);\n            }\n            return word.charAt(0).toUpperCase() + word.substr(1);\n        })\n            .join('');\n    }\n    clone() {\n        const ret = new FormatString(this.index, this.shorthandName, this.ifValue, this.elseValue);\n        return ret;\n    }\n}\nexport class Variable extends TransformableMarker {\n    constructor(name) {\n        super();\n        this.name = name;\n    }\n    resolve(resolver) {\n        let value = resolver.resolve(this);\n        if (this.transform) {\n            value = this.transform.resolve(value || '');\n        }\n        if (value !== undefined) {\n            this._children = [new Text(value)];\n            return true;\n        }\n        return false;\n    }\n    clone() {\n        const ret = new Variable(this.name);\n        if (this.transform) {\n            ret.transform = this.transform.clone();\n        }\n        ret._children = this.children.map(child => child.clone());\n        return ret;\n    }\n}\nfunction walk(marker, visitor) {\n    const stack = [...marker];\n    while (stack.length > 0) {\n        const marker = stack.shift();\n        const recurse = visitor(marker);\n        if (!recurse) {\n            break;\n        }\n        stack.unshift(...marker.children);\n    }\n}\nexport class TextmateSnippet extends Marker {\n    get placeholderInfo() {\n        if (!this._placeholders) {\n            // fill in placeholders\n            const all = [];\n            let last;\n            this.walk(function (candidate) {\n                if (candidate instanceof Placeholder) {\n                    all.push(candidate);\n                    last = !last || last.index < candidate.index ? candidate : last;\n                }\n                return true;\n            });\n            this._placeholders = { all, last };\n        }\n        return this._placeholders;\n    }\n    get placeholders() {\n        const { all } = this.placeholderInfo;\n        return all;\n    }\n    offset(marker) {\n        let pos = 0;\n        let found = false;\n        this.walk(candidate => {\n            if (candidate === marker) {\n                found = true;\n                return false;\n            }\n            pos += candidate.len();\n            return true;\n        });\n        if (!found) {\n            return -1;\n        }\n        return pos;\n    }\n    fullLen(marker) {\n        let ret = 0;\n        walk([marker], marker => {\n            ret += marker.len();\n            return true;\n        });\n        return ret;\n    }\n    enclosingPlaceholders(placeholder) {\n        const ret = [];\n        let { parent } = placeholder;\n        while (parent) {\n            if (parent instanceof Placeholder) {\n                ret.push(parent);\n            }\n            parent = parent.parent;\n        }\n        return ret;\n    }\n    resolveVariables(resolver) {\n        this.walk(candidate => {\n            if (candidate instanceof Variable) {\n                if (candidate.resolve(resolver)) {\n                    this._placeholders = undefined;\n                }\n            }\n            return true;\n        });\n        return this;\n    }\n    appendChild(child) {\n        this._placeholders = undefined;\n        return super.appendChild(child);\n    }\n    replace(child, others) {\n        this._placeholders = undefined;\n        return super.replace(child, others);\n    }\n    clone() {\n        const ret = new TextmateSnippet();\n        this._children = this.children.map(child => child.clone());\n        return ret;\n    }\n    walk(visitor) {\n        walk(this.children, visitor);\n    }\n}\nexport class SnippetParser {\n    constructor() {\n        this._scanner = new Scanner();\n        this._token = { type: 14 /* TokenType.EOF */, pos: 0, len: 0 };\n    }\n    static escape(value) {\n        return value.replace(/\\$|}|\\\\/g, '\\\\$&');\n    }\n    static guessNeedsClipboard(template) {\n        return /\\${?CLIPBOARD/.test(template);\n    }\n    parse(value, insertFinalTabstop, enforceFinalTabstop) {\n        const snippet = new TextmateSnippet();\n        this.parseFragment(value, snippet);\n        this.ensureFinalTabstop(snippet, enforceFinalTabstop ?? false, insertFinalTabstop ?? false);\n        return snippet;\n    }\n    parseFragment(value, snippet) {\n        const offset = snippet.children.length;\n        this._scanner.text(value);\n        this._token = this._scanner.next();\n        while (this._parse(snippet)) {\n            // nothing\n        }\n        // fill in values for placeholders. the first placeholder of an index\n        // that has a value defines the value for all placeholders with that index\n        const placeholderDefaultValues = new Map();\n        const incompletePlaceholders = [];\n        snippet.walk(marker => {\n            if (marker instanceof Placeholder) {\n                if (marker.isFinalTabstop) {\n                    placeholderDefaultValues.set(0, undefined);\n                }\n                else if (!placeholderDefaultValues.has(marker.index) && marker.children.length > 0) {\n                    placeholderDefaultValues.set(marker.index, marker.children);\n                }\n                else {\n                    incompletePlaceholders.push(marker);\n                }\n            }\n            return true;\n        });\n        const fillInIncompletePlaceholder = (placeholder, stack) => {\n            const defaultValues = placeholderDefaultValues.get(placeholder.index);\n            if (!defaultValues) {\n                return;\n            }\n            const clone = new Placeholder(placeholder.index);\n            clone.transform = placeholder.transform;\n            for (const child of defaultValues) {\n                const newChild = child.clone();\n                clone.appendChild(newChild);\n                // \"recurse\" on children that are again placeholders\n                if (newChild instanceof Placeholder && placeholderDefaultValues.has(newChild.index) && !stack.has(newChild.index)) {\n                    stack.add(newChild.index);\n                    fillInIncompletePlaceholder(newChild, stack);\n                    stack.delete(newChild.index);\n                }\n            }\n            snippet.replace(placeholder, [clone]);\n        };\n        const stack = new Set();\n        for (const placeholder of incompletePlaceholders) {\n            fillInIncompletePlaceholder(placeholder, stack);\n        }\n        return snippet.children.slice(offset);\n    }\n    ensureFinalTabstop(snippet, enforceFinalTabstop, insertFinalTabstop) {\n        if (enforceFinalTabstop || insertFinalTabstop && snippet.placeholders.length > 0) {\n            const finalTabstop = snippet.placeholders.find(p => p.index === 0);\n            if (!finalTabstop) {\n                // the snippet uses placeholders but has no\n                // final tabstop defined -> insert at the end\n                snippet.appendChild(new Placeholder(0));\n            }\n        }\n    }\n    _accept(type, value) {\n        if (type === undefined || this._token.type === type) {\n            const ret = !value ? true : this._scanner.tokenText(this._token);\n            this._token = this._scanner.next();\n            return ret;\n        }\n        return false;\n    }\n    _backTo(token) {\n        this._scanner.pos = token.pos + token.len;\n        this._token = token;\n        return false;\n    }\n    _until(type) {\n        const start = this._token;\n        while (this._token.type !== type) {\n            if (this._token.type === 14 /* TokenType.EOF */) {\n                return false;\n            }\n            else if (this._token.type === 5 /* TokenType.Backslash */) {\n                const nextToken = this._scanner.next();\n                if (nextToken.type !== 0 /* TokenType.Dollar */\n                    && nextToken.type !== 4 /* TokenType.CurlyClose */\n                    && nextToken.type !== 5 /* TokenType.Backslash */) {\n                    return false;\n                }\n            }\n            this._token = this._scanner.next();\n        }\n        const value = this._scanner.value.substring(start.pos, this._token.pos).replace(/\\\\(\\$|}|\\\\)/g, '$1');\n        this._token = this._scanner.next();\n        return value;\n    }\n    _parse(marker) {\n        return this._parseEscaped(marker)\n            || this._parseTabstopOrVariableName(marker)\n            || this._parseComplexPlaceholder(marker)\n            || this._parseComplexVariable(marker)\n            || this._parseAnything(marker);\n    }\n    // \\$, \\\\, \\} -> just text\n    _parseEscaped(marker) {\n        let value;\n        if (value = this._accept(5 /* TokenType.Backslash */, true)) {\n            // saw a backslash, append escaped token or that backslash\n            value = this._accept(0 /* TokenType.Dollar */, true)\n                || this._accept(4 /* TokenType.CurlyClose */, true)\n                || this._accept(5 /* TokenType.Backslash */, true)\n                || value;\n            marker.appendChild(new Text(value));\n            return true;\n        }\n        return false;\n    }\n    // $foo -> variable, $1 -> tabstop\n    _parseTabstopOrVariableName(parent) {\n        let value;\n        const token = this._token;\n        const match = this._accept(0 /* TokenType.Dollar */)\n            && (value = this._accept(9 /* TokenType.VariableName */, true) || this._accept(8 /* TokenType.Int */, true));\n        if (!match) {\n            return this._backTo(token);\n        }\n        parent.appendChild(/^\\d+$/.test(value)\n            ? new Placeholder(Number(value))\n            : new Variable(value));\n        return true;\n    }\n    // ${1:<children>}, ${1} -> placeholder\n    _parseComplexPlaceholder(parent) {\n        let index;\n        const token = this._token;\n        const match = this._accept(0 /* TokenType.Dollar */)\n            && this._accept(3 /* TokenType.CurlyOpen */)\n            && (index = this._accept(8 /* TokenType.Int */, true));\n        if (!match) {\n            return this._backTo(token);\n        }\n        const placeholder = new Placeholder(Number(index));\n        if (this._accept(1 /* TokenType.Colon */)) {\n            // ${1:<children>}\n            while (true) {\n                // ...} -> done\n                if (this._accept(4 /* TokenType.CurlyClose */)) {\n                    parent.appendChild(placeholder);\n                    return true;\n                }\n                if (this._parse(placeholder)) {\n                    continue;\n                }\n                // fallback\n                parent.appendChild(new Text('${' + index + ':'));\n                placeholder.children.forEach(parent.appendChild, parent);\n                return true;\n            }\n        }\n        else if (placeholder.index > 0 && this._accept(7 /* TokenType.Pipe */)) {\n            // ${1|one,two,three|}\n            const choice = new Choice();\n            while (true) {\n                if (this._parseChoiceElement(choice)) {\n                    if (this._accept(2 /* TokenType.Comma */)) {\n                        // opt, -> more\n                        continue;\n                    }\n                    if (this._accept(7 /* TokenType.Pipe */)) {\n                        placeholder.appendChild(choice);\n                        if (this._accept(4 /* TokenType.CurlyClose */)) {\n                            // ..|} -> done\n                            parent.appendChild(placeholder);\n                            return true;\n                        }\n                    }\n                }\n                this._backTo(token);\n                return false;\n            }\n        }\n        else if (this._accept(6 /* TokenType.Forwardslash */)) {\n            // ${1/<regex>/<format>/<options>}\n            if (this._parseTransform(placeholder)) {\n                parent.appendChild(placeholder);\n                return true;\n            }\n            this._backTo(token);\n            return false;\n        }\n        else if (this._accept(4 /* TokenType.CurlyClose */)) {\n            // ${1}\n            parent.appendChild(placeholder);\n            return true;\n        }\n        else {\n            // ${1 <- missing curly or colon\n            return this._backTo(token);\n        }\n    }\n    _parseChoiceElement(parent) {\n        const token = this._token;\n        const values = [];\n        while (true) {\n            if (this._token.type === 2 /* TokenType.Comma */ || this._token.type === 7 /* TokenType.Pipe */) {\n                break;\n            }\n            let value;\n            if (value = this._accept(5 /* TokenType.Backslash */, true)) {\n                // \\, \\|, or \\\\\n                value = this._accept(2 /* TokenType.Comma */, true)\n                    || this._accept(7 /* TokenType.Pipe */, true)\n                    || this._accept(5 /* TokenType.Backslash */, true)\n                    || value;\n            }\n            else {\n                value = this._accept(undefined, true);\n            }\n            if (!value) {\n                // EOF\n                this._backTo(token);\n                return false;\n            }\n            values.push(value);\n        }\n        if (values.length === 0) {\n            this._backTo(token);\n            return false;\n        }\n        parent.appendChild(new Text(values.join('')));\n        return true;\n    }\n    // ${foo:<children>}, ${foo} -> variable\n    _parseComplexVariable(parent) {\n        let name;\n        const token = this._token;\n        const match = this._accept(0 /* TokenType.Dollar */)\n            && this._accept(3 /* TokenType.CurlyOpen */)\n            && (name = this._accept(9 /* TokenType.VariableName */, true));\n        if (!match) {\n            return this._backTo(token);\n        }\n        const variable = new Variable(name);\n        if (this._accept(1 /* TokenType.Colon */)) {\n            // ${foo:<children>}\n            while (true) {\n                // ...} -> done\n                if (this._accept(4 /* TokenType.CurlyClose */)) {\n                    parent.appendChild(variable);\n                    return true;\n                }\n                if (this._parse(variable)) {\n                    continue;\n                }\n                // fallback\n                parent.appendChild(new Text('${' + name + ':'));\n                variable.children.forEach(parent.appendChild, parent);\n                return true;\n            }\n        }\n        else if (this._accept(6 /* TokenType.Forwardslash */)) {\n            // ${foo/<regex>/<format>/<options>}\n            if (this._parseTransform(variable)) {\n                parent.appendChild(variable);\n                return true;\n            }\n            this._backTo(token);\n            return false;\n        }\n        else if (this._accept(4 /* TokenType.CurlyClose */)) {\n            // ${foo}\n            parent.appendChild(variable);\n            return true;\n        }\n        else {\n            // ${foo <- missing curly or colon\n            return this._backTo(token);\n        }\n    }\n    _parseTransform(parent) {\n        // ...<regex>/<format>/<options>}\n        const transform = new Transform();\n        let regexValue = '';\n        let regexOptions = '';\n        // (1) /regex\n        while (true) {\n            if (this._accept(6 /* TokenType.Forwardslash */)) {\n                break;\n            }\n            let escaped;\n            if (escaped = this._accept(5 /* TokenType.Backslash */, true)) {\n                escaped = this._accept(6 /* TokenType.Forwardslash */, true) || escaped;\n                regexValue += escaped;\n                continue;\n            }\n            if (this._token.type !== 14 /* TokenType.EOF */) {\n                regexValue += this._accept(undefined, true);\n                continue;\n            }\n            return false;\n        }\n        // (2) /format\n        while (true) {\n            if (this._accept(6 /* TokenType.Forwardslash */)) {\n                break;\n            }\n            let escaped;\n            if (escaped = this._accept(5 /* TokenType.Backslash */, true)) {\n                escaped = this._accept(5 /* TokenType.Backslash */, true) || this._accept(6 /* TokenType.Forwardslash */, true) || escaped;\n                transform.appendChild(new Text(escaped));\n                continue;\n            }\n            if (this._parseFormatString(transform) || this._parseAnything(transform)) {\n                continue;\n            }\n            return false;\n        }\n        // (3) /option\n        while (true) {\n            if (this._accept(4 /* TokenType.CurlyClose */)) {\n                break;\n            }\n            if (this._token.type !== 14 /* TokenType.EOF */) {\n                regexOptions += this._accept(undefined, true);\n                continue;\n            }\n            return false;\n        }\n        try {\n            transform.regexp = new RegExp(regexValue, regexOptions);\n        }\n        catch (e) {\n            // invalid regexp\n            return false;\n        }\n        parent.transform = transform;\n        return true;\n    }\n    _parseFormatString(parent) {\n        const token = this._token;\n        if (!this._accept(0 /* TokenType.Dollar */)) {\n            return false;\n        }\n        let complex = false;\n        if (this._accept(3 /* TokenType.CurlyOpen */)) {\n            complex = true;\n        }\n        const index = this._accept(8 /* TokenType.Int */, true);\n        if (!index) {\n            this._backTo(token);\n            return false;\n        }\n        else if (!complex) {\n            // $1\n            parent.appendChild(new FormatString(Number(index)));\n            return true;\n        }\n        else if (this._accept(4 /* TokenType.CurlyClose */)) {\n            // ${1}\n            parent.appendChild(new FormatString(Number(index)));\n            return true;\n        }\n        else if (!this._accept(1 /* TokenType.Colon */)) {\n            this._backTo(token);\n            return false;\n        }\n        if (this._accept(6 /* TokenType.Forwardslash */)) {\n            // ${1:/upcase}\n            const shorthand = this._accept(9 /* TokenType.VariableName */, true);\n            if (!shorthand || !this._accept(4 /* TokenType.CurlyClose */)) {\n                this._backTo(token);\n                return false;\n            }\n            else {\n                parent.appendChild(new FormatString(Number(index), shorthand));\n                return true;\n            }\n        }\n        else if (this._accept(11 /* TokenType.Plus */)) {\n            // ${1:+<if>}\n            const ifValue = this._until(4 /* TokenType.CurlyClose */);\n            if (ifValue) {\n                parent.appendChild(new FormatString(Number(index), undefined, ifValue, undefined));\n                return true;\n            }\n        }\n        else if (this._accept(12 /* TokenType.Dash */)) {\n            // ${2:-<else>}\n            const elseValue = this._until(4 /* TokenType.CurlyClose */);\n            if (elseValue) {\n                parent.appendChild(new FormatString(Number(index), undefined, undefined, elseValue));\n                return true;\n            }\n        }\n        else if (this._accept(13 /* TokenType.QuestionMark */)) {\n            // ${2:?<if>:<else>}\n            const ifValue = this._until(1 /* TokenType.Colon */);\n            if (ifValue) {\n                const elseValue = this._until(4 /* TokenType.CurlyClose */);\n                if (elseValue) {\n                    parent.appendChild(new FormatString(Number(index), undefined, ifValue, elseValue));\n                    return true;\n                }\n            }\n        }\n        else {\n            // ${1:<else>}\n            const elseValue = this._until(4 /* TokenType.CurlyClose */);\n            if (elseValue) {\n                parent.appendChild(new FormatString(Number(index), undefined, undefined, elseValue));\n                return true;\n            }\n        }\n        this._backTo(token);\n        return false;\n    }\n    _parseAnything(marker) {\n        if (this._token.type !== 14 /* TokenType.EOF */) {\n            marker.appendChild(new Text(this._scanner.tokenText(this._token)));\n            this._accept(undefined);\n            return true;\n        }\n        return false;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { ResourceTextEdit } from '../../../browser/services/bulkEditService.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\n/**\n * Given a {@link DropOrPasteEdit} and set of ranges, creates a {@link WorkspaceEdit} that applies the insert text from\n * the {@link DropOrPasteEdit} at each range plus any additional edits.\n */\nexport function createCombinedWorkspaceEdit(uri, ranges, edit) {\n    // If the edit insert text is empty, skip applying at each range\n    if (typeof edit.insertText === 'string' ? edit.insertText === '' : edit.insertText.snippet === '') {\n        return {\n            edits: edit.additionalEdit?.edits ?? []\n        };\n    }\n    return {\n        edits: [\n            ...ranges.map(range => new ResourceTextEdit(uri, { range, text: typeof edit.insertText === 'string' ? SnippetParser.escape(edit.insertText) + '$0' : edit.insertText.snippet, insertAsSnippet: true })),\n            ...(edit.additionalEdit?.edits ?? [])\n        ]\n    };\n}\nexport function sortEditsByYieldTo(edits) {\n    function yieldsTo(yTo, other) {\n        if ('mimeType' in yTo) {\n            return yTo.mimeType === other.handledMimeType;\n        }\n        return !!other.kind && yTo.kind.contains(other.kind);\n    }\n    // Build list of nodes each node yields to\n    const yieldsToMap = new Map();\n    for (const edit of edits) {\n        for (const yTo of edit.yieldTo ?? []) {\n            for (const other of edits) {\n                if (other === edit) {\n                    continue;\n                }\n                if (yieldsTo(yTo, other)) {\n                    let arr = yieldsToMap.get(edit);\n                    if (!arr) {\n                        arr = [];\n                        yieldsToMap.set(edit, arr);\n                    }\n                    arr.push(other);\n                }\n            }\n        }\n    }\n    if (!yieldsToMap.size) {\n        return Array.from(edits);\n    }\n    // Topological sort\n    const visited = new Set();\n    const tempStack = [];\n    function visit(nodes) {\n        if (!nodes.length) {\n            return [];\n        }\n        const node = nodes[0];\n        if (tempStack.includes(node)) {\n            console.warn('Yield to cycle detected', node);\n            return nodes;\n        }\n        if (visited.has(node)) {\n            return visit(nodes.slice(1));\n        }\n        let pre = [];\n        const yTo = yieldsToMap.get(node);\n        if (yTo) {\n            tempStack.push(node);\n            pre = visit(yTo);\n            tempStack.pop();\n        }\n        visited.add(node);\n        return [...pre, node, ...visit(nodes.slice(1))];\n    }\n    return visit(Array.from(edits));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { disposableTimeout } from '../../../../base/common/async.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { noBreakWhitespace } from '../../../../base/common/strings.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport './inlineProgressWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nconst inlineProgressDecoration = ModelDecorationOptions.register({\n    description: 'inline-progress-widget',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    showIfCollapsed: true,\n    after: {\n        content: noBreakWhitespace,\n        inlineClassName: 'inline-editor-progress-decoration',\n        inlineClassNameAffectsLetterSpacing: true,\n    }\n});\nclass InlineProgressWidget extends Disposable {\n    static { this.baseId = 'editor.widget.inlineProgressWidget'; }\n    constructor(typeId, editor, range, title, delegate) {\n        super();\n        this.typeId = typeId;\n        this.editor = editor;\n        this.range = range;\n        this.delegate = delegate;\n        this.allowEditorOverflow = false;\n        this.suppressMouseDown = true;\n        this.create(title);\n        this.editor.addContentWidget(this);\n        this.editor.layoutContentWidget(this);\n    }\n    create(title) {\n        this.domNode = dom.$('.inline-progress-widget');\n        this.domNode.role = 'button';\n        this.domNode.title = title;\n        const iconElement = dom.$('span.icon');\n        this.domNode.append(iconElement);\n        iconElement.classList.add(...ThemeIcon.asClassNameArray(Codicon.loading), 'codicon-modifier-spin');\n        const updateSize = () => {\n            const lineHeight = this.editor.getOption(67 /* EditorOption.lineHeight */);\n            this.domNode.style.height = `${lineHeight}px`;\n            this.domNode.style.width = `${Math.ceil(0.8 * lineHeight)}px`;\n        };\n        updateSize();\n        this._register(this.editor.onDidChangeConfiguration(c => {\n            if (c.hasChanged(52 /* EditorOption.fontSize */) || c.hasChanged(67 /* EditorOption.lineHeight */)) {\n                updateSize();\n            }\n        }));\n        this._register(dom.addDisposableListener(this.domNode, dom.EventType.CLICK, e => {\n            this.delegate.cancel();\n        }));\n    }\n    getId() {\n        return InlineProgressWidget.baseId + '.' + this.typeId;\n    }\n    getDomNode() {\n        return this.domNode;\n    }\n    getPosition() {\n        return {\n            position: { lineNumber: this.range.startLineNumber, column: this.range.startColumn },\n            preference: [0 /* ContentWidgetPositionPreference.EXACT */]\n        };\n    }\n    dispose() {\n        super.dispose();\n        this.editor.removeContentWidget(this);\n    }\n}\nlet InlineProgressManager = class InlineProgressManager extends Disposable {\n    constructor(id, _editor, _instantiationService) {\n        super();\n        this.id = id;\n        this._editor = _editor;\n        this._instantiationService = _instantiationService;\n        /** Delay before showing the progress widget */\n        this._showDelay = 500; // ms\n        this._showPromise = this._register(new MutableDisposable());\n        this._currentWidget = this._register(new MutableDisposable());\n        this._operationIdPool = 0;\n        this._currentDecorations = _editor.createDecorationsCollection();\n    }\n    dispose() {\n        super.dispose();\n        this._currentDecorations.clear();\n    }\n    async showWhile(position, title, promise, delegate, delayOverride) {\n        const operationId = this._operationIdPool++;\n        this._currentOperation = operationId;\n        this.clear();\n        this._showPromise.value = disposableTimeout(() => {\n            const range = Range.fromPositions(position);\n            const decorationIds = this._currentDecorations.set([{\n                    range: range,\n                    options: inlineProgressDecoration,\n                }]);\n            if (decorationIds.length > 0) {\n                this._currentWidget.value = this._instantiationService.createInstance(InlineProgressWidget, this.id, this._editor, range, title, delegate);\n            }\n        }, delayOverride ?? this._showDelay);\n        try {\n            return await promise;\n        }\n        finally {\n            if (this._currentOperation === operationId) {\n                this.clear();\n                this._currentOperation = undefined;\n            }\n        }\n    }\n    clear() {\n        this._showPromise.clear();\n        this._currentDecorations.clear();\n        this._currentWidget.clear();\n    }\n};\nInlineProgressManager = __decorate([\n    __param(2, IInstantiationService)\n], InlineProgressManager);\nexport { InlineProgressManager };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar MessageController_1;\nimport { renderMarkdown } from '../../../../base/browser/markdownRenderer.js';\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { isMarkdownString } from '../../../../base/common/htmlContent.js';\nimport { DisposableStore, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport './messageController.css';\nimport { EditorCommand, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { openLinkFromMarkdown } from '../../../browser/widget/markdownRenderer/browser/markdownRenderer.js';\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport * as dom from '../../../../base/browser/dom.js';\nlet MessageController = class MessageController {\n    static { MessageController_1 = this; }\n    static { this.ID = 'editor.contrib.messageController'; }\n    static { this.MESSAGE_VISIBLE = new RawContextKey('messageVisible', false, nls.localize('messageVisible', 'Whether the editor is currently showing an inline message')); }\n    static get(editor) {\n        return editor.getContribution(MessageController_1.ID);\n    }\n    constructor(editor, contextKeyService, _openerService) {\n        this._openerService = _openerService;\n        this._messageWidget = new MutableDisposable();\n        this._messageListeners = new DisposableStore();\n        this._mouseOverMessage = false;\n        this._editor = editor;\n        this._visible = MessageController_1.MESSAGE_VISIBLE.bindTo(contextKeyService);\n    }\n    dispose() {\n        this._message?.dispose();\n        this._messageListeners.dispose();\n        this._messageWidget.dispose();\n        this._visible.reset();\n    }\n    showMessage(message, position) {\n        alert(isMarkdownString(message) ? message.value : message);\n        this._visible.set(true);\n        this._messageWidget.clear();\n        this._messageListeners.clear();\n        this._message = isMarkdownString(message) ? renderMarkdown(message, {\n            actionHandler: {\n                callback: (url) => {\n                    this.closeMessage();\n                    openLinkFromMarkdown(this._openerService, url, isMarkdownString(message) ? message.isTrusted : undefined);\n                },\n                disposables: this._messageListeners\n            },\n        }) : undefined;\n        this._messageWidget.value = new MessageWidget(this._editor, position, typeof message === 'string' ? message : this._message.element);\n        // close on blur (debounced to allow to tab into the message), cursor, model change, dispose\n        this._messageListeners.add(Event.debounce(this._editor.onDidBlurEditorText, (last, event) => event, 0)(() => {\n            if (this._mouseOverMessage) {\n                return; // override when mouse over message\n            }\n            if (this._messageWidget.value && dom.isAncestor(dom.getActiveElement(), this._messageWidget.value.getDomNode())) {\n                return; // override when focus is inside the message\n            }\n            this.closeMessage();\n        }));\n        this._messageListeners.add(this._editor.onDidChangeCursorPosition(() => this.closeMessage()));\n        this._messageListeners.add(this._editor.onDidDispose(() => this.closeMessage()));\n        this._messageListeners.add(this._editor.onDidChangeModel(() => this.closeMessage()));\n        this._messageListeners.add(dom.addDisposableListener(this._messageWidget.value.getDomNode(), dom.EventType.MOUSE_ENTER, () => this._mouseOverMessage = true, true));\n        this._messageListeners.add(dom.addDisposableListener(this._messageWidget.value.getDomNode(), dom.EventType.MOUSE_LEAVE, () => this._mouseOverMessage = false, true));\n        // close on mouse move\n        let bounds;\n        this._messageListeners.add(this._editor.onMouseMove(e => {\n            // outside the text area\n            if (!e.target.position) {\n                return;\n            }\n            if (!bounds) {\n                // define bounding box around position and first mouse occurance\n                bounds = new Range(position.lineNumber - 3, 1, e.target.position.lineNumber + 3, 1);\n            }\n            else if (!bounds.containsPosition(e.target.position)) {\n                // check if position is still in bounds\n                this.closeMessage();\n            }\n        }));\n    }\n    closeMessage() {\n        this._visible.reset();\n        this._messageListeners.clear();\n        if (this._messageWidget.value) {\n            this._messageListeners.add(MessageWidget.fadeOut(this._messageWidget.value));\n        }\n    }\n};\nMessageController = MessageController_1 = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, IOpenerService)\n], MessageController);\nexport { MessageController };\nconst MessageCommand = EditorCommand.bindToContribution(MessageController.get);\nregisterEditorCommand(new MessageCommand({\n    id: 'leaveEditorMessage',\n    precondition: MessageController.MESSAGE_VISIBLE,\n    handler: c => c.closeMessage(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        primary: 9 /* KeyCode.Escape */\n    }\n}));\nclass MessageWidget {\n    static fadeOut(messageWidget) {\n        const dispose = () => {\n            messageWidget.dispose();\n            clearTimeout(handle);\n            messageWidget.getDomNode().removeEventListener('animationend', dispose);\n        };\n        const handle = setTimeout(dispose, 110);\n        messageWidget.getDomNode().addEventListener('animationend', dispose);\n        messageWidget.getDomNode().classList.add('fadeOut');\n        return { dispose };\n    }\n    constructor(editor, { lineNumber, column }, text) {\n        // Editor.IContentWidget.allowEditorOverflow\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = false;\n        this._editor = editor;\n        this._editor.revealLinesInCenterIfOutsideViewport(lineNumber, lineNumber, 0 /* ScrollType.Smooth */);\n        this._position = { lineNumber, column };\n        this._domNode = document.createElement('div');\n        this._domNode.classList.add('monaco-editor-overlaymessage');\n        this._domNode.style.marginLeft = '-6px';\n        const anchorTop = document.createElement('div');\n        anchorTop.classList.add('anchor', 'top');\n        this._domNode.appendChild(anchorTop);\n        const message = document.createElement('div');\n        if (typeof text === 'string') {\n            message.classList.add('message');\n            message.textContent = text;\n        }\n        else {\n            text.classList.add('message');\n            message.appendChild(text);\n        }\n        this._domNode.appendChild(message);\n        const anchorBottom = document.createElement('div');\n        anchorBottom.classList.add('anchor', 'below');\n        this._domNode.appendChild(anchorBottom);\n        this._editor.addContentWidget(this);\n        this._domNode.classList.add('fadeIn');\n    }\n    dispose() {\n        this._editor.removeContentWidget(this);\n    }\n    getId() {\n        return 'messageoverlay';\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        return {\n            position: this._position,\n            preference: [\n                1 /* ContentWidgetPositionPreference.ABOVE */,\n                2 /* ContentWidgetPositionPreference.BELOW */,\n            ],\n            positionAffinity: 1 /* PositionAffinity.Right */,\n        };\n    }\n    afterRender(position) {\n        this._domNode.classList.toggle('below', position === 2 /* ContentWidgetPositionPreference.BELOW */);\n    }\n}\nregisterEditorContribution(MessageController.ID, MessageController, 4 /* EditorContributionInstantiation.Lazy */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar PostEditWidget_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Button } from '../../../../base/browser/ui/button/button.js';\nimport { toAction } from '../../../../base/common/actions.js';\nimport { toErrorMessage } from '../../../../base/common/errorMessage.js';\nimport { isCancellationError } from '../../../../base/common/errors.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { Disposable, MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport './postEditWidget.css';\nimport { IBulkEditService } from '../../../browser/services/bulkEditService.js';\nimport { createCombinedWorkspaceEdit } from './edit.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nlet PostEditWidget = class PostEditWidget extends Disposable {\n    static { PostEditWidget_1 = this; }\n    static { this.baseId = 'editor.widget.postEditWidget'; }\n    constructor(typeId, editor, visibleContext, showCommand, range, edits, onSelectNewEdit, _contextMenuService, contextKeyService, _keybindingService) {\n        super();\n        this.typeId = typeId;\n        this.editor = editor;\n        this.showCommand = showCommand;\n        this.range = range;\n        this.edits = edits;\n        this.onSelectNewEdit = onSelectNewEdit;\n        this._contextMenuService = _contextMenuService;\n        this._keybindingService = _keybindingService;\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = true;\n        this.create();\n        this.visibleContext = visibleContext.bindTo(contextKeyService);\n        this.visibleContext.set(true);\n        this._register(toDisposable(() => this.visibleContext.reset()));\n        this.editor.addContentWidget(this);\n        this.editor.layoutContentWidget(this);\n        this._register(toDisposable((() => this.editor.removeContentWidget(this))));\n        this._register(this.editor.onDidChangeCursorPosition(e => {\n            if (!range.containsPosition(e.position)) {\n                this.dispose();\n            }\n        }));\n        this._register(Event.runAndSubscribe(_keybindingService.onDidUpdateKeybindings, () => {\n            this._updateButtonTitle();\n        }));\n    }\n    _updateButtonTitle() {\n        const binding = this._keybindingService.lookupKeybinding(this.showCommand.id)?.getLabel();\n        this.button.element.title = this.showCommand.label + (binding ? ` (${binding})` : '');\n    }\n    create() {\n        this.domNode = dom.$('.post-edit-widget');\n        this.button = this._register(new Button(this.domNode, {\n            supportIcons: true,\n        }));\n        this.button.label = '$(insert)';\n        this._register(dom.addDisposableListener(this.domNode, dom.EventType.CLICK, () => this.showSelector()));\n    }\n    getId() {\n        return PostEditWidget_1.baseId + '.' + this.typeId;\n    }\n    getDomNode() {\n        return this.domNode;\n    }\n    getPosition() {\n        return {\n            position: this.range.getEndPosition(),\n            preference: [2 /* ContentWidgetPositionPreference.BELOW */]\n        };\n    }\n    showSelector() {\n        this._contextMenuService.showContextMenu({\n            getAnchor: () => {\n                const pos = dom.getDomNodePagePosition(this.button.element);\n                return { x: pos.left + pos.width, y: pos.top + pos.height };\n            },\n            getActions: () => {\n                return this.edits.allEdits.map((edit, i) => toAction({\n                    id: '',\n                    label: edit.title,\n                    checked: i === this.edits.activeEditIndex,\n                    run: () => {\n                        if (i !== this.edits.activeEditIndex) {\n                            return this.onSelectNewEdit(i);\n                        }\n                    },\n                }));\n            }\n        });\n    }\n};\nPostEditWidget = PostEditWidget_1 = __decorate([\n    __param(7, IContextMenuService),\n    __param(8, IContextKeyService),\n    __param(9, IKeybindingService)\n], PostEditWidget);\nlet PostEditWidgetManager = class PostEditWidgetManager extends Disposable {\n    constructor(_id, _editor, _visibleContext, _showCommand, _instantiationService, _bulkEditService, _notificationService) {\n        super();\n        this._id = _id;\n        this._editor = _editor;\n        this._visibleContext = _visibleContext;\n        this._showCommand = _showCommand;\n        this._instantiationService = _instantiationService;\n        this._bulkEditService = _bulkEditService;\n        this._notificationService = _notificationService;\n        this._currentWidget = this._register(new MutableDisposable());\n        this._register(Event.any(_editor.onDidChangeModel, _editor.onDidChangeModelContent)(() => this.clear()));\n    }\n    async applyEditAndShowIfNeeded(ranges, edits, canShowWidget, resolve, token) {\n        const model = this._editor.getModel();\n        if (!model || !ranges.length) {\n            return;\n        }\n        const edit = edits.allEdits.at(edits.activeEditIndex);\n        if (!edit) {\n            return;\n        }\n        const onDidSelectEdit = async (newEditIndex) => {\n            const model = this._editor.getModel();\n            if (!model) {\n                return;\n            }\n            await model.undo();\n            this.applyEditAndShowIfNeeded(ranges, { activeEditIndex: newEditIndex, allEdits: edits.allEdits }, canShowWidget, resolve, token);\n        };\n        const handleError = (e, message) => {\n            if (isCancellationError(e)) {\n                return;\n            }\n            this._notificationService.error(message);\n            if (canShowWidget) {\n                this.show(ranges[0], edits, onDidSelectEdit);\n            }\n        };\n        let resolvedEdit;\n        try {\n            resolvedEdit = await resolve(edit, token);\n        }\n        catch (e) {\n            return handleError(e, localize('resolveError', \"Error resolving edit '{0}':\\n{1}\", edit.title, toErrorMessage(e)));\n        }\n        if (token.isCancellationRequested) {\n            return;\n        }\n        const combinedWorkspaceEdit = createCombinedWorkspaceEdit(model.uri, ranges, resolvedEdit);\n        // Use a decoration to track edits around the trigger range\n        const primaryRange = ranges[0];\n        const editTrackingDecoration = model.deltaDecorations([], [{\n                range: primaryRange,\n                options: { description: 'paste-line-suffix', stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */ }\n            }]);\n        this._editor.focus();\n        let editResult;\n        let editRange;\n        try {\n            editResult = await this._bulkEditService.apply(combinedWorkspaceEdit, { editor: this._editor, token });\n            editRange = model.getDecorationRange(editTrackingDecoration[0]);\n        }\n        catch (e) {\n            return handleError(e, localize('applyError', \"Error applying edit '{0}':\\n{1}\", edit.title, toErrorMessage(e)));\n        }\n        finally {\n            model.deltaDecorations(editTrackingDecoration, []);\n        }\n        if (token.isCancellationRequested) {\n            return;\n        }\n        if (canShowWidget && editResult.isApplied && edits.allEdits.length > 1) {\n            this.show(editRange ?? primaryRange, edits, onDidSelectEdit);\n        }\n    }\n    show(range, edits, onDidSelectEdit) {\n        this.clear();\n        if (this._editor.hasModel()) {\n            this._currentWidget.value = this._instantiationService.createInstance((PostEditWidget), this._id, this._editor, this._visibleContext, this._showCommand, range, edits, onDidSelectEdit);\n        }\n    }\n    clear() {\n        this._currentWidget.clear();\n    }\n    tryShowSelector() {\n        this._currentWidget.value?.showSelector();\n    }\n};\nPostEditWidgetManager = __decorate([\n    __param(4, IInstantiationService),\n    __param(5, IBulkEditService),\n    __param(6, INotificationService)\n], PostEditWidgetManager);\nexport { PostEditWidgetManager };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar CopyPasteController_1;\nimport { addDisposableListener, getActiveDocument } from '../../../../base/browser/dom.js';\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { createCancelablePromise, DeferredPromise, raceCancellation } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { UriList, createStringDataTransferItem, matchesMimeType } from '../../../../base/common/dataTransfer.js';\nimport { HierarchicalKind } from '../../../../base/common/hierarchicalKind.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { Mimes } from '../../../../base/common/mime.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { ClipboardEventUtils } from '../../../browser/controller/textAreaInput.js';\nimport { toExternalVSDataTransfer, toVSDataTransfer } from '../../../browser/dnd.js';\nimport { IBulkEditService } from '../../../browser/services/bulkEditService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { DocumentPasteTriggerKind } from '../../../common/languages.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { DefaultTextPasteOrDropEditProvider } from './defaultProviders.js';\nimport { createCombinedWorkspaceEdit, sortEditsByYieldTo } from './edit.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { InlineProgressManager } from '../../inlineProgress/browser/inlineProgress.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport { localize } from '../../../../nls.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IProgressService } from '../../../../platform/progress/common/progress.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nimport { PostEditWidgetManager } from './postEditWidget.js';\nimport { CancellationError, isCancellationError } from '../../../../base/common/errors.js';\nexport const changePasteTypeCommandId = 'editor.changePasteType';\nexport const pasteWidgetVisibleCtx = new RawContextKey('pasteWidgetVisible', false, localize('pasteWidgetVisible', \"Whether the paste widget is showing\"));\nconst vscodeClipboardMime = 'application/vnd.code.copyMetadata';\nlet CopyPasteController = class CopyPasteController extends Disposable {\n    static { CopyPasteController_1 = this; }\n    static { this.ID = 'editor.contrib.copyPasteActionController'; }\n    static get(editor) {\n        return editor.getContribution(CopyPasteController_1.ID);\n    }\n    constructor(editor, instantiationService, _bulkEditService, _clipboardService, _languageFeaturesService, _quickInputService, _progressService) {\n        super();\n        this._bulkEditService = _bulkEditService;\n        this._clipboardService = _clipboardService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._quickInputService = _quickInputService;\n        this._progressService = _progressService;\n        this._editor = editor;\n        const container = editor.getContainerDomNode();\n        this._register(addDisposableListener(container, 'copy', e => this.handleCopy(e)));\n        this._register(addDisposableListener(container, 'cut', e => this.handleCopy(e)));\n        this._register(addDisposableListener(container, 'paste', e => this.handlePaste(e), true));\n        this._pasteProgressManager = this._register(new InlineProgressManager('pasteIntoEditor', editor, instantiationService));\n        this._postPasteWidgetManager = this._register(instantiationService.createInstance(PostEditWidgetManager, 'pasteIntoEditor', editor, pasteWidgetVisibleCtx, { id: changePasteTypeCommandId, label: localize('postPasteWidgetTitle', \"Show paste options...\") }));\n    }\n    changePasteType() {\n        this._postPasteWidgetManager.tryShowSelector();\n    }\n    pasteAs(preferred) {\n        this._editor.focus();\n        try {\n            this._pasteAsActionContext = { preferred };\n            getActiveDocument().execCommand('paste');\n        }\n        finally {\n            this._pasteAsActionContext = undefined;\n        }\n    }\n    clearWidgets() {\n        this._postPasteWidgetManager.clear();\n    }\n    isPasteAsEnabled() {\n        return this._editor.getOption(85 /* EditorOption.pasteAs */).enabled;\n    }\n    async finishedPaste() {\n        await this._currentPasteOperation;\n    }\n    handleCopy(e) {\n        if (!this._editor.hasTextFocus()) {\n            return;\n        }\n        // Explicitly clear the clipboard internal state.\n        // This is needed because on web, the browser clipboard is faked out using an in-memory store.\n        // This means the resources clipboard is not properly updated when copying from the editor.\n        this._clipboardService.clearInternalState?.();\n        if (!e.clipboardData || !this.isPasteAsEnabled()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const selections = this._editor.getSelections();\n        if (!model || !selections?.length) {\n            return;\n        }\n        const enableEmptySelectionClipboard = this._editor.getOption(37 /* EditorOption.emptySelectionClipboard */);\n        let ranges = selections;\n        const wasFromEmptySelection = selections.length === 1 && selections[0].isEmpty();\n        if (wasFromEmptySelection) {\n            if (!enableEmptySelectionClipboard) {\n                return;\n            }\n            ranges = [new Range(ranges[0].startLineNumber, 1, ranges[0].startLineNumber, 1 + model.getLineLength(ranges[0].startLineNumber))];\n        }\n        const toCopy = this._editor._getViewModel()?.getPlainTextToCopy(selections, enableEmptySelectionClipboard, platform.isWindows);\n        const multicursorText = Array.isArray(toCopy) ? toCopy : null;\n        const defaultPastePayload = {\n            multicursorText,\n            pasteOnNewLine: wasFromEmptySelection,\n            mode: null\n        };\n        const providers = this._languageFeaturesService.documentPasteEditProvider\n            .ordered(model)\n            .filter(x => !!x.prepareDocumentPaste);\n        if (!providers.length) {\n            this.setCopyMetadata(e.clipboardData, { defaultPastePayload });\n            return;\n        }\n        const dataTransfer = toVSDataTransfer(e.clipboardData);\n        const providerCopyMimeTypes = providers.flatMap(x => x.copyMimeTypes ?? []);\n        // Save off a handle pointing to data that VS Code maintains.\n        const handle = generateUuid();\n        this.setCopyMetadata(e.clipboardData, {\n            id: handle,\n            providerCopyMimeTypes,\n            defaultPastePayload\n        });\n        const promise = createCancelablePromise(async (token) => {\n            const results = coalesce(await Promise.all(providers.map(async (provider) => {\n                try {\n                    return await provider.prepareDocumentPaste(model, ranges, dataTransfer, token);\n                }\n                catch (err) {\n                    console.error(err);\n                    return undefined;\n                }\n            })));\n            // Values from higher priority providers should overwrite values from lower priority ones.\n            // Reverse the array to so that the calls to `replace` below will do this\n            results.reverse();\n            for (const result of results) {\n                for (const [mime, value] of result) {\n                    dataTransfer.replace(mime, value);\n                }\n            }\n            return dataTransfer;\n        });\n        CopyPasteController_1._currentCopyOperation?.dataTransferPromise.cancel();\n        CopyPasteController_1._currentCopyOperation = { handle: handle, dataTransferPromise: promise };\n    }\n    async handlePaste(e) {\n        if (!e.clipboardData || !this._editor.hasTextFocus()) {\n            return;\n        }\n        MessageController.get(this._editor)?.closeMessage();\n        this._currentPasteOperation?.cancel();\n        this._currentPasteOperation = undefined;\n        const model = this._editor.getModel();\n        const selections = this._editor.getSelections();\n        if (!selections?.length || !model) {\n            return;\n        }\n        if (this._editor.getOption(92 /* EditorOption.readOnly */) // Never enabled if editor is readonly.\n            || (!this.isPasteAsEnabled() && !this._pasteAsActionContext) // Or feature disabled (but still enable if paste was explicitly requested)\n        ) {\n            return;\n        }\n        const metadata = this.fetchCopyMetadata(e);\n        const dataTransfer = toExternalVSDataTransfer(e.clipboardData);\n        dataTransfer.delete(vscodeClipboardMime);\n        const allPotentialMimeTypes = [\n            ...e.clipboardData.types,\n            ...metadata?.providerCopyMimeTypes ?? [],\n            // TODO: always adds `uri-list` because this get set if there are resources in the system clipboard.\n            // However we can only check the system clipboard async. For this early check, just add it in.\n            // We filter providers again once we have the final dataTransfer we will use.\n            Mimes.uriList,\n        ];\n        const allProviders = this._languageFeaturesService.documentPasteEditProvider\n            .ordered(model)\n            .filter(provider => {\n            // Filter out providers that don't match the requested paste types\n            const preference = this._pasteAsActionContext?.preferred;\n            if (preference) {\n                if (provider.providedPasteEditKinds && !this.providerMatchesPreference(provider, preference)) {\n                    return false;\n                }\n            }\n            // And providers that don't handle any of mime types in the clipboard\n            return provider.pasteMimeTypes?.some(type => matchesMimeType(type, allPotentialMimeTypes));\n        });\n        if (!allProviders.length) {\n            if (this._pasteAsActionContext?.preferred) {\n                this.showPasteAsNoEditMessage(selections, this._pasteAsActionContext.preferred);\n            }\n            return;\n        }\n        // Prevent the editor's default paste handler from running.\n        // Note that after this point, we are fully responsible for handling paste.\n        // If we can't provider a paste for any reason, we need to explicitly delegate pasting back to the editor.\n        e.preventDefault();\n        e.stopImmediatePropagation();\n        if (this._pasteAsActionContext) {\n            this.showPasteAsPick(this._pasteAsActionContext.preferred, allProviders, selections, dataTransfer, metadata);\n        }\n        else {\n            this.doPasteInline(allProviders, selections, dataTransfer, metadata, e);\n        }\n    }\n    showPasteAsNoEditMessage(selections, preference) {\n        MessageController.get(this._editor)?.showMessage(localize('pasteAsError', \"No paste edits for '{0}' found\", preference instanceof HierarchicalKind ? preference.value : preference.providerId), selections[0].getStartPosition());\n    }\n    doPasteInline(allProviders, selections, dataTransfer, metadata, clipboardEvent) {\n        const editor = this._editor;\n        if (!editor.hasModel()) {\n            return;\n        }\n        const editorStateCts = new EditorStateCancellationTokenSource(editor, 1 /* CodeEditorStateFlag.Value */ | 2 /* CodeEditorStateFlag.Selection */, undefined);\n        const p = createCancelablePromise(async (pToken) => {\n            const editor = this._editor;\n            if (!editor.hasModel()) {\n                return;\n            }\n            const model = editor.getModel();\n            const disposables = new DisposableStore();\n            const cts = disposables.add(new CancellationTokenSource(pToken));\n            disposables.add(editorStateCts.token.onCancellationRequested(() => cts.cancel()));\n            const token = cts.token;\n            try {\n                await this.mergeInDataFromCopy(dataTransfer, metadata, token);\n                if (token.isCancellationRequested) {\n                    return;\n                }\n                const supportedProviders = allProviders.filter(provider => this.isSupportedPasteProvider(provider, dataTransfer));\n                if (!supportedProviders.length\n                    || (supportedProviders.length === 1 && supportedProviders[0] instanceof DefaultTextPasteOrDropEditProvider) // Only our default text provider is active\n                ) {\n                    return this.applyDefaultPasteHandler(dataTransfer, metadata, token, clipboardEvent);\n                }\n                const context = {\n                    triggerKind: DocumentPasteTriggerKind.Automatic,\n                };\n                const editSession = await this.getPasteEdits(supportedProviders, dataTransfer, model, selections, context, token);\n                disposables.add(editSession);\n                if (token.isCancellationRequested) {\n                    return;\n                }\n                // If the only edit returned is our default text edit, use the default paste handler\n                if (editSession.edits.length === 1 && editSession.edits[0].provider instanceof DefaultTextPasteOrDropEditProvider) {\n                    return this.applyDefaultPasteHandler(dataTransfer, metadata, token, clipboardEvent);\n                }\n                if (editSession.edits.length) {\n                    const canShowWidget = editor.getOption(85 /* EditorOption.pasteAs */).showPasteSelector === 'afterPaste';\n                    return this._postPasteWidgetManager.applyEditAndShowIfNeeded(selections, { activeEditIndex: 0, allEdits: editSession.edits }, canShowWidget, (edit, token) => {\n                        return new Promise((resolve, reject) => {\n                            (async () => {\n                                try {\n                                    const resolveP = edit.provider.resolveDocumentPasteEdit?.(edit, token);\n                                    const showP = new DeferredPromise();\n                                    const resolved = resolveP && await this._pasteProgressManager.showWhile(selections[0].getEndPosition(), localize('resolveProcess', \"Resolving paste edit. Click to cancel\"), Promise.race([showP.p, resolveP]), {\n                                        cancel: () => {\n                                            showP.cancel();\n                                            return reject(new CancellationError());\n                                        }\n                                    }, 0);\n                                    if (resolved) {\n                                        edit.additionalEdit = resolved.additionalEdit;\n                                    }\n                                    return resolve(edit);\n                                }\n                                catch (err) {\n                                    return reject(err);\n                                }\n                            })();\n                        });\n                    }, token);\n                }\n                await this.applyDefaultPasteHandler(dataTransfer, metadata, token, clipboardEvent);\n            }\n            finally {\n                disposables.dispose();\n                if (this._currentPasteOperation === p) {\n                    this._currentPasteOperation = undefined;\n                }\n            }\n        });\n        this._pasteProgressManager.showWhile(selections[0].getEndPosition(), localize('pasteIntoEditorProgress', \"Running paste handlers. Click to cancel and do basic paste\"), p, {\n            cancel: async () => {\n                try {\n                    p.cancel();\n                    if (editorStateCts.token.isCancellationRequested) {\n                        return;\n                    }\n                    await this.applyDefaultPasteHandler(dataTransfer, metadata, editorStateCts.token, clipboardEvent);\n                }\n                finally {\n                    editorStateCts.dispose();\n                }\n            }\n        }).then(() => {\n            editorStateCts.dispose();\n        });\n        this._currentPasteOperation = p;\n    }\n    showPasteAsPick(preference, allProviders, selections, dataTransfer, metadata) {\n        const p = createCancelablePromise(async (token) => {\n            const editor = this._editor;\n            if (!editor.hasModel()) {\n                return;\n            }\n            const model = editor.getModel();\n            const disposables = new DisposableStore();\n            const tokenSource = disposables.add(new EditorStateCancellationTokenSource(editor, 1 /* CodeEditorStateFlag.Value */ | 2 /* CodeEditorStateFlag.Selection */, undefined, token));\n            try {\n                await this.mergeInDataFromCopy(dataTransfer, metadata, tokenSource.token);\n                if (tokenSource.token.isCancellationRequested) {\n                    return;\n                }\n                // Filter out any providers the don't match the full data transfer we will send them.\n                let supportedProviders = allProviders.filter(provider => this.isSupportedPasteProvider(provider, dataTransfer, preference));\n                if (preference) {\n                    // We are looking for a specific edit\n                    supportedProviders = supportedProviders.filter(provider => this.providerMatchesPreference(provider, preference));\n                }\n                const context = {\n                    triggerKind: DocumentPasteTriggerKind.PasteAs,\n                    only: preference && preference instanceof HierarchicalKind ? preference : undefined,\n                };\n                let editSession = disposables.add(await this.getPasteEdits(supportedProviders, dataTransfer, model, selections, context, tokenSource.token));\n                if (tokenSource.token.isCancellationRequested) {\n                    return;\n                }\n                // Filter out any edits that don't match the requested kind\n                if (preference) {\n                    editSession = {\n                        edits: editSession.edits.filter(edit => {\n                            if (preference instanceof HierarchicalKind) {\n                                return preference.contains(edit.kind);\n                            }\n                            else {\n                                return preference.providerId === edit.provider.id;\n                            }\n                        }),\n                        dispose: editSession.dispose\n                    };\n                }\n                if (!editSession.edits.length) {\n                    if (context.only) {\n                        this.showPasteAsNoEditMessage(selections, context.only);\n                    }\n                    return;\n                }\n                let pickedEdit;\n                if (preference) {\n                    pickedEdit = editSession.edits.at(0);\n                }\n                else {\n                    const selected = await this._quickInputService.pick(editSession.edits.map((edit) => ({\n                        label: edit.title,\n                        description: edit.kind?.value,\n                        edit,\n                    })), {\n                        placeHolder: localize('pasteAsPickerPlaceholder', \"Select Paste Action\"),\n                    });\n                    pickedEdit = selected?.edit;\n                }\n                if (!pickedEdit) {\n                    return;\n                }\n                const combinedWorkspaceEdit = createCombinedWorkspaceEdit(model.uri, selections, pickedEdit);\n                await this._bulkEditService.apply(combinedWorkspaceEdit, { editor: this._editor });\n            }\n            finally {\n                disposables.dispose();\n                if (this._currentPasteOperation === p) {\n                    this._currentPasteOperation = undefined;\n                }\n            }\n        });\n        this._progressService.withProgress({\n            location: 10 /* ProgressLocation.Window */,\n            title: localize('pasteAsProgress', \"Running paste handlers\"),\n        }, () => p);\n    }\n    setCopyMetadata(dataTransfer, metadata) {\n        dataTransfer.setData(vscodeClipboardMime, JSON.stringify(metadata));\n    }\n    fetchCopyMetadata(e) {\n        if (!e.clipboardData) {\n            return;\n        }\n        // Prefer using the clipboard data we saved off\n        const rawMetadata = e.clipboardData.getData(vscodeClipboardMime);\n        if (rawMetadata) {\n            try {\n                return JSON.parse(rawMetadata);\n            }\n            catch {\n                return undefined;\n            }\n        }\n        // Otherwise try to extract the generic text editor metadata\n        const [_, metadata] = ClipboardEventUtils.getTextData(e.clipboardData);\n        if (metadata) {\n            return {\n                defaultPastePayload: {\n                    mode: metadata.mode,\n                    multicursorText: metadata.multicursorText ?? null,\n                    pasteOnNewLine: !!metadata.isFromEmptySelection,\n                },\n            };\n        }\n        return undefined;\n    }\n    async mergeInDataFromCopy(dataTransfer, metadata, token) {\n        if (metadata?.id && CopyPasteController_1._currentCopyOperation?.handle === metadata.id) {\n            const toMergeDataTransfer = await CopyPasteController_1._currentCopyOperation.dataTransferPromise;\n            if (token.isCancellationRequested) {\n                return;\n            }\n            for (const [key, value] of toMergeDataTransfer) {\n                dataTransfer.replace(key, value);\n            }\n        }\n        if (!dataTransfer.has(Mimes.uriList)) {\n            const resources = await this._clipboardService.readResources();\n            if (token.isCancellationRequested) {\n                return;\n            }\n            if (resources.length) {\n                dataTransfer.append(Mimes.uriList, createStringDataTransferItem(UriList.create(resources)));\n            }\n        }\n    }\n    async getPasteEdits(providers, dataTransfer, model, selections, context, token) {\n        const disposables = new DisposableStore();\n        const results = await raceCancellation(Promise.all(providers.map(async (provider) => {\n            try {\n                const edits = await provider.provideDocumentPasteEdits?.(model, selections, dataTransfer, context, token);\n                if (edits) {\n                    disposables.add(edits);\n                }\n                return edits?.edits?.map(edit => ({ ...edit, provider }));\n            }\n            catch (err) {\n                if (!isCancellationError(err)) {\n                    console.error(err);\n                }\n                return undefined;\n            }\n        })), token);\n        const edits = coalesce(results ?? []).flat().filter(edit => {\n            return !context.only || context.only.contains(edit.kind);\n        });\n        return {\n            edits: sortEditsByYieldTo(edits),\n            dispose: () => disposables.dispose()\n        };\n    }\n    async applyDefaultPasteHandler(dataTransfer, metadata, token, clipboardEvent) {\n        const textDataTransfer = dataTransfer.get(Mimes.text) ?? dataTransfer.get('text');\n        const text = (await textDataTransfer?.asString()) ?? '';\n        if (token.isCancellationRequested) {\n            return;\n        }\n        const payload = {\n            clipboardEvent,\n            text,\n            pasteOnNewLine: metadata?.defaultPastePayload.pasteOnNewLine ?? false,\n            multicursorText: metadata?.defaultPastePayload.multicursorText ?? null,\n            mode: null,\n        };\n        this._editor.trigger('keyboard', \"paste\" /* Handler.Paste */, payload);\n    }\n    /**\n     * Filter out providers if they:\n     * - Don't handle any of the data transfer types we have\n     * - Don't match the preferred paste kind\n     */\n    isSupportedPasteProvider(provider, dataTransfer, preference) {\n        if (!provider.pasteMimeTypes?.some(type => dataTransfer.matches(type))) {\n            return false;\n        }\n        return !preference || this.providerMatchesPreference(provider, preference);\n    }\n    providerMatchesPreference(provider, preference) {\n        if (preference instanceof HierarchicalKind) {\n            if (!provider.providedPasteEditKinds) {\n                return true;\n            }\n            return provider.providedPasteEditKinds.some(providedKind => preference.contains(providedKind));\n        }\n        else {\n            return provider.id === preference.providerId;\n        }\n    }\n};\nCopyPasteController = CopyPasteController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IBulkEditService),\n    __param(3, IClipboardService),\n    __param(4, ILanguageFeaturesService),\n    __param(5, IQuickInputService),\n    __param(6, IProgressService)\n], CopyPasteController);\nexport { CopyPasteController };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as browser from '../../../../base/browser/browser.js';\nimport { getActiveDocument } from '../../../../base/browser/dom.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { CopyOptions, InMemoryClipboardMetadataManager } from '../../../browser/controller/textAreaInput.js';\nimport { EditorAction, MultiCommand, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { CopyPasteController } from '../../dropOrPasteInto/browser/copyPasteController.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId, MenuRegistry } from '../../../../platform/actions/common/actions.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nconst CLIPBOARD_CONTEXT_MENU_GROUP = '9_cutcopypaste';\nconst supportsCut = (platform.isNative || document.queryCommandSupported('cut'));\nconst supportsCopy = (platform.isNative || document.queryCommandSupported('copy'));\n// Firefox only supports navigator.clipboard.readText() in browser extensions.\n// See https://developer.mozilla.org/en-US/docs/Web/API/Clipboard/readText#Browser_compatibility\n// When loading over http, navigator.clipboard can be undefined. See https://github.com/microsoft/monaco-editor/issues/2313\nconst supportsPaste = (typeof navigator.clipboard === 'undefined' || browser.isFirefox) ? document.queryCommandSupported('paste') : true;\nfunction registerCommand(command) {\n    command.register();\n    return command;\n}\nexport const CutAction = supportsCut ? registerCommand(new MultiCommand({\n    id: 'editor.action.clipboardCutAction',\n    precondition: undefined,\n    kbOpts: (\n    // Do not bind cut keybindings in the browser,\n    // since browsers do that for us and it avoids security prompts\n    platform.isNative ? {\n        primary: 2048 /* KeyMod.CtrlCmd */ | 54 /* KeyCode.KeyX */,\n        win: { primary: 2048 /* KeyMod.CtrlCmd */ | 54 /* KeyCode.KeyX */, secondary: [1024 /* KeyMod.Shift */ | 20 /* KeyCode.Delete */] },\n        weight: 100 /* KeybindingWeight.EditorContrib */\n    } : undefined),\n    menuOpts: [{\n            menuId: MenuId.MenubarEditMenu,\n            group: '2_ccp',\n            title: nls.localize({ key: 'miCut', comment: ['&& denotes a mnemonic'] }, \"Cu&&t\"),\n            order: 1\n        }, {\n            menuId: MenuId.EditorContext,\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\n            title: nls.localize('actions.clipboard.cutLabel', \"Cut\"),\n            when: EditorContextKeys.writable,\n            order: 1,\n        }, {\n            menuId: MenuId.CommandPalette,\n            group: '',\n            title: nls.localize('actions.clipboard.cutLabel', \"Cut\"),\n            order: 1\n        }, {\n            menuId: MenuId.SimpleEditorContext,\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\n            title: nls.localize('actions.clipboard.cutLabel', \"Cut\"),\n            when: EditorContextKeys.writable,\n            order: 1,\n        }]\n})) : undefined;\nexport const CopyAction = supportsCopy ? registerCommand(new MultiCommand({\n    id: 'editor.action.clipboardCopyAction',\n    precondition: undefined,\n    kbOpts: (\n    // Do not bind copy keybindings in the browser,\n    // since browsers do that for us and it avoids security prompts\n    platform.isNative ? {\n        primary: 2048 /* KeyMod.CtrlCmd */ | 33 /* KeyCode.KeyC */,\n        win: { primary: 2048 /* KeyMod.CtrlCmd */ | 33 /* KeyCode.KeyC */, secondary: [2048 /* KeyMod.CtrlCmd */ | 19 /* KeyCode.Insert */] },\n        weight: 100 /* KeybindingWeight.EditorContrib */\n    } : undefined),\n    menuOpts: [{\n            menuId: MenuId.MenubarEditMenu,\n            group: '2_ccp',\n            title: nls.localize({ key: 'miCopy', comment: ['&& denotes a mnemonic'] }, \"&&Copy\"),\n            order: 2\n        }, {\n            menuId: MenuId.EditorContext,\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\n            title: nls.localize('actions.clipboard.copyLabel', \"Copy\"),\n            order: 2,\n        }, {\n            menuId: MenuId.CommandPalette,\n            group: '',\n            title: nls.localize('actions.clipboard.copyLabel', \"Copy\"),\n            order: 1\n        }, {\n            menuId: MenuId.SimpleEditorContext,\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\n            title: nls.localize('actions.clipboard.copyLabel', \"Copy\"),\n            order: 2,\n        }]\n})) : undefined;\nMenuRegistry.appendMenuItem(MenuId.MenubarEditMenu, { submenu: MenuId.MenubarCopy, title: nls.localize2('copy as', \"Copy As\"), group: '2_ccp', order: 3 });\nMenuRegistry.appendMenuItem(MenuId.EditorContext, { submenu: MenuId.EditorContextCopy, title: nls.localize2('copy as', \"Copy As\"), group: CLIPBOARD_CONTEXT_MENU_GROUP, order: 3 });\nMenuRegistry.appendMenuItem(MenuId.EditorContext, { submenu: MenuId.EditorContextShare, title: nls.localize2('share', \"Share\"), group: '11_share', order: -1, when: ContextKeyExpr.and(ContextKeyExpr.notEquals('resourceScheme', 'output'), EditorContextKeys.editorTextFocus) });\nMenuRegistry.appendMenuItem(MenuId.ExplorerContext, { submenu: MenuId.ExplorerContextShare, title: nls.localize2('share', \"Share\"), group: '11_share', order: -1 });\nexport const PasteAction = supportsPaste ? registerCommand(new MultiCommand({\n    id: 'editor.action.clipboardPasteAction',\n    precondition: undefined,\n    kbOpts: (\n    // Do not bind paste keybindings in the browser,\n    // since browsers do that for us and it avoids security prompts\n    platform.isNative ? {\n        primary: 2048 /* KeyMod.CtrlCmd */ | 52 /* KeyCode.KeyV */,\n        win: { primary: 2048 /* KeyMod.CtrlCmd */ | 52 /* KeyCode.KeyV */, secondary: [1024 /* KeyMod.Shift */ | 19 /* KeyCode.Insert */] },\n        linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 52 /* KeyCode.KeyV */, secondary: [1024 /* KeyMod.Shift */ | 19 /* KeyCode.Insert */] },\n        weight: 100 /* KeybindingWeight.EditorContrib */\n    } : undefined),\n    menuOpts: [{\n            menuId: MenuId.MenubarEditMenu,\n            group: '2_ccp',\n            title: nls.localize({ key: 'miPaste', comment: ['&& denotes a mnemonic'] }, \"&&Paste\"),\n            order: 4\n        }, {\n            menuId: MenuId.EditorContext,\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\n            title: nls.localize('actions.clipboard.pasteLabel', \"Paste\"),\n            when: EditorContextKeys.writable,\n            order: 4,\n        }, {\n            menuId: MenuId.CommandPalette,\n            group: '',\n            title: nls.localize('actions.clipboard.pasteLabel', \"Paste\"),\n            order: 1\n        }, {\n            menuId: MenuId.SimpleEditorContext,\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\n            title: nls.localize('actions.clipboard.pasteLabel', \"Paste\"),\n            when: EditorContextKeys.writable,\n            order: 4,\n        }]\n})) : undefined;\nclass ExecCommandCopyWithSyntaxHighlightingAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.clipboardCopyWithSyntaxHighlightingAction',\n            label: nls.localize('actions.clipboard.copyWithSyntaxHighlightingLabel', \"Copy With Syntax Highlighting\"),\n            alias: 'Copy With Syntax Highlighting',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const emptySelectionClipboard = editor.getOption(37 /* EditorOption.emptySelectionClipboard */);\n        if (!emptySelectionClipboard && editor.getSelection().isEmpty()) {\n            return;\n        }\n        CopyOptions.forceCopyWithSyntaxHighlighting = true;\n        editor.focus();\n        editor.getContainerDomNode().ownerDocument.execCommand('copy');\n        CopyOptions.forceCopyWithSyntaxHighlighting = false;\n    }\n}\nfunction registerExecCommandImpl(target, browserCommand) {\n    if (!target) {\n        return;\n    }\n    // 1. handle case when focus is in editor.\n    target.addImplementation(10000, 'code-editor', (accessor, args) => {\n        // Only if editor text focus (i.e. not if editor has widget focus).\n        const focusedEditor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n        if (focusedEditor && focusedEditor.hasTextFocus()) {\n            // Do not execute if there is no selection and empty selection clipboard is off\n            const emptySelectionClipboard = focusedEditor.getOption(37 /* EditorOption.emptySelectionClipboard */);\n            const selection = focusedEditor.getSelection();\n            if (selection && selection.isEmpty() && !emptySelectionClipboard) {\n                return true;\n            }\n            focusedEditor.getContainerDomNode().ownerDocument.execCommand(browserCommand);\n            return true;\n        }\n        return false;\n    });\n    // 2. (default) handle case when focus is somewhere else.\n    target.addImplementation(0, 'generic-dom', (accessor, args) => {\n        getActiveDocument().execCommand(browserCommand);\n        return true;\n    });\n}\nregisterExecCommandImpl(CutAction, 'cut');\nregisterExecCommandImpl(CopyAction, 'copy');\nif (PasteAction) {\n    // 1. Paste: handle case when focus is in editor.\n    PasteAction.addImplementation(10000, 'code-editor', (accessor, args) => {\n        const codeEditorService = accessor.get(ICodeEditorService);\n        const clipboardService = accessor.get(IClipboardService);\n        // Only if editor text focus (i.e. not if editor has widget focus).\n        const focusedEditor = codeEditorService.getFocusedCodeEditor();\n        if (focusedEditor && focusedEditor.hasTextFocus()) {\n            const result = focusedEditor.getContainerDomNode().ownerDocument.execCommand('paste');\n            if (result) {\n                return CopyPasteController.get(focusedEditor)?.finishedPaste() ?? Promise.resolve();\n            }\n            else if (platform.isWeb) {\n                // Use the clipboard service if document.execCommand('paste') was not successful\n                return (async () => {\n                    const clipboardText = await clipboardService.readText();\n                    if (clipboardText !== '') {\n                        const metadata = InMemoryClipboardMetadataManager.INSTANCE.get(clipboardText);\n                        let pasteOnNewLine = false;\n                        let multicursorText = null;\n                        let mode = null;\n                        if (metadata) {\n                            pasteOnNewLine = (focusedEditor.getOption(37 /* EditorOption.emptySelectionClipboard */) && !!metadata.isFromEmptySelection);\n                            multicursorText = (typeof metadata.multicursorText !== 'undefined' ? metadata.multicursorText : null);\n                            mode = metadata.mode;\n                        }\n                        focusedEditor.trigger('keyboard', \"paste\" /* Handler.Paste */, {\n                            text: clipboardText,\n                            pasteOnNewLine,\n                            multicursorText,\n                            mode\n                        });\n                    }\n                })();\n            }\n            return true;\n        }\n        return false;\n    });\n    // 2. Paste: (default) handle case when focus is somewhere else.\n    PasteAction.addImplementation(0, 'generic-dom', (accessor, args) => {\n        getActiveDocument().execCommand('paste');\n        return true;\n    });\n}\nif (supportsCopy) {\n    registerEditorAction(ExecCommandCopyWithSyntaxHighlightingAction);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { HierarchicalKind } from '../../../../base/common/hierarchicalKind.js';\nexport const CodeActionKind = new class {\n    constructor() {\n        this.QuickFix = new HierarchicalKind('quickfix');\n        this.Refactor = new HierarchicalKind('refactor');\n        this.RefactorExtract = this.Refactor.append('extract');\n        this.RefactorInline = this.Refactor.append('inline');\n        this.RefactorMove = this.Refactor.append('move');\n        this.RefactorRewrite = this.Refactor.append('rewrite');\n        this.Notebook = new HierarchicalKind('notebook');\n        this.Source = new HierarchicalKind('source');\n        this.SourceOrganizeImports = this.Source.append('organizeImports');\n        this.SourceFixAll = this.Source.append('fixAll');\n        this.SurroundWith = this.Refactor.append('surround');\n    }\n};\nexport var CodeActionTriggerSource;\n(function (CodeActionTriggerSource) {\n    CodeActionTriggerSource[\"Refactor\"] = \"refactor\";\n    CodeActionTriggerSource[\"RefactorPreview\"] = \"refactor preview\";\n    CodeActionTriggerSource[\"Lightbulb\"] = \"lightbulb\";\n    CodeActionTriggerSource[\"Default\"] = \"other (default)\";\n    CodeActionTriggerSource[\"SourceAction\"] = \"source action\";\n    CodeActionTriggerSource[\"QuickFix\"] = \"quick fix action\";\n    CodeActionTriggerSource[\"FixAll\"] = \"fix all\";\n    CodeActionTriggerSource[\"OrganizeImports\"] = \"organize imports\";\n    CodeActionTriggerSource[\"AutoFix\"] = \"auto fix\";\n    CodeActionTriggerSource[\"QuickFixHover\"] = \"quick fix hover window\";\n    CodeActionTriggerSource[\"OnSave\"] = \"save participants\";\n    CodeActionTriggerSource[\"ProblemsView\"] = \"problems view\";\n})(CodeActionTriggerSource || (CodeActionTriggerSource = {}));\nexport function mayIncludeActionsOfKind(filter, providedKind) {\n    // A provided kind may be a subset or superset of our filtered kind.\n    if (filter.include && !filter.include.intersects(providedKind)) {\n        return false;\n    }\n    if (filter.excludes) {\n        if (filter.excludes.some(exclude => excludesAction(providedKind, exclude, filter.include))) {\n            return false;\n        }\n    }\n    // Don't return source actions unless they are explicitly requested\n    if (!filter.includeSourceActions && CodeActionKind.Source.contains(providedKind)) {\n        return false;\n    }\n    return true;\n}\nexport function filtersAction(filter, action) {\n    const actionKind = action.kind ? new HierarchicalKind(action.kind) : undefined;\n    // Filter out actions by kind\n    if (filter.include) {\n        if (!actionKind || !filter.include.contains(actionKind)) {\n            return false;\n        }\n    }\n    if (filter.excludes) {\n        if (actionKind && filter.excludes.some(exclude => excludesAction(actionKind, exclude, filter.include))) {\n            return false;\n        }\n    }\n    // Don't return source actions unless they are explicitly requested\n    if (!filter.includeSourceActions) {\n        if (actionKind && CodeActionKind.Source.contains(actionKind)) {\n            return false;\n        }\n    }\n    if (filter.onlyIncludePreferredActions) {\n        if (!action.isPreferred) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction excludesAction(providedKind, exclude, include) {\n    if (!exclude.contains(providedKind)) {\n        return false;\n    }\n    if (include && exclude.contains(include)) {\n        // The include is more specific, don't filter out\n        return false;\n    }\n    return true;\n}\nexport class CodeActionCommandArgs {\n    static fromUser(arg, defaults) {\n        if (!arg || typeof arg !== 'object') {\n            return new CodeActionCommandArgs(defaults.kind, defaults.apply, false);\n        }\n        return new CodeActionCommandArgs(CodeActionCommandArgs.getKindFromUser(arg, defaults.kind), CodeActionCommandArgs.getApplyFromUser(arg, defaults.apply), CodeActionCommandArgs.getPreferredUser(arg));\n    }\n    static getApplyFromUser(arg, defaultAutoApply) {\n        switch (typeof arg.apply === 'string' ? arg.apply.toLowerCase() : '') {\n            case 'first': return \"first\" /* CodeActionAutoApply.First */;\n            case 'never': return \"never\" /* CodeActionAutoApply.Never */;\n            case 'ifsingle': return \"ifSingle\" /* CodeActionAutoApply.IfSingle */;\n            default: return defaultAutoApply;\n        }\n    }\n    static getKindFromUser(arg, defaultKind) {\n        return typeof arg.kind === 'string'\n            ? new HierarchicalKind(arg.kind)\n            : defaultKind;\n    }\n    static getPreferredUser(arg) {\n        return typeof arg.preferred === 'boolean'\n            ? arg.preferred\n            : false;\n    }\n    constructor(kind, apply, preferred) {\n        this.kind = kind;\n        this.apply = apply;\n        this.preferred = preferred;\n    }\n}\nexport class CodeActionItem {\n    constructor(action, provider, highlightRange) {\n        this.action = action;\n        this.provider = provider;\n        this.highlightRange = highlightRange;\n    }\n    async resolve(token) {\n        if (this.provider?.resolveCodeAction && !this.action.edit) {\n            let action;\n            try {\n                action = await this.provider.resolveCodeAction(this.action, token);\n            }\n            catch (err) {\n                onUnexpectedExternalError(err);\n            }\n            if (action) {\n                this.action.edit = action.edit;\n            }\n        }\n        return this;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { coalesce, equals, isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { illegalArgument, isCancellationError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IBulkEditService } from '../../../browser/services/bulkEditService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { TextModelCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport * as nls from '../../../../nls.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { Progress } from '../../../../platform/progress/common/progress.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { CodeActionItem, CodeActionKind, CodeActionTriggerSource, filtersAction, mayIncludeActionsOfKind } from '../common/types.js';\nimport { HierarchicalKind } from '../../../../base/common/hierarchicalKind.js';\nexport const codeActionCommandId = 'editor.action.codeAction';\nexport const quickFixCommandId = 'editor.action.quickFix';\nexport const autoFixCommandId = 'editor.action.autoFix';\nexport const refactorCommandId = 'editor.action.refactor';\nexport const sourceActionCommandId = 'editor.action.sourceAction';\nexport const organizeImportsCommandId = 'editor.action.organizeImports';\nexport const fixAllCommandId = 'editor.action.fixAll';\nclass ManagedCodeActionSet extends Disposable {\n    static codeActionsPreferredComparator(a, b) {\n        if (a.isPreferred && !b.isPreferred) {\n            return -1;\n        }\n        else if (!a.isPreferred && b.isPreferred) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    static codeActionsComparator({ action: a }, { action: b }) {\n        if (a.isAI && !b.isAI) {\n            return 1;\n        }\n        else if (!a.isAI && b.isAI) {\n            return -1;\n        }\n        if (isNonEmptyArray(a.diagnostics)) {\n            return isNonEmptyArray(b.diagnostics) ? ManagedCodeActionSet.codeActionsPreferredComparator(a, b) : -1;\n        }\n        else if (isNonEmptyArray(b.diagnostics)) {\n            return 1;\n        }\n        else {\n            return ManagedCodeActionSet.codeActionsPreferredComparator(a, b); // both have no diagnostics\n        }\n    }\n    constructor(actions, documentation, disposables) {\n        super();\n        this.documentation = documentation;\n        this._register(disposables);\n        this.allActions = [...actions].sort(ManagedCodeActionSet.codeActionsComparator);\n        this.validActions = this.allActions.filter(({ action }) => !action.disabled);\n    }\n    get hasAutoFix() {\n        return this.validActions.some(({ action: fix }) => !!fix.kind && CodeActionKind.QuickFix.contains(new HierarchicalKind(fix.kind)) && !!fix.isPreferred);\n    }\n    get hasAIFix() {\n        return this.validActions.some(({ action: fix }) => !!fix.isAI);\n    }\n    get allAIFixes() {\n        return this.validActions.every(({ action: fix }) => !!fix.isAI);\n    }\n}\nconst emptyCodeActionsResponse = { actions: [], documentation: undefined };\nexport async function getCodeActions(registry, model, rangeOrSelection, trigger, progress, token) {\n    const filter = trigger.filter || {};\n    const notebookFilter = {\n        ...filter,\n        excludes: [...(filter.excludes || []), CodeActionKind.Notebook],\n    };\n    const codeActionContext = {\n        only: filter.include?.value,\n        trigger: trigger.type,\n    };\n    const cts = new TextModelCancellationTokenSource(model, token);\n    // if the trigger is auto (autosave, lightbulb, etc), we should exclude notebook codeActions\n    const excludeNotebookCodeActions = (trigger.type === 2 /* languages.CodeActionTriggerType.Auto */);\n    const providers = getCodeActionProviders(registry, model, (excludeNotebookCodeActions) ? notebookFilter : filter);\n    const disposables = new DisposableStore();\n    const promises = providers.map(async (provider) => {\n        try {\n            progress.report(provider);\n            const providedCodeActions = await provider.provideCodeActions(model, rangeOrSelection, codeActionContext, cts.token);\n            if (providedCodeActions) {\n                disposables.add(providedCodeActions);\n            }\n            if (cts.token.isCancellationRequested) {\n                return emptyCodeActionsResponse;\n            }\n            const filteredActions = (providedCodeActions?.actions || []).filter(action => action && filtersAction(filter, action));\n            const documentation = getDocumentationFromProvider(provider, filteredActions, filter.include);\n            return {\n                actions: filteredActions.map(action => new CodeActionItem(action, provider)),\n                documentation\n            };\n        }\n        catch (err) {\n            if (isCancellationError(err)) {\n                throw err;\n            }\n            onUnexpectedExternalError(err);\n            return emptyCodeActionsResponse;\n        }\n    });\n    const listener = registry.onDidChange(() => {\n        const newProviders = registry.all(model);\n        if (!equals(newProviders, providers)) {\n            cts.cancel();\n        }\n    });\n    try {\n        const actions = await Promise.all(promises);\n        const allActions = actions.map(x => x.actions).flat();\n        const allDocumentation = [\n            ...coalesce(actions.map(x => x.documentation)),\n            ...getAdditionalDocumentationForShowingActions(registry, model, trigger, allActions)\n        ];\n        return new ManagedCodeActionSet(allActions, allDocumentation, disposables);\n    }\n    finally {\n        listener.dispose();\n        cts.dispose();\n    }\n}\nfunction getCodeActionProviders(registry, model, filter) {\n    return registry.all(model)\n        // Don't include providers that we know will not return code actions of interest\n        .filter(provider => {\n        if (!provider.providedCodeActionKinds) {\n            // We don't know what type of actions this provider will return.\n            return true;\n        }\n        return provider.providedCodeActionKinds.some(kind => mayIncludeActionsOfKind(filter, new HierarchicalKind(kind)));\n    });\n}\nfunction* getAdditionalDocumentationForShowingActions(registry, model, trigger, actionsToShow) {\n    if (model && actionsToShow.length) {\n        for (const provider of registry.all(model)) {\n            if (provider._getAdditionalMenuItems) {\n                yield* provider._getAdditionalMenuItems?.({ trigger: trigger.type, only: trigger.filter?.include?.value }, actionsToShow.map(item => item.action));\n            }\n        }\n    }\n}\nfunction getDocumentationFromProvider(provider, providedCodeActions, only) {\n    if (!provider.documentation) {\n        return undefined;\n    }\n    const documentation = provider.documentation.map(entry => ({ kind: new HierarchicalKind(entry.kind), command: entry.command }));\n    if (only) {\n        let currentBest;\n        for (const entry of documentation) {\n            if (entry.kind.contains(only)) {\n                if (!currentBest) {\n                    currentBest = entry;\n                }\n                else {\n                    // Take best match\n                    if (currentBest.kind.contains(entry.kind)) {\n                        currentBest = entry;\n                    }\n                }\n            }\n        }\n        if (currentBest) {\n            return currentBest?.command;\n        }\n    }\n    // Otherwise, check to see if any of the provided actions match.\n    for (const action of providedCodeActions) {\n        if (!action.kind) {\n            continue;\n        }\n        for (const entry of documentation) {\n            if (entry.kind.contains(new HierarchicalKind(action.kind))) {\n                return entry.command;\n            }\n        }\n    }\n    return undefined;\n}\nexport var ApplyCodeActionReason;\n(function (ApplyCodeActionReason) {\n    ApplyCodeActionReason[\"OnSave\"] = \"onSave\";\n    ApplyCodeActionReason[\"FromProblemsView\"] = \"fromProblemsView\";\n    ApplyCodeActionReason[\"FromCodeActions\"] = \"fromCodeActions\";\n    ApplyCodeActionReason[\"FromAILightbulb\"] = \"fromAILightbulb\"; // direct invocation when clicking on the AI lightbulb\n})(ApplyCodeActionReason || (ApplyCodeActionReason = {}));\nexport async function applyCodeAction(accessor, item, codeActionReason, options, token = CancellationToken.None) {\n    const bulkEditService = accessor.get(IBulkEditService);\n    const commandService = accessor.get(ICommandService);\n    const telemetryService = accessor.get(ITelemetryService);\n    const notificationService = accessor.get(INotificationService);\n    telemetryService.publicLog2('codeAction.applyCodeAction', {\n        codeActionTitle: item.action.title,\n        codeActionKind: item.action.kind,\n        codeActionIsPreferred: !!item.action.isPreferred,\n        reason: codeActionReason,\n    });\n    await item.resolve(token);\n    if (token.isCancellationRequested) {\n        return;\n    }\n    if (item.action.edit?.edits.length) {\n        const result = await bulkEditService.apply(item.action.edit, {\n            editor: options?.editor,\n            label: item.action.title,\n            quotableLabel: item.action.title,\n            code: 'undoredo.codeAction',\n            respectAutoSaveConfig: codeActionReason !== ApplyCodeActionReason.OnSave,\n            showPreview: options?.preview,\n        });\n        if (!result.isApplied) {\n            return;\n        }\n    }\n    if (item.action.command) {\n        try {\n            await commandService.executeCommand(item.action.command.id, ...(item.action.command.arguments || []));\n        }\n        catch (err) {\n            const message = asMessage(err);\n            notificationService.error(typeof message === 'string'\n                ? message\n                : nls.localize('applyCodeActionFailed', \"An unknown error occurred while applying the code action\"));\n        }\n    }\n}\nfunction asMessage(err) {\n    if (typeof err === 'string') {\n        return err;\n    }\n    else if (err instanceof Error && typeof err.message === 'string') {\n        return err.message;\n    }\n    else {\n        return undefined;\n    }\n}\nCommandsRegistry.registerCommand('_executeCodeActionProvider', async function (accessor, resource, rangeOrSelection, kind, itemResolveCount) {\n    if (!(resource instanceof URI)) {\n        throw illegalArgument();\n    }\n    const { codeActionProvider } = accessor.get(ILanguageFeaturesService);\n    const model = accessor.get(IModelService).getModel(resource);\n    if (!model) {\n        throw illegalArgument();\n    }\n    const validatedRangeOrSelection = Selection.isISelection(rangeOrSelection)\n        ? Selection.liftSelection(rangeOrSelection)\n        : Range.isIRange(rangeOrSelection)\n            ? model.validateRange(rangeOrSelection)\n            : undefined;\n    if (!validatedRangeOrSelection) {\n        throw illegalArgument();\n    }\n    const include = typeof kind === 'string' ? new HierarchicalKind(kind) : undefined;\n    const codeActionSet = await getCodeActions(codeActionProvider, model, validatedRangeOrSelection, { type: 1 /* languages.CodeActionTriggerType.Invoke */, triggerAction: CodeActionTriggerSource.Default, filter: { includeSourceActions: true, include } }, Progress.None, CancellationToken.None);\n    const resolving = [];\n    const resolveCount = Math.min(codeActionSet.validActions.length, typeof itemResolveCount === 'number' ? itemResolveCount : 0);\n    for (let i = 0; i < resolveCount; i++) {\n        resolving.push(codeActionSet.validActions[i].resolve(CancellationToken.None));\n    }\n    try {\n        await Promise.all(resolving);\n        return codeActionSet.validActions.map(item => item.action);\n    }\n    finally {\n        setTimeout(() => codeActionSet.dispose(), 100);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar CodeActionKeybindingResolver_1;\nimport { HierarchicalKind } from '../../../../base/common/hierarchicalKind.js';\nimport { Lazy } from '../../../../base/common/lazy.js';\nimport { codeActionCommandId, fixAllCommandId, organizeImportsCommandId, refactorCommandId, sourceActionCommandId } from './codeAction.js';\nimport { CodeActionCommandArgs, CodeActionKind } from '../common/types.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nlet CodeActionKeybindingResolver = class CodeActionKeybindingResolver {\n    static { CodeActionKeybindingResolver_1 = this; }\n    static { this.codeActionCommands = [\n        refactorCommandId,\n        codeActionCommandId,\n        sourceActionCommandId,\n        organizeImportsCommandId,\n        fixAllCommandId\n    ]; }\n    constructor(keybindingService) {\n        this.keybindingService = keybindingService;\n    }\n    getResolver() {\n        // Lazy since we may not actually ever read the value\n        const allCodeActionBindings = new Lazy(() => this.keybindingService.getKeybindings()\n            .filter(item => CodeActionKeybindingResolver_1.codeActionCommands.indexOf(item.command) >= 0)\n            .filter(item => item.resolvedKeybinding)\n            .map((item) => {\n            // Special case these commands since they come built-in with VS Code and don't use 'commandArgs'\n            let commandArgs = item.commandArgs;\n            if (item.command === organizeImportsCommandId) {\n                commandArgs = { kind: CodeActionKind.SourceOrganizeImports.value };\n            }\n            else if (item.command === fixAllCommandId) {\n                commandArgs = { kind: CodeActionKind.SourceFixAll.value };\n            }\n            return {\n                resolvedKeybinding: item.resolvedKeybinding,\n                ...CodeActionCommandArgs.fromUser(commandArgs, {\n                    kind: HierarchicalKind.None,\n                    apply: \"never\" /* CodeActionAutoApply.Never */\n                })\n            };\n        }));\n        return (action) => {\n            if (action.kind) {\n                const binding = this.bestKeybindingForCodeAction(action, allCodeActionBindings.value);\n                return binding?.resolvedKeybinding;\n            }\n            return undefined;\n        };\n    }\n    bestKeybindingForCodeAction(action, candidates) {\n        if (!action.kind) {\n            return undefined;\n        }\n        const kind = new HierarchicalKind(action.kind);\n        return candidates\n            .filter(candidate => candidate.kind.contains(kind))\n            .filter(candidate => {\n            if (candidate.preferred) {\n                // If the candidate keybinding only applies to preferred actions, the this action must also be preferred\n                return action.isPreferred;\n            }\n            return true;\n        })\n            .reduceRight((currentBest, candidate) => {\n            if (!currentBest) {\n                return candidate;\n            }\n            // Select the more specific binding\n            return currentBest.kind.contains(candidate.kind) ? candidate : currentBest;\n        }, undefined);\n    }\n};\nCodeActionKeybindingResolver = CodeActionKeybindingResolver_1 = __decorate([\n    __param(0, IKeybindingService)\n], CodeActionKeybindingResolver);\nexport { CodeActionKeybindingResolver };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './symbolIcons.css';\nimport { localize } from '../../../../nls.js';\nimport { foreground, registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nexport const SYMBOL_ICON_ARRAY_FOREGROUND = registerColor('symbolIcon.arrayForeground', foreground, localize('symbolIcon.arrayForeground', 'The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_BOOLEAN_FOREGROUND = registerColor('symbolIcon.booleanForeground', foreground, localize('symbolIcon.booleanForeground', 'The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_CLASS_FOREGROUND = registerColor('symbolIcon.classForeground', {\n    dark: '#EE9D28',\n    light: '#D67E00',\n    hcDark: '#EE9D28',\n    hcLight: '#D67E00'\n}, localize('symbolIcon.classForeground', 'The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_COLOR_FOREGROUND = registerColor('symbolIcon.colorForeground', foreground, localize('symbolIcon.colorForeground', 'The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_CONSTANT_FOREGROUND = registerColor('symbolIcon.constantForeground', foreground, localize('symbolIcon.constantForeground', 'The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_CONSTRUCTOR_FOREGROUND = registerColor('symbolIcon.constructorForeground', {\n    dark: '#B180D7',\n    light: '#652D90',\n    hcDark: '#B180D7',\n    hcLight: '#652D90'\n}, localize('symbolIcon.constructorForeground', 'The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_ENUMERATOR_FOREGROUND = registerColor('symbolIcon.enumeratorForeground', {\n    dark: '#EE9D28',\n    light: '#D67E00',\n    hcDark: '#EE9D28',\n    hcLight: '#D67E00'\n}, localize('symbolIcon.enumeratorForeground', 'The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND = registerColor('symbolIcon.enumeratorMemberForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC'\n}, localize('symbolIcon.enumeratorMemberForeground', 'The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_EVENT_FOREGROUND = registerColor('symbolIcon.eventForeground', {\n    dark: '#EE9D28',\n    light: '#D67E00',\n    hcDark: '#EE9D28',\n    hcLight: '#D67E00'\n}, localize('symbolIcon.eventForeground', 'The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FIELD_FOREGROUND = registerColor('symbolIcon.fieldForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC'\n}, localize('symbolIcon.fieldForeground', 'The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FILE_FOREGROUND = registerColor('symbolIcon.fileForeground', foreground, localize('symbolIcon.fileForeground', 'The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FOLDER_FOREGROUND = registerColor('symbolIcon.folderForeground', foreground, localize('symbolIcon.folderForeground', 'The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_FUNCTION_FOREGROUND = registerColor('symbolIcon.functionForeground', {\n    dark: '#B180D7',\n    light: '#652D90',\n    hcDark: '#B180D7',\n    hcLight: '#652D90'\n}, localize('symbolIcon.functionForeground', 'The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_INTERFACE_FOREGROUND = registerColor('symbolIcon.interfaceForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC'\n}, localize('symbolIcon.interfaceForeground', 'The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_KEY_FOREGROUND = registerColor('symbolIcon.keyForeground', foreground, localize('symbolIcon.keyForeground', 'The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_KEYWORD_FOREGROUND = registerColor('symbolIcon.keywordForeground', foreground, localize('symbolIcon.keywordForeground', 'The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_METHOD_FOREGROUND = registerColor('symbolIcon.methodForeground', {\n    dark: '#B180D7',\n    light: '#652D90',\n    hcDark: '#B180D7',\n    hcLight: '#652D90'\n}, localize('symbolIcon.methodForeground', 'The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_MODULE_FOREGROUND = registerColor('symbolIcon.moduleForeground', foreground, localize('symbolIcon.moduleForeground', 'The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_NAMESPACE_FOREGROUND = registerColor('symbolIcon.namespaceForeground', foreground, localize('symbolIcon.namespaceForeground', 'The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_NULL_FOREGROUND = registerColor('symbolIcon.nullForeground', foreground, localize('symbolIcon.nullForeground', 'The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_NUMBER_FOREGROUND = registerColor('symbolIcon.numberForeground', foreground, localize('symbolIcon.numberForeground', 'The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_OBJECT_FOREGROUND = registerColor('symbolIcon.objectForeground', foreground, localize('symbolIcon.objectForeground', 'The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_OPERATOR_FOREGROUND = registerColor('symbolIcon.operatorForeground', foreground, localize('symbolIcon.operatorForeground', 'The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_PACKAGE_FOREGROUND = registerColor('symbolIcon.packageForeground', foreground, localize('symbolIcon.packageForeground', 'The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_PROPERTY_FOREGROUND = registerColor('symbolIcon.propertyForeground', foreground, localize('symbolIcon.propertyForeground', 'The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_REFERENCE_FOREGROUND = registerColor('symbolIcon.referenceForeground', foreground, localize('symbolIcon.referenceForeground', 'The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_SNIPPET_FOREGROUND = registerColor('symbolIcon.snippetForeground', foreground, localize('symbolIcon.snippetForeground', 'The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_STRING_FOREGROUND = registerColor('symbolIcon.stringForeground', foreground, localize('symbolIcon.stringForeground', 'The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_STRUCT_FOREGROUND = registerColor('symbolIcon.structForeground', foreground, localize('symbolIcon.structForeground', 'The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_TEXT_FOREGROUND = registerColor('symbolIcon.textForeground', foreground, localize('symbolIcon.textForeground', 'The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_TYPEPARAMETER_FOREGROUND = registerColor('symbolIcon.typeParameterForeground', foreground, localize('symbolIcon.typeParameterForeground', 'The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_UNIT_FOREGROUND = registerColor('symbolIcon.unitForeground', foreground, localize('symbolIcon.unitForeground', 'The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\nexport const SYMBOL_ICON_VARIABLE_FOREGROUND = registerColor('symbolIcon.variableForeground', {\n    dark: '#75BEFF',\n    light: '#007ACC',\n    hcDark: '#75BEFF',\n    hcLight: '#007ACC',\n}, localize('symbolIcon.variableForeground', 'The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport '../../../../base/browser/ui/codicons/codiconStyles.js'; // The codicon symbol styles are defined here and must be loaded\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { CodeActionKind } from '../common/types.js';\nimport '../../symbolIcons/browser/symbolIcons.js'; // The codicon symbol colors are defined here and must be loaded to get colors\nimport { localize } from '../../../../nls.js';\nimport { HierarchicalKind } from '../../../../base/common/hierarchicalKind.js';\nconst uncategorizedCodeActionGroup = Object.freeze({ kind: HierarchicalKind.Empty, title: localize('codeAction.widget.id.more', 'More Actions...') });\nconst codeActionGroups = Object.freeze([\n    { kind: CodeActionKind.QuickFix, title: localize('codeAction.widget.id.quickfix', 'Quick Fix') },\n    { kind: CodeActionKind.RefactorExtract, title: localize('codeAction.widget.id.extract', 'Extract'), icon: Codicon.wrench },\n    { kind: CodeActionKind.RefactorInline, title: localize('codeAction.widget.id.inline', 'Inline'), icon: Codicon.wrench },\n    { kind: CodeActionKind.RefactorRewrite, title: localize('codeAction.widget.id.convert', 'Rewrite'), icon: Codicon.wrench },\n    { kind: CodeActionKind.RefactorMove, title: localize('codeAction.widget.id.move', 'Move'), icon: Codicon.wrench },\n    { kind: CodeActionKind.SurroundWith, title: localize('codeAction.widget.id.surround', 'Surround With'), icon: Codicon.surroundWith },\n    { kind: CodeActionKind.Source, title: localize('codeAction.widget.id.source', 'Source Action'), icon: Codicon.symbolFile },\n    uncategorizedCodeActionGroup,\n]);\nexport function toMenuItems(inputCodeActions, showHeaders, keybindingResolver) {\n    if (!showHeaders) {\n        return inputCodeActions.map((action) => {\n            return {\n                kind: \"action\" /* ActionListItemKind.Action */,\n                item: action,\n                group: uncategorizedCodeActionGroup,\n                disabled: !!action.action.disabled,\n                label: action.action.disabled || action.action.title,\n                canPreview: !!action.action.edit?.edits.length,\n            };\n        });\n    }\n    // Group code actions\n    const menuEntries = codeActionGroups.map(group => ({ group, actions: [] }));\n    for (const action of inputCodeActions) {\n        const kind = action.action.kind ? new HierarchicalKind(action.action.kind) : HierarchicalKind.None;\n        for (const menuEntry of menuEntries) {\n            if (menuEntry.group.kind.contains(kind)) {\n                menuEntry.actions.push(action);\n                break;\n            }\n        }\n    }\n    const allMenuItems = [];\n    for (const menuEntry of menuEntries) {\n        if (menuEntry.actions.length) {\n            allMenuItems.push({ kind: \"header\" /* ActionListItemKind.Header */, group: menuEntry.group });\n            for (const action of menuEntry.actions) {\n                const group = menuEntry.group;\n                allMenuItems.push({\n                    kind: \"action\" /* ActionListItemKind.Action */,\n                    item: action,\n                    group: action.action.isAI ? { title: group.title, kind: group.kind, icon: Codicon.sparkle } : group,\n                    label: action.action.title,\n                    disabled: !!action.action.disabled,\n                    keybinding: keybindingResolver(action.action),\n                });\n            }\n        }\n    }\n    return allMenuItems;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar LightBulbWidget_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Gesture } from '../../../../base/browser/touch.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport './lightBulbWidget.css';\nimport { GlyphMarginLane } from '../../../common/model.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { computeIndentLevel } from '../../../common/model/utils.js';\nimport { autoFixCommandId, quickFixCommandId } from './codeAction.js';\nimport * as nls from '../../../../nls.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { Range } from '../../../common/core/range.js';\nconst GUTTER_LIGHTBULB_ICON = registerIcon('gutter-lightbulb', Codicon.lightBulb, nls.localize('gutterLightbulbWidget', 'Icon which spawns code actions menu from the gutter when there is no space in the editor.'));\nconst GUTTER_LIGHTBULB_AUTO_FIX_ICON = registerIcon('gutter-lightbulb-auto-fix', Codicon.lightbulbAutofix, nls.localize('gutterLightbulbAutoFixWidget', 'Icon which spawns code actions menu from the gutter when there is no space in the editor and a quick fix is available.'));\nconst GUTTER_LIGHTBULB_AIFIX_ICON = registerIcon('gutter-lightbulb-sparkle', Codicon.lightbulbSparkle, nls.localize('gutterLightbulbAIFixWidget', 'Icon which spawns code actions menu from the gutter when there is no space in the editor and an AI fix is available.'));\nconst GUTTER_LIGHTBULB_AIFIX_AUTO_FIX_ICON = registerIcon('gutter-lightbulb-aifix-auto-fix', Codicon.lightbulbSparkleAutofix, nls.localize('gutterLightbulbAIFixAutoFixWidget', 'Icon which spawns code actions menu from the gutter when there is no space in the editor and an AI fix and a quick fix is available.'));\nconst GUTTER_SPARKLE_FILLED_ICON = registerIcon('gutter-lightbulb-sparkle-filled', Codicon.sparkleFilled, nls.localize('gutterLightbulbSparkleFilledWidget', 'Icon which spawns code actions menu from the gutter when there is no space in the editor and an AI fix and a quick fix is available.'));\nvar LightBulbState;\n(function (LightBulbState) {\n    LightBulbState.Hidden = { type: 0 /* Type.Hidden */ };\n    class Showing {\n        constructor(actions, trigger, editorPosition, widgetPosition) {\n            this.actions = actions;\n            this.trigger = trigger;\n            this.editorPosition = editorPosition;\n            this.widgetPosition = widgetPosition;\n            this.type = 1 /* Type.Showing */;\n        }\n    }\n    LightBulbState.Showing = Showing;\n})(LightBulbState || (LightBulbState = {}));\nlet LightBulbWidget = class LightBulbWidget extends Disposable {\n    static { LightBulbWidget_1 = this; }\n    static { this.GUTTER_DECORATION = ModelDecorationOptions.register({\n        description: 'codicon-gutter-lightbulb-decoration',\n        glyphMarginClassName: ThemeIcon.asClassName(Codicon.lightBulb),\n        glyphMargin: { position: GlyphMarginLane.Left },\n        stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    }); }\n    static { this.ID = 'editor.contrib.lightbulbWidget'; }\n    static { this._posPref = [0 /* ContentWidgetPositionPreference.EXACT */]; }\n    constructor(_editor, _keybindingService) {\n        super();\n        this._editor = _editor;\n        this._keybindingService = _keybindingService;\n        this._onClick = this._register(new Emitter());\n        this.onClick = this._onClick.event;\n        this._state = LightBulbState.Hidden;\n        this._gutterState = LightBulbState.Hidden;\n        this._iconClasses = [];\n        this.lightbulbClasses = [\n            'codicon-' + GUTTER_LIGHTBULB_ICON.id,\n            'codicon-' + GUTTER_LIGHTBULB_AIFIX_AUTO_FIX_ICON.id,\n            'codicon-' + GUTTER_LIGHTBULB_AUTO_FIX_ICON.id,\n            'codicon-' + GUTTER_LIGHTBULB_AIFIX_ICON.id,\n            'codicon-' + GUTTER_SPARKLE_FILLED_ICON.id\n        ];\n        this.gutterDecoration = LightBulbWidget_1.GUTTER_DECORATION;\n        this._domNode = dom.$('div.lightBulbWidget');\n        this._domNode.role = 'listbox';\n        this._register(Gesture.ignoreTarget(this._domNode));\n        this._editor.addContentWidget(this);\n        this._register(this._editor.onDidChangeModelContent(_ => {\n            // cancel when the line in question has been removed\n            const editorModel = this._editor.getModel();\n            if (this.state.type !== 1 /* LightBulbState.Type.Showing */ || !editorModel || this.state.editorPosition.lineNumber >= editorModel.getLineCount()) {\n                this.hide();\n            }\n            if (this.gutterState.type !== 1 /* LightBulbState.Type.Showing */ || !editorModel || this.gutterState.editorPosition.lineNumber >= editorModel.getLineCount()) {\n                this.gutterHide();\n            }\n        }));\n        this._register(dom.addStandardDisposableGenericMouseDownListener(this._domNode, e => {\n            if (this.state.type !== 1 /* LightBulbState.Type.Showing */) {\n                return;\n            }\n            // Make sure that focus / cursor location is not lost when clicking widget icon\n            this._editor.focus();\n            e.preventDefault();\n            // a bit of extra work to make sure the menu\n            // doesn't cover the line-text\n            const { top, height } = dom.getDomNodePagePosition(this._domNode);\n            const lineHeight = this._editor.getOption(67 /* EditorOption.lineHeight */);\n            let pad = Math.floor(lineHeight / 3);\n            if (this.state.widgetPosition.position !== null && this.state.widgetPosition.position.lineNumber < this.state.editorPosition.lineNumber) {\n                pad += lineHeight;\n            }\n            this._onClick.fire({\n                x: e.posx,\n                y: top + height + pad,\n                actions: this.state.actions,\n                trigger: this.state.trigger,\n            });\n        }));\n        this._register(dom.addDisposableListener(this._domNode, 'mouseenter', (e) => {\n            if ((e.buttons & 1) !== 1) {\n                return;\n            }\n            // mouse enters lightbulb while the primary/left button\n            // is being pressed -> hide the lightbulb\n            this.hide();\n        }));\n        this._register(Event.runAndSubscribe(this._keybindingService.onDidUpdateKeybindings, () => {\n            this._preferredKbLabel = this._keybindingService.lookupKeybinding(autoFixCommandId)?.getLabel() ?? undefined;\n            this._quickFixKbLabel = this._keybindingService.lookupKeybinding(quickFixCommandId)?.getLabel() ?? undefined;\n            this._updateLightBulbTitleAndIcon();\n        }));\n        this._register(this._editor.onMouseDown(async (e) => {\n            if (!e.target.element || !this.lightbulbClasses.some(cls => e.target.element && e.target.element.classList.contains(cls))) {\n                return;\n            }\n            if (this.gutterState.type !== 1 /* LightBulbState.Type.Showing */) {\n                return;\n            }\n            // Make sure that focus / cursor location is not lost when clicking widget icon\n            this._editor.focus();\n            // a bit of extra work to make sure the menu\n            // doesn't cover the line-text\n            const { top, height } = dom.getDomNodePagePosition(e.target.element);\n            const lineHeight = this._editor.getOption(67 /* EditorOption.lineHeight */);\n            let pad = Math.floor(lineHeight / 3);\n            if (this.gutterState.widgetPosition.position !== null && this.gutterState.widgetPosition.position.lineNumber < this.gutterState.editorPosition.lineNumber) {\n                pad += lineHeight;\n            }\n            this._onClick.fire({\n                x: e.event.posx,\n                y: top + height + pad,\n                actions: this.gutterState.actions,\n                trigger: this.gutterState.trigger,\n            });\n        }));\n    }\n    dispose() {\n        super.dispose();\n        this._editor.removeContentWidget(this);\n        if (this._gutterDecorationID) {\n            this._removeGutterDecoration(this._gutterDecorationID);\n        }\n    }\n    getId() {\n        return 'LightBulbWidget';\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        return this._state.type === 1 /* LightBulbState.Type.Showing */ ? this._state.widgetPosition : null;\n    }\n    update(actions, trigger, atPosition) {\n        if (actions.validActions.length <= 0) {\n            this.gutterHide();\n            return this.hide();\n        }\n        const hasTextFocus = this._editor.hasTextFocus();\n        if (!hasTextFocus) {\n            this.gutterHide();\n            return this.hide();\n        }\n        const options = this._editor.getOptions();\n        if (!options.get(65 /* EditorOption.lightbulb */).enabled) {\n            this.gutterHide();\n            return this.hide();\n        }\n        const model = this._editor.getModel();\n        if (!model) {\n            this.gutterHide();\n            return this.hide();\n        }\n        const { lineNumber, column } = model.validatePosition(atPosition);\n        const tabSize = model.getOptions().tabSize;\n        const fontInfo = this._editor.getOptions().get(50 /* EditorOption.fontInfo */);\n        const lineContent = model.getLineContent(lineNumber);\n        const indent = computeIndentLevel(lineContent, tabSize);\n        const lineHasSpace = fontInfo.spaceWidth * indent > 22;\n        const isFolded = (lineNumber) => {\n            return lineNumber > 2 && this._editor.getTopForLineNumber(lineNumber) === this._editor.getTopForLineNumber(lineNumber - 1);\n        };\n        // Check for glyph margin decorations of any kind\n        const currLineDecorations = this._editor.getLineDecorations(lineNumber);\n        let hasDecoration = false;\n        if (currLineDecorations) {\n            for (const decoration of currLineDecorations) {\n                const glyphClass = decoration.options.glyphMarginClassName;\n                if (glyphClass && !this.lightbulbClasses.some(className => glyphClass.includes(className))) {\n                    hasDecoration = true;\n                    break;\n                }\n            }\n        }\n        let effectiveLineNumber = lineNumber;\n        let effectiveColumnNumber = 1;\n        if (!lineHasSpace) {\n            // Checks if line is empty or starts with any amount of whitespace\n            const isLineEmptyOrIndented = (lineNumber) => {\n                const lineContent = model.getLineContent(lineNumber);\n                return /^\\s*$|^\\s+/.test(lineContent) || lineContent.length <= effectiveColumnNumber;\n            };\n            if (lineNumber > 1 && !isFolded(lineNumber - 1)) {\n                const lineCount = model.getLineCount();\n                const endLine = lineNumber === lineCount;\n                const prevLineEmptyOrIndented = lineNumber > 1 && isLineEmptyOrIndented(lineNumber - 1);\n                const nextLineEmptyOrIndented = !endLine && isLineEmptyOrIndented(lineNumber + 1);\n                const currLineEmptyOrIndented = isLineEmptyOrIndented(lineNumber);\n                const notEmpty = !nextLineEmptyOrIndented && !prevLineEmptyOrIndented;\n                // check above and below. if both are blocked, display lightbulb in the gutter.\n                if (!nextLineEmptyOrIndented && !prevLineEmptyOrIndented && !hasDecoration) {\n                    this.gutterState = new LightBulbState.Showing(actions, trigger, atPosition, {\n                        position: { lineNumber: effectiveLineNumber, column: effectiveColumnNumber },\n                        preference: LightBulbWidget_1._posPref\n                    });\n                    this.renderGutterLightbub();\n                    return this.hide();\n                }\n                else if (prevLineEmptyOrIndented || endLine || (prevLineEmptyOrIndented && !currLineEmptyOrIndented)) {\n                    effectiveLineNumber -= 1;\n                }\n                else if (nextLineEmptyOrIndented || (notEmpty && currLineEmptyOrIndented)) {\n                    effectiveLineNumber += 1;\n                }\n            }\n            else if (lineNumber === 1 && (lineNumber === model.getLineCount() || !isLineEmptyOrIndented(lineNumber + 1) && !isLineEmptyOrIndented(lineNumber))) {\n                // special checks for first line blocked vs. not blocked.\n                this.gutterState = new LightBulbState.Showing(actions, trigger, atPosition, {\n                    position: { lineNumber: effectiveLineNumber, column: effectiveColumnNumber },\n                    preference: LightBulbWidget_1._posPref\n                });\n                if (hasDecoration) {\n                    this.gutterHide();\n                }\n                else {\n                    this.renderGutterLightbub();\n                    return this.hide();\n                }\n            }\n            else if ((lineNumber < model.getLineCount()) && !isFolded(lineNumber + 1)) {\n                effectiveLineNumber += 1;\n            }\n            else if (column * fontInfo.spaceWidth < 22) {\n                // cannot show lightbulb above/below and showing\n                // it inline would overlay the cursor...\n                return this.hide();\n            }\n            effectiveColumnNumber = /^\\S\\s*$/.test(model.getLineContent(effectiveLineNumber)) ? 2 : 1;\n        }\n        this.state = new LightBulbState.Showing(actions, trigger, atPosition, {\n            position: { lineNumber: effectiveLineNumber, column: effectiveColumnNumber },\n            preference: LightBulbWidget_1._posPref\n        });\n        if (this._gutterDecorationID) {\n            this._removeGutterDecoration(this._gutterDecorationID);\n            this.gutterHide();\n        }\n        const validActions = actions.validActions;\n        const actionKind = actions.validActions[0].action.kind;\n        if (validActions.length !== 1 || !actionKind) {\n            this._editor.layoutContentWidget(this);\n            return;\n        }\n        this._editor.layoutContentWidget(this);\n    }\n    hide() {\n        if (this.state === LightBulbState.Hidden) {\n            return;\n        }\n        this.state = LightBulbState.Hidden;\n        this._editor.layoutContentWidget(this);\n    }\n    gutterHide() {\n        if (this.gutterState === LightBulbState.Hidden) {\n            return;\n        }\n        if (this._gutterDecorationID) {\n            this._removeGutterDecoration(this._gutterDecorationID);\n        }\n        this.gutterState = LightBulbState.Hidden;\n    }\n    get state() { return this._state; }\n    set state(value) {\n        this._state = value;\n        this._updateLightBulbTitleAndIcon();\n    }\n    get gutterState() { return this._gutterState; }\n    set gutterState(value) {\n        this._gutterState = value;\n        this._updateGutterLightBulbTitleAndIcon();\n    }\n    _updateLightBulbTitleAndIcon() {\n        this._domNode.classList.remove(...this._iconClasses);\n        this._iconClasses = [];\n        if (this.state.type !== 1 /* LightBulbState.Type.Showing */) {\n            return;\n        }\n        let icon;\n        let autoRun = false;\n        if (this.state.actions.allAIFixes) {\n            icon = Codicon.sparkleFilled;\n            if (this.state.actions.validActions.length === 1) {\n                autoRun = true;\n            }\n        }\n        else if (this.state.actions.hasAutoFix) {\n            if (this.state.actions.hasAIFix) {\n                icon = Codicon.lightbulbSparkleAutofix;\n            }\n            else {\n                icon = Codicon.lightbulbAutofix;\n            }\n        }\n        else if (this.state.actions.hasAIFix) {\n            icon = Codicon.lightbulbSparkle;\n        }\n        else {\n            icon = Codicon.lightBulb;\n        }\n        this._updateLightbulbTitle(this.state.actions.hasAutoFix, autoRun);\n        this._iconClasses = ThemeIcon.asClassNameArray(icon);\n        this._domNode.classList.add(...this._iconClasses);\n    }\n    _updateGutterLightBulbTitleAndIcon() {\n        if (this.gutterState.type !== 1 /* LightBulbState.Type.Showing */) {\n            return;\n        }\n        let icon;\n        let autoRun = false;\n        if (this.gutterState.actions.allAIFixes) {\n            icon = GUTTER_SPARKLE_FILLED_ICON;\n            if (this.gutterState.actions.validActions.length === 1) {\n                autoRun = true;\n            }\n        }\n        else if (this.gutterState.actions.hasAutoFix) {\n            if (this.gutterState.actions.hasAIFix) {\n                icon = GUTTER_LIGHTBULB_AIFIX_AUTO_FIX_ICON;\n            }\n            else {\n                icon = GUTTER_LIGHTBULB_AUTO_FIX_ICON;\n            }\n        }\n        else if (this.gutterState.actions.hasAIFix) {\n            icon = GUTTER_LIGHTBULB_AIFIX_ICON;\n        }\n        else {\n            icon = GUTTER_LIGHTBULB_ICON;\n        }\n        this._updateLightbulbTitle(this.gutterState.actions.hasAutoFix, autoRun);\n        const GUTTER_DECORATION = ModelDecorationOptions.register({\n            description: 'codicon-gutter-lightbulb-decoration',\n            glyphMarginClassName: ThemeIcon.asClassName(icon),\n            glyphMargin: { position: GlyphMarginLane.Left },\n            stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n        });\n        this.gutterDecoration = GUTTER_DECORATION;\n    }\n    /* Gutter Helper Functions */\n    renderGutterLightbub() {\n        const selection = this._editor.getSelection();\n        if (!selection) {\n            return;\n        }\n        if (this._gutterDecorationID === undefined) {\n            this._addGutterDecoration(selection.startLineNumber);\n        }\n        else {\n            this._updateGutterDecoration(this._gutterDecorationID, selection.startLineNumber);\n        }\n    }\n    _addGutterDecoration(lineNumber) {\n        this._editor.changeDecorations((accessor) => {\n            this._gutterDecorationID = accessor.addDecoration(new Range(lineNumber, 0, lineNumber, 0), this.gutterDecoration);\n        });\n    }\n    _removeGutterDecoration(decorationId) {\n        this._editor.changeDecorations((accessor) => {\n            accessor.removeDecoration(decorationId);\n            this._gutterDecorationID = undefined;\n        });\n    }\n    _updateGutterDecoration(decorationId, lineNumber) {\n        this._editor.changeDecorations((accessor) => {\n            accessor.changeDecoration(decorationId, new Range(lineNumber, 0, lineNumber, 0));\n            accessor.changeDecorationOptions(decorationId, this.gutterDecoration);\n        });\n    }\n    _updateLightbulbTitle(autoFix, autoRun) {\n        if (this.state.type !== 1 /* LightBulbState.Type.Showing */) {\n            return;\n        }\n        if (autoRun) {\n            this.title = nls.localize('codeActionAutoRun', \"Run: {0}\", this.state.actions.validActions[0].action.title);\n        }\n        else if (autoFix && this._preferredKbLabel) {\n            this.title = nls.localize('preferredcodeActionWithKb', \"Show Code Actions. Preferred Quick Fix Available ({0})\", this._preferredKbLabel);\n        }\n        else if (!autoFix && this._quickFixKbLabel) {\n            this.title = nls.localize('codeActionWithKb', \"Show Code Actions ({0})\", this._quickFixKbLabel);\n        }\n        else if (!autoFix) {\n            this.title = nls.localize('codeAction', \"Show Code Actions\");\n        }\n    }\n    set title(value) {\n        this._domNode.title = value;\n    }\n};\nLightBulbWidget = LightBulbWidget_1 = __decorate([\n    __param(1, IKeybindingService)\n], LightBulbWidget);\nexport { LightBulbWidget };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createCancelablePromise, TimeoutTimer } from '../../../../base/common/async.js';\nimport { isCancellationError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { ShowLightbulbIconMode } from '../../../common/config/editorOptions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { Progress } from '../../../../platform/progress/common/progress.js';\nimport { CodeActionKind, CodeActionTriggerSource } from '../common/types.js';\nimport { getCodeActions } from './codeAction.js';\nimport { HierarchicalKind } from '../../../../base/common/hierarchicalKind.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nexport const SUPPORTED_CODE_ACTIONS = new RawContextKey('supportedCodeAction', '');\nexport const APPLY_FIX_ALL_COMMAND_ID = '_typescript.applyFixAllCodeAction';\nclass CodeActionOracle extends Disposable {\n    constructor(_editor, _markerService, _signalChange, _delay = 250) {\n        super();\n        this._editor = _editor;\n        this._markerService = _markerService;\n        this._signalChange = _signalChange;\n        this._delay = _delay;\n        this._autoTriggerTimer = this._register(new TimeoutTimer());\n        this._register(this._markerService.onMarkerChanged(e => this._onMarkerChanges(e)));\n        this._register(this._editor.onDidChangeCursorPosition(() => this._tryAutoTrigger()));\n    }\n    trigger(trigger) {\n        const selection = this._getRangeOfSelectionUnlessWhitespaceEnclosed(trigger);\n        this._signalChange(selection ? { trigger, selection } : undefined);\n    }\n    _onMarkerChanges(resources) {\n        const model = this._editor.getModel();\n        if (model && resources.some(resource => isEqual(resource, model.uri))) {\n            this._tryAutoTrigger();\n        }\n    }\n    _tryAutoTrigger() {\n        this._autoTriggerTimer.cancelAndSet(() => {\n            this.trigger({ type: 2 /* CodeActionTriggerType.Auto */, triggerAction: CodeActionTriggerSource.Default });\n        }, this._delay);\n    }\n    _getRangeOfSelectionUnlessWhitespaceEnclosed(trigger) {\n        if (!this._editor.hasModel()) {\n            return undefined;\n        }\n        const selection = this._editor.getSelection();\n        if (trigger.type === 1 /* CodeActionTriggerType.Invoke */) {\n            return selection;\n        }\n        const enabled = this._editor.getOption(65 /* EditorOption.lightbulb */).enabled;\n        if (enabled === ShowLightbulbIconMode.Off) {\n            return undefined;\n        }\n        else if (enabled === ShowLightbulbIconMode.On) {\n            return selection;\n        }\n        else if (enabled === ShowLightbulbIconMode.OnCode) {\n            const isSelectionEmpty = selection.isEmpty();\n            if (!isSelectionEmpty) {\n                return selection;\n            }\n            const model = this._editor.getModel();\n            const { lineNumber, column } = selection.getPosition();\n            const line = model.getLineContent(lineNumber);\n            if (line.length === 0) {\n                // empty line\n                return undefined;\n            }\n            else if (column === 1) {\n                // look only right\n                if (/\\s/.test(line[0])) {\n                    return undefined;\n                }\n            }\n            else if (column === model.getLineMaxColumn(lineNumber)) {\n                // look only left\n                if (/\\s/.test(line[line.length - 1])) {\n                    return undefined;\n                }\n            }\n            else {\n                // look left and right\n                if (/\\s/.test(line[column - 2]) && /\\s/.test(line[column - 1])) {\n                    return undefined;\n                }\n            }\n        }\n        return selection;\n    }\n}\nexport var CodeActionsState;\n(function (CodeActionsState) {\n    CodeActionsState.Empty = { type: 0 /* Type.Empty */ };\n    class Triggered {\n        constructor(trigger, position, _cancellablePromise) {\n            this.trigger = trigger;\n            this.position = position;\n            this._cancellablePromise = _cancellablePromise;\n            this.type = 1 /* Type.Triggered */;\n            this.actions = _cancellablePromise.catch((e) => {\n                if (isCancellationError(e)) {\n                    return emptyCodeActionSet;\n                }\n                throw e;\n            });\n        }\n        cancel() {\n            this._cancellablePromise.cancel();\n        }\n    }\n    CodeActionsState.Triggered = Triggered;\n})(CodeActionsState || (CodeActionsState = {}));\nconst emptyCodeActionSet = Object.freeze({\n    allActions: [],\n    validActions: [],\n    dispose: () => { },\n    documentation: [],\n    hasAutoFix: false,\n    hasAIFix: false,\n    allAIFixes: false,\n});\nexport class CodeActionModel extends Disposable {\n    constructor(_editor, _registry, _markerService, contextKeyService, _progressService, _configurationService, _telemetryService) {\n        super();\n        this._editor = _editor;\n        this._registry = _registry;\n        this._markerService = _markerService;\n        this._progressService = _progressService;\n        this._configurationService = _configurationService;\n        this._telemetryService = _telemetryService;\n        this._codeActionOracle = this._register(new MutableDisposable());\n        this._state = CodeActionsState.Empty;\n        this._onDidChangeState = this._register(new Emitter());\n        this.onDidChangeState = this._onDidChangeState.event;\n        this._disposed = false;\n        this._supportedCodeActions = SUPPORTED_CODE_ACTIONS.bindTo(contextKeyService);\n        this._register(this._editor.onDidChangeModel(() => this._update()));\n        this._register(this._editor.onDidChangeModelLanguage(() => this._update()));\n        this._register(this._registry.onDidChange(() => this._update()));\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(65 /* EditorOption.lightbulb */)) {\n                this._update();\n            }\n        }));\n        this._update();\n    }\n    dispose() {\n        if (this._disposed) {\n            return;\n        }\n        this._disposed = true;\n        super.dispose();\n        this.setState(CodeActionsState.Empty, true);\n    }\n    _settingEnabledNearbyQuickfixes() {\n        const model = this._editor?.getModel();\n        return this._configurationService ? this._configurationService.getValue('editor.codeActionWidget.includeNearbyQuickFixes', { resource: model?.uri }) : false;\n    }\n    _update() {\n        if (this._disposed) {\n            return;\n        }\n        this._codeActionOracle.value = undefined;\n        this.setState(CodeActionsState.Empty);\n        const model = this._editor.getModel();\n        if (model\n            && this._registry.has(model)\n            && !this._editor.getOption(92 /* EditorOption.readOnly */)) {\n            const supportedActions = this._registry.all(model).flatMap(provider => provider.providedCodeActionKinds ?? []);\n            this._supportedCodeActions.set(supportedActions.join(' '));\n            this._codeActionOracle.value = new CodeActionOracle(this._editor, this._markerService, trigger => {\n                if (!trigger) {\n                    this.setState(CodeActionsState.Empty);\n                    return;\n                }\n                const startPosition = trigger.selection.getStartPosition();\n                const actions = createCancelablePromise(async (token) => {\n                    if (this._settingEnabledNearbyQuickfixes() && trigger.trigger.type === 1 /* CodeActionTriggerType.Invoke */ && (trigger.trigger.triggerAction === CodeActionTriggerSource.QuickFix || trigger.trigger.filter?.include?.contains(CodeActionKind.QuickFix))) {\n                        const codeActionSet = await getCodeActions(this._registry, model, trigger.selection, trigger.trigger, Progress.None, token);\n                        const allCodeActions = [...codeActionSet.allActions];\n                        if (token.isCancellationRequested) {\n                            return emptyCodeActionSet;\n                        }\n                        // Search for quickfixes in the curret code action set.\n                        const foundQuickfix = codeActionSet.validActions?.some(action => action.action.kind ? CodeActionKind.QuickFix.contains(new HierarchicalKind(action.action.kind)) : false);\n                        const allMarkers = this._markerService.read({ resource: model.uri });\n                        if (foundQuickfix) {\n                            for (const action of codeActionSet.validActions) {\n                                if (action.action.command?.arguments?.some(arg => typeof arg === 'string' && arg.includes(APPLY_FIX_ALL_COMMAND_ID))) {\n                                    action.action.diagnostics = [...allMarkers.filter(marker => marker.relatedInformation)];\n                                }\n                            }\n                            return { validActions: codeActionSet.validActions, allActions: allCodeActions, documentation: codeActionSet.documentation, hasAutoFix: codeActionSet.hasAutoFix, hasAIFix: codeActionSet.hasAIFix, allAIFixes: codeActionSet.allAIFixes, dispose: () => { codeActionSet.dispose(); } };\n                        }\n                        else if (!foundQuickfix) {\n                            // If markers exists, and there are no quickfixes found or length is zero, check for quickfixes on that line.\n                            if (allMarkers.length > 0) {\n                                const currPosition = trigger.selection.getPosition();\n                                let trackedPosition = currPosition;\n                                let distance = Number.MAX_VALUE;\n                                const currentActions = [...codeActionSet.validActions];\n                                for (const marker of allMarkers) {\n                                    const col = marker.endColumn;\n                                    const row = marker.endLineNumber;\n                                    const startRow = marker.startLineNumber;\n                                    // Found quickfix on the same line and check relative distance to other markers\n                                    if ((row === currPosition.lineNumber || startRow === currPosition.lineNumber)) {\n                                        trackedPosition = new Position(row, col);\n                                        const newCodeActionTrigger = {\n                                            type: trigger.trigger.type,\n                                            triggerAction: trigger.trigger.triggerAction,\n                                            filter: { include: trigger.trigger.filter?.include ? trigger.trigger.filter?.include : CodeActionKind.QuickFix },\n                                            autoApply: trigger.trigger.autoApply,\n                                            context: { notAvailableMessage: trigger.trigger.context?.notAvailableMessage || '', position: trackedPosition }\n                                        };\n                                        const selectionAsPosition = new Selection(trackedPosition.lineNumber, trackedPosition.column, trackedPosition.lineNumber, trackedPosition.column);\n                                        const actionsAtMarker = await getCodeActions(this._registry, model, selectionAsPosition, newCodeActionTrigger, Progress.None, token);\n                                        if (actionsAtMarker.validActions.length !== 0) {\n                                            for (const action of actionsAtMarker.validActions) {\n                                                if (action.action.command?.arguments?.some(arg => typeof arg === 'string' && arg.includes(APPLY_FIX_ALL_COMMAND_ID))) {\n                                                    action.action.diagnostics = [...allMarkers.filter(marker => marker.relatedInformation)];\n                                                }\n                                            }\n                                            if (codeActionSet.allActions.length === 0) {\n                                                allCodeActions.push(...actionsAtMarker.allActions);\n                                            }\n                                            // Already filtered through to only get quickfixes, so no need to filter again.\n                                            if (Math.abs(currPosition.column - col) < distance) {\n                                                currentActions.unshift(...actionsAtMarker.validActions);\n                                            }\n                                            else {\n                                                currentActions.push(...actionsAtMarker.validActions);\n                                            }\n                                        }\n                                        distance = Math.abs(currPosition.column - col);\n                                    }\n                                }\n                                const filteredActions = currentActions.filter((action, index, self) => self.findIndex((a) => a.action.title === action.action.title) === index);\n                                filteredActions.sort((a, b) => {\n                                    if (a.action.isPreferred && !b.action.isPreferred) {\n                                        return -1;\n                                    }\n                                    else if (!a.action.isPreferred && b.action.isPreferred) {\n                                        return 1;\n                                    }\n                                    else if (a.action.isAI && !b.action.isAI) {\n                                        return 1;\n                                    }\n                                    else if (!a.action.isAI && b.action.isAI) {\n                                        return -1;\n                                    }\n                                    else {\n                                        return 0;\n                                    }\n                                });\n                                // Only retriggers if actually found quickfix on the same line as cursor\n                                return { validActions: filteredActions, allActions: allCodeActions, documentation: codeActionSet.documentation, hasAutoFix: codeActionSet.hasAutoFix, hasAIFix: codeActionSet.hasAIFix, allAIFixes: codeActionSet.allAIFixes, dispose: () => { codeActionSet.dispose(); } };\n                            }\n                        }\n                    }\n                    // Case for manual triggers - specifically Source Actions and Refactors\n                    if (trigger.trigger.type === 1 /* CodeActionTriggerType.Invoke */) {\n                        const sw = new StopWatch();\n                        const codeActions = await getCodeActions(this._registry, model, trigger.selection, trigger.trigger, Progress.None, token);\n                        // Telemetry for duration of each code action on save.\n                        if (this._telemetryService) {\n                            this._telemetryService.publicLog2('codeAction.invokedDurations', {\n                                codeActions: codeActions.validActions.length,\n                                duration: sw.elapsed()\n                            });\n                        }\n                        return codeActions;\n                    }\n                    return getCodeActions(this._registry, model, trigger.selection, trigger.trigger, Progress.None, token);\n                });\n                if (trigger.trigger.type === 1 /* CodeActionTriggerType.Invoke */) {\n                    this._progressService?.showWhile(actions, 250);\n                }\n                const newState = new CodeActionsState.Triggered(trigger.trigger, startPosition, actions);\n                let isManualToAutoTransition = false;\n                if (this._state.type === 1 /* CodeActionsState.Type.Triggered */) {\n                    // Check if the current state is manual and the new state is automatic\n                    isManualToAutoTransition = this._state.trigger.type === 1 /* CodeActionTriggerType.Invoke */ &&\n                        newState.type === 1 /* CodeActionsState.Type.Triggered */ &&\n                        newState.trigger.type === 2 /* CodeActionTriggerType.Auto */ &&\n                        this._state.position !== newState.position;\n                }\n                // Do not trigger state if current state is manual and incoming state is automatic\n                if (!isManualToAutoTransition) {\n                    this.setState(newState);\n                }\n                else {\n                    // Reset the new state after getting code actions back.\n                    setTimeout(() => {\n                        this.setState(newState);\n                    }, 500);\n                }\n            }, undefined);\n            this._codeActionOracle.value.trigger({ type: 2 /* CodeActionTriggerType.Auto */, triggerAction: CodeActionTriggerSource.Default });\n        }\n        else {\n            this._supportedCodeActions.reset();\n        }\n    }\n    trigger(trigger) {\n        this._codeActionOracle.value?.trigger(trigger);\n    }\n    setState(newState, skipNotify) {\n        if (newState === this._state) {\n            return;\n        }\n        // Cancel old request\n        if (this._state.type === 1 /* CodeActionsState.Type.Triggered */) {\n            this._state.cancel();\n        }\n        this._state = newState;\n        if (!skipNotify && !this._disposed) {\n            this._onDidChangeState.fire(newState);\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar CodeActionController_1;\nimport { getDomNodePagePosition } from '../../../../base/browser/dom.js';\nimport * as aria from '../../../../base/browser/ui/aria/aria.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Lazy } from '../../../../base/common/lazy.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ApplyCodeActionReason, applyCodeAction } from './codeAction.js';\nimport { CodeActionKeybindingResolver } from './codeActionKeybindingResolver.js';\nimport { toMenuItems } from './codeActionMenu.js';\nimport { LightBulbWidget } from './lightBulbWidget.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport { localize } from '../../../../nls.js';\nimport { IActionWidgetService } from '../../../../platform/actionWidget/browser/actionWidget.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IMarkerService } from '../../../../platform/markers/common/markers.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { editorFindMatchHighlight, editorFindMatchHighlightBorder } from '../../../../platform/theme/common/colorRegistry.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { CodeActionKind, CodeActionTriggerSource } from '../common/types.js';\nimport { CodeActionModel } from './codeActionModel.js';\nimport { HierarchicalKind } from '../../../../base/common/hierarchicalKind.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nconst DECORATION_CLASS_NAME = 'quickfix-edit-highlight';\nlet CodeActionController = class CodeActionController extends Disposable {\n    static { CodeActionController_1 = this; }\n    static { this.ID = 'editor.contrib.codeActionController'; }\n    static get(editor) {\n        return editor.getContribution(CodeActionController_1.ID);\n    }\n    constructor(editor, markerService, contextKeyService, instantiationService, languageFeaturesService, progressService, _commandService, _configurationService, _actionWidgetService, _instantiationService, _telemetryService) {\n        super();\n        this._commandService = _commandService;\n        this._configurationService = _configurationService;\n        this._actionWidgetService = _actionWidgetService;\n        this._instantiationService = _instantiationService;\n        this._telemetryService = _telemetryService;\n        this._activeCodeActions = this._register(new MutableDisposable());\n        this._showDisabled = false;\n        this._disposed = false;\n        this._editor = editor;\n        this._model = this._register(new CodeActionModel(this._editor, languageFeaturesService.codeActionProvider, markerService, contextKeyService, progressService, _configurationService, this._telemetryService));\n        this._register(this._model.onDidChangeState(newState => this.update(newState)));\n        this._lightBulbWidget = new Lazy(() => {\n            const widget = this._editor.getContribution(LightBulbWidget.ID);\n            if (widget) {\n                this._register(widget.onClick(e => this.showCodeActionsFromLightbulb(e.actions, e)));\n            }\n            return widget;\n        });\n        this._resolver = instantiationService.createInstance(CodeActionKeybindingResolver);\n        this._register(this._editor.onDidLayoutChange(() => this._actionWidgetService.hide()));\n    }\n    dispose() {\n        this._disposed = true;\n        super.dispose();\n    }\n    async showCodeActionsFromLightbulb(actions, at) {\n        if (actions.allAIFixes && actions.validActions.length === 1) {\n            const actionItem = actions.validActions[0];\n            const command = actionItem.action.command;\n            if (command && command.id === 'inlineChat.start') {\n                if (command.arguments && command.arguments.length >= 1) {\n                    command.arguments[0] = { ...command.arguments[0], autoSend: false };\n                }\n            }\n            await this._applyCodeAction(actionItem, false, false, ApplyCodeActionReason.FromAILightbulb);\n            return;\n        }\n        await this.showCodeActionList(actions, at, { includeDisabledActions: false, fromLightbulb: true });\n    }\n    showCodeActions(_trigger, actions, at) {\n        return this.showCodeActionList(actions, at, { includeDisabledActions: false, fromLightbulb: false });\n    }\n    manualTriggerAtCurrentPosition(notAvailableMessage, triggerAction, filter, autoApply) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        MessageController.get(this._editor)?.closeMessage();\n        const triggerPosition = this._editor.getPosition();\n        this._trigger({ type: 1 /* CodeActionTriggerType.Invoke */, triggerAction, filter, autoApply, context: { notAvailableMessage, position: triggerPosition } });\n    }\n    _trigger(trigger) {\n        return this._model.trigger(trigger);\n    }\n    async _applyCodeAction(action, retrigger, preview, actionReason) {\n        try {\n            await this._instantiationService.invokeFunction(applyCodeAction, action, actionReason, { preview, editor: this._editor });\n        }\n        finally {\n            if (retrigger) {\n                this._trigger({ type: 2 /* CodeActionTriggerType.Auto */, triggerAction: CodeActionTriggerSource.QuickFix, filter: {} });\n            }\n        }\n    }\n    hideLightBulbWidget() {\n        this._lightBulbWidget.rawValue?.hide();\n        this._lightBulbWidget.rawValue?.gutterHide();\n    }\n    async update(newState) {\n        if (newState.type !== 1 /* CodeActionsState.Type.Triggered */) {\n            this.hideLightBulbWidget();\n            return;\n        }\n        let actions;\n        try {\n            actions = await newState.actions;\n        }\n        catch (e) {\n            onUnexpectedError(e);\n            return;\n        }\n        if (this._disposed) {\n            return;\n        }\n        const selection = this._editor.getSelection();\n        if (selection?.startLineNumber !== newState.position.lineNumber) {\n            return;\n        }\n        this._lightBulbWidget.value?.update(actions, newState.trigger, newState.position);\n        if (newState.trigger.type === 1 /* CodeActionTriggerType.Invoke */) {\n            if (newState.trigger.filter?.include) { // Triggered for specific scope\n                // Check to see if we want to auto apply.\n                const validActionToApply = this.tryGetValidActionToApply(newState.trigger, actions);\n                if (validActionToApply) {\n                    try {\n                        this.hideLightBulbWidget();\n                        await this._applyCodeAction(validActionToApply, false, false, ApplyCodeActionReason.FromCodeActions);\n                    }\n                    finally {\n                        actions.dispose();\n                    }\n                    return;\n                }\n                // Check to see if there is an action that we would have applied were it not invalid\n                if (newState.trigger.context) {\n                    const invalidAction = this.getInvalidActionThatWouldHaveBeenApplied(newState.trigger, actions);\n                    if (invalidAction && invalidAction.action.disabled) {\n                        MessageController.get(this._editor)?.showMessage(invalidAction.action.disabled, newState.trigger.context.position);\n                        actions.dispose();\n                        return;\n                    }\n                }\n            }\n            const includeDisabledActions = !!newState.trigger.filter?.include;\n            if (newState.trigger.context) {\n                if (!actions.allActions.length || !includeDisabledActions && !actions.validActions.length) {\n                    MessageController.get(this._editor)?.showMessage(newState.trigger.context.notAvailableMessage, newState.trigger.context.position);\n                    this._activeCodeActions.value = actions;\n                    actions.dispose();\n                    return;\n                }\n            }\n            this._activeCodeActions.value = actions;\n            this.showCodeActionList(actions, this.toCoords(newState.position), { includeDisabledActions, fromLightbulb: false });\n        }\n        else {\n            // auto magically triggered\n            if (this._actionWidgetService.isVisible) {\n                // TODO: Figure out if we should update the showing menu?\n                actions.dispose();\n            }\n            else {\n                this._activeCodeActions.value = actions;\n            }\n        }\n    }\n    getInvalidActionThatWouldHaveBeenApplied(trigger, actions) {\n        if (!actions.allActions.length) {\n            return undefined;\n        }\n        if ((trigger.autoApply === \"first\" /* CodeActionAutoApply.First */ && actions.validActions.length === 0)\n            || (trigger.autoApply === \"ifSingle\" /* CodeActionAutoApply.IfSingle */ && actions.allActions.length === 1)) {\n            return actions.allActions.find(({ action }) => action.disabled);\n        }\n        return undefined;\n    }\n    tryGetValidActionToApply(trigger, actions) {\n        if (!actions.validActions.length) {\n            return undefined;\n        }\n        if ((trigger.autoApply === \"first\" /* CodeActionAutoApply.First */ && actions.validActions.length > 0)\n            || (trigger.autoApply === \"ifSingle\" /* CodeActionAutoApply.IfSingle */ && actions.validActions.length === 1)) {\n            return actions.validActions[0];\n        }\n        return undefined;\n    }\n    static { this.DECORATION = ModelDecorationOptions.register({\n        description: 'quickfix-highlight',\n        className: DECORATION_CLASS_NAME\n    }); }\n    async showCodeActionList(actions, at, options) {\n        const currentDecorations = this._editor.createDecorationsCollection();\n        const editorDom = this._editor.getDomNode();\n        if (!editorDom) {\n            return;\n        }\n        const actionsToShow = options.includeDisabledActions && (this._showDisabled || actions.validActions.length === 0) ? actions.allActions : actions.validActions;\n        if (!actionsToShow.length) {\n            return;\n        }\n        const anchor = Position.isIPosition(at) ? this.toCoords(at) : at;\n        const delegate = {\n            onSelect: async (action, preview) => {\n                this._applyCodeAction(action, /* retrigger */ true, !!preview, options.fromLightbulb ? ApplyCodeActionReason.FromAILightbulb : ApplyCodeActionReason.FromCodeActions);\n                this._actionWidgetService.hide(false);\n                currentDecorations.clear();\n            },\n            onHide: (didCancel) => {\n                this._editor?.focus();\n                currentDecorations.clear();\n            },\n            onHover: async (action, token) => {\n                if (token.isCancellationRequested) {\n                    return;\n                }\n                let canPreview = false;\n                const actionKind = action.action.kind;\n                if (actionKind) {\n                    const hierarchicalKind = new HierarchicalKind(actionKind);\n                    const refactorKinds = [\n                        CodeActionKind.RefactorExtract,\n                        CodeActionKind.RefactorInline,\n                        CodeActionKind.RefactorRewrite,\n                        CodeActionKind.RefactorMove,\n                        CodeActionKind.Source\n                    ];\n                    canPreview = refactorKinds.some(refactorKind => refactorKind.contains(hierarchicalKind));\n                }\n                return { canPreview: canPreview || !!action.action.edit?.edits.length };\n            },\n            onFocus: (action) => {\n                if (action && action.action) {\n                    const ranges = action.action.ranges;\n                    const diagnostics = action.action.diagnostics;\n                    currentDecorations.clear();\n                    if (ranges && ranges.length > 0) {\n                        // Handles case for `fix all` where there are multiple diagnostics.\n                        const decorations = (diagnostics && diagnostics?.length > 1)\n                            ? diagnostics.map(diagnostic => ({ range: diagnostic, options: CodeActionController_1.DECORATION }))\n                            : ranges.map(range => ({ range, options: CodeActionController_1.DECORATION }));\n                        currentDecorations.set(decorations);\n                    }\n                    else if (diagnostics && diagnostics.length > 0) {\n                        const decorations = diagnostics.map(diagnostic => ({ range: diagnostic, options: CodeActionController_1.DECORATION }));\n                        currentDecorations.set(decorations);\n                        const diagnostic = diagnostics[0];\n                        if (diagnostic.startLineNumber && diagnostic.startColumn) {\n                            const selectionText = this._editor.getModel()?.getWordAtPosition({ lineNumber: diagnostic.startLineNumber, column: diagnostic.startColumn })?.word;\n                            aria.status(localize('editingNewSelection', \"Context: {0} at line {1} and column {2}.\", selectionText, diagnostic.startLineNumber, diagnostic.startColumn));\n                        }\n                    }\n                }\n                else {\n                    currentDecorations.clear();\n                }\n            }\n        };\n        this._actionWidgetService.show('codeActionWidget', true, toMenuItems(actionsToShow, this._shouldShowHeaders(), this._resolver.getResolver()), delegate, anchor, editorDom, this._getActionBarActions(actions, at, options));\n    }\n    toCoords(position) {\n        if (!this._editor.hasModel()) {\n            return { x: 0, y: 0 };\n        }\n        this._editor.revealPosition(position, 1 /* ScrollType.Immediate */);\n        this._editor.render();\n        // Translate to absolute editor position\n        const cursorCoords = this._editor.getScrolledVisiblePosition(position);\n        const editorCoords = getDomNodePagePosition(this._editor.getDomNode());\n        const x = editorCoords.left + cursorCoords.left;\n        const y = editorCoords.top + cursorCoords.top + cursorCoords.height;\n        return { x, y };\n    }\n    _shouldShowHeaders() {\n        const model = this._editor?.getModel();\n        return this._configurationService.getValue('editor.codeActionWidget.showHeaders', { resource: model?.uri });\n    }\n    _getActionBarActions(actions, at, options) {\n        if (options.fromLightbulb) {\n            return [];\n        }\n        const resultActions = actions.documentation.map((command) => ({\n            id: command.id,\n            label: command.title,\n            tooltip: command.tooltip ?? '',\n            class: undefined,\n            enabled: true,\n            run: () => this._commandService.executeCommand(command.id, ...(command.arguments ?? [])),\n        }));\n        if (options.includeDisabledActions && actions.validActions.length > 0 && actions.allActions.length !== actions.validActions.length) {\n            resultActions.push(this._showDisabled ? {\n                id: 'hideMoreActions',\n                label: localize('hideMoreActions', 'Hide Disabled'),\n                enabled: true,\n                tooltip: '',\n                class: undefined,\n                run: () => {\n                    this._showDisabled = false;\n                    return this.showCodeActionList(actions, at, options);\n                }\n            } : {\n                id: 'showMoreActions',\n                label: localize('showMoreActions', 'Show Disabled'),\n                enabled: true,\n                tooltip: '',\n                class: undefined,\n                run: () => {\n                    this._showDisabled = true;\n                    return this.showCodeActionList(actions, at, options);\n                }\n            });\n        }\n        return resultActions;\n    }\n};\nCodeActionController = CodeActionController_1 = __decorate([\n    __param(1, IMarkerService),\n    __param(2, IContextKeyService),\n    __param(3, IInstantiationService),\n    __param(4, ILanguageFeaturesService),\n    __param(5, IEditorProgressService),\n    __param(6, ICommandService),\n    __param(7, IConfigurationService),\n    __param(8, IActionWidgetService),\n    __param(9, IInstantiationService),\n    __param(10, ITelemetryService)\n], CodeActionController);\nexport { CodeActionController };\nregisterThemingParticipant((theme, collector) => {\n    const addBackgroundColorRule = (selector, color) => {\n        if (color) {\n            collector.addRule(`.monaco-editor ${selector} { background-color: ${color}; }`);\n        }\n    };\n    addBackgroundColorRule('.quickfix-edit-highlight', theme.getColor(editorFindMatchHighlight));\n    const findMatchHighlightBorder = theme.getColor(editorFindMatchHighlightBorder);\n    if (findMatchHighlightBorder) {\n        collector.addRule(`.monaco-editor .quickfix-edit-highlight { border: 1px ${isHighContrast(theme.type) ? 'dotted' : 'solid'} ${findMatchHighlightBorder}; box-sizing: border-box; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { HierarchicalKind } from '../../../../base/common/hierarchicalKind.js';\nimport { escapeRegExpCharacters } from '../../../../base/common/strings.js';\nimport { EditorAction, EditorCommand } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { autoFixCommandId, codeActionCommandId, fixAllCommandId, organizeImportsCommandId, quickFixCommandId, refactorCommandId, sourceActionCommandId } from './codeAction.js';\nimport * as nls from '../../../../nls.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { CodeActionCommandArgs, CodeActionKind, CodeActionTriggerSource } from '../common/types.js';\nimport { CodeActionController } from './codeActionController.js';\nimport { SUPPORTED_CODE_ACTIONS } from './codeActionModel.js';\nfunction contextKeyForSupportedActions(kind) {\n    return ContextKeyExpr.regex(SUPPORTED_CODE_ACTIONS.keys()[0], new RegExp('(\\\\s|^)' + escapeRegExpCharacters(kind.value) + '\\\\b'));\n}\nconst argsSchema = {\n    type: 'object',\n    defaultSnippets: [{ body: { kind: '' } }],\n    properties: {\n        'kind': {\n            type: 'string',\n            description: nls.localize('args.schema.kind', \"Kind of the code action to run.\"),\n        },\n        'apply': {\n            type: 'string',\n            description: nls.localize('args.schema.apply', \"Controls when the returned actions are applied.\"),\n            default: \"ifSingle\" /* CodeActionAutoApply.IfSingle */,\n            enum: [\"first\" /* CodeActionAutoApply.First */, \"ifSingle\" /* CodeActionAutoApply.IfSingle */, \"never\" /* CodeActionAutoApply.Never */],\n            enumDescriptions: [\n                nls.localize('args.schema.apply.first', \"Always apply the first returned code action.\"),\n                nls.localize('args.schema.apply.ifSingle', \"Apply the first returned code action if it is the only one.\"),\n                nls.localize('args.schema.apply.never', \"Do not apply the returned code actions.\"),\n            ]\n        },\n        'preferred': {\n            type: 'boolean',\n            default: false,\n            description: nls.localize('args.schema.preferred', \"Controls if only preferred code actions should be returned.\"),\n        }\n    }\n};\nfunction triggerCodeActionsForEditorSelection(editor, notAvailableMessage, filter, autoApply, triggerAction = CodeActionTriggerSource.Default) {\n    if (editor.hasModel()) {\n        const controller = CodeActionController.get(editor);\n        controller?.manualTriggerAtCurrentPosition(notAvailableMessage, triggerAction, filter, autoApply);\n    }\n}\nexport class QuickFixAction extends EditorAction {\n    constructor() {\n        super({\n            id: quickFixCommandId,\n            label: nls.localize('quickfix.trigger.label', \"Quick Fix...\"),\n            alias: 'Quick Fix...',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 89 /* KeyCode.Period */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('editor.action.quickFix.noneMessage', \"No code actions available\"), undefined, undefined, CodeActionTriggerSource.QuickFix);\n    }\n}\nexport class CodeActionCommand extends EditorCommand {\n    constructor() {\n        super({\n            id: codeActionCommandId,\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\n            metadata: {\n                description: 'Trigger a code action',\n                args: [{ name: 'args', schema: argsSchema, }]\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor, userArgs) {\n        const args = CodeActionCommandArgs.fromUser(userArgs, {\n            kind: HierarchicalKind.Empty,\n            apply: \"ifSingle\" /* CodeActionAutoApply.IfSingle */,\n        });\n        return triggerCodeActionsForEditorSelection(editor, typeof userArgs?.kind === 'string'\n            ? args.preferred\n                ? nls.localize('editor.action.codeAction.noneMessage.preferred.kind', \"No preferred code actions for '{0}' available\", userArgs.kind)\n                : nls.localize('editor.action.codeAction.noneMessage.kind', \"No code actions for '{0}' available\", userArgs.kind)\n            : args.preferred\n                ? nls.localize('editor.action.codeAction.noneMessage.preferred', \"No preferred code actions available\")\n                : nls.localize('editor.action.codeAction.noneMessage', \"No code actions available\"), {\n            include: args.kind,\n            includeSourceActions: true,\n            onlyIncludePreferredActions: args.preferred,\n        }, args.apply);\n    }\n}\nexport class RefactorAction extends EditorAction {\n    constructor() {\n        super({\n            id: refactorCommandId,\n            label: nls.localize('refactor.label', \"Refactor...\"),\n            alias: 'Refactor...',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 48 /* KeyCode.KeyR */,\n                mac: {\n                    primary: 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 48 /* KeyCode.KeyR */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 2,\n                when: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.Refactor)),\n            },\n            metadata: {\n                description: 'Refactor...',\n                args: [{ name: 'args', schema: argsSchema }]\n            }\n        });\n    }\n    run(_accessor, editor, userArgs) {\n        const args = CodeActionCommandArgs.fromUser(userArgs, {\n            kind: CodeActionKind.Refactor,\n            apply: \"never\" /* CodeActionAutoApply.Never */\n        });\n        return triggerCodeActionsForEditorSelection(editor, typeof userArgs?.kind === 'string'\n            ? args.preferred\n                ? nls.localize('editor.action.refactor.noneMessage.preferred.kind', \"No preferred refactorings for '{0}' available\", userArgs.kind)\n                : nls.localize('editor.action.refactor.noneMessage.kind', \"No refactorings for '{0}' available\", userArgs.kind)\n            : args.preferred\n                ? nls.localize('editor.action.refactor.noneMessage.preferred', \"No preferred refactorings available\")\n                : nls.localize('editor.action.refactor.noneMessage', \"No refactorings available\"), {\n            include: CodeActionKind.Refactor.contains(args.kind) ? args.kind : HierarchicalKind.None,\n            onlyIncludePreferredActions: args.preferred\n        }, args.apply, CodeActionTriggerSource.Refactor);\n    }\n}\nexport class SourceAction extends EditorAction {\n    constructor() {\n        super({\n            id: sourceActionCommandId,\n            label: nls.localize('source.label', \"Source Action...\"),\n            alias: 'Source Action...',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 2.1,\n                when: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.Source)),\n            },\n            metadata: {\n                description: 'Source Action...',\n                args: [{ name: 'args', schema: argsSchema }]\n            }\n        });\n    }\n    run(_accessor, editor, userArgs) {\n        const args = CodeActionCommandArgs.fromUser(userArgs, {\n            kind: CodeActionKind.Source,\n            apply: \"never\" /* CodeActionAutoApply.Never */\n        });\n        return triggerCodeActionsForEditorSelection(editor, typeof userArgs?.kind === 'string'\n            ? args.preferred\n                ? nls.localize('editor.action.source.noneMessage.preferred.kind', \"No preferred source actions for '{0}' available\", userArgs.kind)\n                : nls.localize('editor.action.source.noneMessage.kind', \"No source actions for '{0}' available\", userArgs.kind)\n            : args.preferred\n                ? nls.localize('editor.action.source.noneMessage.preferred', \"No preferred source actions available\")\n                : nls.localize('editor.action.source.noneMessage', \"No source actions available\"), {\n            include: CodeActionKind.Source.contains(args.kind) ? args.kind : HierarchicalKind.None,\n            includeSourceActions: true,\n            onlyIncludePreferredActions: args.preferred,\n        }, args.apply, CodeActionTriggerSource.SourceAction);\n    }\n}\nexport class OrganizeImportsAction extends EditorAction {\n    constructor() {\n        super({\n            id: organizeImportsCommandId,\n            label: nls.localize('organizeImports.label', \"Organize Imports\"),\n            alias: 'Organize Imports',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.SourceOrganizeImports)),\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 45 /* KeyCode.KeyO */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n        });\n    }\n    run(_accessor, editor) {\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('editor.action.organize.noneMessage', \"No organize imports action available\"), { include: CodeActionKind.SourceOrganizeImports, includeSourceActions: true }, \"ifSingle\" /* CodeActionAutoApply.IfSingle */, CodeActionTriggerSource.OrganizeImports);\n    }\n}\nexport class FixAllAction extends EditorAction {\n    constructor() {\n        super({\n            id: fixAllCommandId,\n            label: nls.localize('fixAll.label', \"Fix All\"),\n            alias: 'Fix All',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.SourceFixAll))\n        });\n    }\n    run(_accessor, editor) {\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('fixAll.noneMessage', \"No fix all action available\"), { include: CodeActionKind.SourceFixAll, includeSourceActions: true }, \"ifSingle\" /* CodeActionAutoApply.IfSingle */, CodeActionTriggerSource.FixAll);\n    }\n}\nexport class AutoFixAction extends EditorAction {\n    constructor() {\n        super({\n            id: autoFixCommandId,\n            label: nls.localize('autoFix.label', \"Auto Fix...\"),\n            alias: 'Auto Fix...',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.QuickFix)),\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 89 /* KeyCode.Period */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 89 /* KeyCode.Period */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('editor.action.autoFix.noneMessage', \"No auto fixes available\"), {\n            include: CodeActionKind.QuickFix,\n            onlyIncludePreferredActions: true\n        }, \"ifSingle\" /* CodeActionAutoApply.IfSingle */, CodeActionTriggerSource.AutoFix);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { editorConfigurationBaseNode } from '../../../common/config/editorConfigurationSchema.js';\nimport { AutoFixAction, CodeActionCommand, FixAllAction, OrganizeImportsAction, QuickFixAction, RefactorAction, SourceAction } from './codeActionCommands.js';\nimport { CodeActionController } from './codeActionController.js';\nimport { LightBulbWidget } from './lightBulbWidget.js';\nimport * as nls from '../../../../nls.js';\nimport { Extensions } from '../../../../platform/configuration/common/configurationRegistry.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nregisterEditorContribution(CodeActionController.ID, CodeActionController, 3 /* EditorContributionInstantiation.Eventually */);\nregisterEditorContribution(LightBulbWidget.ID, LightBulbWidget, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(QuickFixAction);\nregisterEditorAction(RefactorAction);\nregisterEditorAction(SourceAction);\nregisterEditorAction(OrganizeImportsAction);\nregisterEditorAction(AutoFixAction);\nregisterEditorAction(FixAllAction);\nregisterEditorCommand(new CodeActionCommand());\nRegistry.as(Extensions.Configuration).registerConfiguration({\n    ...editorConfigurationBaseNode,\n    properties: {\n        'editor.codeActionWidget.showHeaders': {\n            type: 'boolean',\n            scope: 5 /* ConfigurationScope.LANGUAGE_OVERRIDABLE */,\n            description: nls.localize('showCodeActionHeaders', \"Enable/disable showing group headers in the Code Action menu.\"),\n            default: true,\n        },\n    }\n});\nRegistry.as(Extensions.Configuration).registerConfiguration({\n    ...editorConfigurationBaseNode,\n    properties: {\n        'editor.codeActionWidget.includeNearbyQuickFixes': {\n            type: 'boolean',\n            scope: 5 /* ConfigurationScope.LANGUAGE_OVERRIDABLE */,\n            description: nls.localize('includeNearbyQuickFixes', \"Enable/disable showing nearest Quick Fix within a line when not currently on a diagnostic.\"),\n            default: true,\n        },\n    }\n});\nRegistry.as(Extensions.Configuration).registerConfiguration({\n    ...editorConfigurationBaseNode,\n    properties: {\n        'editor.codeActions.triggerOnFocusChange': {\n            type: 'boolean',\n            scope: 5 /* ConfigurationScope.LANGUAGE_OVERRIDABLE */,\n            markdownDescription: nls.localize('triggerOnFocusChange', 'Enable triggering {0} when {1} is set to {2}. Code Actions must be set to {3} to be triggered for window and focus changes.', '`#editor.codeActionsOnSave#`', '`#files.autoSave#`', '`afterDelay`', '`always`'),\n            default: false,\n        },\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { illegalArgument, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport class CodeLensModel {\n    constructor() {\n        this.lenses = [];\n        this._disposables = new DisposableStore();\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n    get isDisposed() {\n        return this._disposables.isDisposed;\n    }\n    add(list, provider) {\n        this._disposables.add(list);\n        for (const symbol of list.lenses) {\n            this.lenses.push({ symbol, provider });\n        }\n    }\n}\nexport async function getCodeLensModel(registry, model, token) {\n    const provider = registry.ordered(model);\n    const providerRanks = new Map();\n    const result = new CodeLensModel();\n    const promises = provider.map(async (provider, i) => {\n        providerRanks.set(provider, i);\n        try {\n            const list = await Promise.resolve(provider.provideCodeLenses(model, token));\n            if (list) {\n                result.add(list, provider);\n            }\n        }\n        catch (err) {\n            onUnexpectedExternalError(err);\n        }\n    });\n    await Promise.all(promises);\n    result.lenses = result.lenses.sort((a, b) => {\n        // sort by lineNumber, provider-rank, and column\n        if (a.symbol.range.startLineNumber < b.symbol.range.startLineNumber) {\n            return -1;\n        }\n        else if (a.symbol.range.startLineNumber > b.symbol.range.startLineNumber) {\n            return 1;\n        }\n        else if ((providerRanks.get(a.provider)) < (providerRanks.get(b.provider))) {\n            return -1;\n        }\n        else if ((providerRanks.get(a.provider)) > (providerRanks.get(b.provider))) {\n            return 1;\n        }\n        else if (a.symbol.range.startColumn < b.symbol.range.startColumn) {\n            return -1;\n        }\n        else if (a.symbol.range.startColumn > b.symbol.range.startColumn) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    });\n    return result;\n}\nCommandsRegistry.registerCommand('_executeCodeLensProvider', function (accessor, ...args) {\n    let [uri, itemResolveCount] = args;\n    assertType(URI.isUri(uri));\n    assertType(typeof itemResolveCount === 'number' || !itemResolveCount);\n    const { codeLensProvider } = accessor.get(ILanguageFeaturesService);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        throw illegalArgument();\n    }\n    const result = [];\n    const disposables = new DisposableStore();\n    return getCodeLensModel(codeLensProvider, model, CancellationToken.None).then(value => {\n        disposables.add(value);\n        const resolve = [];\n        for (const item of value.lenses) {\n            if (itemResolveCount === undefined || itemResolveCount === null || Boolean(item.symbol.command)) {\n                result.push(item.symbol);\n            }\n            else if (itemResolveCount-- > 0 && item.provider.resolveCodeLens) {\n                resolve.push(Promise.resolve(item.provider.resolveCodeLens(model, item.symbol, CancellationToken.None)).then(symbol => result.push(symbol || item.symbol)));\n            }\n        }\n        return Promise.all(resolve);\n    }).then(() => {\n        return result;\n    }).finally(() => {\n        // make sure to return results, then (on next tick)\n        // dispose the results\n        setTimeout(() => disposables.dispose(), 100);\n    });\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Event } from '../../../../base/common/event.js';\nimport { LRUCache } from '../../../../base/common/map.js';\nimport { Range } from '../../../common/core/range.js';\nimport { CodeLensModel } from './codelens.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService, WillSaveStateReason } from '../../../../platform/storage/common/storage.js';\nimport { mainWindow } from '../../../../base/browser/window.js';\nimport { runWhenWindowIdle } from '../../../../base/browser/dom.js';\nexport const ICodeLensCache = createDecorator('ICodeLensCache');\nclass CacheItem {\n    constructor(lineCount, data) {\n        this.lineCount = lineCount;\n        this.data = data;\n    }\n}\nlet CodeLensCache = class CodeLensCache {\n    constructor(storageService) {\n        this._fakeProvider = new class {\n            provideCodeLenses() {\n                throw new Error('not supported');\n            }\n        };\n        this._cache = new LRUCache(20, 0.75);\n        // remove old data\n        const oldkey = 'codelens/cache';\n        runWhenWindowIdle(mainWindow, () => storageService.remove(oldkey, 1 /* StorageScope.WORKSPACE */));\n        // restore lens data on start\n        const key = 'codelens/cache2';\n        const raw = storageService.get(key, 1 /* StorageScope.WORKSPACE */, '{}');\n        this._deserialize(raw);\n        // store lens data on shutdown\n        const onWillSaveStateBecauseOfShutdown = Event.filter(storageService.onWillSaveState, e => e.reason === WillSaveStateReason.SHUTDOWN);\n        Event.once(onWillSaveStateBecauseOfShutdown)(e => {\n            storageService.store(key, this._serialize(), 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n        });\n    }\n    put(model, data) {\n        // create a copy of the model that is without command-ids\n        // but with comand-labels\n        const copyItems = data.lenses.map((item) => {\n            return {\n                range: item.symbol.range,\n                command: item.symbol.command && { id: '', title: item.symbol.command?.title },\n            };\n        });\n        const copyModel = new CodeLensModel();\n        copyModel.add({ lenses: copyItems, dispose: () => { } }, this._fakeProvider);\n        const item = new CacheItem(model.getLineCount(), copyModel);\n        this._cache.set(model.uri.toString(), item);\n    }\n    get(model) {\n        const item = this._cache.get(model.uri.toString());\n        return item && item.lineCount === model.getLineCount() ? item.data : undefined;\n    }\n    delete(model) {\n        this._cache.delete(model.uri.toString());\n    }\n    // --- persistence\n    _serialize() {\n        const data = Object.create(null);\n        for (const [key, value] of this._cache) {\n            const lines = new Set();\n            for (const d of value.data.lenses) {\n                lines.add(d.symbol.range.startLineNumber);\n            }\n            data[key] = {\n                lineCount: value.lineCount,\n                lines: [...lines.values()]\n            };\n        }\n        return JSON.stringify(data);\n    }\n    _deserialize(raw) {\n        try {\n            const data = JSON.parse(raw);\n            for (const key in data) {\n                const element = data[key];\n                const lenses = [];\n                for (const line of element.lines) {\n                    lenses.push({ range: new Range(line, 1, line, 11) });\n                }\n                const model = new CodeLensModel();\n                model.add({ lenses, dispose() { } }, this._fakeProvider);\n                this._cache.set(key, new CacheItem(element.lineCount, model));\n            }\n        }\n        catch {\n            // ignore...\n        }\n    }\n};\nCodeLensCache = __decorate([\n    __param(0, IStorageService)\n], CodeLensCache);\nexport { CodeLensCache };\nregisterSingleton(ICodeLensCache, CodeLensCache, 1 /* InstantiationType.Delayed */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { renderLabelWithIcons } from '../../../../base/browser/ui/iconLabel/iconLabels.js';\nimport './codelensWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nclass CodeLensViewZone {\n    constructor(afterLineNumber, heightInPx, onHeight) {\n        /**\n         * We want that this view zone, which reserves space for a code lens appears\n         * as close as possible to the next line, so we use a very large value here.\n         */\n        this.afterColumn = 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */;\n        this.afterLineNumber = afterLineNumber;\n        this.heightInPx = heightInPx;\n        this._onHeight = onHeight;\n        this.suppressMouseDown = true;\n        this.domNode = document.createElement('div');\n    }\n    onComputedHeight(height) {\n        if (this._lastHeight === undefined) {\n            this._lastHeight = height;\n        }\n        else if (this._lastHeight !== height) {\n            this._lastHeight = height;\n            this._onHeight();\n        }\n    }\n    isVisible() {\n        return this._lastHeight !== 0\n            && this.domNode.hasAttribute('monaco-visible-view-zone');\n    }\n}\nclass CodeLensContentWidget {\n    static { this._idPool = 0; }\n    constructor(editor, line) {\n        // Editor.IContentWidget.allowEditorOverflow\n        this.allowEditorOverflow = false;\n        this.suppressMouseDown = true;\n        this._commands = new Map();\n        this._isEmpty = true;\n        this._editor = editor;\n        this._id = `codelens.widget-${(CodeLensContentWidget._idPool++)}`;\n        this.updatePosition(line);\n        this._domNode = document.createElement('span');\n        this._domNode.className = `codelens-decoration`;\n    }\n    withCommands(lenses, animate) {\n        this._commands.clear();\n        const children = [];\n        let hasSymbol = false;\n        for (let i = 0; i < lenses.length; i++) {\n            const lens = lenses[i];\n            if (!lens) {\n                continue;\n            }\n            hasSymbol = true;\n            if (lens.command) {\n                const title = renderLabelWithIcons(lens.command.title.trim());\n                if (lens.command.id) {\n                    const id = `c${(CodeLensContentWidget._idPool++)}`;\n                    children.push(dom.$('a', { id, title: lens.command.tooltip, role: 'button' }, ...title));\n                    this._commands.set(id, lens.command);\n                }\n                else {\n                    children.push(dom.$('span', { title: lens.command.tooltip }, ...title));\n                }\n                if (i + 1 < lenses.length) {\n                    children.push(dom.$('span', undefined, '\\u00a0|\\u00a0'));\n                }\n            }\n        }\n        if (!hasSymbol) {\n            // symbols but no commands\n            dom.reset(this._domNode, dom.$('span', undefined, 'no commands'));\n        }\n        else {\n            // symbols and commands\n            dom.reset(this._domNode, ...children);\n            if (this._isEmpty && animate) {\n                this._domNode.classList.add('fadein');\n            }\n            this._isEmpty = false;\n        }\n    }\n    getCommand(link) {\n        return link.parentElement === this._domNode\n            ? this._commands.get(link.id)\n            : undefined;\n    }\n    getId() {\n        return this._id;\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    updatePosition(line) {\n        const column = this._editor.getModel().getLineFirstNonWhitespaceColumn(line);\n        this._widgetPosition = {\n            position: { lineNumber: line, column: column },\n            preference: [1 /* ContentWidgetPositionPreference.ABOVE */]\n        };\n    }\n    getPosition() {\n        return this._widgetPosition || null;\n    }\n}\nexport class CodeLensHelper {\n    constructor() {\n        this._removeDecorations = [];\n        this._addDecorations = [];\n        this._addDecorationsCallbacks = [];\n    }\n    addDecoration(decoration, callback) {\n        this._addDecorations.push(decoration);\n        this._addDecorationsCallbacks.push(callback);\n    }\n    removeDecoration(decorationId) {\n        this._removeDecorations.push(decorationId);\n    }\n    commit(changeAccessor) {\n        const resultingDecorations = changeAccessor.deltaDecorations(this._removeDecorations, this._addDecorations);\n        for (let i = 0, len = resultingDecorations.length; i < len; i++) {\n            this._addDecorationsCallbacks[i](resultingDecorations[i]);\n        }\n    }\n}\nconst codeLensDecorationOptions = ModelDecorationOptions.register({\n    collapseOnReplaceEdit: true,\n    description: 'codelens'\n});\nexport class CodeLensWidget {\n    constructor(data, editor, helper, viewZoneChangeAccessor, heightInPx, updateCallback) {\n        this._isDisposed = false;\n        this._editor = editor;\n        this._data = data;\n        // create combined range, track all ranges with decorations,\n        // check if there is already something to render\n        this._decorationIds = [];\n        let range;\n        const lenses = [];\n        this._data.forEach((codeLensData, i) => {\n            if (codeLensData.symbol.command) {\n                lenses.push(codeLensData.symbol);\n            }\n            helper.addDecoration({\n                range: codeLensData.symbol.range,\n                options: codeLensDecorationOptions\n            }, id => this._decorationIds[i] = id);\n            // the range contains all lenses on this line\n            if (!range) {\n                range = Range.lift(codeLensData.symbol.range);\n            }\n            else {\n                range = Range.plusRange(range, codeLensData.symbol.range);\n            }\n        });\n        this._viewZone = new CodeLensViewZone(range.startLineNumber - 1, heightInPx, updateCallback);\n        this._viewZoneId = viewZoneChangeAccessor.addZone(this._viewZone);\n        if (lenses.length > 0) {\n            this._createContentWidgetIfNecessary();\n            this._contentWidget.withCommands(lenses, false);\n        }\n    }\n    _createContentWidgetIfNecessary() {\n        if (!this._contentWidget) {\n            this._contentWidget = new CodeLensContentWidget(this._editor, this._viewZone.afterLineNumber + 1);\n            this._editor.addContentWidget(this._contentWidget);\n        }\n        else {\n            this._editor.layoutContentWidget(this._contentWidget);\n        }\n    }\n    dispose(helper, viewZoneChangeAccessor) {\n        this._decorationIds.forEach(helper.removeDecoration, helper);\n        this._decorationIds = [];\n        viewZoneChangeAccessor?.removeZone(this._viewZoneId);\n        if (this._contentWidget) {\n            this._editor.removeContentWidget(this._contentWidget);\n            this._contentWidget = undefined;\n        }\n        this._isDisposed = true;\n    }\n    isDisposed() {\n        return this._isDisposed;\n    }\n    isValid() {\n        return this._decorationIds.some((id, i) => {\n            const range = this._editor.getModel().getDecorationRange(id);\n            const symbol = this._data[i].symbol;\n            return !!(range && Range.isEmpty(symbol.range) === range.isEmpty());\n        });\n    }\n    updateCodeLensSymbols(data, helper) {\n        this._decorationIds.forEach(helper.removeDecoration, helper);\n        this._decorationIds = [];\n        this._data = data;\n        this._data.forEach((codeLensData, i) => {\n            helper.addDecoration({\n                range: codeLensData.symbol.range,\n                options: codeLensDecorationOptions\n            }, id => this._decorationIds[i] = id);\n        });\n    }\n    updateHeight(height, viewZoneChangeAccessor) {\n        this._viewZone.heightInPx = height;\n        viewZoneChangeAccessor.layoutZone(this._viewZoneId);\n        if (this._contentWidget) {\n            this._editor.layoutContentWidget(this._contentWidget);\n        }\n    }\n    computeIfNecessary(model) {\n        if (!this._viewZone.isVisible()) {\n            return null;\n        }\n        // Read editor current state\n        for (let i = 0; i < this._decorationIds.length; i++) {\n            const range = model.getDecorationRange(this._decorationIds[i]);\n            if (range) {\n                this._data[i].symbol.range = range;\n            }\n        }\n        return this._data;\n    }\n    updateCommands(symbols) {\n        this._createContentWidgetIfNecessary();\n        this._contentWidget.withCommands(symbols, true);\n        for (let i = 0; i < this._data.length; i++) {\n            const resolved = symbols[i];\n            if (resolved) {\n                const { symbol } = this._data[i];\n                symbol.command = resolved.command || symbol.command;\n            }\n        }\n    }\n    getCommand(link) {\n        return this._contentWidget?.getCommand(link);\n    }\n    getLineNumber() {\n        const range = this._editor.getModel().getDecorationRange(this._decorationIds[0]);\n        if (range) {\n            return range.startLineNumber;\n        }\n        return -1;\n    }\n    update(viewZoneChangeAccessor) {\n        if (this.isValid()) {\n            const range = this._editor.getModel().getDecorationRange(this._decorationIds[0]);\n            if (range) {\n                this._viewZone.afterLineNumber = range.startLineNumber - 1;\n                viewZoneChangeAccessor.layoutZone(this._viewZoneId);\n                if (this._contentWidget) {\n                    this._contentWidget.updatePosition(range.startLineNumber);\n                    this._editor.layoutContentWidget(this._contentWidget);\n                }\n            }\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { createCancelablePromise, disposableTimeout, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EDITOR_FONT_DEFAULTS } from '../../../common/config/editorOptions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { getCodeLensModel } from './codelens.js';\nimport { ICodeLensCache } from './codeLensCache.js';\nimport { CodeLensHelper, CodeLensWidget } from './codelensWidget.js';\nimport { localize } from '../../../../nls.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nlet CodeLensContribution = class CodeLensContribution {\n    static { this.ID = 'css.editor.codeLens'; }\n    constructor(_editor, _languageFeaturesService, debounceService, _commandService, _notificationService, _codeLensCache) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._commandService = _commandService;\n        this._notificationService = _notificationService;\n        this._codeLensCache = _codeLensCache;\n        this._disposables = new DisposableStore();\n        this._localToDispose = new DisposableStore();\n        this._lenses = [];\n        this._oldCodeLensModels = new DisposableStore();\n        this._provideCodeLensDebounce = debounceService.for(_languageFeaturesService.codeLensProvider, 'CodeLensProvide', { min: 250 });\n        this._resolveCodeLensesDebounce = debounceService.for(_languageFeaturesService.codeLensProvider, 'CodeLensResolve', { min: 250, salt: 'resolve' });\n        this._resolveCodeLensesScheduler = new RunOnceScheduler(() => this._resolveCodeLensesInViewport(), this._resolveCodeLensesDebounce.default());\n        this._disposables.add(this._editor.onDidChangeModel(() => this._onModelChange()));\n        this._disposables.add(this._editor.onDidChangeModelLanguage(() => this._onModelChange()));\n        this._disposables.add(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(50 /* EditorOption.fontInfo */) || e.hasChanged(19 /* EditorOption.codeLensFontSize */) || e.hasChanged(18 /* EditorOption.codeLensFontFamily */)) {\n                this._updateLensStyle();\n            }\n            if (e.hasChanged(17 /* EditorOption.codeLens */)) {\n                this._onModelChange();\n            }\n        }));\n        this._disposables.add(_languageFeaturesService.codeLensProvider.onDidChange(this._onModelChange, this));\n        this._onModelChange();\n        this._updateLensStyle();\n    }\n    dispose() {\n        this._localDispose();\n        this._disposables.dispose();\n        this._oldCodeLensModels.dispose();\n        this._currentCodeLensModel?.dispose();\n    }\n    _getLayoutInfo() {\n        const lineHeightFactor = Math.max(1.3, this._editor.getOption(67 /* EditorOption.lineHeight */) / this._editor.getOption(52 /* EditorOption.fontSize */));\n        let fontSize = this._editor.getOption(19 /* EditorOption.codeLensFontSize */);\n        if (!fontSize || fontSize < 5) {\n            fontSize = (this._editor.getOption(52 /* EditorOption.fontSize */) * .9) | 0;\n        }\n        return {\n            fontSize,\n            codeLensHeight: (fontSize * lineHeightFactor) | 0,\n        };\n    }\n    _updateLensStyle() {\n        const { codeLensHeight, fontSize } = this._getLayoutInfo();\n        const fontFamily = this._editor.getOption(18 /* EditorOption.codeLensFontFamily */);\n        const editorFontInfo = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        const { style } = this._editor.getContainerDomNode();\n        style.setProperty('--vscode-editorCodeLens-lineHeight', `${codeLensHeight}px`);\n        style.setProperty('--vscode-editorCodeLens-fontSize', `${fontSize}px`);\n        style.setProperty('--vscode-editorCodeLens-fontFeatureSettings', editorFontInfo.fontFeatureSettings);\n        if (fontFamily) {\n            style.setProperty('--vscode-editorCodeLens-fontFamily', fontFamily);\n            style.setProperty('--vscode-editorCodeLens-fontFamilyDefault', EDITOR_FONT_DEFAULTS.fontFamily);\n        }\n        //\n        this._editor.changeViewZones(accessor => {\n            for (const lens of this._lenses) {\n                lens.updateHeight(codeLensHeight, accessor);\n            }\n        });\n    }\n    _localDispose() {\n        this._getCodeLensModelPromise?.cancel();\n        this._getCodeLensModelPromise = undefined;\n        this._resolveCodeLensesPromise?.cancel();\n        this._resolveCodeLensesPromise = undefined;\n        this._localToDispose.clear();\n        this._oldCodeLensModels.clear();\n        this._currentCodeLensModel?.dispose();\n    }\n    _onModelChange() {\n        this._localDispose();\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        if (!this._editor.getOption(17 /* EditorOption.codeLens */) || model.isTooLargeForTokenization()) {\n            return;\n        }\n        const cachedLenses = this._codeLensCache.get(model);\n        if (cachedLenses) {\n            this._renderCodeLensSymbols(cachedLenses);\n        }\n        if (!this._languageFeaturesService.codeLensProvider.has(model)) {\n            // no provider -> return but check with\n            // cached lenses. they expire after 30 seconds\n            if (cachedLenses) {\n                disposableTimeout(() => {\n                    const cachedLensesNow = this._codeLensCache.get(model);\n                    if (cachedLenses === cachedLensesNow) {\n                        this._codeLensCache.delete(model);\n                        this._onModelChange();\n                    }\n                }, 30 * 1000, this._localToDispose);\n            }\n            return;\n        }\n        for (const provider of this._languageFeaturesService.codeLensProvider.all(model)) {\n            if (typeof provider.onDidChange === 'function') {\n                const registration = provider.onDidChange(() => scheduler.schedule());\n                this._localToDispose.add(registration);\n            }\n        }\n        const scheduler = new RunOnceScheduler(() => {\n            const t1 = Date.now();\n            this._getCodeLensModelPromise?.cancel();\n            this._getCodeLensModelPromise = createCancelablePromise(token => getCodeLensModel(this._languageFeaturesService.codeLensProvider, model, token));\n            this._getCodeLensModelPromise.then(result => {\n                if (this._currentCodeLensModel) {\n                    this._oldCodeLensModels.add(this._currentCodeLensModel);\n                }\n                this._currentCodeLensModel = result;\n                // cache model to reduce flicker\n                this._codeLensCache.put(model, result);\n                // update moving average\n                const newDelay = this._provideCodeLensDebounce.update(model, Date.now() - t1);\n                scheduler.delay = newDelay;\n                // render lenses\n                this._renderCodeLensSymbols(result);\n                // dom.scheduleAtNextAnimationFrame(() => this._resolveCodeLensesInViewport());\n                this._resolveCodeLensesInViewportSoon();\n            }, onUnexpectedError);\n        }, this._provideCodeLensDebounce.get(model));\n        this._localToDispose.add(scheduler);\n        this._localToDispose.add(toDisposable(() => this._resolveCodeLensesScheduler.cancel()));\n        this._localToDispose.add(this._editor.onDidChangeModelContent(() => {\n            this._editor.changeDecorations(decorationsAccessor => {\n                this._editor.changeViewZones(viewZonesAccessor => {\n                    const toDispose = [];\n                    let lastLensLineNumber = -1;\n                    this._lenses.forEach((lens) => {\n                        if (!lens.isValid() || lastLensLineNumber === lens.getLineNumber()) {\n                            // invalid -> lens collapsed, attach range doesn't exist anymore\n                            // line_number -> lenses should never be on the same line\n                            toDispose.push(lens);\n                        }\n                        else {\n                            lens.update(viewZonesAccessor);\n                            lastLensLineNumber = lens.getLineNumber();\n                        }\n                    });\n                    const helper = new CodeLensHelper();\n                    toDispose.forEach((l) => {\n                        l.dispose(helper, viewZonesAccessor);\n                        this._lenses.splice(this._lenses.indexOf(l), 1);\n                    });\n                    helper.commit(decorationsAccessor);\n                });\n            });\n            // Ask for all references again\n            scheduler.schedule();\n            // Cancel pending and active resolve requests\n            this._resolveCodeLensesScheduler.cancel();\n            this._resolveCodeLensesPromise?.cancel();\n            this._resolveCodeLensesPromise = undefined;\n        }));\n        this._localToDispose.add(this._editor.onDidFocusEditorText(() => {\n            scheduler.schedule();\n        }));\n        this._localToDispose.add(this._editor.onDidBlurEditorText(() => {\n            scheduler.cancel();\n        }));\n        this._localToDispose.add(this._editor.onDidScrollChange(e => {\n            if (e.scrollTopChanged && this._lenses.length > 0) {\n                this._resolveCodeLensesInViewportSoon();\n            }\n        }));\n        this._localToDispose.add(this._editor.onDidLayoutChange(() => {\n            this._resolveCodeLensesInViewportSoon();\n        }));\n        this._localToDispose.add(toDisposable(() => {\n            if (this._editor.getModel()) {\n                const scrollState = StableEditorScrollState.capture(this._editor);\n                this._editor.changeDecorations(decorationsAccessor => {\n                    this._editor.changeViewZones(viewZonesAccessor => {\n                        this._disposeAllLenses(decorationsAccessor, viewZonesAccessor);\n                    });\n                });\n                scrollState.restore(this._editor);\n            }\n            else {\n                // No accessors available\n                this._disposeAllLenses(undefined, undefined);\n            }\n        }));\n        this._localToDispose.add(this._editor.onMouseDown(e => {\n            if (e.target.type !== 9 /* MouseTargetType.CONTENT_WIDGET */) {\n                return;\n            }\n            let target = e.target.element;\n            if (target?.tagName === 'SPAN') {\n                target = target.parentElement;\n            }\n            if (target?.tagName === 'A') {\n                for (const lens of this._lenses) {\n                    const command = lens.getCommand(target);\n                    if (command) {\n                        this._commandService.executeCommand(command.id, ...(command.arguments || [])).catch(err => this._notificationService.error(err));\n                        break;\n                    }\n                }\n            }\n        }));\n        scheduler.schedule();\n    }\n    _disposeAllLenses(decChangeAccessor, viewZoneChangeAccessor) {\n        const helper = new CodeLensHelper();\n        for (const lens of this._lenses) {\n            lens.dispose(helper, viewZoneChangeAccessor);\n        }\n        if (decChangeAccessor) {\n            helper.commit(decChangeAccessor);\n        }\n        this._lenses.length = 0;\n    }\n    _renderCodeLensSymbols(symbols) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const maxLineNumber = this._editor.getModel().getLineCount();\n        const groups = [];\n        let lastGroup;\n        for (const symbol of symbols.lenses) {\n            const line = symbol.symbol.range.startLineNumber;\n            if (line < 1 || line > maxLineNumber) {\n                // invalid code lens\n                continue;\n            }\n            else if (lastGroup && lastGroup[lastGroup.length - 1].symbol.range.startLineNumber === line) {\n                // on same line as previous\n                lastGroup.push(symbol);\n            }\n            else {\n                // on later line as previous\n                lastGroup = [symbol];\n                groups.push(lastGroup);\n            }\n        }\n        if (!groups.length && !this._lenses.length) {\n            // Nothing to change\n            return;\n        }\n        const scrollState = StableEditorScrollState.capture(this._editor);\n        const layoutInfo = this._getLayoutInfo();\n        this._editor.changeDecorations(decorationsAccessor => {\n            this._editor.changeViewZones(viewZoneAccessor => {\n                const helper = new CodeLensHelper();\n                let codeLensIndex = 0;\n                let groupsIndex = 0;\n                while (groupsIndex < groups.length && codeLensIndex < this._lenses.length) {\n                    const symbolsLineNumber = groups[groupsIndex][0].symbol.range.startLineNumber;\n                    const codeLensLineNumber = this._lenses[codeLensIndex].getLineNumber();\n                    if (codeLensLineNumber < symbolsLineNumber) {\n                        this._lenses[codeLensIndex].dispose(helper, viewZoneAccessor);\n                        this._lenses.splice(codeLensIndex, 1);\n                    }\n                    else if (codeLensLineNumber === symbolsLineNumber) {\n                        this._lenses[codeLensIndex].updateCodeLensSymbols(groups[groupsIndex], helper);\n                        groupsIndex++;\n                        codeLensIndex++;\n                    }\n                    else {\n                        this._lenses.splice(codeLensIndex, 0, new CodeLensWidget(groups[groupsIndex], this._editor, helper, viewZoneAccessor, layoutInfo.codeLensHeight, () => this._resolveCodeLensesInViewportSoon()));\n                        codeLensIndex++;\n                        groupsIndex++;\n                    }\n                }\n                // Delete extra code lenses\n                while (codeLensIndex < this._lenses.length) {\n                    this._lenses[codeLensIndex].dispose(helper, viewZoneAccessor);\n                    this._lenses.splice(codeLensIndex, 1);\n                }\n                // Create extra symbols\n                while (groupsIndex < groups.length) {\n                    this._lenses.push(new CodeLensWidget(groups[groupsIndex], this._editor, helper, viewZoneAccessor, layoutInfo.codeLensHeight, () => this._resolveCodeLensesInViewportSoon()));\n                    groupsIndex++;\n                }\n                helper.commit(decorationsAccessor);\n            });\n        });\n        scrollState.restore(this._editor);\n    }\n    _resolveCodeLensesInViewportSoon() {\n        const model = this._editor.getModel();\n        if (model) {\n            this._resolveCodeLensesScheduler.schedule();\n        }\n    }\n    _resolveCodeLensesInViewport() {\n        this._resolveCodeLensesPromise?.cancel();\n        this._resolveCodeLensesPromise = undefined;\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        const toResolve = [];\n        const lenses = [];\n        this._lenses.forEach((lens) => {\n            const request = lens.computeIfNecessary(model);\n            if (request) {\n                toResolve.push(request);\n                lenses.push(lens);\n            }\n        });\n        if (toResolve.length === 0) {\n            return;\n        }\n        const t1 = Date.now();\n        const resolvePromise = createCancelablePromise(token => {\n            const promises = toResolve.map((request, i) => {\n                const resolvedSymbols = new Array(request.length);\n                const promises = request.map((request, i) => {\n                    if (!request.symbol.command && typeof request.provider.resolveCodeLens === 'function') {\n                        return Promise.resolve(request.provider.resolveCodeLens(model, request.symbol, token)).then(symbol => {\n                            resolvedSymbols[i] = symbol;\n                        }, onUnexpectedExternalError);\n                    }\n                    else {\n                        resolvedSymbols[i] = request.symbol;\n                        return Promise.resolve(undefined);\n                    }\n                });\n                return Promise.all(promises).then(() => {\n                    if (!token.isCancellationRequested && !lenses[i].isDisposed()) {\n                        lenses[i].updateCommands(resolvedSymbols);\n                    }\n                });\n            });\n            return Promise.all(promises);\n        });\n        this._resolveCodeLensesPromise = resolvePromise;\n        this._resolveCodeLensesPromise.then(() => {\n            // update moving average\n            const newDelay = this._resolveCodeLensesDebounce.update(model, Date.now() - t1);\n            this._resolveCodeLensesScheduler.delay = newDelay;\n            if (this._currentCodeLensModel) { // update the cached state with new resolved items\n                this._codeLensCache.put(model, this._currentCodeLensModel);\n            }\n            this._oldCodeLensModels.clear(); // dispose old models once we have updated the UI with the current model\n            if (resolvePromise === this._resolveCodeLensesPromise) {\n                this._resolveCodeLensesPromise = undefined;\n            }\n        }, err => {\n            onUnexpectedError(err); // can also be cancellation!\n            if (resolvePromise === this._resolveCodeLensesPromise) {\n                this._resolveCodeLensesPromise = undefined;\n            }\n        });\n    }\n    async getModel() {\n        await this._getCodeLensModelPromise;\n        await this._resolveCodeLensesPromise;\n        return !this._currentCodeLensModel?.isDisposed\n            ? this._currentCodeLensModel\n            : undefined;\n    }\n};\nCodeLensContribution = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, ILanguageFeatureDebounceService),\n    __param(3, ICommandService),\n    __param(4, INotificationService),\n    __param(5, ICodeLensCache)\n], CodeLensContribution);\nexport { CodeLensContribution };\nregisterEditorContribution(CodeLensContribution.ID, CodeLensContribution, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nregisterEditorAction(class ShowLensesInCurrentLine extends EditorAction {\n    constructor() {\n        super({\n            id: 'codelens.showLensesInCurrentLine',\n            precondition: EditorContextKeys.hasCodeLensProvider,\n            label: localize('showLensOnLine', \"Show CodeLens Commands For Current Line\"),\n            alias: 'Show CodeLens Commands For Current Line',\n        });\n    }\n    async run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const quickInputService = accessor.get(IQuickInputService);\n        const commandService = accessor.get(ICommandService);\n        const notificationService = accessor.get(INotificationService);\n        const lineNumber = editor.getSelection().positionLineNumber;\n        const codelensController = editor.getContribution(CodeLensContribution.ID);\n        if (!codelensController) {\n            return;\n        }\n        const model = await codelensController.getModel();\n        if (!model) {\n            // nothing\n            return;\n        }\n        const items = [];\n        for (const lens of model.lenses) {\n            if (lens.symbol.command && lens.symbol.range.startLineNumber === lineNumber) {\n                items.push({\n                    label: lens.symbol.command.title,\n                    command: lens.symbol.command\n                });\n            }\n        }\n        if (items.length === 0) {\n            // We dont want an empty picker\n            return;\n        }\n        const item = await quickInputService.pick(items, {\n            canPickMany: false,\n            placeHolder: localize('placeHolder', \"Select a command\")\n        });\n        if (!item) {\n            // Nothing picked\n            return;\n        }\n        let command = item.command;\n        if (model.isDisposed) {\n            // try to find the same command again in-case the model has been re-created in the meantime\n            // this is a best attempt approach which shouldn't be needed because eager model re-creates\n            // shouldn't happen due to focus in/out anymore\n            const newModel = await codelensController.getModel();\n            const newLens = newModel?.lenses.find(lens => lens.symbol.range.startLineNumber === lineNumber && lens.symbol.command?.title === command.title);\n            if (!newLens || !newLens.symbol.command) {\n                return;\n            }\n            command = newLens.symbol.command;\n        }\n        try {\n            await commandService.executeCommand(command.id, ...(command.arguments || []));\n        }\n        catch (err) {\n            notificationService.error(err);\n        }\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Color, RGBA } from '../../../../base/common/color.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { registerEditorFeature } from '../../../common/editorFeatures.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nlet DefaultDocumentColorProvider = class DefaultDocumentColorProvider {\n    constructor(_editorWorkerService) {\n        this._editorWorkerService = _editorWorkerService;\n    }\n    async provideDocumentColors(model, _token) {\n        return this._editorWorkerService.computeDefaultDocumentColors(model.uri);\n    }\n    provideColorPresentations(_model, colorInfo, _token) {\n        const range = colorInfo.range;\n        const colorFromInfo = colorInfo.color;\n        const alpha = colorFromInfo.alpha;\n        const color = new Color(new RGBA(Math.round(255 * colorFromInfo.red), Math.round(255 * colorFromInfo.green), Math.round(255 * colorFromInfo.blue), alpha));\n        const rgb = alpha ? Color.Format.CSS.formatRGB(color) : Color.Format.CSS.formatRGBA(color);\n        const hsl = alpha ? Color.Format.CSS.formatHSL(color) : Color.Format.CSS.formatHSLA(color);\n        const hex = alpha ? Color.Format.CSS.formatHex(color) : Color.Format.CSS.formatHexA(color);\n        const colorPresentations = [];\n        colorPresentations.push({ label: rgb, textEdit: { range: range, text: rgb } });\n        colorPresentations.push({ label: hsl, textEdit: { range: range, text: hsl } });\n        colorPresentations.push({ label: hex, textEdit: { range: range, text: hex } });\n        return colorPresentations;\n    }\n};\nDefaultDocumentColorProvider = __decorate([\n    __param(0, IEditorWorkerService)\n], DefaultDocumentColorProvider);\nexport { DefaultDocumentColorProvider };\nlet DefaultDocumentColorProviderFeature = class DefaultDocumentColorProviderFeature extends Disposable {\n    constructor(_languageFeaturesService, editorWorkerService) {\n        super();\n        this._register(_languageFeaturesService.colorProvider.register('*', new DefaultDocumentColorProvider(editorWorkerService)));\n    }\n};\nDefaultDocumentColorProviderFeature = __decorate([\n    __param(0, ILanguageFeaturesService),\n    __param(1, IEditorWorkerService)\n], DefaultDocumentColorProviderFeature);\nregisterEditorFeature(DefaultDocumentColorProviderFeature);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { illegalArgument, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../common/core/range.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { DefaultDocumentColorProvider } from './defaultDocumentColorProvider.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nexport async function getColors(colorProviderRegistry, model, token, isDefaultColorDecoratorsEnabled = true) {\n    return _findColorData(new ColorDataCollector(), colorProviderRegistry, model, token, isDefaultColorDecoratorsEnabled);\n}\nexport function getColorPresentations(model, colorInfo, provider, token) {\n    return Promise.resolve(provider.provideColorPresentations(model, colorInfo, token));\n}\nclass ColorDataCollector {\n    constructor() { }\n    async compute(provider, model, token, colors) {\n        const documentColors = await provider.provideDocumentColors(model, token);\n        if (Array.isArray(documentColors)) {\n            for (const colorInfo of documentColors) {\n                colors.push({ colorInfo, provider });\n            }\n        }\n        return Array.isArray(documentColors);\n    }\n}\nclass ExtColorDataCollector {\n    constructor() { }\n    async compute(provider, model, token, colors) {\n        const documentColors = await provider.provideDocumentColors(model, token);\n        if (Array.isArray(documentColors)) {\n            for (const colorInfo of documentColors) {\n                colors.push({ range: colorInfo.range, color: [colorInfo.color.red, colorInfo.color.green, colorInfo.color.blue, colorInfo.color.alpha] });\n            }\n        }\n        return Array.isArray(documentColors);\n    }\n}\nclass ColorPresentationsCollector {\n    constructor(colorInfo) {\n        this.colorInfo = colorInfo;\n    }\n    async compute(provider, model, _token, colors) {\n        const documentColors = await provider.provideColorPresentations(model, this.colorInfo, CancellationToken.None);\n        if (Array.isArray(documentColors)) {\n            colors.push(...documentColors);\n        }\n        return Array.isArray(documentColors);\n    }\n}\nasync function _findColorData(collector, colorProviderRegistry, model, token, isDefaultColorDecoratorsEnabled) {\n    let validDocumentColorProviderFound = false;\n    let defaultProvider;\n    const colorData = [];\n    const documentColorProviders = colorProviderRegistry.ordered(model);\n    for (let i = documentColorProviders.length - 1; i >= 0; i--) {\n        const provider = documentColorProviders[i];\n        if (provider instanceof DefaultDocumentColorProvider) {\n            defaultProvider = provider;\n        }\n        else {\n            try {\n                if (await collector.compute(provider, model, token, colorData)) {\n                    validDocumentColorProviderFound = true;\n                }\n            }\n            catch (e) {\n                onUnexpectedExternalError(e);\n            }\n        }\n    }\n    if (validDocumentColorProviderFound) {\n        return colorData;\n    }\n    if (defaultProvider && isDefaultColorDecoratorsEnabled) {\n        await collector.compute(defaultProvider, model, token, colorData);\n        return colorData;\n    }\n    return [];\n}\nfunction _setupColorCommand(accessor, resource) {\n    const { colorProvider: colorProviderRegistry } = accessor.get(ILanguageFeaturesService);\n    const model = accessor.get(IModelService).getModel(resource);\n    if (!model) {\n        throw illegalArgument();\n    }\n    const isDefaultColorDecoratorsEnabled = accessor.get(IConfigurationService).getValue('editor.defaultColorDecorators', { resource });\n    return { model, colorProviderRegistry, isDefaultColorDecoratorsEnabled };\n}\nCommandsRegistry.registerCommand('_executeDocumentColorProvider', function (accessor, ...args) {\n    const [resource] = args;\n    if (!(resource instanceof URI)) {\n        throw illegalArgument();\n    }\n    const { model, colorProviderRegistry, isDefaultColorDecoratorsEnabled } = _setupColorCommand(accessor, resource);\n    return _findColorData(new ExtColorDataCollector(), colorProviderRegistry, model, CancellationToken.None, isDefaultColorDecoratorsEnabled);\n});\nCommandsRegistry.registerCommand('_executeColorPresentationProvider', function (accessor, ...args) {\n    const [color, context] = args;\n    const { uri, range } = context;\n    if (!(uri instanceof URI) || !Array.isArray(color) || color.length !== 4 || !Range.isIRange(range)) {\n        throw illegalArgument();\n    }\n    const { model, colorProviderRegistry, isDefaultColorDecoratorsEnabled } = _setupColorCommand(accessor, uri);\n    const [red, green, blue, alpha] = color;\n    return _findColorData(new ColorPresentationsCollector({ range: range, color: { red, green, blue, alpha } }), colorProviderRegistry, model, CancellationToken.None, isDefaultColorDecoratorsEnabled);\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ColorDetector_1;\nimport { createCancelablePromise, TimeoutTimer } from '../../../../base/common/async.js';\nimport { RGBA } from '../../../../base/common/color.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { noBreakWhitespace } from '../../../../base/common/strings.js';\nimport { DynamicCssRules } from '../../../browser/editorDom.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { getColors } from './color.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nexport const ColorDecorationInjectedTextMarker = Object.create({});\nlet ColorDetector = class ColorDetector extends Disposable {\n    static { ColorDetector_1 = this; }\n    static { this.ID = 'editor.contrib.colorDetector'; }\n    static { this.RECOMPUTE_TIME = 1000; } // ms\n    constructor(_editor, _configurationService, _languageFeaturesService, languageFeatureDebounceService) {\n        super();\n        this._editor = _editor;\n        this._configurationService = _configurationService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._localToDispose = this._register(new DisposableStore());\n        this._decorationsIds = [];\n        this._colorDatas = new Map();\n        this._colorDecoratorIds = this._editor.createDecorationsCollection();\n        this._ruleFactory = new DynamicCssRules(this._editor);\n        this._decoratorLimitReporter = new DecoratorLimitReporter();\n        this._colorDecorationClassRefs = this._register(new DisposableStore());\n        this._debounceInformation = languageFeatureDebounceService.for(_languageFeaturesService.colorProvider, 'Document Colors', { min: ColorDetector_1.RECOMPUTE_TIME });\n        this._register(_editor.onDidChangeModel(() => {\n            this._isColorDecoratorsEnabled = this.isEnabled();\n            this.updateColors();\n        }));\n        this._register(_editor.onDidChangeModelLanguage(() => this.updateColors()));\n        this._register(_languageFeaturesService.colorProvider.onDidChange(() => this.updateColors()));\n        this._register(_editor.onDidChangeConfiguration((e) => {\n            const prevIsEnabled = this._isColorDecoratorsEnabled;\n            this._isColorDecoratorsEnabled = this.isEnabled();\n            this._isDefaultColorDecoratorsEnabled = this._editor.getOption(148 /* EditorOption.defaultColorDecorators */);\n            const updatedColorDecoratorsSetting = prevIsEnabled !== this._isColorDecoratorsEnabled || e.hasChanged(21 /* EditorOption.colorDecoratorsLimit */);\n            const updatedDefaultColorDecoratorsSetting = e.hasChanged(148 /* EditorOption.defaultColorDecorators */);\n            if (updatedColorDecoratorsSetting || updatedDefaultColorDecoratorsSetting) {\n                if (this._isColorDecoratorsEnabled) {\n                    this.updateColors();\n                }\n                else {\n                    this.removeAllDecorations();\n                }\n            }\n        }));\n        this._timeoutTimer = null;\n        this._computePromise = null;\n        this._isColorDecoratorsEnabled = this.isEnabled();\n        this._isDefaultColorDecoratorsEnabled = this._editor.getOption(148 /* EditorOption.defaultColorDecorators */);\n        this.updateColors();\n    }\n    isEnabled() {\n        const model = this._editor.getModel();\n        if (!model) {\n            return false;\n        }\n        const languageId = model.getLanguageId();\n        // handle deprecated settings. [languageId].colorDecorators.enable\n        const deprecatedConfig = this._configurationService.getValue(languageId);\n        if (deprecatedConfig && typeof deprecatedConfig === 'object') {\n            const colorDecorators = deprecatedConfig['colorDecorators']; // deprecatedConfig.valueOf('.colorDecorators.enable');\n            if (colorDecorators && colorDecorators['enable'] !== undefined && !colorDecorators['enable']) {\n                return colorDecorators['enable'];\n            }\n        }\n        return this._editor.getOption(20 /* EditorOption.colorDecorators */);\n    }\n    static get(editor) {\n        return editor.getContribution(this.ID);\n    }\n    dispose() {\n        this.stop();\n        this.removeAllDecorations();\n        super.dispose();\n    }\n    updateColors() {\n        this.stop();\n        if (!this._isColorDecoratorsEnabled) {\n            return;\n        }\n        const model = this._editor.getModel();\n        if (!model || !this._languageFeaturesService.colorProvider.has(model)) {\n            return;\n        }\n        this._localToDispose.add(this._editor.onDidChangeModelContent(() => {\n            if (!this._timeoutTimer) {\n                this._timeoutTimer = new TimeoutTimer();\n                this._timeoutTimer.cancelAndSet(() => {\n                    this._timeoutTimer = null;\n                    this.beginCompute();\n                }, this._debounceInformation.get(model));\n            }\n        }));\n        this.beginCompute();\n    }\n    async beginCompute() {\n        this._computePromise = createCancelablePromise(async (token) => {\n            const model = this._editor.getModel();\n            if (!model) {\n                return [];\n            }\n            const sw = new StopWatch(false);\n            const colors = await getColors(this._languageFeaturesService.colorProvider, model, token, this._isDefaultColorDecoratorsEnabled);\n            this._debounceInformation.update(model, sw.elapsed());\n            return colors;\n        });\n        try {\n            const colors = await this._computePromise;\n            this.updateDecorations(colors);\n            this.updateColorDecorators(colors);\n            this._computePromise = null;\n        }\n        catch (e) {\n            onUnexpectedError(e);\n        }\n    }\n    stop() {\n        if (this._timeoutTimer) {\n            this._timeoutTimer.cancel();\n            this._timeoutTimer = null;\n        }\n        if (this._computePromise) {\n            this._computePromise.cancel();\n            this._computePromise = null;\n        }\n        this._localToDispose.clear();\n    }\n    updateDecorations(colorDatas) {\n        const decorations = colorDatas.map(c => ({\n            range: {\n                startLineNumber: c.colorInfo.range.startLineNumber,\n                startColumn: c.colorInfo.range.startColumn,\n                endLineNumber: c.colorInfo.range.endLineNumber,\n                endColumn: c.colorInfo.range.endColumn\n            },\n            options: ModelDecorationOptions.EMPTY\n        }));\n        this._editor.changeDecorations((changeAccessor) => {\n            this._decorationsIds = changeAccessor.deltaDecorations(this._decorationsIds, decorations);\n            this._colorDatas = new Map();\n            this._decorationsIds.forEach((id, i) => this._colorDatas.set(id, colorDatas[i]));\n        });\n    }\n    updateColorDecorators(colorData) {\n        this._colorDecorationClassRefs.clear();\n        const decorations = [];\n        const limit = this._editor.getOption(21 /* EditorOption.colorDecoratorsLimit */);\n        for (let i = 0; i < colorData.length && decorations.length < limit; i++) {\n            const { red, green, blue, alpha } = colorData[i].colorInfo.color;\n            const rgba = new RGBA(Math.round(red * 255), Math.round(green * 255), Math.round(blue * 255), alpha);\n            const color = `rgba(${rgba.r}, ${rgba.g}, ${rgba.b}, ${rgba.a})`;\n            const ref = this._colorDecorationClassRefs.add(this._ruleFactory.createClassNameRef({\n                backgroundColor: color\n            }));\n            decorations.push({\n                range: {\n                    startLineNumber: colorData[i].colorInfo.range.startLineNumber,\n                    startColumn: colorData[i].colorInfo.range.startColumn,\n                    endLineNumber: colorData[i].colorInfo.range.endLineNumber,\n                    endColumn: colorData[i].colorInfo.range.endColumn\n                },\n                options: {\n                    description: 'colorDetector',\n                    before: {\n                        content: noBreakWhitespace,\n                        inlineClassName: `${ref.className} colorpicker-color-decoration`,\n                        inlineClassNameAffectsLetterSpacing: true,\n                        attachedData: ColorDecorationInjectedTextMarker\n                    }\n                }\n            });\n        }\n        const limited = limit < colorData.length ? limit : false;\n        this._decoratorLimitReporter.update(colorData.length, limited);\n        this._colorDecoratorIds.set(decorations);\n    }\n    removeAllDecorations() {\n        this._editor.removeDecorations(this._decorationsIds);\n        this._decorationsIds = [];\n        this._colorDecoratorIds.clear();\n        this._colorDecorationClassRefs.clear();\n    }\n    getColorData(position) {\n        const model = this._editor.getModel();\n        if (!model) {\n            return null;\n        }\n        const decorations = model\n            .getDecorationsInRange(Range.fromPositions(position, position))\n            .filter(d => this._colorDatas.has(d.id));\n        if (decorations.length === 0) {\n            return null;\n        }\n        return this._colorDatas.get(decorations[0].id);\n    }\n    isColorDecoration(decoration) {\n        return this._colorDecoratorIds.has(decoration);\n    }\n};\nColorDetector = ColorDetector_1 = __decorate([\n    __param(1, IConfigurationService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, ILanguageFeatureDebounceService)\n], ColorDetector);\nexport { ColorDetector };\nexport class DecoratorLimitReporter {\n    constructor() {\n        this._onDidChange = new Emitter();\n        this._computed = 0;\n        this._limited = false;\n    }\n    update(computed, limited) {\n        if (computed !== this._computed || limited !== this._limited) {\n            this._computed = computed;\n            this._limited = limited;\n            this._onDidChange.fire();\n        }\n    }\n}\nregisterEditorContribution(ColorDetector.ID, ColorDetector, 1 /* EditorContributionInstantiation.AfterFirstRender */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../base/common/event.js';\nexport class ColorPickerModel {\n    get color() {\n        return this._color;\n    }\n    set color(color) {\n        if (this._color.equals(color)) {\n            return;\n        }\n        this._color = color;\n        this._onDidChangeColor.fire(color);\n    }\n    get presentation() { return this.colorPresentations[this.presentationIndex]; }\n    get colorPresentations() {\n        return this._colorPresentations;\n    }\n    set colorPresentations(colorPresentations) {\n        this._colorPresentations = colorPresentations;\n        if (this.presentationIndex > colorPresentations.length - 1) {\n            this.presentationIndex = 0;\n        }\n        this._onDidChangePresentation.fire(this.presentation);\n    }\n    constructor(color, availableColorPresentations, presentationIndex) {\n        this.presentationIndex = presentationIndex;\n        this._onColorFlushed = new Emitter();\n        this.onColorFlushed = this._onColorFlushed.event;\n        this._onDidChangeColor = new Emitter();\n        this.onDidChangeColor = this._onDidChangeColor.event;\n        this._onDidChangePresentation = new Emitter();\n        this.onDidChangePresentation = this._onDidChangePresentation.event;\n        this.originalColor = color;\n        this._color = color;\n        this._colorPresentations = availableColorPresentations;\n    }\n    selectNextColorPresentation() {\n        this.presentationIndex = (this.presentationIndex + 1) % this.colorPresentations.length;\n        this.flushColor();\n        this._onDidChangePresentation.fire(this.presentation);\n    }\n    guessColorPresentation(color, originalText) {\n        let presentationIndex = -1;\n        for (let i = 0; i < this.colorPresentations.length; i++) {\n            if (originalText.toLowerCase() === this.colorPresentations[i].label) {\n                presentationIndex = i;\n                break;\n            }\n        }\n        if (presentationIndex === -1) {\n            // check which color presentation text has same prefix as original text's prefix\n            const originalTextPrefix = originalText.split('(')[0].toLowerCase();\n            for (let i = 0; i < this.colorPresentations.length; i++) {\n                if (this.colorPresentations[i].label.toLowerCase().startsWith(originalTextPrefix)) {\n                    presentationIndex = i;\n                    break;\n                }\n            }\n        }\n        if (presentationIndex !== -1 && presentationIndex !== this.presentationIndex) {\n            this.presentationIndex = presentationIndex;\n            this._onDidChangePresentation.fire(this.presentation);\n        }\n    }\n    flushColor() {\n        this._onColorFlushed.fire(this._color);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { PixelRatio } from '../../../../base/browser/pixelRatio.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { GlobalPointerMoveMonitor } from '../../../../base/browser/globalPointerMoveMonitor.js';\nimport { Widget } from '../../../../base/browser/ui/widget.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Color, HSVA, RGBA } from '../../../../base/common/color.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport './colorPicker.css';\nimport { localize } from '../../../../nls.js';\nimport { editorHoverBackground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nconst $ = dom.$;\nexport class ColorPickerHeader extends Disposable {\n    constructor(container, model, themeService, showingStandaloneColorPicker = false) {\n        super();\n        this.model = model;\n        this.showingStandaloneColorPicker = showingStandaloneColorPicker;\n        this._closeButton = null;\n        this._domNode = $('.colorpicker-header');\n        dom.append(container, this._domNode);\n        this._pickedColorNode = dom.append(this._domNode, $('.picked-color'));\n        dom.append(this._pickedColorNode, $('span.codicon.codicon-color-mode'));\n        this._pickedColorPresentation = dom.append(this._pickedColorNode, document.createElement('span'));\n        this._pickedColorPresentation.classList.add('picked-color-presentation');\n        const tooltip = localize('clickToToggleColorOptions', \"Click to toggle color options (rgb/hsl/hex)\");\n        this._pickedColorNode.setAttribute('title', tooltip);\n        this._originalColorNode = dom.append(this._domNode, $('.original-color'));\n        this._originalColorNode.style.backgroundColor = Color.Format.CSS.format(this.model.originalColor) || '';\n        this.backgroundColor = themeService.getColorTheme().getColor(editorHoverBackground) || Color.white;\n        this._register(themeService.onDidColorThemeChange(theme => {\n            this.backgroundColor = theme.getColor(editorHoverBackground) || Color.white;\n        }));\n        this._register(dom.addDisposableListener(this._pickedColorNode, dom.EventType.CLICK, () => this.model.selectNextColorPresentation()));\n        this._register(dom.addDisposableListener(this._originalColorNode, dom.EventType.CLICK, () => {\n            this.model.color = this.model.originalColor;\n            this.model.flushColor();\n        }));\n        this._register(model.onDidChangeColor(this.onDidChangeColor, this));\n        this._register(model.onDidChangePresentation(this.onDidChangePresentation, this));\n        this._pickedColorNode.style.backgroundColor = Color.Format.CSS.format(model.color) || '';\n        this._pickedColorNode.classList.toggle('light', model.color.rgba.a < 0.5 ? this.backgroundColor.isLighter() : model.color.isLighter());\n        this.onDidChangeColor(this.model.color);\n        // When the color picker widget is a standalone color picker widget, then add a close button\n        if (this.showingStandaloneColorPicker) {\n            this._domNode.classList.add('standalone-colorpicker');\n            this._closeButton = this._register(new CloseButton(this._domNode));\n        }\n    }\n    get closeButton() {\n        return this._closeButton;\n    }\n    get pickedColorNode() {\n        return this._pickedColorNode;\n    }\n    get originalColorNode() {\n        return this._originalColorNode;\n    }\n    onDidChangeColor(color) {\n        this._pickedColorNode.style.backgroundColor = Color.Format.CSS.format(color) || '';\n        this._pickedColorNode.classList.toggle('light', color.rgba.a < 0.5 ? this.backgroundColor.isLighter() : color.isLighter());\n        this.onDidChangePresentation();\n    }\n    onDidChangePresentation() {\n        this._pickedColorPresentation.textContent = this.model.presentation ? this.model.presentation.label : '';\n    }\n}\nclass CloseButton extends Disposable {\n    constructor(container) {\n        super();\n        this._onClicked = this._register(new Emitter());\n        this.onClicked = this._onClicked.event;\n        this._button = document.createElement('div');\n        this._button.classList.add('close-button');\n        dom.append(container, this._button);\n        const innerDiv = document.createElement('div');\n        innerDiv.classList.add('close-button-inner-div');\n        dom.append(this._button, innerDiv);\n        const closeButton = dom.append(innerDiv, $('.button' + ThemeIcon.asCSSSelector(registerIcon('color-picker-close', Codicon.close, localize('closeIcon', 'Icon to close the color picker')))));\n        closeButton.classList.add('close-icon');\n        this._register(dom.addDisposableListener(this._button, dom.EventType.CLICK, () => {\n            this._onClicked.fire();\n        }));\n    }\n}\nexport class ColorPickerBody extends Disposable {\n    constructor(container, model, pixelRatio, isStandaloneColorPicker = false) {\n        super();\n        this.model = model;\n        this.pixelRatio = pixelRatio;\n        this._insertButton = null;\n        this._domNode = $('.colorpicker-body');\n        dom.append(container, this._domNode);\n        this._saturationBox = new SaturationBox(this._domNode, this.model, this.pixelRatio);\n        this._register(this._saturationBox);\n        this._register(this._saturationBox.onDidChange(this.onDidSaturationValueChange, this));\n        this._register(this._saturationBox.onColorFlushed(this.flushColor, this));\n        this._opacityStrip = new OpacityStrip(this._domNode, this.model, isStandaloneColorPicker);\n        this._register(this._opacityStrip);\n        this._register(this._opacityStrip.onDidChange(this.onDidOpacityChange, this));\n        this._register(this._opacityStrip.onColorFlushed(this.flushColor, this));\n        this._hueStrip = new HueStrip(this._domNode, this.model, isStandaloneColorPicker);\n        this._register(this._hueStrip);\n        this._register(this._hueStrip.onDidChange(this.onDidHueChange, this));\n        this._register(this._hueStrip.onColorFlushed(this.flushColor, this));\n        if (isStandaloneColorPicker) {\n            this._insertButton = this._register(new InsertButton(this._domNode));\n            this._domNode.classList.add('standalone-colorpicker');\n        }\n    }\n    flushColor() {\n        this.model.flushColor();\n    }\n    onDidSaturationValueChange({ s, v }) {\n        const hsva = this.model.color.hsva;\n        this.model.color = new Color(new HSVA(hsva.h, s, v, hsva.a));\n    }\n    onDidOpacityChange(a) {\n        const hsva = this.model.color.hsva;\n        this.model.color = new Color(new HSVA(hsva.h, hsva.s, hsva.v, a));\n    }\n    onDidHueChange(value) {\n        const hsva = this.model.color.hsva;\n        const h = (1 - value) * 360;\n        this.model.color = new Color(new HSVA(h === 360 ? 0 : h, hsva.s, hsva.v, hsva.a));\n    }\n    get domNode() {\n        return this._domNode;\n    }\n    get saturationBox() {\n        return this._saturationBox;\n    }\n    get enterButton() {\n        return this._insertButton;\n    }\n    layout() {\n        this._saturationBox.layout();\n        this._opacityStrip.layout();\n        this._hueStrip.layout();\n    }\n}\nclass SaturationBox extends Disposable {\n    constructor(container, model, pixelRatio) {\n        super();\n        this.model = model;\n        this.pixelRatio = pixelRatio;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._onColorFlushed = new Emitter();\n        this.onColorFlushed = this._onColorFlushed.event;\n        this._domNode = $('.saturation-wrap');\n        dom.append(container, this._domNode);\n        // Create canvas, draw selected color\n        this._canvas = document.createElement('canvas');\n        this._canvas.className = 'saturation-box';\n        dom.append(this._domNode, this._canvas);\n        // Add selection circle\n        this.selection = $('.saturation-selection');\n        dom.append(this._domNode, this.selection);\n        this.layout();\n        this._register(dom.addDisposableListener(this._domNode, dom.EventType.POINTER_DOWN, e => this.onPointerDown(e)));\n        this._register(this.model.onDidChangeColor(this.onDidChangeColor, this));\n        this.monitor = null;\n    }\n    get domNode() {\n        return this._domNode;\n    }\n    onPointerDown(e) {\n        if (!e.target || !(e.target instanceof Element)) {\n            return;\n        }\n        this.monitor = this._register(new GlobalPointerMoveMonitor());\n        const origin = dom.getDomNodePagePosition(this._domNode);\n        if (e.target !== this.selection) {\n            this.onDidChangePosition(e.offsetX, e.offsetY);\n        }\n        this.monitor.startMonitoring(e.target, e.pointerId, e.buttons, event => this.onDidChangePosition(event.pageX - origin.left, event.pageY - origin.top), () => null);\n        const pointerUpListener = dom.addDisposableListener(e.target.ownerDocument, dom.EventType.POINTER_UP, () => {\n            this._onColorFlushed.fire();\n            pointerUpListener.dispose();\n            if (this.monitor) {\n                this.monitor.stopMonitoring(true);\n                this.monitor = null;\n            }\n        }, true);\n    }\n    onDidChangePosition(left, top) {\n        const s = Math.max(0, Math.min(1, left / this.width));\n        const v = Math.max(0, Math.min(1, 1 - (top / this.height)));\n        this.paintSelection(s, v);\n        this._onDidChange.fire({ s, v });\n    }\n    layout() {\n        this.width = this._domNode.offsetWidth;\n        this.height = this._domNode.offsetHeight;\n        this._canvas.width = this.width * this.pixelRatio;\n        this._canvas.height = this.height * this.pixelRatio;\n        this.paint();\n        const hsva = this.model.color.hsva;\n        this.paintSelection(hsva.s, hsva.v);\n    }\n    paint() {\n        const hsva = this.model.color.hsva;\n        const saturatedColor = new Color(new HSVA(hsva.h, 1, 1, 1));\n        const ctx = this._canvas.getContext('2d');\n        const whiteGradient = ctx.createLinearGradient(0, 0, this._canvas.width, 0);\n        whiteGradient.addColorStop(0, 'rgba(255, 255, 255, 1)');\n        whiteGradient.addColorStop(0.5, 'rgba(255, 255, 255, 0.5)');\n        whiteGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');\n        const blackGradient = ctx.createLinearGradient(0, 0, 0, this._canvas.height);\n        blackGradient.addColorStop(0, 'rgba(0, 0, 0, 0)');\n        blackGradient.addColorStop(1, 'rgba(0, 0, 0, 1)');\n        ctx.rect(0, 0, this._canvas.width, this._canvas.height);\n        ctx.fillStyle = Color.Format.CSS.format(saturatedColor);\n        ctx.fill();\n        ctx.fillStyle = whiteGradient;\n        ctx.fill();\n        ctx.fillStyle = blackGradient;\n        ctx.fill();\n    }\n    paintSelection(s, v) {\n        this.selection.style.left = `${s * this.width}px`;\n        this.selection.style.top = `${this.height - v * this.height}px`;\n    }\n    onDidChangeColor(color) {\n        if (this.monitor && this.monitor.isMonitoring()) {\n            return;\n        }\n        this.paint();\n        const hsva = color.hsva;\n        this.paintSelection(hsva.s, hsva.v);\n    }\n}\nclass Strip extends Disposable {\n    constructor(container, model, showingStandaloneColorPicker = false) {\n        super();\n        this.model = model;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._onColorFlushed = new Emitter();\n        this.onColorFlushed = this._onColorFlushed.event;\n        if (showingStandaloneColorPicker) {\n            this.domNode = dom.append(container, $('.standalone-strip'));\n            this.overlay = dom.append(this.domNode, $('.standalone-overlay'));\n        }\n        else {\n            this.domNode = dom.append(container, $('.strip'));\n            this.overlay = dom.append(this.domNode, $('.overlay'));\n        }\n        this.slider = dom.append(this.domNode, $('.slider'));\n        this.slider.style.top = `0px`;\n        this._register(dom.addDisposableListener(this.domNode, dom.EventType.POINTER_DOWN, e => this.onPointerDown(e)));\n        this._register(model.onDidChangeColor(this.onDidChangeColor, this));\n        this.layout();\n    }\n    layout() {\n        this.height = this.domNode.offsetHeight - this.slider.offsetHeight;\n        const value = this.getValue(this.model.color);\n        this.updateSliderPosition(value);\n    }\n    onDidChangeColor(color) {\n        const value = this.getValue(color);\n        this.updateSliderPosition(value);\n    }\n    onPointerDown(e) {\n        if (!e.target || !(e.target instanceof Element)) {\n            return;\n        }\n        const monitor = this._register(new GlobalPointerMoveMonitor());\n        const origin = dom.getDomNodePagePosition(this.domNode);\n        this.domNode.classList.add('grabbing');\n        if (e.target !== this.slider) {\n            this.onDidChangeTop(e.offsetY);\n        }\n        monitor.startMonitoring(e.target, e.pointerId, e.buttons, event => this.onDidChangeTop(event.pageY - origin.top), () => null);\n        const pointerUpListener = dom.addDisposableListener(e.target.ownerDocument, dom.EventType.POINTER_UP, () => {\n            this._onColorFlushed.fire();\n            pointerUpListener.dispose();\n            monitor.stopMonitoring(true);\n            this.domNode.classList.remove('grabbing');\n        }, true);\n    }\n    onDidChangeTop(top) {\n        const value = Math.max(0, Math.min(1, 1 - (top / this.height)));\n        this.updateSliderPosition(value);\n        this._onDidChange.fire(value);\n    }\n    updateSliderPosition(value) {\n        this.slider.style.top = `${(1 - value) * this.height}px`;\n    }\n}\nclass OpacityStrip extends Strip {\n    constructor(container, model, showingStandaloneColorPicker = false) {\n        super(container, model, showingStandaloneColorPicker);\n        this.domNode.classList.add('opacity-strip');\n        this.onDidChangeColor(this.model.color);\n    }\n    onDidChangeColor(color) {\n        super.onDidChangeColor(color);\n        const { r, g, b } = color.rgba;\n        const opaque = new Color(new RGBA(r, g, b, 1));\n        const transparent = new Color(new RGBA(r, g, b, 0));\n        this.overlay.style.background = `linear-gradient(to bottom, ${opaque} 0%, ${transparent} 100%)`;\n    }\n    getValue(color) {\n        return color.hsva.a;\n    }\n}\nclass HueStrip extends Strip {\n    constructor(container, model, showingStandaloneColorPicker = false) {\n        super(container, model, showingStandaloneColorPicker);\n        this.domNode.classList.add('hue-strip');\n    }\n    getValue(color) {\n        return 1 - (color.hsva.h / 360);\n    }\n}\nexport class InsertButton extends Disposable {\n    constructor(container) {\n        super();\n        this._onClicked = this._register(new Emitter());\n        this.onClicked = this._onClicked.event;\n        this._button = dom.append(container, document.createElement('button'));\n        this._button.classList.add('insert-button');\n        this._button.textContent = 'Insert';\n        this._register(dom.addDisposableListener(this._button, dom.EventType.CLICK, () => {\n            this._onClicked.fire();\n        }));\n    }\n    get button() {\n        return this._button;\n    }\n}\nexport class ColorPickerWidget extends Widget {\n    constructor(container, model, pixelRatio, themeService, standaloneColorPicker = false) {\n        super();\n        this.model = model;\n        this.pixelRatio = pixelRatio;\n        this._register(PixelRatio.getInstance(dom.getWindow(container)).onDidChange(() => this.layout()));\n        this._domNode = $('.colorpicker-widget');\n        container.appendChild(this._domNode);\n        this.header = this._register(new ColorPickerHeader(this._domNode, this.model, themeService, standaloneColorPicker));\n        this.body = this._register(new ColorPickerBody(this._domNode, this.model, this.pixelRatio, standaloneColorPicker));\n    }\n    layout() {\n        this.body.layout();\n    }\n    get domNode() {\n        return this._domNode;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class HoverRangeAnchor {\n    constructor(priority, range, initialMousePosX, initialMousePosY) {\n        this.priority = priority;\n        this.range = range;\n        this.initialMousePosX = initialMousePosX;\n        this.initialMousePosY = initialMousePosY;\n        this.type = 1 /* HoverAnchorType.Range */;\n    }\n    equals(other) {\n        return (other.type === 1 /* HoverAnchorType.Range */ && this.range.equalsRange(other.range));\n    }\n    canAdoptVisibleHover(lastAnchor, showAtPosition) {\n        return (lastAnchor.type === 1 /* HoverAnchorType.Range */ && showAtPosition.lineNumber === this.range.startLineNumber);\n    }\n}\nexport class HoverForeignElementAnchor {\n    constructor(priority, owner, range, initialMousePosX, initialMousePosY, supportsMarkerHover) {\n        this.priority = priority;\n        this.owner = owner;\n        this.range = range;\n        this.initialMousePosX = initialMousePosX;\n        this.initialMousePosY = initialMousePosY;\n        this.supportsMarkerHover = supportsMarkerHover;\n        this.type = 2 /* HoverAnchorType.ForeignElement */;\n    }\n    equals(other) {\n        return (other.type === 2 /* HoverAnchorType.ForeignElement */ && this.owner === other.owner);\n    }\n    canAdoptVisibleHover(lastAnchor, showAtPosition) {\n        return (lastAnchor.type === 2 /* HoverAnchorType.ForeignElement */ && this.owner === lastAnchor.owner);\n    }\n}\n/**\n * Default implementation of IRenderedHoverParts.\n */\nexport class RenderedHoverParts {\n    constructor(renderedHoverParts) {\n        this.renderedHoverParts = renderedHoverParts;\n    }\n    dispose() {\n        for (const part of this.renderedHoverParts) {\n            part.dispose();\n        }\n    }\n}\nexport const HoverParticipantRegistry = (new class HoverParticipantRegistry {\n    constructor() {\n        this._participants = [];\n    }\n    register(ctor) {\n        this._participants.push(ctor);\n    }\n    getAll() {\n        return this._participants;\n    }\n}());\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Color, RGBA } from '../../../../base/common/color.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { Range } from '../../../common/core/range.js';\nimport { getColorPresentations, getColors } from './color.js';\nimport { ColorDetector } from './colorDetector.js';\nimport { ColorPickerModel } from './colorPickerModel.js';\nimport { ColorPickerWidget } from './colorPickerWidget.js';\nimport { RenderedHoverParts } from '../../hover/browser/hoverTypes.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { Dimension } from '../../../../base/browser/dom.js';\nexport class ColorHover {\n    constructor(owner, range, model, provider) {\n        this.owner = owner;\n        this.range = range;\n        this.model = model;\n        this.provider = provider;\n        /**\n         * Force the hover to always be rendered at this specific range,\n         * even in the case of multiple hover parts.\n         */\n        this.forceShowAtRange = true;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* HoverAnchorType.Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n}\nlet ColorHoverParticipant = class ColorHoverParticipant {\n    constructor(_editor, _themeService) {\n        this._editor = _editor;\n        this._themeService = _themeService;\n        this.hoverOrdinal = 2;\n    }\n    computeSync(_anchor, _lineDecorations) {\n        return [];\n    }\n    computeAsync(anchor, lineDecorations, token) {\n        return AsyncIterableObject.fromPromise(this._computeAsync(anchor, lineDecorations, token));\n    }\n    async _computeAsync(_anchor, lineDecorations, _token) {\n        if (!this._editor.hasModel()) {\n            return [];\n        }\n        const colorDetector = ColorDetector.get(this._editor);\n        if (!colorDetector) {\n            return [];\n        }\n        for (const d of lineDecorations) {\n            if (!colorDetector.isColorDecoration(d)) {\n                continue;\n            }\n            const colorData = colorDetector.getColorData(d.range.getStartPosition());\n            if (colorData) {\n                const colorHover = await _createColorHover(this, this._editor.getModel(), colorData.colorInfo, colorData.provider);\n                return [colorHover];\n            }\n        }\n        return [];\n    }\n    renderHoverParts(context, hoverParts) {\n        const renderedPart = renderHoverParts(this, this._editor, this._themeService, hoverParts, context);\n        if (!renderedPart) {\n            return new RenderedHoverParts([]);\n        }\n        this._colorPicker = renderedPart.colorPicker;\n        const renderedHoverPart = {\n            hoverPart: renderedPart.hoverPart,\n            hoverElement: this._colorPicker.domNode,\n            dispose() { renderedPart.disposables.dispose(); }\n        };\n        return new RenderedHoverParts([renderedHoverPart]);\n    }\n    handleResize() {\n        this._colorPicker?.layout();\n    }\n    isColorPickerVisible() {\n        return !!this._colorPicker;\n    }\n};\nColorHoverParticipant = __decorate([\n    __param(1, IThemeService)\n], ColorHoverParticipant);\nexport { ColorHoverParticipant };\nexport class StandaloneColorPickerHover {\n    constructor(owner, range, model, provider) {\n        this.owner = owner;\n        this.range = range;\n        this.model = model;\n        this.provider = provider;\n    }\n}\nlet StandaloneColorPickerParticipant = class StandaloneColorPickerParticipant {\n    constructor(_editor, _themeService) {\n        this._editor = _editor;\n        this._themeService = _themeService;\n        this._color = null;\n    }\n    async createColorHover(defaultColorInfo, defaultColorProvider, colorProviderRegistry) {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        const colorDetector = ColorDetector.get(this._editor);\n        if (!colorDetector) {\n            return null;\n        }\n        const colors = await getColors(colorProviderRegistry, this._editor.getModel(), CancellationToken.None);\n        let foundColorInfo = null;\n        let foundColorProvider = null;\n        for (const colorData of colors) {\n            const colorInfo = colorData.colorInfo;\n            if (Range.containsRange(colorInfo.range, defaultColorInfo.range)) {\n                foundColorInfo = colorInfo;\n                foundColorProvider = colorData.provider;\n            }\n        }\n        const colorInfo = foundColorInfo ?? defaultColorInfo;\n        const colorProvider = foundColorProvider ?? defaultColorProvider;\n        const foundInEditor = !!foundColorInfo;\n        return { colorHover: await _createColorHover(this, this._editor.getModel(), colorInfo, colorProvider), foundInEditor: foundInEditor };\n    }\n    async updateEditorModel(colorHoverData) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const colorPickerModel = colorHoverData.model;\n        let range = new Range(colorHoverData.range.startLineNumber, colorHoverData.range.startColumn, colorHoverData.range.endLineNumber, colorHoverData.range.endColumn);\n        if (this._color) {\n            await _updateColorPresentations(this._editor.getModel(), colorPickerModel, this._color, range, colorHoverData);\n            range = _updateEditorModel(this._editor, range, colorPickerModel);\n        }\n    }\n    renderHoverParts(context, hoverParts) {\n        return renderHoverParts(this, this._editor, this._themeService, hoverParts, context);\n    }\n    set color(color) {\n        this._color = color;\n    }\n    get color() {\n        return this._color;\n    }\n};\nStandaloneColorPickerParticipant = __decorate([\n    __param(1, IThemeService)\n], StandaloneColorPickerParticipant);\nexport { StandaloneColorPickerParticipant };\nasync function _createColorHover(participant, editorModel, colorInfo, provider) {\n    const originalText = editorModel.getValueInRange(colorInfo.range);\n    const { red, green, blue, alpha } = colorInfo.color;\n    const rgba = new RGBA(Math.round(red * 255), Math.round(green * 255), Math.round(blue * 255), alpha);\n    const color = new Color(rgba);\n    const colorPresentations = await getColorPresentations(editorModel, colorInfo, provider, CancellationToken.None);\n    const model = new ColorPickerModel(color, [], 0);\n    model.colorPresentations = colorPresentations || [];\n    model.guessColorPresentation(color, originalText);\n    if (participant instanceof ColorHoverParticipant) {\n        return new ColorHover(participant, Range.lift(colorInfo.range), model, provider);\n    }\n    else {\n        return new StandaloneColorPickerHover(participant, Range.lift(colorInfo.range), model, provider);\n    }\n}\nfunction renderHoverParts(participant, editor, themeService, hoverParts, context) {\n    if (hoverParts.length === 0 || !editor.hasModel()) {\n        return undefined;\n    }\n    if (context.setMinimumDimensions) {\n        const minimumHeight = editor.getOption(67 /* EditorOption.lineHeight */) + 8;\n        context.setMinimumDimensions(new Dimension(302, minimumHeight));\n    }\n    const disposables = new DisposableStore();\n    const colorHover = hoverParts[0];\n    const editorModel = editor.getModel();\n    const model = colorHover.model;\n    const colorPicker = disposables.add(new ColorPickerWidget(context.fragment, model, editor.getOption(144 /* EditorOption.pixelRatio */), themeService, participant instanceof StandaloneColorPickerParticipant));\n    let editorUpdatedByColorPicker = false;\n    let range = new Range(colorHover.range.startLineNumber, colorHover.range.startColumn, colorHover.range.endLineNumber, colorHover.range.endColumn);\n    if (participant instanceof StandaloneColorPickerParticipant) {\n        const color = colorHover.model.color;\n        participant.color = color;\n        _updateColorPresentations(editorModel, model, color, range, colorHover);\n        disposables.add(model.onColorFlushed((color) => {\n            participant.color = color;\n        }));\n    }\n    else {\n        disposables.add(model.onColorFlushed(async (color) => {\n            await _updateColorPresentations(editorModel, model, color, range, colorHover);\n            editorUpdatedByColorPicker = true;\n            range = _updateEditorModel(editor, range, model);\n        }));\n    }\n    disposables.add(model.onDidChangeColor((color) => {\n        _updateColorPresentations(editorModel, model, color, range, colorHover);\n    }));\n    disposables.add(editor.onDidChangeModelContent((e) => {\n        if (editorUpdatedByColorPicker) {\n            editorUpdatedByColorPicker = false;\n        }\n        else {\n            context.hide();\n            editor.focus();\n        }\n    }));\n    return { hoverPart: colorHover, colorPicker, disposables };\n}\nfunction _updateEditorModel(editor, range, model) {\n    const textEdits = [];\n    const edit = model.presentation.textEdit ?? { range, text: model.presentation.label, forceMoveMarkers: false };\n    textEdits.push(edit);\n    if (model.presentation.additionalTextEdits) {\n        textEdits.push(...model.presentation.additionalTextEdits);\n    }\n    const replaceRange = Range.lift(edit.range);\n    const trackedRange = editor.getModel()._setTrackedRange(null, replaceRange, 3 /* TrackedRangeStickiness.GrowsOnlyWhenTypingAfter */);\n    editor.executeEdits('colorpicker', textEdits);\n    editor.pushUndoStop();\n    return editor.getModel()._getTrackedRange(trackedRange) ?? replaceRange;\n}\nasync function _updateColorPresentations(editorModel, colorPickerModel, color, range, colorHover) {\n    const colorPresentations = await getColorPresentations(editorModel, {\n        range: range,\n        color: {\n            red: color.rgba.r / 255,\n            green: color.rgba.g / 255,\n            blue: color.rgba.b / 255,\n            alpha: color.rgba.a\n        }\n    }, colorHover.provider, CancellationToken.None);\n    colorPickerModel.colorPresentations = colorPresentations || [];\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as nls from '../../../../nls.js';\nexport const SHOW_OR_FOCUS_HOVER_ACTION_ID = 'editor.action.showHover';\nexport const SHOW_DEFINITION_PREVIEW_HOVER_ACTION_ID = 'editor.action.showDefinitionPreviewHover';\nexport const SCROLL_UP_HOVER_ACTION_ID = 'editor.action.scrollUpHover';\nexport const SCROLL_DOWN_HOVER_ACTION_ID = 'editor.action.scrollDownHover';\nexport const SCROLL_LEFT_HOVER_ACTION_ID = 'editor.action.scrollLeftHover';\nexport const SCROLL_RIGHT_HOVER_ACTION_ID = 'editor.action.scrollRightHover';\nexport const PAGE_UP_HOVER_ACTION_ID = 'editor.action.pageUpHover';\nexport const PAGE_DOWN_HOVER_ACTION_ID = 'editor.action.pageDownHover';\nexport const GO_TO_TOP_HOVER_ACTION_ID = 'editor.action.goToTopHover';\nexport const GO_TO_BOTTOM_HOVER_ACTION_ID = 'editor.action.goToBottomHover';\nexport const INCREASE_HOVER_VERBOSITY_ACTION_ID = 'editor.action.increaseHoverVerbosityLevel';\nexport const INCREASE_HOVER_VERBOSITY_ACTION_LABEL = nls.localize({ key: 'increaseHoverVerbosityLevel', comment: ['Label for action that will increase the hover verbosity level.'] }, \"Increase Hover Verbosity Level\");\nexport const DECREASE_HOVER_VERBOSITY_ACTION_ID = 'editor.action.decreaseHoverVerbosityLevel';\nexport const DECREASE_HOVER_VERBOSITY_ACTION_LABEL = nls.localize({ key: 'decreaseHoverVerbosityLevel', comment: ['Label for action that will decrease the hover verbosity level.'] }, \"Decrease Hover Verbosity Level\");\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport const inlineSuggestCommitId = 'editor.action.inlineSuggest.commit';\nexport const showPreviousInlineSuggestionActionId = 'editor.action.inlineSuggest.showPrevious';\nexport const showNextInlineSuggestionActionId = 'editor.action.inlineSuggest.showNext';\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InlineSuggestionHintsContentWidget_1;\nimport { h } from '../../../../../base/browser/dom.js';\nimport { ActionViewItem } from '../../../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { KeybindingLabel, unthemedKeybindingLabelOptions } from '../../../../../base/browser/ui/keybindingLabel/keybindingLabel.js';\nimport { Action, Separator } from '../../../../../base/common/actions.js';\nimport { equals } from '../../../../../base/common/arrays.js';\nimport { RunOnceScheduler } from '../../../../../base/common/async.js';\nimport { Codicon } from '../../../../../base/common/codicons.js';\nimport { Disposable, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { autorun, autorunWithStore, derived, derivedObservableWithCache, observableFromEvent } from '../../../../../base/common/observable.js';\nimport { derivedWithStore } from '../../../../../base/common/observableInternal/derived.js';\nimport { OS } from '../../../../../base/common/platform.js';\nimport { ThemeIcon } from '../../../../../base/common/themables.js';\nimport './inlineCompletionsHintsWidget.css';\nimport { Position } from '../../../../common/core/position.js';\nimport { InlineCompletionTriggerKind } from '../../../../common/languages.js';\nimport { showNextInlineSuggestionActionId, showPreviousInlineSuggestionActionId } from '../controller/commandIds.js';\nimport { localize } from '../../../../../nls.js';\nimport { MenuEntryActionViewItem, createAndFillInActionBarActions } from '../../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { WorkbenchToolBar } from '../../../../../platform/actions/browser/toolbar.js';\nimport { IMenuService, MenuId, MenuItemAction } from '../../../../../platform/actions/common/actions.js';\nimport { ICommandService } from '../../../../../platform/commands/common/commands.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ITelemetryService } from '../../../../../platform/telemetry/common/telemetry.js';\nimport { registerIcon } from '../../../../../platform/theme/common/iconRegistry.js';\nlet InlineCompletionsHintsWidget = class InlineCompletionsHintsWidget extends Disposable {\n    constructor(editor, model, instantiationService) {\n        super();\n        this.editor = editor;\n        this.model = model;\n        this.instantiationService = instantiationService;\n        this.alwaysShowToolbar = observableFromEvent(this, this.editor.onDidChangeConfiguration, () => this.editor.getOption(62 /* EditorOption.inlineSuggest */).showToolbar === 'always');\n        this.sessionPosition = undefined;\n        this.position = derived(this, reader => {\n            const ghostText = this.model.read(reader)?.primaryGhostText.read(reader);\n            if (!this.alwaysShowToolbar.read(reader) || !ghostText || ghostText.parts.length === 0) {\n                this.sessionPosition = undefined;\n                return null;\n            }\n            const firstColumn = ghostText.parts[0].column;\n            if (this.sessionPosition && this.sessionPosition.lineNumber !== ghostText.lineNumber) {\n                this.sessionPosition = undefined;\n            }\n            const position = new Position(ghostText.lineNumber, Math.min(firstColumn, this.sessionPosition?.column ?? Number.MAX_SAFE_INTEGER));\n            this.sessionPosition = position;\n            return position;\n        });\n        this._register(autorunWithStore((reader, store) => {\n            /** @description setup content widget */\n            const model = this.model.read(reader);\n            if (!model || !this.alwaysShowToolbar.read(reader)) {\n                return;\n            }\n            const contentWidgetValue = derivedWithStore((reader, store) => {\n                const contentWidget = store.add(this.instantiationService.createInstance(InlineSuggestionHintsContentWidget, this.editor, true, this.position, model.selectedInlineCompletionIndex, model.inlineCompletionsCount, model.activeCommands));\n                editor.addContentWidget(contentWidget);\n                store.add(toDisposable(() => editor.removeContentWidget(contentWidget)));\n                store.add(autorun(reader => {\n                    /** @description request explicit */\n                    const position = this.position.read(reader);\n                    if (!position) {\n                        return;\n                    }\n                    if (model.lastTriggerKind.read(reader) !== InlineCompletionTriggerKind.Explicit) {\n                        model.triggerExplicitly();\n                    }\n                }));\n                return contentWidget;\n            });\n            const hadPosition = derivedObservableWithCache(this, (reader, lastValue) => !!this.position.read(reader) || !!lastValue);\n            store.add(autorun(reader => {\n                if (hadPosition.read(reader)) {\n                    contentWidgetValue.read(reader);\n                }\n            }));\n        }));\n    }\n};\nInlineCompletionsHintsWidget = __decorate([\n    __param(2, IInstantiationService)\n], InlineCompletionsHintsWidget);\nexport { InlineCompletionsHintsWidget };\nconst inlineSuggestionHintsNextIcon = registerIcon('inline-suggestion-hints-next', Codicon.chevronRight, localize('parameterHintsNextIcon', 'Icon for show next parameter hint.'));\nconst inlineSuggestionHintsPreviousIcon = registerIcon('inline-suggestion-hints-previous', Codicon.chevronLeft, localize('parameterHintsPreviousIcon', 'Icon for show previous parameter hint.'));\nlet InlineSuggestionHintsContentWidget = class InlineSuggestionHintsContentWidget extends Disposable {\n    static { InlineSuggestionHintsContentWidget_1 = this; }\n    static { this._dropDownVisible = false; }\n    static get dropDownVisible() { return this._dropDownVisible; }\n    static { this.id = 0; }\n    createCommandAction(commandId, label, iconClassName) {\n        const action = new Action(commandId, label, iconClassName, true, () => this._commandService.executeCommand(commandId));\n        const kb = this.keybindingService.lookupKeybinding(commandId, this._contextKeyService);\n        let tooltip = label;\n        if (kb) {\n            tooltip = localize({ key: 'content', comment: ['A label', 'A keybinding'] }, '{0} ({1})', label, kb.getLabel());\n        }\n        action.tooltip = tooltip;\n        return action;\n    }\n    constructor(editor, withBorder, _position, _currentSuggestionIdx, _suggestionCount, _extraCommands, _commandService, instantiationService, keybindingService, _contextKeyService, _menuService) {\n        super();\n        this.editor = editor;\n        this.withBorder = withBorder;\n        this._position = _position;\n        this._currentSuggestionIdx = _currentSuggestionIdx;\n        this._suggestionCount = _suggestionCount;\n        this._extraCommands = _extraCommands;\n        this._commandService = _commandService;\n        this.keybindingService = keybindingService;\n        this._contextKeyService = _contextKeyService;\n        this._menuService = _menuService;\n        this.id = `InlineSuggestionHintsContentWidget${InlineSuggestionHintsContentWidget_1.id++}`;\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = false;\n        this.nodes = h('div.inlineSuggestionsHints', { className: this.withBorder ? '.withBorder' : '' }, [\n            h('div@toolBar'),\n        ]);\n        this.previousAction = this.createCommandAction(showPreviousInlineSuggestionActionId, localize('previous', 'Previous'), ThemeIcon.asClassName(inlineSuggestionHintsPreviousIcon));\n        this.availableSuggestionCountAction = new Action('inlineSuggestionHints.availableSuggestionCount', '', undefined, false);\n        this.nextAction = this.createCommandAction(showNextInlineSuggestionActionId, localize('next', 'Next'), ThemeIcon.asClassName(inlineSuggestionHintsNextIcon));\n        // TODO@hediet: deprecate MenuId.InlineCompletionsActions\n        this.inlineCompletionsActionsMenus = this._register(this._menuService.createMenu(MenuId.InlineCompletionsActions, this._contextKeyService));\n        this.clearAvailableSuggestionCountLabelDebounced = this._register(new RunOnceScheduler(() => {\n            this.availableSuggestionCountAction.label = '';\n        }, 100));\n        this.disableButtonsDebounced = this._register(new RunOnceScheduler(() => {\n            this.previousAction.enabled = this.nextAction.enabled = false;\n        }, 100));\n        this.toolBar = this._register(instantiationService.createInstance(CustomizedMenuWorkbenchToolBar, this.nodes.toolBar, MenuId.InlineSuggestionToolbar, {\n            menuOptions: { renderShortTitle: true },\n            toolbarOptions: { primaryGroup: g => g.startsWith('primary') },\n            actionViewItemProvider: (action, options) => {\n                if (action instanceof MenuItemAction) {\n                    return instantiationService.createInstance(StatusBarViewItem, action, undefined);\n                }\n                if (action === this.availableSuggestionCountAction) {\n                    const a = new ActionViewItemWithClassName(undefined, action, { label: true, icon: false });\n                    a.setClass('availableSuggestionCount');\n                    return a;\n                }\n                return undefined;\n            },\n            telemetrySource: 'InlineSuggestionToolbar',\n        }));\n        this.toolBar.setPrependedPrimaryActions([\n            this.previousAction,\n            this.availableSuggestionCountAction,\n            this.nextAction,\n        ]);\n        this._register(this.toolBar.onDidChangeDropdownVisibility(e => {\n            InlineSuggestionHintsContentWidget_1._dropDownVisible = e;\n        }));\n        this._register(autorun(reader => {\n            /** @description update position */\n            this._position.read(reader);\n            this.editor.layoutContentWidget(this);\n        }));\n        this._register(autorun(reader => {\n            /** @description counts */\n            const suggestionCount = this._suggestionCount.read(reader);\n            const currentSuggestionIdx = this._currentSuggestionIdx.read(reader);\n            if (suggestionCount !== undefined) {\n                this.clearAvailableSuggestionCountLabelDebounced.cancel();\n                this.availableSuggestionCountAction.label = `${currentSuggestionIdx + 1}/${suggestionCount}`;\n            }\n            else {\n                this.clearAvailableSuggestionCountLabelDebounced.schedule();\n            }\n            if (suggestionCount !== undefined && suggestionCount > 1) {\n                this.disableButtonsDebounced.cancel();\n                this.previousAction.enabled = this.nextAction.enabled = true;\n            }\n            else {\n                this.disableButtonsDebounced.schedule();\n            }\n        }));\n        this._register(autorun(reader => {\n            /** @description extra commands */\n            const extraCommands = this._extraCommands.read(reader);\n            const extraActions = extraCommands.map(c => ({\n                class: undefined,\n                id: c.id,\n                enabled: true,\n                tooltip: c.tooltip || '',\n                label: c.title,\n                run: (event) => {\n                    return this._commandService.executeCommand(c.id);\n                },\n            }));\n            for (const [_, group] of this.inlineCompletionsActionsMenus.getActions()) {\n                for (const action of group) {\n                    if (action instanceof MenuItemAction) {\n                        extraActions.push(action);\n                    }\n                }\n            }\n            if (extraActions.length > 0) {\n                extraActions.unshift(new Separator());\n            }\n            this.toolBar.setAdditionalSecondaryActions(extraActions);\n        }));\n    }\n    getId() { return this.id; }\n    getDomNode() {\n        return this.nodes.root;\n    }\n    getPosition() {\n        return {\n            position: this._position.get(),\n            preference: [1 /* ContentWidgetPositionPreference.ABOVE */, 2 /* ContentWidgetPositionPreference.BELOW */],\n            positionAffinity: 3 /* PositionAffinity.LeftOfInjectedText */,\n        };\n    }\n};\nInlineSuggestionHintsContentWidget = InlineSuggestionHintsContentWidget_1 = __decorate([\n    __param(6, ICommandService),\n    __param(7, IInstantiationService),\n    __param(8, IKeybindingService),\n    __param(9, IContextKeyService),\n    __param(10, IMenuService)\n], InlineSuggestionHintsContentWidget);\nexport { InlineSuggestionHintsContentWidget };\nclass ActionViewItemWithClassName extends ActionViewItem {\n    constructor() {\n        super(...arguments);\n        this._className = undefined;\n    }\n    setClass(className) {\n        this._className = className;\n    }\n    render(container) {\n        super.render(container);\n        if (this._className) {\n            container.classList.add(this._className);\n        }\n    }\n    updateTooltip() {\n        // NOOP, disable tooltip\n    }\n}\nclass StatusBarViewItem extends MenuEntryActionViewItem {\n    updateLabel() {\n        const kb = this._keybindingService.lookupKeybinding(this._action.id, this._contextKeyService);\n        if (!kb) {\n            return super.updateLabel();\n        }\n        if (this.label) {\n            const div = h('div.keybinding').root;\n            const k = this._register(new KeybindingLabel(div, OS, { disableTitle: true, ...unthemedKeybindingLabelOptions }));\n            k.set(kb);\n            this.label.textContent = this._action.label;\n            this.label.appendChild(div);\n            this.label.classList.add('inlineSuggestionStatusBarItemLabel');\n        }\n    }\n    updateTooltip() {\n        // NOOP, disable tooltip\n    }\n}\nlet CustomizedMenuWorkbenchToolBar = class CustomizedMenuWorkbenchToolBar extends WorkbenchToolBar {\n    constructor(container, menuId, options2, menuService, contextKeyService, contextMenuService, keybindingService, commandService, telemetryService) {\n        super(container, { resetMenu: menuId, ...options2 }, menuService, contextKeyService, contextMenuService, keybindingService, commandService, telemetryService);\n        this.menuId = menuId;\n        this.options2 = options2;\n        this.menuService = menuService;\n        this.contextKeyService = contextKeyService;\n        this.menu = this._store.add(this.menuService.createMenu(this.menuId, this.contextKeyService, { emitEventsForSubmenuChanges: true }));\n        this.additionalActions = [];\n        this.prependedPrimaryActions = [];\n        this._store.add(this.menu.onDidChange(() => this.updateToolbar()));\n        this.updateToolbar();\n    }\n    updateToolbar() {\n        const primary = [];\n        const secondary = [];\n        createAndFillInActionBarActions(this.menu, this.options2?.menuOptions, { primary, secondary }, this.options2?.toolbarOptions?.primaryGroup, this.options2?.toolbarOptions?.shouldInlineSubmenu, this.options2?.toolbarOptions?.useSeparatorsInPrimaryActions);\n        secondary.push(...this.additionalActions);\n        primary.unshift(...this.prependedPrimaryActions);\n        this.setActions(primary, secondary);\n    }\n    setPrependedPrimaryActions(actions) {\n        if (equals(this.prependedPrimaryActions, actions, (a, b) => a === b)) {\n            return;\n        }\n        this.prependedPrimaryActions = actions;\n        this.updateToolbar();\n    }\n    setAdditionalSecondaryActions(actions) {\n        if (equals(this.additionalActions, actions, (a, b) => a === b)) {\n            return;\n        }\n        this.additionalActions = actions;\n        this.updateToolbar();\n    }\n};\nCustomizedMenuWorkbenchToolBar = __decorate([\n    __param(3, IMenuService),\n    __param(4, IContextKeyService),\n    __param(5, IContextMenuService),\n    __param(6, IKeybindingService),\n    __param(7, ICommandService),\n    __param(8, ITelemetryService)\n], CustomizedMenuWorkbenchToolBar);\nexport { CustomizedMenuWorkbenchToolBar };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nexport function isMousePositionWithinElement(element, posx, posy) {\n    const elementRect = dom.getDomNodePagePosition(element);\n    if (posx < elementRect.left\n        || posx > elementRect.left + elementRect.width\n        || posy < elementRect.top\n        || posy > elementRect.top + elementRect.height) {\n        return false;\n    }\n    return true;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createCancelableAsyncIterable, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nexport class HoverResult {\n    constructor(value, isComplete, hasLoadingMessage) {\n        this.value = value;\n        this.isComplete = isComplete;\n        this.hasLoadingMessage = hasLoadingMessage;\n    }\n}\n/**\n * Computing the hover is very fine tuned.\n *\n * Suppose the hover delay is 300ms (the default). Then, when resting the mouse at an anchor:\n * - at 150ms, the async computation is triggered (i.e. semantic hover)\n *   - if async results already come in, they are not rendered yet.\n * - at 300ms, the sync computation is triggered (i.e. decorations, markers)\n *   - if there are sync or async results, they are rendered.\n * - at 900ms, if the async computation hasn't finished, a \"Loading...\" result is added.\n */\nexport class HoverOperation extends Disposable {\n    constructor(_editor, _computer) {\n        super();\n        this._editor = _editor;\n        this._computer = _computer;\n        this._onResult = this._register(new Emitter());\n        this.onResult = this._onResult.event;\n        this._firstWaitScheduler = this._register(new RunOnceScheduler(() => this._triggerAsyncComputation(), 0));\n        this._secondWaitScheduler = this._register(new RunOnceScheduler(() => this._triggerSyncComputation(), 0));\n        this._loadingMessageScheduler = this._register(new RunOnceScheduler(() => this._triggerLoadingMessage(), 0));\n        this._state = 0 /* HoverOperationState.Idle */;\n        this._asyncIterable = null;\n        this._asyncIterableDone = false;\n        this._result = [];\n    }\n    dispose() {\n        if (this._asyncIterable) {\n            this._asyncIterable.cancel();\n            this._asyncIterable = null;\n        }\n        super.dispose();\n    }\n    get _hoverTime() {\n        return this._editor.getOption(60 /* EditorOption.hover */).delay;\n    }\n    get _firstWaitTime() {\n        return this._hoverTime / 2;\n    }\n    get _secondWaitTime() {\n        return this._hoverTime - this._firstWaitTime;\n    }\n    get _loadingMessageTime() {\n        return 3 * this._hoverTime;\n    }\n    _setState(state, fireResult = true) {\n        this._state = state;\n        if (fireResult) {\n            this._fireResult();\n        }\n    }\n    _triggerAsyncComputation() {\n        this._setState(2 /* HoverOperationState.SecondWait */);\n        this._secondWaitScheduler.schedule(this._secondWaitTime);\n        if (this._computer.computeAsync) {\n            this._asyncIterableDone = false;\n            this._asyncIterable = createCancelableAsyncIterable(token => this._computer.computeAsync(token));\n            (async () => {\n                try {\n                    for await (const item of this._asyncIterable) {\n                        if (item) {\n                            this._result.push(item);\n                            this._fireResult();\n                        }\n                    }\n                    this._asyncIterableDone = true;\n                    if (this._state === 3 /* HoverOperationState.WaitingForAsync */ || this._state === 4 /* HoverOperationState.WaitingForAsyncShowingLoading */) {\n                        this._setState(0 /* HoverOperationState.Idle */);\n                    }\n                }\n                catch (e) {\n                    onUnexpectedError(e);\n                }\n            })();\n        }\n        else {\n            this._asyncIterableDone = true;\n        }\n    }\n    _triggerSyncComputation() {\n        if (this._computer.computeSync) {\n            this._result = this._result.concat(this._computer.computeSync());\n        }\n        this._setState(this._asyncIterableDone ? 0 /* HoverOperationState.Idle */ : 3 /* HoverOperationState.WaitingForAsync */);\n    }\n    _triggerLoadingMessage() {\n        if (this._state === 3 /* HoverOperationState.WaitingForAsync */) {\n            this._setState(4 /* HoverOperationState.WaitingForAsyncShowingLoading */);\n        }\n    }\n    _fireResult() {\n        if (this._state === 1 /* HoverOperationState.FirstWait */ || this._state === 2 /* HoverOperationState.SecondWait */) {\n            // Do not send out results before the hover time\n            return;\n        }\n        const isComplete = (this._state === 0 /* HoverOperationState.Idle */);\n        const hasLoadingMessage = (this._state === 4 /* HoverOperationState.WaitingForAsyncShowingLoading */);\n        this._onResult.fire(new HoverResult(this._result.slice(0), isComplete, hasLoadingMessage));\n    }\n    start(mode) {\n        if (mode === 0 /* HoverStartMode.Delayed */) {\n            if (this._state === 0 /* HoverOperationState.Idle */) {\n                this._setState(1 /* HoverOperationState.FirstWait */);\n                this._firstWaitScheduler.schedule(this._firstWaitTime);\n                this._loadingMessageScheduler.schedule(this._loadingMessageTime);\n            }\n        }\n        else {\n            switch (this._state) {\n                case 0 /* HoverOperationState.Idle */:\n                    this._triggerAsyncComputation();\n                    this._secondWaitScheduler.cancel();\n                    this._triggerSyncComputation();\n                    break;\n                case 2 /* HoverOperationState.SecondWait */:\n                    this._secondWaitScheduler.cancel();\n                    this._triggerSyncComputation();\n                    break;\n            }\n        }\n    }\n    cancel() {\n        this._firstWaitScheduler.cancel();\n        this._secondWaitScheduler.cancel();\n        this._loadingMessageScheduler.cancel();\n        if (this._asyncIterable) {\n            this._asyncIterable.cancel();\n            this._asyncIterable = null;\n        }\n        this._result = [];\n        this._setState(0 /* HoverOperationState.Idle */, false);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { ResizableHTMLElement } from '../../../../base/browser/ui/resizable/resizable.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport * as dom from '../../../../base/browser/dom.js';\nconst TOP_HEIGHT = 30;\nconst BOTTOM_HEIGHT = 24;\nexport class ResizableContentWidget extends Disposable {\n    constructor(_editor, minimumSize = new dom.Dimension(10, 10)) {\n        super();\n        this._editor = _editor;\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = false;\n        this._resizableNode = this._register(new ResizableHTMLElement());\n        this._contentPosition = null;\n        this._isResizing = false;\n        this._resizableNode.domNode.style.position = 'absolute';\n        this._resizableNode.minSize = dom.Dimension.lift(minimumSize);\n        this._resizableNode.layout(minimumSize.height, minimumSize.width);\n        this._resizableNode.enableSashes(true, true, true, true);\n        this._register(this._resizableNode.onDidResize(e => {\n            this._resize(new dom.Dimension(e.dimension.width, e.dimension.height));\n            if (e.done) {\n                this._isResizing = false;\n            }\n        }));\n        this._register(this._resizableNode.onDidWillResize(() => {\n            this._isResizing = true;\n        }));\n    }\n    get isResizing() {\n        return this._isResizing;\n    }\n    getDomNode() {\n        return this._resizableNode.domNode;\n    }\n    getPosition() {\n        return this._contentPosition;\n    }\n    get position() {\n        return this._contentPosition?.position ? Position.lift(this._contentPosition.position) : undefined;\n    }\n    _availableVerticalSpaceAbove(position) {\n        const editorDomNode = this._editor.getDomNode();\n        const mouseBox = this._editor.getScrolledVisiblePosition(position);\n        if (!editorDomNode || !mouseBox) {\n            return;\n        }\n        const editorBox = dom.getDomNodePagePosition(editorDomNode);\n        return editorBox.top + mouseBox.top - TOP_HEIGHT;\n    }\n    _availableVerticalSpaceBelow(position) {\n        const editorDomNode = this._editor.getDomNode();\n        const mouseBox = this._editor.getScrolledVisiblePosition(position);\n        if (!editorDomNode || !mouseBox) {\n            return;\n        }\n        const editorBox = dom.getDomNodePagePosition(editorDomNode);\n        const bodyBox = dom.getClientArea(editorDomNode.ownerDocument.body);\n        const mouseBottom = editorBox.top + mouseBox.top + mouseBox.height;\n        return bodyBox.height - mouseBottom - BOTTOM_HEIGHT;\n    }\n    _findPositionPreference(widgetHeight, showAtPosition) {\n        const maxHeightBelow = Math.min(this._availableVerticalSpaceBelow(showAtPosition) ?? Infinity, widgetHeight);\n        const maxHeightAbove = Math.min(this._availableVerticalSpaceAbove(showAtPosition) ?? Infinity, widgetHeight);\n        const maxHeight = Math.min(Math.max(maxHeightAbove, maxHeightBelow), widgetHeight);\n        const height = Math.min(widgetHeight, maxHeight);\n        let renderingAbove;\n        if (this._editor.getOption(60 /* EditorOption.hover */).above) {\n            renderingAbove = height <= maxHeightAbove ? 1 /* ContentWidgetPositionPreference.ABOVE */ : 2 /* ContentWidgetPositionPreference.BELOW */;\n        }\n        else {\n            renderingAbove = height <= maxHeightBelow ? 2 /* ContentWidgetPositionPreference.BELOW */ : 1 /* ContentWidgetPositionPreference.ABOVE */;\n        }\n        if (renderingAbove === 1 /* ContentWidgetPositionPreference.ABOVE */) {\n            this._resizableNode.enableSashes(true, true, false, false);\n        }\n        else {\n            this._resizableNode.enableSashes(false, true, true, false);\n        }\n        return renderingAbove;\n    }\n    _resize(dimension) {\n        this._resizableNode.layout(dimension.height, dimension.width);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ContentHoverWidget_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ResizableContentWidget } from './resizableContentWidget.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { getHoverAccessibleViewHint, HoverWidget } from '../../../../base/browser/ui/hover/hoverWidget.js';\nimport { Emitter } from '../../../../base/common/event.js';\nconst HORIZONTAL_SCROLLING_BY = 30;\nconst CONTAINER_HEIGHT_PADDING = 6;\nlet ContentHoverWidget = class ContentHoverWidget extends ResizableContentWidget {\n    static { ContentHoverWidget_1 = this; }\n    static { this.ID = 'editor.contrib.resizableContentHoverWidget'; }\n    static { this._lastDimensions = new dom.Dimension(0, 0); }\n    get isVisibleFromKeyboard() {\n        return (this._renderedHover?.source === 1 /* HoverStartSource.Keyboard */);\n    }\n    get isVisible() {\n        return this._hoverVisibleKey.get() ?? false;\n    }\n    get isFocused() {\n        return this._hoverFocusedKey.get() ?? false;\n    }\n    constructor(editor, contextKeyService, _configurationService, _accessibilityService, _keybindingService) {\n        const minimumHeight = editor.getOption(67 /* EditorOption.lineHeight */) + 8;\n        const minimumWidth = 150;\n        const minimumSize = new dom.Dimension(minimumWidth, minimumHeight);\n        super(editor, minimumSize);\n        this._configurationService = _configurationService;\n        this._accessibilityService = _accessibilityService;\n        this._keybindingService = _keybindingService;\n        this._hover = this._register(new HoverWidget());\n        this._onDidResize = this._register(new Emitter());\n        this.onDidResize = this._onDidResize.event;\n        this._minimumSize = minimumSize;\n        this._hoverVisibleKey = EditorContextKeys.hoverVisible.bindTo(contextKeyService);\n        this._hoverFocusedKey = EditorContextKeys.hoverFocused.bindTo(contextKeyService);\n        dom.append(this._resizableNode.domNode, this._hover.containerDomNode);\n        this._resizableNode.domNode.style.zIndex = '50';\n        this._register(this._editor.onDidLayoutChange(() => {\n            if (this.isVisible) {\n                this._updateMaxDimensions();\n            }\n        }));\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(50 /* EditorOption.fontInfo */)) {\n                this._updateFont();\n            }\n        }));\n        const focusTracker = this._register(dom.trackFocus(this._resizableNode.domNode));\n        this._register(focusTracker.onDidFocus(() => {\n            this._hoverFocusedKey.set(true);\n        }));\n        this._register(focusTracker.onDidBlur(() => {\n            this._hoverFocusedKey.set(false);\n        }));\n        this._setRenderedHover(undefined);\n        this._editor.addContentWidget(this);\n    }\n    dispose() {\n        super.dispose();\n        this._renderedHover?.dispose();\n        this._editor.removeContentWidget(this);\n    }\n    getId() {\n        return ContentHoverWidget_1.ID;\n    }\n    static _applyDimensions(container, width, height) {\n        const transformedWidth = typeof width === 'number' ? `${width}px` : width;\n        const transformedHeight = typeof height === 'number' ? `${height}px` : height;\n        container.style.width = transformedWidth;\n        container.style.height = transformedHeight;\n    }\n    _setContentsDomNodeDimensions(width, height) {\n        const contentsDomNode = this._hover.contentsDomNode;\n        return ContentHoverWidget_1._applyDimensions(contentsDomNode, width, height);\n    }\n    _setContainerDomNodeDimensions(width, height) {\n        const containerDomNode = this._hover.containerDomNode;\n        return ContentHoverWidget_1._applyDimensions(containerDomNode, width, height);\n    }\n    _setHoverWidgetDimensions(width, height) {\n        this._setContentsDomNodeDimensions(width, height);\n        this._setContainerDomNodeDimensions(width, height);\n        this._layoutContentWidget();\n    }\n    static _applyMaxDimensions(container, width, height) {\n        const transformedWidth = typeof width === 'number' ? `${width}px` : width;\n        const transformedHeight = typeof height === 'number' ? `${height}px` : height;\n        container.style.maxWidth = transformedWidth;\n        container.style.maxHeight = transformedHeight;\n    }\n    _setHoverWidgetMaxDimensions(width, height) {\n        ContentHoverWidget_1._applyMaxDimensions(this._hover.contentsDomNode, width, height);\n        ContentHoverWidget_1._applyMaxDimensions(this._hover.containerDomNode, width, height);\n        this._hover.containerDomNode.style.setProperty('--vscode-hover-maxWidth', typeof width === 'number' ? `${width}px` : width);\n        this._layoutContentWidget();\n    }\n    _setAdjustedHoverWidgetDimensions(size) {\n        this._setHoverWidgetMaxDimensions('none', 'none');\n        const width = size.width;\n        const height = size.height;\n        this._setHoverWidgetDimensions(width, height);\n    }\n    _updateResizableNodeMaxDimensions() {\n        const maxRenderingWidth = this._findMaximumRenderingWidth() ?? Infinity;\n        const maxRenderingHeight = this._findMaximumRenderingHeight() ?? Infinity;\n        this._resizableNode.maxSize = new dom.Dimension(maxRenderingWidth, maxRenderingHeight);\n        this._setHoverWidgetMaxDimensions(maxRenderingWidth, maxRenderingHeight);\n    }\n    _resize(size) {\n        ContentHoverWidget_1._lastDimensions = new dom.Dimension(size.width, size.height);\n        this._setAdjustedHoverWidgetDimensions(size);\n        this._resizableNode.layout(size.height, size.width);\n        this._updateResizableNodeMaxDimensions();\n        this._hover.scrollbar.scanDomNode();\n        this._editor.layoutContentWidget(this);\n        this._onDidResize.fire();\n    }\n    _findAvailableSpaceVertically() {\n        const position = this._renderedHover?.showAtPosition;\n        if (!position) {\n            return;\n        }\n        return this._positionPreference === 1 /* ContentWidgetPositionPreference.ABOVE */ ?\n            this._availableVerticalSpaceAbove(position)\n            : this._availableVerticalSpaceBelow(position);\n    }\n    _findMaximumRenderingHeight() {\n        const availableSpace = this._findAvailableSpaceVertically();\n        if (!availableSpace) {\n            return;\n        }\n        // Padding needed in order to stop the resizing down to a smaller height\n        let maximumHeight = CONTAINER_HEIGHT_PADDING;\n        Array.from(this._hover.contentsDomNode.children).forEach((hoverPart) => {\n            maximumHeight += hoverPart.clientHeight;\n        });\n        return Math.min(availableSpace, maximumHeight);\n    }\n    _isHoverTextOverflowing() {\n        // To find out if the text is overflowing, we will disable wrapping, check the widths, and then re-enable wrapping\n        this._hover.containerDomNode.style.setProperty('--vscode-hover-whiteSpace', 'nowrap');\n        this._hover.containerDomNode.style.setProperty('--vscode-hover-sourceWhiteSpace', 'nowrap');\n        const overflowing = Array.from(this._hover.contentsDomNode.children).some((hoverElement) => {\n            return hoverElement.scrollWidth > hoverElement.clientWidth;\n        });\n        this._hover.containerDomNode.style.removeProperty('--vscode-hover-whiteSpace');\n        this._hover.containerDomNode.style.removeProperty('--vscode-hover-sourceWhiteSpace');\n        return overflowing;\n    }\n    _findMaximumRenderingWidth() {\n        if (!this._editor || !this._editor.hasModel()) {\n            return;\n        }\n        const overflowing = this._isHoverTextOverflowing();\n        const initialWidth = (typeof this._contentWidth === 'undefined'\n            ? 0\n            : this._contentWidth - 2 // - 2 for the borders\n        );\n        if (overflowing || this._hover.containerDomNode.clientWidth < initialWidth) {\n            const bodyBoxWidth = dom.getClientArea(this._hover.containerDomNode.ownerDocument.body).width;\n            const horizontalPadding = 14;\n            return bodyBoxWidth - horizontalPadding;\n        }\n        else {\n            return this._hover.containerDomNode.clientWidth + 2;\n        }\n    }\n    isMouseGettingCloser(posx, posy) {\n        if (!this._renderedHover) {\n            return false;\n        }\n        if (this._renderedHover.initialMousePosX === undefined || this._renderedHover.initialMousePosY === undefined) {\n            this._renderedHover.initialMousePosX = posx;\n            this._renderedHover.initialMousePosY = posy;\n            return false;\n        }\n        const widgetRect = dom.getDomNodePagePosition(this.getDomNode());\n        if (this._renderedHover.closestMouseDistance === undefined) {\n            this._renderedHover.closestMouseDistance = computeDistanceFromPointToRectangle(this._renderedHover.initialMousePosX, this._renderedHover.initialMousePosY, widgetRect.left, widgetRect.top, widgetRect.width, widgetRect.height);\n        }\n        const distance = computeDistanceFromPointToRectangle(posx, posy, widgetRect.left, widgetRect.top, widgetRect.width, widgetRect.height);\n        if (distance > this._renderedHover.closestMouseDistance + 4 /* tolerance of 4 pixels */) {\n            // The mouse is getting farther away\n            return false;\n        }\n        this._renderedHover.closestMouseDistance = Math.min(this._renderedHover.closestMouseDistance, distance);\n        return true;\n    }\n    _setRenderedHover(renderedHover) {\n        this._renderedHover?.dispose();\n        this._renderedHover = renderedHover;\n        this._hoverVisibleKey.set(!!renderedHover);\n        this._hover.containerDomNode.classList.toggle('hidden', !renderedHover);\n    }\n    _updateFont() {\n        const { fontSize, lineHeight } = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        const contentsDomNode = this._hover.contentsDomNode;\n        contentsDomNode.style.fontSize = `${fontSize}px`;\n        contentsDomNode.style.lineHeight = `${lineHeight / fontSize}`;\n        const codeClasses = Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName('code'));\n        codeClasses.forEach(node => this._editor.applyFontInfo(node));\n    }\n    _updateContent(node) {\n        const contentsDomNode = this._hover.contentsDomNode;\n        contentsDomNode.style.paddingBottom = '';\n        contentsDomNode.textContent = '';\n        contentsDomNode.appendChild(node);\n    }\n    _layoutContentWidget() {\n        this._editor.layoutContentWidget(this);\n        this._hover.onContentsChanged();\n    }\n    _updateMaxDimensions() {\n        const height = Math.max(this._editor.getLayoutInfo().height / 4, 250, ContentHoverWidget_1._lastDimensions.height);\n        const width = Math.max(this._editor.getLayoutInfo().width * 0.66, 500, ContentHoverWidget_1._lastDimensions.width);\n        this._setHoverWidgetMaxDimensions(width, height);\n    }\n    _render(renderedHover) {\n        this._setRenderedHover(renderedHover);\n        this._updateFont();\n        this._updateContent(renderedHover.domNode);\n        this._updateMaxDimensions();\n        this.onContentsChanged();\n        // Simply force a synchronous render on the editor\n        // such that the widget does not really render with left = '0px'\n        this._editor.render();\n    }\n    getPosition() {\n        if (!this._renderedHover) {\n            return null;\n        }\n        return {\n            position: this._renderedHover.showAtPosition,\n            secondaryPosition: this._renderedHover.showAtSecondaryPosition,\n            positionAffinity: this._renderedHover.shouldAppearBeforeContent ? 3 /* PositionAffinity.LeftOfInjectedText */ : undefined,\n            preference: [this._positionPreference ?? 1 /* ContentWidgetPositionPreference.ABOVE */]\n        };\n    }\n    show(renderedHover) {\n        if (!this._editor || !this._editor.hasModel()) {\n            return;\n        }\n        this._render(renderedHover);\n        const widgetHeight = dom.getTotalHeight(this._hover.containerDomNode);\n        const widgetPosition = renderedHover.showAtPosition;\n        this._positionPreference = this._findPositionPreference(widgetHeight, widgetPosition) ?? 1 /* ContentWidgetPositionPreference.ABOVE */;\n        // See https://github.com/microsoft/vscode/issues/140339\n        // TODO: Doing a second layout of the hover after force rendering the editor\n        this.onContentsChanged();\n        if (renderedHover.shouldFocus) {\n            this._hover.containerDomNode.focus();\n        }\n        this._onDidResize.fire();\n        // The aria label overrides the label, so if we add to it, add the contents of the hover\n        const hoverFocused = this._hover.containerDomNode.ownerDocument.activeElement === this._hover.containerDomNode;\n        const accessibleViewHint = hoverFocused && getHoverAccessibleViewHint(this._configurationService.getValue('accessibility.verbosity.hover') === true && this._accessibilityService.isScreenReaderOptimized(), this._keybindingService.lookupKeybinding('editor.action.accessibleView')?.getAriaLabel() ?? '');\n        if (accessibleViewHint) {\n            this._hover.contentsDomNode.ariaLabel = this._hover.contentsDomNode.textContent + ', ' + accessibleViewHint;\n        }\n    }\n    hide() {\n        if (!this._renderedHover) {\n            return;\n        }\n        const hoverStoleFocus = this._renderedHover.shouldFocus || this._hoverFocusedKey.get();\n        this._setRenderedHover(undefined);\n        this._resizableNode.maxSize = new dom.Dimension(Infinity, Infinity);\n        this._resizableNode.clearSashHoverState();\n        this._hoverFocusedKey.set(false);\n        this._editor.layoutContentWidget(this);\n        if (hoverStoleFocus) {\n            this._editor.focus();\n        }\n    }\n    _removeConstraintsRenderNormally() {\n        // Added because otherwise the initial size of the hover content is smaller than should be\n        const layoutInfo = this._editor.getLayoutInfo();\n        this._resizableNode.layout(layoutInfo.height, layoutInfo.width);\n        this._setHoverWidgetDimensions('auto', 'auto');\n    }\n    setMinimumDimensions(dimensions) {\n        // We combine the new minimum dimensions with the previous ones\n        this._minimumSize = new dom.Dimension(Math.max(this._minimumSize.width, dimensions.width), Math.max(this._minimumSize.height, dimensions.height));\n        this._updateMinimumWidth();\n    }\n    _updateMinimumWidth() {\n        const width = (typeof this._contentWidth === 'undefined'\n            ? this._minimumSize.width\n            : Math.min(this._contentWidth, this._minimumSize.width));\n        // We want to avoid that the hover is artificially large, so we use the content width as minimum width\n        this._resizableNode.minSize = new dom.Dimension(width, this._minimumSize.height);\n    }\n    onContentsChanged() {\n        this._removeConstraintsRenderNormally();\n        const containerDomNode = this._hover.containerDomNode;\n        let height = dom.getTotalHeight(containerDomNode);\n        let width = dom.getTotalWidth(containerDomNode);\n        this._resizableNode.layout(height, width);\n        this._setHoverWidgetDimensions(width, height);\n        height = dom.getTotalHeight(containerDomNode);\n        width = dom.getTotalWidth(containerDomNode);\n        this._contentWidth = width;\n        this._updateMinimumWidth();\n        this._resizableNode.layout(height, width);\n        if (this._renderedHover?.showAtPosition) {\n            const widgetHeight = dom.getTotalHeight(this._hover.containerDomNode);\n            this._positionPreference = this._findPositionPreference(widgetHeight, this._renderedHover.showAtPosition);\n        }\n        this._layoutContentWidget();\n    }\n    focus() {\n        this._hover.containerDomNode.focus();\n    }\n    scrollUp() {\n        const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n        const fontInfo = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        this._hover.scrollbar.setScrollPosition({ scrollTop: scrollTop - fontInfo.lineHeight });\n    }\n    scrollDown() {\n        const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n        const fontInfo = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        this._hover.scrollbar.setScrollPosition({ scrollTop: scrollTop + fontInfo.lineHeight });\n    }\n    scrollLeft() {\n        const scrollLeft = this._hover.scrollbar.getScrollPosition().scrollLeft;\n        this._hover.scrollbar.setScrollPosition({ scrollLeft: scrollLeft - HORIZONTAL_SCROLLING_BY });\n    }\n    scrollRight() {\n        const scrollLeft = this._hover.scrollbar.getScrollPosition().scrollLeft;\n        this._hover.scrollbar.setScrollPosition({ scrollLeft: scrollLeft + HORIZONTAL_SCROLLING_BY });\n    }\n    pageUp() {\n        const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n        const scrollHeight = this._hover.scrollbar.getScrollDimensions().height;\n        this._hover.scrollbar.setScrollPosition({ scrollTop: scrollTop - scrollHeight });\n    }\n    pageDown() {\n        const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n        const scrollHeight = this._hover.scrollbar.getScrollDimensions().height;\n        this._hover.scrollbar.setScrollPosition({ scrollTop: scrollTop + scrollHeight });\n    }\n    goToTop() {\n        this._hover.scrollbar.setScrollPosition({ scrollTop: 0 });\n    }\n    goToBottom() {\n        this._hover.scrollbar.setScrollPosition({ scrollTop: this._hover.scrollbar.getScrollDimensions().scrollHeight });\n    }\n};\nContentHoverWidget = ContentHoverWidget_1 = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, IConfigurationService),\n    __param(3, IAccessibilityService),\n    __param(4, IKeybindingService)\n], ContentHoverWidget);\nexport { ContentHoverWidget };\nfunction computeDistanceFromPointToRectangle(pointX, pointY, left, top, width, height) {\n    const x = (left + width / 2); // x center of rectangle\n    const y = (top + height / 2); // y center of rectangle\n    const dx = Math.max(Math.abs(pointX - x) - width / 2, 0);\n    const dy = Math.max(Math.abs(pointY - y) - height / 2, 0);\n    return Math.sqrt(dx * dx + dy * dy);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nexport class ContentHoverComputer {\n    get anchor() { return this._anchor; }\n    set anchor(value) { this._anchor = value; }\n    get shouldFocus() { return this._shouldFocus; }\n    set shouldFocus(value) { this._shouldFocus = value; }\n    get source() { return this._source; }\n    set source(value) { this._source = value; }\n    get insistOnKeepingHoverVisible() { return this._insistOnKeepingHoverVisible; }\n    set insistOnKeepingHoverVisible(value) { this._insistOnKeepingHoverVisible = value; }\n    constructor(_editor, _participants) {\n        this._editor = _editor;\n        this._participants = _participants;\n        this._anchor = null;\n        this._shouldFocus = false;\n        this._source = 0 /* HoverStartSource.Mouse */;\n        this._insistOnKeepingHoverVisible = false;\n    }\n    static _getLineDecorations(editor, anchor) {\n        if (anchor.type !== 1 /* HoverAnchorType.Range */ && !anchor.supportsMarkerHover) {\n            return [];\n        }\n        const model = editor.getModel();\n        const lineNumber = anchor.range.startLineNumber;\n        if (lineNumber > model.getLineCount()) {\n            // invalid line\n            return [];\n        }\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        return editor.getLineDecorations(lineNumber).filter((d) => {\n            if (d.options.isWholeLine) {\n                return true;\n            }\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\n            if (d.options.showIfCollapsed) {\n                // Relax check around `showIfCollapsed` decorations to also include +/- 1 character\n                if (startColumn > anchor.range.startColumn + 1 || anchor.range.endColumn - 1 > endColumn) {\n                    return false;\n                }\n            }\n            else {\n                if (startColumn > anchor.range.startColumn || anchor.range.endColumn > endColumn) {\n                    return false;\n                }\n            }\n            return true;\n        });\n    }\n    computeAsync(token) {\n        const anchor = this._anchor;\n        if (!this._editor.hasModel() || !anchor) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const lineDecorations = ContentHoverComputer._getLineDecorations(this._editor, anchor);\n        return AsyncIterableObject.merge(this._participants.map((participant) => {\n            if (!participant.computeAsync) {\n                return AsyncIterableObject.EMPTY;\n            }\n            return participant.computeAsync(anchor, lineDecorations, token);\n        }));\n    }\n    computeSync() {\n        if (!this._editor.hasModel() || !this._anchor) {\n            return [];\n        }\n        const lineDecorations = ContentHoverComputer._getLineDecorations(this._editor, this._anchor);\n        let result = [];\n        for (const participant of this._participants) {\n            result = result.concat(participant.computeSync(this._anchor, lineDecorations));\n        }\n        return coalesce(result);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class HoverResult {\n    constructor(anchor, hoverParts, isComplete) {\n        this.anchor = anchor;\n        this.hoverParts = hoverParts;\n        this.isComplete = isComplete;\n    }\n    filter(anchor) {\n        const filteredHoverParts = this.hoverParts.filter((m) => m.isValidForHoverAnchor(anchor));\n        if (filteredHoverParts.length === this.hoverParts.length) {\n            return this;\n        }\n        return new FilteredHoverResult(this, this.anchor, filteredHoverParts, this.isComplete);\n    }\n}\nexport class FilteredHoverResult extends HoverResult {\n    constructor(original, anchor, messages, isComplete) {\n        super(anchor, messages, isComplete);\n        this.original = original;\n    }\n    filter(anchor) {\n        return this.original.filter(anchor);\n    }\n}\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { HoverAction } from '../../../../base/browser/ui/hover/hoverWidget.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nconst $ = dom.$;\nlet EditorHoverStatusBar = class EditorHoverStatusBar extends Disposable {\n    get hasContent() {\n        return this._hasContent;\n    }\n    constructor(_keybindingService) {\n        super();\n        this._keybindingService = _keybindingService;\n        this.actions = [];\n        this._hasContent = false;\n        this.hoverElement = $('div.hover-row.status-bar');\n        this.hoverElement.tabIndex = 0;\n        this.actionsElement = dom.append(this.hoverElement, $('div.actions'));\n    }\n    addAction(actionOptions) {\n        const keybinding = this._keybindingService.lookupKeybinding(actionOptions.commandId);\n        const keybindingLabel = keybinding ? keybinding.getLabel() : null;\n        this._hasContent = true;\n        const action = this._register(HoverAction.render(this.actionsElement, actionOptions, keybindingLabel));\n        this.actions.push(action);\n        return action;\n    }\n    append(element) {\n        const result = dom.append(this.actionsElement, element);\n        this._hasContent = true;\n        return result;\n    }\n};\nEditorHoverStatusBar = __decorate([\n    __param(0, IKeybindingService)\n], EditorHoverStatusBar);\nexport { EditorHoverStatusBar };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport class HoverProviderResult {\n    constructor(provider, hover, ordinal) {\n        this.provider = provider;\n        this.hover = hover;\n        this.ordinal = ordinal;\n    }\n}\n/**\n * Does not throw or return a rejected promise (returns undefined instead).\n */\nasync function executeProvider(provider, ordinal, model, position, token) {\n    const result = await Promise\n        .resolve(provider.provideHover(model, position, token))\n        .catch(onUnexpectedExternalError);\n    if (!result || !isValid(result)) {\n        return undefined;\n    }\n    return new HoverProviderResult(provider, result, ordinal);\n}\nexport function getHoverProviderResultsAsAsyncIterable(registry, model, position, token, recursive = false) {\n    const providers = registry.ordered(model, recursive);\n    const promises = providers.map((provider, index) => executeProvider(provider, index, model, position, token));\n    return AsyncIterableObject.fromPromises(promises).coalesce();\n}\nexport function getHoversPromise(registry, model, position, token, recursive = false) {\n    return getHoverProviderResultsAsAsyncIterable(registry, model, position, token, recursive).map(item => item.hover).toPromise();\n}\nregisterModelAndPositionCommand('_executeHoverProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    return getHoversPromise(languageFeaturesService.hoverProvider, model, position, CancellationToken.None);\n});\nregisterModelAndPositionCommand('_executeHoverProvider_recursive', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    return getHoversPromise(languageFeaturesService.hoverProvider, model, position, CancellationToken.None, true);\n});\nfunction isValid(result) {\n    const hasRange = (typeof result.range !== 'undefined');\n    const hasHtmlContent = typeof result.contents !== 'undefined' && result.contents && result.contents.length > 0;\n    return hasRange && hasHtmlContent;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { asArray, compareBy, numberComparator } from '../../../../base/common/arrays.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { isEmptyMarkdownString, MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../../browser/widget/markdownRenderer/browser/markdownRenderer.js';\nimport { DECREASE_HOVER_VERBOSITY_ACTION_ID, INCREASE_HOVER_VERBOSITY_ACTION_ID } from './hoverActionIds.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { RenderedHoverParts } from './hoverTypes.js';\nimport * as nls from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { HoverVerbosityAction } from '../../../common/languages.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ClickAction, KeyDownAction } from '../../../../base/browser/ui/hover/hoverWidget.js';\nimport { IHoverService, WorkbenchHoverDelegate } from '../../../../platform/hover/browser/hover.js';\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { getHoverProviderResultsAsAsyncIterable } from './getHover.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nconst $ = dom.$;\nconst increaseHoverVerbosityIcon = registerIcon('hover-increase-verbosity', Codicon.add, nls.localize('increaseHoverVerbosity', 'Icon for increaseing hover verbosity.'));\nconst decreaseHoverVerbosityIcon = registerIcon('hover-decrease-verbosity', Codicon.remove, nls.localize('decreaseHoverVerbosity', 'Icon for decreasing hover verbosity.'));\nexport class MarkdownHover {\n    constructor(owner, range, contents, isBeforeContent, ordinal, source = undefined) {\n        this.owner = owner;\n        this.range = range;\n        this.contents = contents;\n        this.isBeforeContent = isBeforeContent;\n        this.ordinal = ordinal;\n        this.source = source;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* HoverAnchorType.Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n}\nclass HoverSource {\n    constructor(hover, hoverProvider, hoverPosition) {\n        this.hover = hover;\n        this.hoverProvider = hoverProvider;\n        this.hoverPosition = hoverPosition;\n    }\n    supportsVerbosityAction(hoverVerbosityAction) {\n        switch (hoverVerbosityAction) {\n            case HoverVerbosityAction.Increase:\n                return this.hover.canIncreaseVerbosity ?? false;\n            case HoverVerbosityAction.Decrease:\n                return this.hover.canDecreaseVerbosity ?? false;\n        }\n    }\n}\nlet MarkdownHoverParticipant = class MarkdownHoverParticipant {\n    constructor(_editor, _languageService, _openerService, _configurationService, _languageFeaturesService, _keybindingService, _hoverService, _commandService) {\n        this._editor = _editor;\n        this._languageService = _languageService;\n        this._openerService = _openerService;\n        this._configurationService = _configurationService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._keybindingService = _keybindingService;\n        this._hoverService = _hoverService;\n        this._commandService = _commandService;\n        this.hoverOrdinal = 3;\n    }\n    createLoadingMessage(anchor) {\n        return new MarkdownHover(this, anchor.range, [new MarkdownString().appendText(nls.localize('modesContentHover.loading', \"Loading...\"))], false, 2000);\n    }\n    computeSync(anchor, lineDecorations) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */) {\n            return [];\n        }\n        const model = this._editor.getModel();\n        const lineNumber = anchor.range.startLineNumber;\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        const result = [];\n        let index = 1000;\n        const lineLength = model.getLineLength(lineNumber);\n        const languageId = model.getLanguageIdAtPosition(anchor.range.startLineNumber, anchor.range.startColumn);\n        const stopRenderingLineAfter = this._editor.getOption(118 /* EditorOption.stopRenderingLineAfter */);\n        const maxTokenizationLineLength = this._configurationService.getValue('editor.maxTokenizationLineLength', {\n            overrideIdentifier: languageId\n        });\n        let stopRenderingMessage = false;\n        if (stopRenderingLineAfter >= 0 && lineLength > stopRenderingLineAfter && anchor.range.startColumn >= stopRenderingLineAfter) {\n            stopRenderingMessage = true;\n            result.push(new MarkdownHover(this, anchor.range, [{\n                    value: nls.localize('stopped rendering', \"Rendering paused for long line for performance reasons. This can be configured via `editor.stopRenderingLineAfter`.\")\n                }], false, index++));\n        }\n        if (!stopRenderingMessage && typeof maxTokenizationLineLength === 'number' && lineLength >= maxTokenizationLineLength) {\n            result.push(new MarkdownHover(this, anchor.range, [{\n                    value: nls.localize('too many characters', \"Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.\")\n                }], false, index++));\n        }\n        let isBeforeContent = false;\n        for (const d of lineDecorations) {\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\n            const hoverMessage = d.options.hoverMessage;\n            if (!hoverMessage || isEmptyMarkdownString(hoverMessage)) {\n                continue;\n            }\n            if (d.options.beforeContentClassName) {\n                isBeforeContent = true;\n            }\n            const range = new Range(anchor.range.startLineNumber, startColumn, anchor.range.startLineNumber, endColumn);\n            result.push(new MarkdownHover(this, range, asArray(hoverMessage), isBeforeContent, index++));\n        }\n        return result;\n    }\n    computeAsync(anchor, lineDecorations, token) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const model = this._editor.getModel();\n        const hoverProviderRegistry = this._languageFeaturesService.hoverProvider;\n        if (!hoverProviderRegistry.has(model)) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const markdownHovers = this._getMarkdownHovers(hoverProviderRegistry, model, anchor, token);\n        return markdownHovers;\n    }\n    _getMarkdownHovers(hoverProviderRegistry, model, anchor, token) {\n        const position = anchor.range.getStartPosition();\n        const hoverProviderResults = getHoverProviderResultsAsAsyncIterable(hoverProviderRegistry, model, position, token);\n        const markdownHovers = hoverProviderResults.filter(item => !isEmptyMarkdownString(item.hover.contents))\n            .map(item => {\n            const range = item.hover.range ? Range.lift(item.hover.range) : anchor.range;\n            const hoverSource = new HoverSource(item.hover, item.provider, position);\n            return new MarkdownHover(this, range, item.hover.contents, false, item.ordinal, hoverSource);\n        });\n        return markdownHovers;\n    }\n    renderHoverParts(context, hoverParts) {\n        this._renderedHoverParts = new MarkdownRenderedHoverParts(hoverParts, context.fragment, this, this._editor, this._languageService, this._openerService, this._commandService, this._keybindingService, this._hoverService, this._configurationService, context.onContentsChanged);\n        return this._renderedHoverParts;\n    }\n    updateMarkdownHoverVerbosityLevel(action, index, focus) {\n        return Promise.resolve(this._renderedHoverParts?.updateMarkdownHoverPartVerbosityLevel(action, index, focus));\n    }\n};\nMarkdownHoverParticipant = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IOpenerService),\n    __param(3, IConfigurationService),\n    __param(4, ILanguageFeaturesService),\n    __param(5, IKeybindingService),\n    __param(6, IHoverService),\n    __param(7, ICommandService)\n], MarkdownHoverParticipant);\nexport { MarkdownHoverParticipant };\nclass RenderedMarkdownHoverPart {\n    constructor(hoverPart, hoverElement, disposables) {\n        this.hoverPart = hoverPart;\n        this.hoverElement = hoverElement;\n        this.disposables = disposables;\n    }\n    dispose() {\n        this.disposables.dispose();\n    }\n}\nclass MarkdownRenderedHoverParts {\n    constructor(hoverParts, hoverPartsContainer, _hoverParticipant, _editor, _languageService, _openerService, _commandService, _keybindingService, _hoverService, _configurationService, _onFinishedRendering) {\n        this._hoverParticipant = _hoverParticipant;\n        this._editor = _editor;\n        this._languageService = _languageService;\n        this._openerService = _openerService;\n        this._commandService = _commandService;\n        this._keybindingService = _keybindingService;\n        this._hoverService = _hoverService;\n        this._configurationService = _configurationService;\n        this._onFinishedRendering = _onFinishedRendering;\n        this._ongoingHoverOperations = new Map();\n        this._disposables = new DisposableStore();\n        this.renderedHoverParts = this._renderHoverParts(hoverParts, hoverPartsContainer, this._onFinishedRendering);\n        this._disposables.add(toDisposable(() => {\n            this.renderedHoverParts.forEach(renderedHoverPart => {\n                renderedHoverPart.dispose();\n            });\n            this._ongoingHoverOperations.forEach(operation => {\n                operation.tokenSource.dispose(true);\n            });\n        }));\n    }\n    _renderHoverParts(hoverParts, hoverPartsContainer, onFinishedRendering) {\n        hoverParts.sort(compareBy(hover => hover.ordinal, numberComparator));\n        return hoverParts.map(hoverPart => {\n            const renderedHoverPart = this._renderHoverPart(hoverPart, onFinishedRendering);\n            hoverPartsContainer.appendChild(renderedHoverPart.hoverElement);\n            return renderedHoverPart;\n        });\n    }\n    _renderHoverPart(hoverPart, onFinishedRendering) {\n        const renderedMarkdownPart = this._renderMarkdownHover(hoverPart, onFinishedRendering);\n        const renderedMarkdownElement = renderedMarkdownPart.hoverElement;\n        const hoverSource = hoverPart.source;\n        const disposables = new DisposableStore();\n        disposables.add(renderedMarkdownPart);\n        if (!hoverSource) {\n            return new RenderedMarkdownHoverPart(hoverPart, renderedMarkdownElement, disposables);\n        }\n        const canIncreaseVerbosity = hoverSource.supportsVerbosityAction(HoverVerbosityAction.Increase);\n        const canDecreaseVerbosity = hoverSource.supportsVerbosityAction(HoverVerbosityAction.Decrease);\n        if (!canIncreaseVerbosity && !canDecreaseVerbosity) {\n            return new RenderedMarkdownHoverPart(hoverPart, renderedMarkdownElement, disposables);\n        }\n        const actionsContainer = $('div.verbosity-actions');\n        renderedMarkdownElement.prepend(actionsContainer);\n        disposables.add(this._renderHoverExpansionAction(actionsContainer, HoverVerbosityAction.Increase, canIncreaseVerbosity));\n        disposables.add(this._renderHoverExpansionAction(actionsContainer, HoverVerbosityAction.Decrease, canDecreaseVerbosity));\n        return new RenderedMarkdownHoverPart(hoverPart, renderedMarkdownElement, disposables);\n    }\n    _renderMarkdownHover(markdownHover, onFinishedRendering) {\n        const renderedMarkdownHover = renderMarkdownInContainer(this._editor, markdownHover, this._languageService, this._openerService, onFinishedRendering);\n        return renderedMarkdownHover;\n    }\n    _renderHoverExpansionAction(container, action, actionEnabled) {\n        const store = new DisposableStore();\n        const isActionIncrease = action === HoverVerbosityAction.Increase;\n        const actionElement = dom.append(container, $(ThemeIcon.asCSSSelector(isActionIncrease ? increaseHoverVerbosityIcon : decreaseHoverVerbosityIcon)));\n        actionElement.tabIndex = 0;\n        const hoverDelegate = new WorkbenchHoverDelegate('mouse', false, { target: container, position: { hoverPosition: 0 /* HoverPosition.LEFT */ } }, this._configurationService, this._hoverService);\n        store.add(this._hoverService.setupManagedHover(hoverDelegate, actionElement, labelForHoverVerbosityAction(this._keybindingService, action)));\n        if (!actionEnabled) {\n            actionElement.classList.add('disabled');\n            return store;\n        }\n        actionElement.classList.add('enabled');\n        const actionFunction = () => this._commandService.executeCommand(action === HoverVerbosityAction.Increase ? INCREASE_HOVER_VERBOSITY_ACTION_ID : DECREASE_HOVER_VERBOSITY_ACTION_ID);\n        store.add(new ClickAction(actionElement, actionFunction));\n        store.add(new KeyDownAction(actionElement, actionFunction, [3 /* KeyCode.Enter */, 10 /* KeyCode.Space */]));\n        return store;\n    }\n    async updateMarkdownHoverPartVerbosityLevel(action, index, focus = true) {\n        const model = this._editor.getModel();\n        if (!model) {\n            return undefined;\n        }\n        const hoverRenderedPart = this._getRenderedHoverPartAtIndex(index);\n        const hoverSource = hoverRenderedPart?.hoverPart.source;\n        if (!hoverRenderedPart || !hoverSource?.supportsVerbosityAction(action)) {\n            return undefined;\n        }\n        const newHover = await this._fetchHover(hoverSource, model, action);\n        if (!newHover) {\n            return undefined;\n        }\n        const newHoverSource = new HoverSource(newHover, hoverSource.hoverProvider, hoverSource.hoverPosition);\n        const initialHoverPart = hoverRenderedPart.hoverPart;\n        const newHoverPart = new MarkdownHover(this._hoverParticipant, initialHoverPart.range, newHover.contents, initialHoverPart.isBeforeContent, initialHoverPart.ordinal, newHoverSource);\n        const newHoverRenderedPart = this._renderHoverPart(newHoverPart, this._onFinishedRendering);\n        this._replaceRenderedHoverPartAtIndex(index, newHoverRenderedPart, newHoverPart);\n        if (focus) {\n            this._focusOnHoverPartWithIndex(index);\n        }\n        return {\n            hoverPart: newHoverPart,\n            hoverElement: newHoverRenderedPart.hoverElement\n        };\n    }\n    async _fetchHover(hoverSource, model, action) {\n        let verbosityDelta = action === HoverVerbosityAction.Increase ? 1 : -1;\n        const provider = hoverSource.hoverProvider;\n        const ongoingHoverOperation = this._ongoingHoverOperations.get(provider);\n        if (ongoingHoverOperation) {\n            ongoingHoverOperation.tokenSource.cancel();\n            verbosityDelta += ongoingHoverOperation.verbosityDelta;\n        }\n        const tokenSource = new CancellationTokenSource();\n        this._ongoingHoverOperations.set(provider, { verbosityDelta, tokenSource });\n        const context = { verbosityRequest: { verbosityDelta, previousHover: hoverSource.hover } };\n        let hover;\n        try {\n            hover = await Promise.resolve(provider.provideHover(model, hoverSource.hoverPosition, tokenSource.token, context));\n        }\n        catch (e) {\n            onUnexpectedExternalError(e);\n        }\n        tokenSource.dispose();\n        this._ongoingHoverOperations.delete(provider);\n        return hover;\n    }\n    _replaceRenderedHoverPartAtIndex(index, renderedHoverPart, hoverPart) {\n        if (index >= this.renderedHoverParts.length || index < 0) {\n            return;\n        }\n        const currentRenderedHoverPart = this.renderedHoverParts[index];\n        const currentRenderedMarkdown = currentRenderedHoverPart.hoverElement;\n        const renderedMarkdown = renderedHoverPart.hoverElement;\n        const renderedChildrenElements = Array.from(renderedMarkdown.children);\n        currentRenderedMarkdown.replaceChildren(...renderedChildrenElements);\n        const newRenderedHoverPart = new RenderedMarkdownHoverPart(hoverPart, currentRenderedMarkdown, renderedHoverPart.disposables);\n        currentRenderedMarkdown.focus();\n        currentRenderedHoverPart.dispose();\n        this.renderedHoverParts[index] = newRenderedHoverPart;\n    }\n    _focusOnHoverPartWithIndex(index) {\n        this.renderedHoverParts[index].hoverElement.focus();\n    }\n    _getRenderedHoverPartAtIndex(index) {\n        return this.renderedHoverParts[index];\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n}\nexport function renderMarkdownHovers(context, markdownHovers, editor, languageService, openerService) {\n    // Sort hover parts to keep them stable since they might come in async, out-of-order\n    markdownHovers.sort(compareBy(hover => hover.ordinal, numberComparator));\n    const renderedHoverParts = [];\n    for (const markdownHover of markdownHovers) {\n        renderedHoverParts.push(renderMarkdownInContainer(editor, markdownHover, languageService, openerService, context.onContentsChanged));\n    }\n    return new RenderedHoverParts(renderedHoverParts);\n}\nfunction renderMarkdownInContainer(editor, markdownHover, languageService, openerService, onFinishedRendering) {\n    const disposables = new DisposableStore();\n    const renderedMarkdown = $('div.hover-row');\n    const renderedMarkdownContents = $('div.hover-row-contents');\n    renderedMarkdown.appendChild(renderedMarkdownContents);\n    const markdownStrings = markdownHover.contents;\n    for (const markdownString of markdownStrings) {\n        if (isEmptyMarkdownString(markdownString)) {\n            continue;\n        }\n        const markdownHoverElement = $('div.markdown-hover');\n        const hoverContentsElement = dom.append(markdownHoverElement, $('div.hover-contents'));\n        const renderer = disposables.add(new MarkdownRenderer({ editor }, languageService, openerService));\n        disposables.add(renderer.onDidRenderAsync(() => {\n            hoverContentsElement.className = 'hover-contents code-hover-contents';\n            onFinishedRendering();\n        }));\n        const renderedContents = disposables.add(renderer.render(markdownString));\n        hoverContentsElement.appendChild(renderedContents.element);\n        renderedMarkdownContents.appendChild(markdownHoverElement);\n    }\n    const renderedHoverPart = {\n        hoverPart: markdownHover,\n        hoverElement: renderedMarkdown,\n        dispose() { disposables.dispose(); }\n    };\n    return renderedHoverPart;\n}\nexport function labelForHoverVerbosityAction(keybindingService, action) {\n    switch (action) {\n        case HoverVerbosityAction.Increase: {\n            const kb = keybindingService.lookupKeybinding(INCREASE_HOVER_VERBOSITY_ACTION_ID);\n            return kb ?\n                nls.localize('increaseVerbosityWithKb', \"Increase Hover Verbosity ({0})\", kb.getLabel()) :\n                nls.localize('increaseVerbosity', \"Increase Hover Verbosity\");\n        }\n        case HoverVerbosityAction.Decrease: {\n            const kb = keybindingService.lookupKeybinding(DECREASE_HOVER_VERBOSITY_ACTION_ID);\n            return kb ?\n                nls.localize('decreaseVerbosityWithKb', \"Decrease Hover Verbosity ({0})\", kb.getLabel()) :\n                nls.localize('decreaseVerbosity', \"Decrease Hover Verbosity\");\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../../base/common/platform.js';\nfunction hasModifier(e, modifier) {\n    return !!e[modifier];\n}\n/**\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\n */\nexport class ClickLinkMouseEvent {\n    constructor(source, opts) {\n        this.target = source.target;\n        this.isLeftClick = source.event.leftButton;\n        this.isMiddleClick = source.event.middleButton;\n        this.isRightClick = source.event.rightButton;\n        this.hasTriggerModifier = hasModifier(source.event, opts.triggerModifier);\n        this.hasSideBySideModifier = hasModifier(source.event, opts.triggerSideBySideModifier);\n        this.isNoneOrSingleMouseDown = (source.event.detail <= 1);\n    }\n}\n/**\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\n */\nexport class ClickLinkKeyboardEvent {\n    constructor(source, opts) {\n        this.keyCodeIsTriggerKey = (source.keyCode === opts.triggerKey);\n        this.keyCodeIsSideBySideKey = (source.keyCode === opts.triggerSideBySideKey);\n        this.hasTriggerModifier = hasModifier(source, opts.triggerModifier);\n    }\n}\nexport class ClickLinkOptions {\n    constructor(triggerKey, triggerModifier, triggerSideBySideKey, triggerSideBySideModifier) {\n        this.triggerKey = triggerKey;\n        this.triggerModifier = triggerModifier;\n        this.triggerSideBySideKey = triggerSideBySideKey;\n        this.triggerSideBySideModifier = triggerSideBySideModifier;\n    }\n    equals(other) {\n        return (this.triggerKey === other.triggerKey\n            && this.triggerModifier === other.triggerModifier\n            && this.triggerSideBySideKey === other.triggerSideBySideKey\n            && this.triggerSideBySideModifier === other.triggerSideBySideModifier);\n    }\n}\nfunction createOptions(multiCursorModifier) {\n    if (multiCursorModifier === 'altKey') {\n        if (platform.isMacintosh) {\n            return new ClickLinkOptions(57 /* KeyCode.Meta */, 'metaKey', 6 /* KeyCode.Alt */, 'altKey');\n        }\n        return new ClickLinkOptions(5 /* KeyCode.Ctrl */, 'ctrlKey', 6 /* KeyCode.Alt */, 'altKey');\n    }\n    if (platform.isMacintosh) {\n        return new ClickLinkOptions(6 /* KeyCode.Alt */, 'altKey', 57 /* KeyCode.Meta */, 'metaKey');\n    }\n    return new ClickLinkOptions(6 /* KeyCode.Alt */, 'altKey', 5 /* KeyCode.Ctrl */, 'ctrlKey');\n}\nexport class ClickLinkGesture extends Disposable {\n    constructor(editor, opts) {\n        super();\n        this._onMouseMoveOrRelevantKeyDown = this._register(new Emitter());\n        this.onMouseMoveOrRelevantKeyDown = this._onMouseMoveOrRelevantKeyDown.event;\n        this._onExecute = this._register(new Emitter());\n        this.onExecute = this._onExecute.event;\n        this._onCancel = this._register(new Emitter());\n        this.onCancel = this._onCancel.event;\n        this._editor = editor;\n        this._extractLineNumberFromMouseEvent = opts?.extractLineNumberFromMouseEvent ?? ((e) => e.target.position ? e.target.position.lineNumber : 0);\n        this._opts = createOptions(this._editor.getOption(78 /* EditorOption.multiCursorModifier */));\n        this._lastMouseMoveEvent = null;\n        this._hasTriggerKeyOnMouseDown = false;\n        this._lineNumberOnMouseDown = 0;\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(78 /* EditorOption.multiCursorModifier */)) {\n                const newOpts = createOptions(this._editor.getOption(78 /* EditorOption.multiCursorModifier */));\n                if (this._opts.equals(newOpts)) {\n                    return;\n                }\n                this._opts = newOpts;\n                this._lastMouseMoveEvent = null;\n                this._hasTriggerKeyOnMouseDown = false;\n                this._lineNumberOnMouseDown = 0;\n                this._onCancel.fire();\n            }\n        }));\n        this._register(this._editor.onMouseMove((e) => this._onEditorMouseMove(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onMouseDown((e) => this._onEditorMouseDown(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onMouseUp((e) => this._onEditorMouseUp(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onKeyDown((e) => this._onEditorKeyDown(new ClickLinkKeyboardEvent(e, this._opts))));\n        this._register(this._editor.onKeyUp((e) => this._onEditorKeyUp(new ClickLinkKeyboardEvent(e, this._opts))));\n        this._register(this._editor.onMouseDrag(() => this._resetHandler()));\n        this._register(this._editor.onDidChangeCursorSelection((e) => this._onDidChangeCursorSelection(e)));\n        this._register(this._editor.onDidChangeModel((e) => this._resetHandler()));\n        this._register(this._editor.onDidChangeModelContent(() => this._resetHandler()));\n        this._register(this._editor.onDidScrollChange((e) => {\n            if (e.scrollTopChanged || e.scrollLeftChanged) {\n                this._resetHandler();\n            }\n        }));\n    }\n    _onDidChangeCursorSelection(e) {\n        if (e.selection && e.selection.startColumn !== e.selection.endColumn) {\n            this._resetHandler(); // immediately stop this feature if the user starts to select (https://github.com/microsoft/vscode/issues/7827)\n        }\n    }\n    _onEditorMouseMove(mouseEvent) {\n        this._lastMouseMoveEvent = mouseEvent;\n        this._onMouseMoveOrRelevantKeyDown.fire([mouseEvent, null]);\n    }\n    _onEditorMouseDown(mouseEvent) {\n        // We need to record if we had the trigger key on mouse down because someone might select something in the editor\n        // holding the mouse down and then while mouse is down start to press Ctrl/Cmd to start a copy operation and then\n        // release the mouse button without wanting to do the navigation.\n        // With this flag we prevent goto definition if the mouse was down before the trigger key was pressed.\n        this._hasTriggerKeyOnMouseDown = mouseEvent.hasTriggerModifier;\n        this._lineNumberOnMouseDown = this._extractLineNumberFromMouseEvent(mouseEvent);\n    }\n    _onEditorMouseUp(mouseEvent) {\n        const currentLineNumber = this._extractLineNumberFromMouseEvent(mouseEvent);\n        if (this._hasTriggerKeyOnMouseDown && this._lineNumberOnMouseDown && this._lineNumberOnMouseDown === currentLineNumber) {\n            this._onExecute.fire(mouseEvent);\n        }\n    }\n    _onEditorKeyDown(e) {\n        if (this._lastMouseMoveEvent\n            && (e.keyCodeIsTriggerKey // User just pressed Ctrl/Cmd (normal goto definition)\n                || (e.keyCodeIsSideBySideKey && e.hasTriggerModifier) // User pressed Ctrl/Cmd+Alt (goto definition to the side)\n            )) {\n            this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent, e]);\n        }\n        else if (e.hasTriggerModifier) {\n            this._onCancel.fire(); // remove decorations if user holds another key with ctrl/cmd to prevent accident goto declaration\n        }\n    }\n    _onEditorKeyUp(e) {\n        if (e.keyCodeIsTriggerKey) {\n            this._onCancel.fire();\n        }\n    }\n    _resetHandler() {\n        this._lastMouseMoveEvent = null;\n        this._hasTriggerKeyOnMouseDown = false;\n        this._onCancel.fire();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { URI } from '../../../../base/common/uri.js';\nexport class InlayHintAnchor {\n    constructor(range, direction) {\n        this.range = range;\n        this.direction = direction;\n    }\n}\nexport class InlayHintItem {\n    constructor(hint, anchor, provider) {\n        this.hint = hint;\n        this.anchor = anchor;\n        this.provider = provider;\n        this._isResolved = false;\n    }\n    with(delta) {\n        const result = new InlayHintItem(this.hint, delta.anchor, this.provider);\n        result._isResolved = this._isResolved;\n        result._currentResolve = this._currentResolve;\n        return result;\n    }\n    async resolve(token) {\n        if (typeof this.provider.resolveInlayHint !== 'function') {\n            return;\n        }\n        if (this._currentResolve) {\n            // wait for an active resolve operation and try again\n            // when that's done.\n            await this._currentResolve;\n            if (token.isCancellationRequested) {\n                return;\n            }\n            return this.resolve(token);\n        }\n        if (!this._isResolved) {\n            this._currentResolve = this._doResolve(token)\n                .finally(() => this._currentResolve = undefined);\n        }\n        await this._currentResolve;\n    }\n    async _doResolve(token) {\n        try {\n            const newHint = await Promise.resolve(this.provider.resolveInlayHint(this.hint, token));\n            this.hint.tooltip = newHint?.tooltip ?? this.hint.tooltip;\n            this.hint.label = newHint?.label ?? this.hint.label;\n            this.hint.textEdits = newHint?.textEdits ?? this.hint.textEdits;\n            this._isResolved = true;\n        }\n        catch (err) {\n            onUnexpectedExternalError(err);\n            this._isResolved = false;\n        }\n    }\n}\nexport class InlayHintsFragments {\n    static { this._emptyInlayHintList = Object.freeze({ dispose() { }, hints: [] }); }\n    static async create(registry, model, ranges, token) {\n        const data = [];\n        const promises = registry.ordered(model).reverse().map(provider => ranges.map(async (range) => {\n            try {\n                const result = await provider.provideInlayHints(model, range, token);\n                if (result?.hints.length || provider.onDidChangeInlayHints) {\n                    data.push([result ?? InlayHintsFragments._emptyInlayHintList, provider]);\n                }\n            }\n            catch (err) {\n                onUnexpectedExternalError(err);\n            }\n        }));\n        await Promise.all(promises.flat());\n        if (token.isCancellationRequested || model.isDisposed()) {\n            throw new CancellationError();\n        }\n        return new InlayHintsFragments(ranges, data, model);\n    }\n    constructor(ranges, data, model) {\n        this._disposables = new DisposableStore();\n        this.ranges = ranges;\n        this.provider = new Set();\n        const items = [];\n        for (const [list, provider] of data) {\n            this._disposables.add(list);\n            this.provider.add(provider);\n            for (const hint of list.hints) {\n                // compute the range to which the item should be attached to\n                const position = model.validatePosition(hint.position);\n                let direction = 'before';\n                const wordRange = InlayHintsFragments._getRangeAtPosition(model, position);\n                let range;\n                if (wordRange.getStartPosition().isBefore(position)) {\n                    range = Range.fromPositions(wordRange.getStartPosition(), position);\n                    direction = 'after';\n                }\n                else {\n                    range = Range.fromPositions(position, wordRange.getEndPosition());\n                    direction = 'before';\n                }\n                items.push(new InlayHintItem(hint, new InlayHintAnchor(range, direction), provider));\n            }\n        }\n        this.items = items.sort((a, b) => Position.compare(a.hint.position, b.hint.position));\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n    static _getRangeAtPosition(model, position) {\n        const line = position.lineNumber;\n        const word = model.getWordAtPosition(position);\n        if (word) {\n            // always prefer the word range\n            return new Range(line, word.startColumn, line, word.endColumn);\n        }\n        model.tokenization.tokenizeIfCheap(line);\n        const tokens = model.tokenization.getLineTokens(line);\n        const offset = position.column - 1;\n        const idx = tokens.findTokenIndexAtOffset(offset);\n        let start = tokens.getStartOffset(idx);\n        let end = tokens.getEndOffset(idx);\n        if (end - start === 1) {\n            // single character token, when at its end try leading/trailing token instead\n            if (start === offset && idx > 1) {\n                // leading token\n                start = tokens.getStartOffset(idx - 1);\n                end = tokens.getEndOffset(idx - 1);\n            }\n            else if (end === offset && idx < tokens.getCount() - 1) {\n                // trailing token\n                start = tokens.getStartOffset(idx + 1);\n                end = tokens.getEndOffset(idx + 1);\n            }\n        }\n        return new Range(line, start + 1, line, end + 1);\n    }\n}\nexport function asCommandLink(command) {\n    return URI.from({\n        scheme: Schemas.command,\n        path: command.id,\n        query: command.arguments && encodeURIComponent(JSON.stringify(command.arguments))\n    }).toString();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Sash } from '../../../../base/browser/ui/sash/sash.js';\nimport { Color, RGBA } from '../../../../base/common/color.js';\nimport { IdGenerator } from '../../../../base/common/idGenerator.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport * as objects from '../../../../base/common/objects.js';\nimport './zoneWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nconst defaultColor = new Color(new RGBA(0, 122, 204));\nconst defaultOptions = {\n    showArrow: true,\n    showFrame: true,\n    className: '',\n    frameColor: defaultColor,\n    arrowColor: defaultColor,\n    keepEditorSelection: false\n};\nconst WIDGET_ID = 'vs.editor.contrib.zoneWidget';\nclass ViewZoneDelegate {\n    constructor(domNode, afterLineNumber, afterColumn, heightInLines, onDomNodeTop, onComputedHeight, showInHiddenAreas, ordinal) {\n        this.id = ''; // A valid zone id should be greater than 0\n        this.domNode = domNode;\n        this.afterLineNumber = afterLineNumber;\n        this.afterColumn = afterColumn;\n        this.heightInLines = heightInLines;\n        this.showInHiddenAreas = showInHiddenAreas;\n        this.ordinal = ordinal;\n        this._onDomNodeTop = onDomNodeTop;\n        this._onComputedHeight = onComputedHeight;\n    }\n    onDomNodeTop(top) {\n        this._onDomNodeTop(top);\n    }\n    onComputedHeight(height) {\n        this._onComputedHeight(height);\n    }\n}\nexport class OverlayWidgetDelegate {\n    constructor(id, domNode) {\n        this._id = id;\n        this._domNode = domNode;\n    }\n    getId() {\n        return this._id;\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        return null;\n    }\n}\nclass Arrow {\n    static { this._IdGenerator = new IdGenerator('.arrow-decoration-'); }\n    constructor(_editor) {\n        this._editor = _editor;\n        this._ruleName = Arrow._IdGenerator.nextId();\n        this._decorations = this._editor.createDecorationsCollection();\n        this._color = null;\n        this._height = -1;\n    }\n    dispose() {\n        this.hide();\n        dom.removeCSSRulesContainingSelector(this._ruleName);\n    }\n    set color(value) {\n        if (this._color !== value) {\n            this._color = value;\n            this._updateStyle();\n        }\n    }\n    set height(value) {\n        if (this._height !== value) {\n            this._height = value;\n            this._updateStyle();\n        }\n    }\n    _updateStyle() {\n        dom.removeCSSRulesContainingSelector(this._ruleName);\n        dom.createCSSRule(`.monaco-editor ${this._ruleName}`, `border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px !important; margin-left: -${this._height}px; `);\n    }\n    show(where) {\n        if (where.column === 1) {\n            // the arrow isn't pretty at column 1 and we need to push it out a little\n            where = { lineNumber: where.lineNumber, column: 2 };\n        }\n        this._decorations.set([{\n                range: Range.fromPositions(where),\n                options: {\n                    description: 'zone-widget-arrow',\n                    className: this._ruleName,\n                    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */\n                }\n            }]);\n    }\n    hide() {\n        this._decorations.clear();\n    }\n}\nexport class ZoneWidget {\n    constructor(editor, options = {}) {\n        this._arrow = null;\n        this._overlayWidget = null;\n        this._resizeSash = null;\n        this._viewZone = null;\n        this._disposables = new DisposableStore();\n        this.container = null;\n        this._isShowing = false;\n        this.editor = editor;\n        this._positionMarkerId = this.editor.createDecorationsCollection();\n        this.options = objects.deepClone(options);\n        objects.mixin(this.options, defaultOptions, false);\n        this.domNode = document.createElement('div');\n        if (!this.options.isAccessible) {\n            this.domNode.setAttribute('aria-hidden', 'true');\n            this.domNode.setAttribute('role', 'presentation');\n        }\n        this._disposables.add(this.editor.onDidLayoutChange((info) => {\n            const width = this._getWidth(info);\n            this.domNode.style.width = width + 'px';\n            this.domNode.style.left = this._getLeft(info) + 'px';\n            this._onWidth(width);\n        }));\n    }\n    dispose() {\n        if (this._overlayWidget) {\n            this.editor.removeOverlayWidget(this._overlayWidget);\n            this._overlayWidget = null;\n        }\n        if (this._viewZone) {\n            this.editor.changeViewZones(accessor => {\n                if (this._viewZone) {\n                    accessor.removeZone(this._viewZone.id);\n                }\n                this._viewZone = null;\n            });\n        }\n        this._positionMarkerId.clear();\n        this._disposables.dispose();\n    }\n    create() {\n        this.domNode.classList.add('zone-widget');\n        if (this.options.className) {\n            this.domNode.classList.add(this.options.className);\n        }\n        this.container = document.createElement('div');\n        this.container.classList.add('zone-widget-container');\n        this.domNode.appendChild(this.container);\n        if (this.options.showArrow) {\n            this._arrow = new Arrow(this.editor);\n            this._disposables.add(this._arrow);\n        }\n        this._fillContainer(this.container);\n        this._initSash();\n        this._applyStyles();\n    }\n    style(styles) {\n        if (styles.frameColor) {\n            this.options.frameColor = styles.frameColor;\n        }\n        if (styles.arrowColor) {\n            this.options.arrowColor = styles.arrowColor;\n        }\n        this._applyStyles();\n    }\n    _applyStyles() {\n        if (this.container && this.options.frameColor) {\n            const frameColor = this.options.frameColor.toString();\n            this.container.style.borderTopColor = frameColor;\n            this.container.style.borderBottomColor = frameColor;\n        }\n        if (this._arrow && this.options.arrowColor) {\n            const arrowColor = this.options.arrowColor.toString();\n            this._arrow.color = arrowColor;\n        }\n    }\n    _getWidth(info) {\n        return info.width - info.minimap.minimapWidth - info.verticalScrollbarWidth;\n    }\n    _getLeft(info) {\n        // If minimap is to the left, we move beyond it\n        if (info.minimap.minimapWidth > 0 && info.minimap.minimapLeft === 0) {\n            return info.minimap.minimapWidth;\n        }\n        return 0;\n    }\n    _onViewZoneTop(top) {\n        this.domNode.style.top = top + 'px';\n    }\n    _onViewZoneHeight(height) {\n        this.domNode.style.height = `${height}px`;\n        if (this.container) {\n            const containerHeight = height - this._decoratingElementsHeight();\n            this.container.style.height = `${containerHeight}px`;\n            const layoutInfo = this.editor.getLayoutInfo();\n            this._doLayout(containerHeight, this._getWidth(layoutInfo));\n        }\n        this._resizeSash?.layout();\n    }\n    get position() {\n        const range = this._positionMarkerId.getRange(0);\n        if (!range) {\n            return undefined;\n        }\n        return range.getStartPosition();\n    }\n    show(rangeOrPos, heightInLines) {\n        const range = Range.isIRange(rangeOrPos) ? Range.lift(rangeOrPos) : Range.fromPositions(rangeOrPos);\n        this._isShowing = true;\n        this._showImpl(range, heightInLines);\n        this._isShowing = false;\n        this._positionMarkerId.set([{ range, options: ModelDecorationOptions.EMPTY }]);\n    }\n    hide() {\n        if (this._viewZone) {\n            this.editor.changeViewZones(accessor => {\n                if (this._viewZone) {\n                    accessor.removeZone(this._viewZone.id);\n                }\n            });\n            this._viewZone = null;\n        }\n        if (this._overlayWidget) {\n            this.editor.removeOverlayWidget(this._overlayWidget);\n            this._overlayWidget = null;\n        }\n        this._arrow?.hide();\n        this._positionMarkerId.clear();\n    }\n    _decoratingElementsHeight() {\n        const lineHeight = this.editor.getOption(67 /* EditorOption.lineHeight */);\n        let result = 0;\n        if (this.options.showArrow) {\n            const arrowHeight = Math.round(lineHeight / 3);\n            result += 2 * arrowHeight;\n        }\n        if (this.options.showFrame) {\n            const frameThickness = Math.round(lineHeight / 9);\n            result += 2 * frameThickness;\n        }\n        return result;\n    }\n    _showImpl(where, heightInLines) {\n        const position = where.getStartPosition();\n        const layoutInfo = this.editor.getLayoutInfo();\n        const width = this._getWidth(layoutInfo);\n        this.domNode.style.width = `${width}px`;\n        this.domNode.style.left = this._getLeft(layoutInfo) + 'px';\n        // Render the widget as zone (rendering) and widget (lifecycle)\n        const viewZoneDomNode = document.createElement('div');\n        viewZoneDomNode.style.overflow = 'hidden';\n        const lineHeight = this.editor.getOption(67 /* EditorOption.lineHeight */);\n        // adjust heightInLines to viewport\n        if (!this.options.allowUnlimitedHeight) {\n            const maxHeightInLines = Math.max(12, (this.editor.getLayoutInfo().height / lineHeight) * 0.8);\n            heightInLines = Math.min(heightInLines, maxHeightInLines);\n        }\n        let arrowHeight = 0;\n        let frameThickness = 0;\n        // Render the arrow one 1/3 of an editor line height\n        if (this._arrow && this.options.showArrow) {\n            arrowHeight = Math.round(lineHeight / 3);\n            this._arrow.height = arrowHeight;\n            this._arrow.show(position);\n        }\n        // Render the frame as 1/9 of an editor line height\n        if (this.options.showFrame) {\n            frameThickness = Math.round(lineHeight / 9);\n        }\n        // insert zone widget\n        this.editor.changeViewZones((accessor) => {\n            if (this._viewZone) {\n                accessor.removeZone(this._viewZone.id);\n            }\n            if (this._overlayWidget) {\n                this.editor.removeOverlayWidget(this._overlayWidget);\n                this._overlayWidget = null;\n            }\n            this.domNode.style.top = '-1000px';\n            this._viewZone = new ViewZoneDelegate(viewZoneDomNode, position.lineNumber, position.column, heightInLines, (top) => this._onViewZoneTop(top), (height) => this._onViewZoneHeight(height), this.options.showInHiddenAreas, this.options.ordinal);\n            this._viewZone.id = accessor.addZone(this._viewZone);\n            this._overlayWidget = new OverlayWidgetDelegate(WIDGET_ID + this._viewZone.id, this.domNode);\n            this.editor.addOverlayWidget(this._overlayWidget);\n        });\n        if (this.container && this.options.showFrame) {\n            const width = this.options.frameWidth ? this.options.frameWidth : frameThickness;\n            this.container.style.borderTopWidth = width + 'px';\n            this.container.style.borderBottomWidth = width + 'px';\n        }\n        const containerHeight = heightInLines * lineHeight - this._decoratingElementsHeight();\n        if (this.container) {\n            this.container.style.top = arrowHeight + 'px';\n            this.container.style.height = containerHeight + 'px';\n            this.container.style.overflow = 'hidden';\n        }\n        this._doLayout(containerHeight, width);\n        if (!this.options.keepEditorSelection) {\n            this.editor.setSelection(where);\n        }\n        const model = this.editor.getModel();\n        if (model) {\n            const range = model.validateRange(new Range(where.startLineNumber, 1, where.endLineNumber + 1, 1));\n            this.revealRange(range, range.startLineNumber === model.getLineCount());\n        }\n    }\n    revealRange(range, isLastLine) {\n        if (isLastLine) {\n            this.editor.revealLineNearTop(range.endLineNumber, 0 /* ScrollType.Smooth */);\n        }\n        else {\n            this.editor.revealRange(range, 0 /* ScrollType.Smooth */);\n        }\n    }\n    setCssClass(className, classToReplace) {\n        if (!this.container) {\n            return;\n        }\n        if (classToReplace) {\n            this.container.classList.remove(classToReplace);\n        }\n        this.container.classList.add(className);\n    }\n    _onWidth(widthInPixel) {\n        // implement in subclass\n    }\n    _doLayout(heightInPixel, widthInPixel) {\n        // implement in subclass\n    }\n    _relayout(newHeightInLines) {\n        if (this._viewZone && this._viewZone.heightInLines !== newHeightInLines) {\n            this.editor.changeViewZones(accessor => {\n                if (this._viewZone) {\n                    this._viewZone.heightInLines = newHeightInLines;\n                    accessor.layoutZone(this._viewZone.id);\n                }\n            });\n        }\n    }\n    // --- sash\n    _initSash() {\n        if (this._resizeSash) {\n            return;\n        }\n        this._resizeSash = this._disposables.add(new Sash(this.domNode, this, { orientation: 1 /* Orientation.HORIZONTAL */ }));\n        if (!this.options.isResizeable) {\n            this._resizeSash.state = 0 /* SashState.Disabled */;\n        }\n        let data;\n        this._disposables.add(this._resizeSash.onDidStart((e) => {\n            if (this._viewZone) {\n                data = {\n                    startY: e.startY,\n                    heightInLines: this._viewZone.heightInLines,\n                };\n            }\n        }));\n        this._disposables.add(this._resizeSash.onDidEnd(() => {\n            data = undefined;\n        }));\n        this._disposables.add(this._resizeSash.onDidChange((evt) => {\n            if (data) {\n                const lineDelta = (evt.currentY - data.startY) / this.editor.getOption(67 /* EditorOption.lineHeight */);\n                const roundedLineDelta = lineDelta < 0 ? Math.ceil(lineDelta) : Math.floor(lineDelta);\n                const newHeightInLines = data.heightInLines + roundedLineDelta;\n                if (newHeightInLines > 5 && newHeightInLines < 35) {\n                    this._relayout(newHeightInLines);\n                }\n            }\n        }));\n    }\n    getHorizontalSashLeft() {\n        return 0;\n    }\n    getHorizontalSashTop() {\n        return (this.domNode.style.height === null ? 0 : parseInt(this.domNode.style.height)) - (this._decoratingElementsHeight() / 2);\n    }\n    getHorizontalSashWidth() {\n        const layoutInfo = this.editor.getLayoutInfo();\n        return layoutInfo.width - layoutInfo.minimap.minimapWidth;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ActionBar } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { Action } from '../../../../base/common/actions.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport * as objects from '../../../../base/common/objects.js';\nimport './media/peekViewWidget.css';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/codeEditor/embeddedCodeEditorWidget.js';\nimport { ZoneWidget } from '../../zoneWidget/browser/zoneWidget.js';\nimport * as nls from '../../../../nls.js';\nimport { createActionViewItem } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator, IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { activeContrastBorder, contrastBorder, editorForeground, editorInfoForeground, registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nexport const IPeekViewService = createDecorator('IPeekViewService');\nregisterSingleton(IPeekViewService, class {\n    constructor() {\n        this._widgets = new Map();\n    }\n    addExclusiveWidget(editor, widget) {\n        const existing = this._widgets.get(editor);\n        if (existing) {\n            existing.listener.dispose();\n            existing.widget.dispose();\n        }\n        const remove = () => {\n            const data = this._widgets.get(editor);\n            if (data && data.widget === widget) {\n                data.listener.dispose();\n                this._widgets.delete(editor);\n            }\n        };\n        this._widgets.set(editor, { widget, listener: widget.onDidClose(remove) });\n    }\n}, 1 /* InstantiationType.Delayed */);\nexport var PeekContext;\n(function (PeekContext) {\n    PeekContext.inPeekEditor = new RawContextKey('inReferenceSearchEditor', true, nls.localize('inReferenceSearchEditor', \"Whether the current code editor is embedded inside peek\"));\n    PeekContext.notInPeekEditor = PeekContext.inPeekEditor.toNegated();\n})(PeekContext || (PeekContext = {}));\nlet PeekContextController = class PeekContextController {\n    static { this.ID = 'editor.contrib.referenceController'; }\n    constructor(editor, contextKeyService) {\n        if (editor instanceof EmbeddedCodeEditorWidget) {\n            PeekContext.inPeekEditor.bindTo(contextKeyService);\n        }\n    }\n    dispose() { }\n};\nPeekContextController = __decorate([\n    __param(1, IContextKeyService)\n], PeekContextController);\nregisterEditorContribution(PeekContextController.ID, PeekContextController, 0 /* EditorContributionInstantiation.Eager */); // eager because it needs to define a context key\nexport function getOuterEditor(accessor) {\n    const editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n    if (editor instanceof EmbeddedCodeEditorWidget) {\n        return editor.getParentEditor();\n    }\n    return editor;\n}\nconst defaultOptions = {\n    headerBackgroundColor: Color.white,\n    primaryHeadingColor: Color.fromHex('#333333'),\n    secondaryHeadingColor: Color.fromHex('#6c6c6cb3')\n};\nlet PeekViewWidget = class PeekViewWidget extends ZoneWidget {\n    constructor(editor, options, instantiationService) {\n        super(editor, options);\n        this.instantiationService = instantiationService;\n        this._onDidClose = new Emitter();\n        this.onDidClose = this._onDidClose.event;\n        objects.mixin(this.options, defaultOptions, false);\n    }\n    dispose() {\n        if (!this.disposed) {\n            this.disposed = true; // prevent consumers who dispose on onDidClose from looping\n            super.dispose();\n            this._onDidClose.fire(this);\n        }\n    }\n    style(styles) {\n        const options = this.options;\n        if (styles.headerBackgroundColor) {\n            options.headerBackgroundColor = styles.headerBackgroundColor;\n        }\n        if (styles.primaryHeadingColor) {\n            options.primaryHeadingColor = styles.primaryHeadingColor;\n        }\n        if (styles.secondaryHeadingColor) {\n            options.secondaryHeadingColor = styles.secondaryHeadingColor;\n        }\n        super.style(styles);\n    }\n    _applyStyles() {\n        super._applyStyles();\n        const options = this.options;\n        if (this._headElement && options.headerBackgroundColor) {\n            this._headElement.style.backgroundColor = options.headerBackgroundColor.toString();\n        }\n        if (this._primaryHeading && options.primaryHeadingColor) {\n            this._primaryHeading.style.color = options.primaryHeadingColor.toString();\n        }\n        if (this._secondaryHeading && options.secondaryHeadingColor) {\n            this._secondaryHeading.style.color = options.secondaryHeadingColor.toString();\n        }\n        if (this._bodyElement && options.frameColor) {\n            this._bodyElement.style.borderColor = options.frameColor.toString();\n        }\n    }\n    _fillContainer(container) {\n        this.setCssClass('peekview-widget');\n        this._headElement = dom.$('.head');\n        this._bodyElement = dom.$('.body');\n        this._fillHead(this._headElement);\n        this._fillBody(this._bodyElement);\n        container.appendChild(this._headElement);\n        container.appendChild(this._bodyElement);\n    }\n    _fillHead(container, noCloseAction) {\n        this._titleElement = dom.$('.peekview-title');\n        if (this.options.supportOnTitleClick) {\n            this._titleElement.classList.add('clickable');\n            dom.addStandardDisposableListener(this._titleElement, 'click', event => this._onTitleClick(event));\n        }\n        dom.append(this._headElement, this._titleElement);\n        this._fillTitleIcon(this._titleElement);\n        this._primaryHeading = dom.$('span.filename');\n        this._secondaryHeading = dom.$('span.dirname');\n        this._metaHeading = dom.$('span.meta');\n        dom.append(this._titleElement, this._primaryHeading, this._secondaryHeading, this._metaHeading);\n        const actionsContainer = dom.$('.peekview-actions');\n        dom.append(this._headElement, actionsContainer);\n        const actionBarOptions = this._getActionBarOptions();\n        this._actionbarWidget = new ActionBar(actionsContainer, actionBarOptions);\n        this._disposables.add(this._actionbarWidget);\n        if (!noCloseAction) {\n            this._actionbarWidget.push(new Action('peekview.close', nls.localize('label.close', \"Close\"), ThemeIcon.asClassName(Codicon.close), true, () => {\n                this.dispose();\n                return Promise.resolve();\n            }), { label: false, icon: true });\n        }\n    }\n    _fillTitleIcon(container) {\n    }\n    _getActionBarOptions() {\n        return {\n            actionViewItemProvider: createActionViewItem.bind(undefined, this.instantiationService),\n            orientation: 0 /* ActionsOrientation.HORIZONTAL */\n        };\n    }\n    _onTitleClick(event) {\n        // implement me if supportOnTitleClick option is set\n    }\n    setTitle(primaryHeading, secondaryHeading) {\n        if (this._primaryHeading && this._secondaryHeading) {\n            this._primaryHeading.innerText = primaryHeading;\n            this._primaryHeading.setAttribute('title', primaryHeading);\n            if (secondaryHeading) {\n                this._secondaryHeading.innerText = secondaryHeading;\n            }\n            else {\n                dom.clearNode(this._secondaryHeading);\n            }\n        }\n    }\n    setMetaTitle(value) {\n        if (this._metaHeading) {\n            if (value) {\n                this._metaHeading.innerText = value;\n                dom.show(this._metaHeading);\n            }\n            else {\n                dom.hide(this._metaHeading);\n            }\n        }\n    }\n    _doLayout(heightInPixel, widthInPixel) {\n        if (!this._isShowing && heightInPixel < 0) {\n            // Looks like the view zone got folded away!\n            this.dispose();\n            return;\n        }\n        const headHeight = Math.ceil(this.editor.getOption(67 /* EditorOption.lineHeight */) * 1.2);\n        const bodyHeight = Math.round(heightInPixel - (headHeight + 2 /* the border-top/bottom width*/));\n        this._doLayoutHead(headHeight, widthInPixel);\n        this._doLayoutBody(bodyHeight, widthInPixel);\n    }\n    _doLayoutHead(heightInPixel, widthInPixel) {\n        if (this._headElement) {\n            this._headElement.style.height = `${heightInPixel}px`;\n            this._headElement.style.lineHeight = this._headElement.style.height;\n        }\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        if (this._bodyElement) {\n            this._bodyElement.style.height = `${heightInPixel}px`;\n        }\n    }\n};\nPeekViewWidget = __decorate([\n    __param(2, IInstantiationService)\n], PeekViewWidget);\nexport { PeekViewWidget };\nexport const peekViewTitleBackground = registerColor('peekViewTitle.background', { dark: '#252526', light: '#F3F3F3', hcDark: Color.black, hcLight: Color.white }, nls.localize('peekViewTitleBackground', 'Background color of the peek view title area.'));\nexport const peekViewTitleForeground = registerColor('peekViewTitleLabel.foreground', { dark: Color.white, light: Color.black, hcDark: Color.white, hcLight: editorForeground }, nls.localize('peekViewTitleForeground', 'Color of the peek view title.'));\nexport const peekViewTitleInfoForeground = registerColor('peekViewTitleDescription.foreground', { dark: '#ccccccb3', light: '#616161', hcDark: '#FFFFFF99', hcLight: '#292929' }, nls.localize('peekViewTitleInfoForeground', 'Color of the peek view title info.'));\nexport const peekViewBorder = registerColor('peekView.border', { dark: editorInfoForeground, light: editorInfoForeground, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('peekViewBorder', 'Color of the peek view borders and arrow.'));\nexport const peekViewResultsBackground = registerColor('peekViewResult.background', { dark: '#252526', light: '#F3F3F3', hcDark: Color.black, hcLight: Color.white }, nls.localize('peekViewResultsBackground', 'Background color of the peek view result list.'));\nexport const peekViewResultsMatchForeground = registerColor('peekViewResult.lineForeground', { dark: '#bbbbbb', light: '#646465', hcDark: Color.white, hcLight: editorForeground }, nls.localize('peekViewResultsMatchForeground', 'Foreground color for line nodes in the peek view result list.'));\nexport const peekViewResultsFileForeground = registerColor('peekViewResult.fileForeground', { dark: Color.white, light: '#1E1E1E', hcDark: Color.white, hcLight: editorForeground }, nls.localize('peekViewResultsFileForeground', 'Foreground color for file nodes in the peek view result list.'));\nexport const peekViewResultsSelectionBackground = registerColor('peekViewResult.selectionBackground', { dark: '#3399ff33', light: '#3399ff33', hcDark: null, hcLight: null }, nls.localize('peekViewResultsSelectionBackground', 'Background color of the selected entry in the peek view result list.'));\nexport const peekViewResultsSelectionForeground = registerColor('peekViewResult.selectionForeground', { dark: Color.white, light: '#6C6C6C', hcDark: Color.white, hcLight: editorForeground }, nls.localize('peekViewResultsSelectionForeground', 'Foreground color of the selected entry in the peek view result list.'));\nexport const peekViewEditorBackground = registerColor('peekViewEditor.background', { dark: '#001F33', light: '#F2F8FC', hcDark: Color.black, hcLight: Color.white }, nls.localize('peekViewEditorBackground', 'Background color of the peek view editor.'));\nexport const peekViewEditorGutterBackground = registerColor('peekViewEditorGutter.background', peekViewEditorBackground, nls.localize('peekViewEditorGutterBackground', 'Background color of the gutter in the peek view editor.'));\nexport const peekViewEditorStickyScrollBackground = registerColor('peekViewEditorStickyScroll.background', peekViewEditorBackground, nls.localize('peekViewEditorStickScrollBackground', 'Background color of sticky scroll in the peek view editor.'));\nexport const peekViewResultsMatchHighlight = registerColor('peekViewResult.matchHighlightBackground', { dark: '#ea5c004d', light: '#ea5c004d', hcDark: null, hcLight: null }, nls.localize('peekViewResultsMatchHighlight', 'Match highlight color in the peek view result list.'));\nexport const peekViewEditorMatchHighlight = registerColor('peekViewEditor.matchHighlightBackground', { dark: '#ff8f0099', light: '#f5d802de', hcDark: null, hcLight: null }, nls.localize('peekViewEditorMatchHighlight', 'Match highlight color in the peek view editor.'));\nexport const peekViewEditorMatchHighlightBorder = registerColor('peekViewEditor.matchHighlightBorder', { dark: null, light: null, hcDark: activeContrastBorder, hcLight: activeContrastBorder }, nls.localize('peekViewEditorMatchHighlightBorder', 'Match highlight border in the peek view editor.'));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { defaultGenerator } from '../../../../base/common/idGenerator.js';\nimport { dispose } from '../../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nimport { basename, extUri } from '../../../../base/common/resources.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nexport class OneReference {\n    constructor(isProviderFirst, parent, link, _rangeCallback) {\n        this.isProviderFirst = isProviderFirst;\n        this.parent = parent;\n        this.link = link;\n        this._rangeCallback = _rangeCallback;\n        this.id = defaultGenerator.nextId();\n    }\n    get uri() {\n        return this.link.uri;\n    }\n    get range() {\n        return this._range ?? this.link.targetSelectionRange ?? this.link.range;\n    }\n    set range(value) {\n        this._range = value;\n        this._rangeCallback(this);\n    }\n    get ariaMessage() {\n        const preview = this.parent.getPreview(this)?.preview(this.range);\n        if (!preview) {\n            return localize('aria.oneReference', \"in {0} on line {1} at column {2}\", basename(this.uri), this.range.startLineNumber, this.range.startColumn);\n        }\n        else {\n            return localize({ key: 'aria.oneReference.preview', comment: ['Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code'] }, \"{0} in {1} on line {2} at column {3}\", preview.value, basename(this.uri), this.range.startLineNumber, this.range.startColumn);\n        }\n    }\n}\nexport class FilePreview {\n    constructor(_modelReference) {\n        this._modelReference = _modelReference;\n    }\n    dispose() {\n        this._modelReference.dispose();\n    }\n    preview(range, n = 8) {\n        const model = this._modelReference.object.textEditorModel;\n        if (!model) {\n            return undefined;\n        }\n        const { startLineNumber, startColumn, endLineNumber, endColumn } = range;\n        const word = model.getWordUntilPosition({ lineNumber: startLineNumber, column: startColumn - n });\n        const beforeRange = new Range(startLineNumber, word.startColumn, startLineNumber, startColumn);\n        const afterRange = new Range(endLineNumber, endColumn, endLineNumber, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n        const before = model.getValueInRange(beforeRange).replace(/^\\s+/, '');\n        const inside = model.getValueInRange(range);\n        const after = model.getValueInRange(afterRange).replace(/\\s+$/, '');\n        return {\n            value: before + inside + after,\n            highlight: { start: before.length, end: before.length + inside.length }\n        };\n    }\n}\nexport class FileReferences {\n    constructor(parent, uri) {\n        this.parent = parent;\n        this.uri = uri;\n        this.children = [];\n        this._previews = new ResourceMap();\n    }\n    dispose() {\n        dispose(this._previews.values());\n        this._previews.clear();\n    }\n    getPreview(child) {\n        return this._previews.get(child.uri);\n    }\n    get ariaMessage() {\n        const len = this.children.length;\n        if (len === 1) {\n            return localize('aria.fileReferences.1', \"1 symbol in {0}, full path {1}\", basename(this.uri), this.uri.fsPath);\n        }\n        else {\n            return localize('aria.fileReferences.N', \"{0} symbols in {1}, full path {2}\", len, basename(this.uri), this.uri.fsPath);\n        }\n    }\n    async resolve(textModelResolverService) {\n        if (this._previews.size !== 0) {\n            return this;\n        }\n        for (const child of this.children) {\n            if (this._previews.has(child.uri)) {\n                continue;\n            }\n            try {\n                const ref = await textModelResolverService.createModelReference(child.uri);\n                this._previews.set(child.uri, new FilePreview(ref));\n            }\n            catch (err) {\n                onUnexpectedError(err);\n            }\n        }\n        return this;\n    }\n}\nexport class ReferencesModel {\n    constructor(links, title) {\n        this.groups = [];\n        this.references = [];\n        this._onDidChangeReferenceRange = new Emitter();\n        this.onDidChangeReferenceRange = this._onDidChangeReferenceRange.event;\n        this._links = links;\n        this._title = title;\n        // grouping and sorting\n        const [providersFirst] = links;\n        links.sort(ReferencesModel._compareReferences);\n        let current;\n        for (const link of links) {\n            if (!current || !extUri.isEqual(current.uri, link.uri, true)) {\n                // new group\n                current = new FileReferences(this, link.uri);\n                this.groups.push(current);\n            }\n            // append, check for equality first!\n            if (current.children.length === 0 || ReferencesModel._compareReferences(link, current.children[current.children.length - 1]) !== 0) {\n                const oneRef = new OneReference(providersFirst === link, current, link, ref => this._onDidChangeReferenceRange.fire(ref));\n                this.references.push(oneRef);\n                current.children.push(oneRef);\n            }\n        }\n    }\n    dispose() {\n        dispose(this.groups);\n        this._onDidChangeReferenceRange.dispose();\n        this.groups.length = 0;\n    }\n    clone() {\n        return new ReferencesModel(this._links, this._title);\n    }\n    get title() {\n        return this._title;\n    }\n    get isEmpty() {\n        return this.groups.length === 0;\n    }\n    get ariaMessage() {\n        if (this.isEmpty) {\n            return localize('aria.result.0', \"No results found\");\n        }\n        else if (this.references.length === 1) {\n            return localize('aria.result.1', \"Found 1 symbol in {0}\", this.references[0].uri.fsPath);\n        }\n        else if (this.groups.length === 1) {\n            return localize('aria.result.n1', \"Found {0} symbols in {1}\", this.references.length, this.groups[0].uri.fsPath);\n        }\n        else {\n            return localize('aria.result.nm', \"Found {0} symbols in {1} files\", this.references.length, this.groups.length);\n        }\n    }\n    nextOrPreviousReference(reference, next) {\n        const { parent } = reference;\n        let idx = parent.children.indexOf(reference);\n        const childCount = parent.children.length;\n        const groupCount = parent.parent.groups.length;\n        if (groupCount === 1 || next && idx + 1 < childCount || !next && idx > 0) {\n            // cycling within one file\n            if (next) {\n                idx = (idx + 1) % childCount;\n            }\n            else {\n                idx = (idx + childCount - 1) % childCount;\n            }\n            return parent.children[idx];\n        }\n        idx = parent.parent.groups.indexOf(parent);\n        if (next) {\n            idx = (idx + 1) % groupCount;\n            return parent.parent.groups[idx].children[0];\n        }\n        else {\n            idx = (idx + groupCount - 1) % groupCount;\n            return parent.parent.groups[idx].children[parent.parent.groups[idx].children.length - 1];\n        }\n    }\n    nearestReference(resource, position) {\n        const nearest = this.references.map((ref, idx) => {\n            return {\n                idx,\n                prefixLen: strings.commonPrefixLength(ref.uri.toString(), resource.toString()),\n                offsetDist: Math.abs(ref.range.startLineNumber - position.lineNumber) * 100 + Math.abs(ref.range.startColumn - position.column)\n            };\n        }).sort((a, b) => {\n            if (a.prefixLen > b.prefixLen) {\n                return -1;\n            }\n            else if (a.prefixLen < b.prefixLen) {\n                return 1;\n            }\n            else if (a.offsetDist < b.offsetDist) {\n                return -1;\n            }\n            else if (a.offsetDist > b.offsetDist) {\n                return 1;\n            }\n            else {\n                return 0;\n            }\n        })[0];\n        if (nearest) {\n            return this.references[nearest.idx];\n        }\n        return undefined;\n    }\n    referenceAt(resource, position) {\n        for (const ref of this.references) {\n            if (ref.uri.toString() === resource.toString()) {\n                if (Range.containsPosition(ref.range, position)) {\n                    return ref;\n                }\n            }\n        }\n        return undefined;\n    }\n    firstReference() {\n        for (const ref of this.references) {\n            if (ref.isProviderFirst) {\n                return ref;\n            }\n        }\n        return this.references[0];\n    }\n    static _compareReferences(a, b) {\n        return extUri.compare(a.uri, b.uri) || Range.compareRangesUsingStarts(a.range, b.range);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar FileReferencesRenderer_1;\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { CountBadge } from '../../../../../base/browser/ui/countBadge/countBadge.js';\nimport { HighlightedLabel } from '../../../../../base/browser/ui/highlightedlabel/highlightedLabel.js';\nimport { IconLabel } from '../../../../../base/browser/ui/iconLabel/iconLabel.js';\nimport { createMatches, FuzzyScore } from '../../../../../base/common/filters.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { basename, dirname } from '../../../../../base/common/resources.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { localize } from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { defaultCountBadgeStyles } from '../../../../../platform/theme/browser/defaultStyles.js';\nimport { FileReferences, OneReference, ReferencesModel } from '../referencesModel.js';\nlet DataSource = class DataSource {\n    constructor(_resolverService) {\n        this._resolverService = _resolverService;\n    }\n    hasChildren(element) {\n        if (element instanceof ReferencesModel) {\n            return true;\n        }\n        if (element instanceof FileReferences) {\n            return true;\n        }\n        return false;\n    }\n    getChildren(element) {\n        if (element instanceof ReferencesModel) {\n            return element.groups;\n        }\n        if (element instanceof FileReferences) {\n            return element.resolve(this._resolverService).then(val => {\n                // if (element.failure) {\n                // \t// refresh the element on failure so that\n                // \t// we can update its rendering\n                // \treturn tree.refresh(element).then(() => val.children);\n                // }\n                return val.children;\n            });\n        }\n        throw new Error('bad tree');\n    }\n};\nDataSource = __decorate([\n    __param(0, ITextModelService)\n], DataSource);\nexport { DataSource };\n//#endregion\nexport class Delegate {\n    getHeight() {\n        return 23;\n    }\n    getTemplateId(element) {\n        if (element instanceof FileReferences) {\n            return FileReferencesRenderer.id;\n        }\n        else {\n            return OneReferenceRenderer.id;\n        }\n    }\n}\nlet StringRepresentationProvider = class StringRepresentationProvider {\n    constructor(_keybindingService) {\n        this._keybindingService = _keybindingService;\n    }\n    getKeyboardNavigationLabel(element) {\n        if (element instanceof OneReference) {\n            const parts = element.parent.getPreview(element)?.preview(element.range);\n            if (parts) {\n                return parts.value;\n            }\n        }\n        // FileReferences or unresolved OneReference\n        return basename(element.uri);\n    }\n};\nStringRepresentationProvider = __decorate([\n    __param(0, IKeybindingService)\n], StringRepresentationProvider);\nexport { StringRepresentationProvider };\nexport class IdentityProvider {\n    getId(element) {\n        return element instanceof OneReference ? element.id : element.uri;\n    }\n}\n//#region render: File\nlet FileReferencesTemplate = class FileReferencesTemplate extends Disposable {\n    constructor(container, _labelService) {\n        super();\n        this._labelService = _labelService;\n        const parent = document.createElement('div');\n        parent.classList.add('reference-file');\n        this.file = this._register(new IconLabel(parent, { supportHighlights: true }));\n        this.badge = new CountBadge(dom.append(parent, dom.$('.count')), {}, defaultCountBadgeStyles);\n        container.appendChild(parent);\n    }\n    set(element, matches) {\n        const parent = dirname(element.uri);\n        this.file.setLabel(this._labelService.getUriBasenameLabel(element.uri), this._labelService.getUriLabel(parent, { relative: true }), { title: this._labelService.getUriLabel(element.uri), matches });\n        const len = element.children.length;\n        this.badge.setCount(len);\n        if (len > 1) {\n            this.badge.setTitleFormat(localize('referencesCount', \"{0} references\", len));\n        }\n        else {\n            this.badge.setTitleFormat(localize('referenceCount', \"{0} reference\", len));\n        }\n    }\n};\nFileReferencesTemplate = __decorate([\n    __param(1, ILabelService)\n], FileReferencesTemplate);\nlet FileReferencesRenderer = class FileReferencesRenderer {\n    static { FileReferencesRenderer_1 = this; }\n    static { this.id = 'FileReferencesRenderer'; }\n    constructor(_instantiationService) {\n        this._instantiationService = _instantiationService;\n        this.templateId = FileReferencesRenderer_1.id;\n    }\n    renderTemplate(container) {\n        return this._instantiationService.createInstance(FileReferencesTemplate, container);\n    }\n    renderElement(node, index, template) {\n        template.set(node.element, createMatches(node.filterData));\n    }\n    disposeTemplate(templateData) {\n        templateData.dispose();\n    }\n};\nFileReferencesRenderer = FileReferencesRenderer_1 = __decorate([\n    __param(0, IInstantiationService)\n], FileReferencesRenderer);\nexport { FileReferencesRenderer };\n//#endregion\n//#region render: Reference\nclass OneReferenceTemplate extends Disposable {\n    constructor(container) {\n        super();\n        this.label = this._register(new HighlightedLabel(container));\n    }\n    set(element, score) {\n        const preview = element.parent.getPreview(element)?.preview(element.range);\n        if (!preview || !preview.value) {\n            // this means we FAILED to resolve the document or the value is the empty string\n            this.label.set(`${basename(element.uri)}:${element.range.startLineNumber + 1}:${element.range.startColumn + 1}`);\n        }\n        else {\n            // render search match as highlight unless\n            // we have score, then render the score\n            const { value, highlight } = preview;\n            if (score && !FuzzyScore.isDefault(score)) {\n                this.label.element.classList.toggle('referenceMatch', false);\n                this.label.set(value, createMatches(score));\n            }\n            else {\n                this.label.element.classList.toggle('referenceMatch', true);\n                this.label.set(value, [highlight]);\n            }\n        }\n    }\n}\nexport class OneReferenceRenderer {\n    constructor() {\n        this.templateId = OneReferenceRenderer.id;\n    }\n    static { this.id = 'OneReferenceRenderer'; }\n    renderTemplate(container) {\n        return new OneReferenceTemplate(container);\n    }\n    renderElement(node, index, templateData) {\n        templateData.set(node.element, node.filterData);\n    }\n    disposeTemplate(templateData) {\n        templateData.dispose();\n    }\n}\n//#endregion\nexport class AccessibilityProvider {\n    getWidgetAriaLabel() {\n        return localize('treeAriaLabel', \"References\");\n    }\n    getAriaLabel(element) {\n        return element.ariaMessage;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { Sizing, SplitView } from '../../../../../base/browser/ui/splitview/splitview.js';\nimport { Color } from '../../../../../base/common/color.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { basenameOrAuthority, dirname } from '../../../../../base/common/resources.js';\nimport './referencesWidget.css';\nimport { EmbeddedCodeEditorWidget } from '../../../../browser/widget/codeEditor/embeddedCodeEditorWidget.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ModelDecorationOptions, TextModel } from '../../../../common/model/textModel.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../../../../common/languages/modesRegistry.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { AccessibilityProvider, DataSource, Delegate, FileReferencesRenderer, IdentityProvider, OneReferenceRenderer, StringRepresentationProvider } from './referencesTree.js';\nimport * as peekView from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { WorkbenchAsyncDataTree } from '../../../../../platform/list/browser/listService.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { FileReferences, OneReference } from '../referencesModel.js';\nclass DecorationsManager {\n    static { this.DecorationOptions = ModelDecorationOptions.register({\n        description: 'reference-decoration',\n        stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n        className: 'reference-decoration'\n    }); }\n    constructor(_editor, _model) {\n        this._editor = _editor;\n        this._model = _model;\n        this._decorations = new Map();\n        this._decorationIgnoreSet = new Set();\n        this._callOnDispose = new DisposableStore();\n        this._callOnModelChange = new DisposableStore();\n        this._callOnDispose.add(this._editor.onDidChangeModel(() => this._onModelChanged()));\n        this._onModelChanged();\n    }\n    dispose() {\n        this._callOnModelChange.dispose();\n        this._callOnDispose.dispose();\n        this.removeDecorations();\n    }\n    _onModelChanged() {\n        this._callOnModelChange.clear();\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const ref of this._model.references) {\n            if (ref.uri.toString() === model.uri.toString()) {\n                this._addDecorations(ref.parent);\n                return;\n            }\n        }\n    }\n    _addDecorations(reference) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(() => this._onDecorationChanged()));\n        const newDecorations = [];\n        const newDecorationsActualIndex = [];\n        for (let i = 0, len = reference.children.length; i < len; i++) {\n            const oneReference = reference.children[i];\n            if (this._decorationIgnoreSet.has(oneReference.id)) {\n                continue;\n            }\n            if (oneReference.uri.toString() !== this._editor.getModel().uri.toString()) {\n                continue;\n            }\n            newDecorations.push({\n                range: oneReference.range,\n                options: DecorationsManager.DecorationOptions\n            });\n            newDecorationsActualIndex.push(i);\n        }\n        this._editor.changeDecorations((changeAccessor) => {\n            const decorations = changeAccessor.deltaDecorations([], newDecorations);\n            for (let i = 0; i < decorations.length; i++) {\n                this._decorations.set(decorations[i], reference.children[newDecorationsActualIndex[i]]);\n            }\n        });\n    }\n    _onDecorationChanged() {\n        const toRemove = [];\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const [decorationId, reference] of this._decorations) {\n            const newRange = model.getDecorationRange(decorationId);\n            if (!newRange) {\n                continue;\n            }\n            let ignore = false;\n            if (Range.equalsRange(newRange, reference.range)) {\n                continue;\n            }\n            if (Range.spansMultipleLines(newRange)) {\n                ignore = true;\n            }\n            else {\n                const lineLength = reference.range.endColumn - reference.range.startColumn;\n                const newLineLength = newRange.endColumn - newRange.startColumn;\n                if (lineLength !== newLineLength) {\n                    ignore = true;\n                }\n            }\n            if (ignore) {\n                this._decorationIgnoreSet.add(reference.id);\n                toRemove.push(decorationId);\n            }\n            else {\n                reference.range = newRange;\n            }\n        }\n        for (let i = 0, len = toRemove.length; i < len; i++) {\n            this._decorations.delete(toRemove[i]);\n        }\n        this._editor.removeDecorations(toRemove);\n    }\n    removeDecorations() {\n        this._editor.removeDecorations([...this._decorations.keys()]);\n        this._decorations.clear();\n    }\n}\nexport class LayoutData {\n    constructor() {\n        this.ratio = 0.7;\n        this.heightInLines = 18;\n    }\n    static fromJSON(raw) {\n        let ratio;\n        let heightInLines;\n        try {\n            const data = JSON.parse(raw);\n            ratio = data.ratio;\n            heightInLines = data.heightInLines;\n        }\n        catch {\n            //\n        }\n        return {\n            ratio: ratio || 0.7,\n            heightInLines: heightInLines || 18\n        };\n    }\n}\nclass ReferencesTree extends WorkbenchAsyncDataTree {\n}\n/**\n * ZoneWidget that is shown inside the editor\n */\nlet ReferenceWidget = class ReferenceWidget extends peekView.PeekViewWidget {\n    constructor(editor, _defaultTreeKeyboardSupport, layoutData, themeService, _textModelResolverService, _instantiationService, _peekViewService, _uriLabel, _keybindingService) {\n        super(editor, { showFrame: false, showArrow: true, isResizeable: true, isAccessible: true, supportOnTitleClick: true }, _instantiationService);\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this.layoutData = layoutData;\n        this._textModelResolverService = _textModelResolverService;\n        this._instantiationService = _instantiationService;\n        this._peekViewService = _peekViewService;\n        this._uriLabel = _uriLabel;\n        this._keybindingService = _keybindingService;\n        this._disposeOnNewModel = new DisposableStore();\n        this._callOnDispose = new DisposableStore();\n        this._onDidSelectReference = new Emitter();\n        this.onDidSelectReference = this._onDidSelectReference.event;\n        this._dim = new dom.Dimension(0, 0);\n        this._isClosing = false; // whether or not a dispose is already in progress\n        this._applyTheme(themeService.getColorTheme());\n        this._callOnDispose.add(themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this._peekViewService.addExclusiveWidget(editor, this);\n        this.create();\n    }\n    get isClosing() {\n        return this._isClosing;\n    }\n    dispose() {\n        this._isClosing = true;\n        this.setModel(undefined);\n        this._callOnDispose.dispose();\n        this._disposeOnNewModel.dispose();\n        dispose(this._preview);\n        dispose(this._previewNotAvailableMessage);\n        dispose(this._tree);\n        dispose(this._previewModelReference);\n        this._splitView.dispose();\n        super.dispose();\n    }\n    _applyTheme(theme) {\n        const borderColor = theme.getColor(peekView.peekViewBorder) || Color.transparent;\n        this.style({\n            arrowColor: borderColor,\n            frameColor: borderColor,\n            headerBackgroundColor: theme.getColor(peekView.peekViewTitleBackground) || Color.transparent,\n            primaryHeadingColor: theme.getColor(peekView.peekViewTitleForeground),\n            secondaryHeadingColor: theme.getColor(peekView.peekViewTitleInfoForeground)\n        });\n    }\n    show(where) {\n        super.show(where, this.layoutData.heightInLines || 18);\n    }\n    focusOnReferenceTree() {\n        this._tree.domFocus();\n    }\n    focusOnPreviewEditor() {\n        this._preview.focus();\n    }\n    isPreviewEditorFocused() {\n        return this._preview.hasTextFocus();\n    }\n    _onTitleClick(e) {\n        if (this._preview && this._preview.getModel()) {\n            this._onDidSelectReference.fire({\n                element: this._getFocusedReference(),\n                kind: e.ctrlKey || e.metaKey || e.altKey ? 'side' : 'open',\n                source: 'title'\n            });\n        }\n    }\n    _fillBody(containerElement) {\n        this.setCssClass('reference-zone-widget');\n        // message pane\n        this._messageContainer = dom.append(containerElement, dom.$('div.messages'));\n        dom.hide(this._messageContainer);\n        this._splitView = new SplitView(containerElement, { orientation: 1 /* Orientation.HORIZONTAL */ });\n        // editor\n        this._previewContainer = dom.append(containerElement, dom.$('div.preview.inline'));\n        const options = {\n            scrollBeyondLastLine: false,\n            scrollbar: {\n                verticalScrollbarSize: 14,\n                horizontal: 'auto',\n                useShadows: true,\n                verticalHasArrows: false,\n                horizontalHasArrows: false,\n                alwaysConsumeMouseWheel: true\n            },\n            overviewRulerLanes: 2,\n            fixedOverflowWidgets: true,\n            minimap: {\n                enabled: false\n            }\n        };\n        this._preview = this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._previewContainer, options, {}, this.editor);\n        dom.hide(this._previewContainer);\n        this._previewNotAvailableMessage = this._instantiationService.createInstance(TextModel, nls.localize('missingPreviewMessage', \"no preview available\"), PLAINTEXT_LANGUAGE_ID, TextModel.DEFAULT_CREATION_OPTIONS, null);\n        // tree\n        this._treeContainer = dom.append(containerElement, dom.$('div.ref-tree.inline'));\n        const treeOptions = {\n            keyboardSupport: this._defaultTreeKeyboardSupport,\n            accessibilityProvider: new AccessibilityProvider(),\n            keyboardNavigationLabelProvider: this._instantiationService.createInstance(StringRepresentationProvider),\n            identityProvider: new IdentityProvider(),\n            openOnSingleClick: true,\n            selectionNavigation: true,\n            overrideStyles: {\n                listBackground: peekView.peekViewResultsBackground\n            }\n        };\n        if (this._defaultTreeKeyboardSupport) {\n            // the tree will consume `Escape` and prevent the widget from closing\n            this._callOnDispose.add(dom.addStandardDisposableListener(this._treeContainer, 'keydown', (e) => {\n                if (e.equals(9 /* KeyCode.Escape */)) {\n                    this._keybindingService.dispatchEvent(e, e.target);\n                    e.stopPropagation();\n                }\n            }, true));\n        }\n        this._tree = this._instantiationService.createInstance(ReferencesTree, 'ReferencesWidget', this._treeContainer, new Delegate(), [\n            this._instantiationService.createInstance(FileReferencesRenderer),\n            this._instantiationService.createInstance(OneReferenceRenderer),\n        ], this._instantiationService.createInstance(DataSource), treeOptions);\n        // split stuff\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._previewContainer,\n            minimumSize: 200,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._preview.layout({ height: this._dim.height, width });\n            }\n        }, Sizing.Distribute);\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._treeContainer,\n            minimumSize: 100,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._treeContainer.style.height = `${this._dim.height}px`;\n                this._treeContainer.style.width = `${width}px`;\n                this._tree.layout(this._dim.height, width);\n            }\n        }, Sizing.Distribute);\n        this._disposables.add(this._splitView.onDidSashChange(() => {\n            if (this._dim.width) {\n                this.layoutData.ratio = this._splitView.getViewSize(0) / this._dim.width;\n            }\n        }, undefined));\n        // listen on selection and focus\n        const onEvent = (element, kind) => {\n            if (element instanceof OneReference) {\n                if (kind === 'show') {\n                    this._revealReference(element, false);\n                }\n                this._onDidSelectReference.fire({ element, kind, source: 'tree' });\n            }\n        };\n        this._disposables.add(this._tree.onDidOpen(e => {\n            if (e.sideBySide) {\n                onEvent(e.element, 'side');\n            }\n            else if (e.editorOptions.pinned) {\n                onEvent(e.element, 'goto');\n            }\n            else {\n                onEvent(e.element, 'show');\n            }\n        }));\n        dom.hide(this._treeContainer);\n    }\n    _onWidth(width) {\n        if (this._dim) {\n            this._doLayoutBody(this._dim.height, width);\n        }\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        super._doLayoutBody(heightInPixel, widthInPixel);\n        this._dim = new dom.Dimension(widthInPixel, heightInPixel);\n        this.layoutData.heightInLines = this._viewZone ? this._viewZone.heightInLines : this.layoutData.heightInLines;\n        this._splitView.layout(widthInPixel);\n        this._splitView.resizeView(0, widthInPixel * this.layoutData.ratio);\n    }\n    setSelection(selection) {\n        return this._revealReference(selection, true).then(() => {\n            if (!this._model) {\n                // disposed\n                return;\n            }\n            // show in tree\n            this._tree.setSelection([selection]);\n            this._tree.setFocus([selection]);\n        });\n    }\n    setModel(newModel) {\n        // clean up\n        this._disposeOnNewModel.clear();\n        this._model = newModel;\n        if (this._model) {\n            return this._onNewModel();\n        }\n        return Promise.resolve();\n    }\n    _onNewModel() {\n        if (!this._model) {\n            return Promise.resolve(undefined);\n        }\n        if (this._model.isEmpty) {\n            this.setTitle('');\n            this._messageContainer.innerText = nls.localize('noResults', \"No results\");\n            dom.show(this._messageContainer);\n            return Promise.resolve(undefined);\n        }\n        dom.hide(this._messageContainer);\n        this._decorationsManager = new DecorationsManager(this._preview, this._model);\n        this._disposeOnNewModel.add(this._decorationsManager);\n        // listen on model changes\n        this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(reference => this._tree.rerender(reference)));\n        // listen on editor\n        this._disposeOnNewModel.add(this._preview.onMouseDown(e => {\n            const { event, target } = e;\n            if (event.detail !== 2) {\n                return;\n            }\n            const element = this._getFocusedReference();\n            if (!element) {\n                return;\n            }\n            this._onDidSelectReference.fire({\n                element: { uri: element.uri, range: target.range },\n                kind: (event.ctrlKey || event.metaKey || event.altKey) ? 'side' : 'open',\n                source: 'editor'\n            });\n        }));\n        // make sure things are rendered\n        this.container.classList.add('results-loaded');\n        dom.show(this._treeContainer);\n        dom.show(this._previewContainer);\n        this._splitView.layout(this._dim.width);\n        this.focusOnReferenceTree();\n        // pick input and a reference to begin with\n        return this._tree.setInput(this._model.groups.length === 1 ? this._model.groups[0] : this._model);\n    }\n    _getFocusedReference() {\n        const [element] = this._tree.getFocus();\n        if (element instanceof OneReference) {\n            return element;\n        }\n        else if (element instanceof FileReferences) {\n            if (element.children.length > 0) {\n                return element.children[0];\n            }\n        }\n        return undefined;\n    }\n    async revealReference(reference) {\n        await this._revealReference(reference, false);\n        this._onDidSelectReference.fire({ element: reference, kind: 'goto', source: 'tree' });\n    }\n    async _revealReference(reference, revealParent) {\n        // check if there is anything to do...\n        if (this._revealedReference === reference) {\n            return;\n        }\n        this._revealedReference = reference;\n        // Update widget header\n        if (reference.uri.scheme !== Schemas.inMemory) {\n            this.setTitle(basenameOrAuthority(reference.uri), this._uriLabel.getUriLabel(dirname(reference.uri)));\n        }\n        else {\n            this.setTitle(nls.localize('peekView.alternateTitle', \"References\"));\n        }\n        const promise = this._textModelResolverService.createModelReference(reference.uri);\n        if (this._tree.getInput() === reference.parent) {\n            this._tree.reveal(reference);\n        }\n        else {\n            if (revealParent) {\n                this._tree.reveal(reference.parent);\n            }\n            await this._tree.expand(reference.parent);\n            this._tree.reveal(reference);\n        }\n        const ref = await promise;\n        if (!this._model) {\n            // disposed\n            ref.dispose();\n            return;\n        }\n        dispose(this._previewModelReference);\n        // show in editor\n        const model = ref.object;\n        if (model) {\n            const scrollType = this._preview.getModel() === model.textEditorModel ? 0 /* ScrollType.Smooth */ : 1 /* ScrollType.Immediate */;\n            const sel = Range.lift(reference.range).collapseToStart();\n            this._previewModelReference = ref;\n            this._preview.setModel(model.textEditorModel);\n            this._preview.setSelection(sel);\n            this._preview.revealRangeInCenter(sel, scrollType);\n        }\n        else {\n            this._preview.setModel(this._previewNotAvailableMessage);\n            ref.dispose();\n        }\n    }\n};\nReferenceWidget = __decorate([\n    __param(3, IThemeService),\n    __param(4, ITextModelService),\n    __param(5, IInstantiationService),\n    __param(6, peekView.IPeekViewService),\n    __param(7, ILabelService),\n    __param(8, IKeybindingService)\n], ReferenceWidget);\nexport { ReferenceWidget };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ReferencesController_1;\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ICodeEditorService } from '../../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { getOuterEditor, PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { CommandsRegistry } from '../../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { KeybindingsRegistry } from '../../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { IListService, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse, WorkbenchTreeElementCanExpand } from '../../../../../platform/list/browser/listService.js';\nimport { INotificationService } from '../../../../../platform/notification/common/notification.js';\nimport { IStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { OneReference } from '../referencesModel.js';\nimport { LayoutData, ReferenceWidget } from './referencesWidget.js';\nimport { EditorContextKeys } from '../../../../common/editorContextKeys.js';\nimport { InputFocusedContext } from '../../../../../platform/contextkey/common/contextkeys.js';\nexport const ctxReferenceSearchVisible = new RawContextKey('referenceSearchVisible', false, nls.localize('referenceSearchVisible', \"Whether reference peek is visible, like 'Peek References' or 'Peek Definition'\"));\nlet ReferencesController = class ReferencesController {\n    static { ReferencesController_1 = this; }\n    static { this.ID = 'editor.contrib.referencesController'; }\n    static get(editor) {\n        return editor.getContribution(ReferencesController_1.ID);\n    }\n    constructor(_defaultTreeKeyboardSupport, _editor, contextKeyService, _editorService, _notificationService, _instantiationService, _storageService, _configurationService) {\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this._editor = _editor;\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._instantiationService = _instantiationService;\n        this._storageService = _storageService;\n        this._configurationService = _configurationService;\n        this._disposables = new DisposableStore();\n        this._requestIdPool = 0;\n        this._ignoreModelChangeEvent = false;\n        this._referenceSearchVisible = ctxReferenceSearchVisible.bindTo(contextKeyService);\n    }\n    dispose() {\n        this._referenceSearchVisible.reset();\n        this._disposables.dispose();\n        this._widget?.dispose();\n        this._model?.dispose();\n        this._widget = undefined;\n        this._model = undefined;\n    }\n    toggleWidget(range, modelPromise, peekMode) {\n        // close current widget and return early is position didn't change\n        let widgetPosition;\n        if (this._widget) {\n            widgetPosition = this._widget.position;\n        }\n        this.closeWidget();\n        if (!!widgetPosition && range.containsPosition(widgetPosition)) {\n            return;\n        }\n        this._peekMode = peekMode;\n        this._referenceSearchVisible.set(true);\n        // close the widget on model/mode changes\n        this._disposables.add(this._editor.onDidChangeModelLanguage(() => { this.closeWidget(); }));\n        this._disposables.add(this._editor.onDidChangeModel(() => {\n            if (!this._ignoreModelChangeEvent) {\n                this.closeWidget();\n            }\n        }));\n        const storageKey = 'peekViewLayout';\n        const data = LayoutData.fromJSON(this._storageService.get(storageKey, 0 /* StorageScope.PROFILE */, '{}'));\n        this._widget = this._instantiationService.createInstance(ReferenceWidget, this._editor, this._defaultTreeKeyboardSupport, data);\n        this._widget.setTitle(nls.localize('labelLoading', \"Loading...\"));\n        this._widget.show(range);\n        this._disposables.add(this._widget.onDidClose(() => {\n            modelPromise.cancel();\n            if (this._widget) {\n                this._storageService.store(storageKey, JSON.stringify(this._widget.layoutData), 0 /* StorageScope.PROFILE */, 1 /* StorageTarget.MACHINE */);\n                if (!this._widget.isClosing) {\n                    // to prevent calling this too many times, check whether it was already closing.\n                    this.closeWidget();\n                }\n                this._widget = undefined;\n            }\n            else {\n                this.closeWidget();\n            }\n        }));\n        this._disposables.add(this._widget.onDidSelectReference(event => {\n            const { element, kind } = event;\n            if (!element) {\n                return;\n            }\n            switch (kind) {\n                case 'open':\n                    if (event.source !== 'editor' || !this._configurationService.getValue('editor.stablePeek')) {\n                        // when stable peek is configured we don't close\n                        // the peek window on selecting the editor\n                        this.openReference(element, false, false);\n                    }\n                    break;\n                case 'side':\n                    this.openReference(element, true, false);\n                    break;\n                case 'goto':\n                    if (peekMode) {\n                        this._gotoReference(element, true);\n                    }\n                    else {\n                        this.openReference(element, false, true);\n                    }\n                    break;\n            }\n        }));\n        const requestId = ++this._requestIdPool;\n        modelPromise.then(model => {\n            // still current request? widget still open?\n            if (requestId !== this._requestIdPool || !this._widget) {\n                model.dispose();\n                return undefined;\n            }\n            this._model?.dispose();\n            this._model = model;\n            // show widget\n            return this._widget.setModel(this._model).then(() => {\n                if (this._widget && this._model && this._editor.hasModel()) { // might have been closed\n                    // set title\n                    if (!this._model.isEmpty) {\n                        this._widget.setMetaTitle(nls.localize('metaTitle.N', \"{0} ({1})\", this._model.title, this._model.references.length));\n                    }\n                    else {\n                        this._widget.setMetaTitle('');\n                    }\n                    // set 'best' selection\n                    const uri = this._editor.getModel().uri;\n                    const pos = new Position(range.startLineNumber, range.startColumn);\n                    const selection = this._model.nearestReference(uri, pos);\n                    if (selection) {\n                        return this._widget.setSelection(selection).then(() => {\n                            if (this._widget && this._editor.getOption(87 /* EditorOption.peekWidgetDefaultFocus */) === 'editor') {\n                                this._widget.focusOnPreviewEditor();\n                            }\n                        });\n                    }\n                }\n                return undefined;\n            });\n        }, error => {\n            this._notificationService.error(error);\n        });\n    }\n    changeFocusBetweenPreviewAndReferences() {\n        if (!this._widget) {\n            // can be called while still resolving...\n            return;\n        }\n        if (this._widget.isPreviewEditorFocused()) {\n            this._widget.focusOnReferenceTree();\n        }\n        else {\n            this._widget.focusOnPreviewEditor();\n        }\n    }\n    async goToNextOrPreviousReference(fwd) {\n        if (!this._editor.hasModel() || !this._model || !this._widget) {\n            // can be called while still resolving...\n            return;\n        }\n        const currentPosition = this._widget.position;\n        if (!currentPosition) {\n            return;\n        }\n        const source = this._model.nearestReference(this._editor.getModel().uri, currentPosition);\n        if (!source) {\n            return;\n        }\n        const target = this._model.nextOrPreviousReference(source, fwd);\n        const editorFocus = this._editor.hasTextFocus();\n        const previewEditorFocus = this._widget.isPreviewEditorFocused();\n        await this._widget.setSelection(target);\n        await this._gotoReference(target, false);\n        if (editorFocus) {\n            this._editor.focus();\n        }\n        else if (this._widget && previewEditorFocus) {\n            this._widget.focusOnPreviewEditor();\n        }\n    }\n    async revealReference(reference) {\n        if (!this._editor.hasModel() || !this._model || !this._widget) {\n            // can be called while still resolving...\n            return;\n        }\n        await this._widget.revealReference(reference);\n    }\n    closeWidget(focusEditor = true) {\n        this._widget?.dispose();\n        this._model?.dispose();\n        this._referenceSearchVisible.reset();\n        this._disposables.clear();\n        this._widget = undefined;\n        this._model = undefined;\n        if (focusEditor) {\n            this._editor.focus();\n        }\n        this._requestIdPool += 1; // Cancel pending requests\n    }\n    _gotoReference(ref, pinned) {\n        this._widget?.hide();\n        this._ignoreModelChangeEvent = true;\n        const range = Range.lift(ref.range).collapseToStart();\n        return this._editorService.openCodeEditor({\n            resource: ref.uri,\n            options: { selection: range, selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */, pinned }\n        }, this._editor).then(openedEditor => {\n            this._ignoreModelChangeEvent = false;\n            if (!openedEditor || !this._widget) {\n                // something went wrong...\n                this.closeWidget();\n                return;\n            }\n            if (this._editor === openedEditor) {\n                //\n                this._widget.show(range);\n                this._widget.focusOnReferenceTree();\n            }\n            else {\n                // we opened a different editor instance which means a different controller instance.\n                // therefore we stop with this controller and continue with the other\n                const other = ReferencesController_1.get(openedEditor);\n                const model = this._model.clone();\n                this.closeWidget();\n                openedEditor.focus();\n                other?.toggleWidget(range, createCancelablePromise(_ => Promise.resolve(model)), this._peekMode ?? false);\n            }\n        }, (err) => {\n            this._ignoreModelChangeEvent = false;\n            onUnexpectedError(err);\n        });\n    }\n    openReference(ref, sideBySide, pinned) {\n        // clear stage\n        if (!sideBySide) {\n            this.closeWidget();\n        }\n        const { uri, range } = ref;\n        this._editorService.openCodeEditor({\n            resource: uri,\n            options: { selection: range, selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */, pinned }\n        }, this._editor, sideBySide);\n    }\n};\nReferencesController = ReferencesController_1 = __decorate([\n    __param(2, IContextKeyService),\n    __param(3, ICodeEditorService),\n    __param(4, INotificationService),\n    __param(5, IInstantiationService),\n    __param(6, IStorageService),\n    __param(7, IConfigurationService)\n], ReferencesController);\nexport { ReferencesController };\nfunction withController(accessor, fn) {\n    const outerEditor = getOuterEditor(accessor);\n    if (!outerEditor) {\n        return;\n    }\n    const controller = ReferencesController.get(outerEditor);\n    if (controller) {\n        fn(controller);\n    }\n}\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'togglePeekWidgetFocus',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 60 /* KeyCode.F2 */),\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.changeFocusBetweenPreviewAndReferences();\n        });\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'goToNextReference',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 10,\n    primary: 62 /* KeyCode.F4 */,\n    secondary: [70 /* KeyCode.F12 */],\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.goToNextOrPreviousReference(true);\n        });\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'goToPreviousReference',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 10,\n    primary: 1024 /* KeyMod.Shift */ | 62 /* KeyCode.F4 */,\n    secondary: [1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */],\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.goToNextOrPreviousReference(false);\n        });\n    }\n});\n// commands that aren't needed anymore because there is now ContextKeyExpr.OR\nCommandsRegistry.registerCommandAlias('goToNextReferenceFromEmbeddedEditor', 'goToNextReference');\nCommandsRegistry.registerCommandAlias('goToPreviousReferenceFromEmbeddedEditor', 'goToPreviousReference');\n// close\nCommandsRegistry.registerCommandAlias('closeReferenceSearchEditor', 'closeReferenceSearch');\nCommandsRegistry.registerCommand('closeReferenceSearch', accessor => withController(accessor, controller => controller.closeWidget()));\nKeybindingsRegistry.registerKeybindingRule({\n    id: 'closeReferenceSearch',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 101,\n    primary: 9 /* KeyCode.Escape */,\n    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */],\n    when: ContextKeyExpr.and(PeekContext.inPeekEditor, ContextKeyExpr.not('config.editor.stablePeek'))\n});\nKeybindingsRegistry.registerKeybindingRule({\n    id: 'closeReferenceSearch',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */ + 50,\n    primary: 9 /* KeyCode.Escape */,\n    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */],\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, ContextKeyExpr.not('config.editor.stablePeek'), ContextKeyExpr.or(EditorContextKeys.editorTextFocus, InputFocusedContext.negate()))\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'revealReference',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */,\n    primary: 3 /* KeyCode.Enter */,\n    mac: {\n        primary: 3 /* KeyCode.Enter */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */]\n    },\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse.negate(), WorkbenchTreeElementCanExpand.negate()),\n    handler(accessor) {\n        const listService = accessor.get(IListService);\n        const focus = listService.lastFocusedList?.getFocus();\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n            withController(accessor, controller => controller.revealReference(focus[0]));\n        }\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'openReferenceToSide',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    primary: 2048 /* KeyMod.CtrlCmd */ | 3 /* KeyCode.Enter */,\n    mac: {\n        primary: 256 /* KeyMod.WinCtrl */ | 3 /* KeyCode.Enter */\n    },\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse.negate(), WorkbenchTreeElementCanExpand.negate()),\n    handler(accessor) {\n        const listService = accessor.get(IListService);\n        const focus = listService.lastFocusedList?.getFocus();\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n            withController(accessor, controller => controller.openReference(focus[0], true, true));\n        }\n    }\n});\nCommandsRegistry.registerCommand('openReference', (accessor) => {\n    const listService = accessor.get(IListService);\n    const focus = listService.lastFocusedList?.getFocus();\n    if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n        withController(accessor, controller => controller.openReference(focus[0], false, true));\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Emitter } from '../../../../base/common/event.js';\nimport { combinedDisposable, DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { EditorCommand, registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { KeybindingsRegistry } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nexport const ctxHasSymbols = new RawContextKey('hasSymbols', false, localize('hasSymbols', \"Whether there are symbol locations that can be navigated via keyboard-only.\"));\nexport const ISymbolNavigationService = createDecorator('ISymbolNavigationService');\nlet SymbolNavigationService = class SymbolNavigationService {\n    constructor(contextKeyService, _editorService, _notificationService, _keybindingService) {\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._keybindingService = _keybindingService;\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n        this._ignoreEditorChange = false;\n        this._ctxHasSymbols = ctxHasSymbols.bindTo(contextKeyService);\n    }\n    reset() {\n        this._ctxHasSymbols.reset();\n        this._currentState?.dispose();\n        this._currentMessage?.dispose();\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n    }\n    put(anchor) {\n        const refModel = anchor.parent.parent;\n        if (refModel.references.length <= 1) {\n            this.reset();\n            return;\n        }\n        this._currentModel = refModel;\n        this._currentIdx = refModel.references.indexOf(anchor);\n        this._ctxHasSymbols.set(true);\n        this._showMessage();\n        const editorState = new EditorState(this._editorService);\n        const listener = editorState.onDidChange(_ => {\n            if (this._ignoreEditorChange) {\n                return;\n            }\n            const editor = this._editorService.getActiveCodeEditor();\n            if (!editor) {\n                return;\n            }\n            const model = editor.getModel();\n            const position = editor.getPosition();\n            if (!model || !position) {\n                return;\n            }\n            let seenUri = false;\n            let seenPosition = false;\n            for (const reference of refModel.references) {\n                if (isEqual(reference.uri, model.uri)) {\n                    seenUri = true;\n                    seenPosition = seenPosition || Range.containsPosition(reference.range, position);\n                }\n                else if (seenUri) {\n                    break;\n                }\n            }\n            if (!seenUri || !seenPosition) {\n                this.reset();\n            }\n        });\n        this._currentState = combinedDisposable(editorState, listener);\n    }\n    revealNext(source) {\n        if (!this._currentModel) {\n            return Promise.resolve();\n        }\n        // get next result and advance\n        this._currentIdx += 1;\n        this._currentIdx %= this._currentModel.references.length;\n        const reference = this._currentModel.references[this._currentIdx];\n        // status\n        this._showMessage();\n        // open editor, ignore events while that happens\n        this._ignoreEditorChange = true;\n        return this._editorService.openCodeEditor({\n            resource: reference.uri,\n            options: {\n                selection: Range.collapseToStart(reference.range),\n                selectionRevealType: 3 /* TextEditorSelectionRevealType.NearTopIfOutsideViewport */\n            }\n        }, source).finally(() => {\n            this._ignoreEditorChange = false;\n        });\n    }\n    _showMessage() {\n        this._currentMessage?.dispose();\n        const kb = this._keybindingService.lookupKeybinding('editor.gotoNextSymbolFromResult');\n        const message = kb\n            ? localize('location.kb', \"Symbol {0} of {1}, {2} for next\", this._currentIdx + 1, this._currentModel.references.length, kb.getLabel())\n            : localize('location', \"Symbol {0} of {1}\", this._currentIdx + 1, this._currentModel.references.length);\n        this._currentMessage = this._notificationService.status(message);\n    }\n};\nSymbolNavigationService = __decorate([\n    __param(0, IContextKeyService),\n    __param(1, ICodeEditorService),\n    __param(2, INotificationService),\n    __param(3, IKeybindingService)\n], SymbolNavigationService);\nregisterSingleton(ISymbolNavigationService, SymbolNavigationService, 1 /* InstantiationType.Delayed */);\nregisterEditorCommand(new class extends EditorCommand {\n    constructor() {\n        super({\n            id: 'editor.gotoNextSymbolFromResult',\n            precondition: ctxHasSymbols,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */,\n                primary: 70 /* KeyCode.F12 */\n            }\n        });\n    }\n    runEditorCommand(accessor, editor) {\n        return accessor.get(ISymbolNavigationService).revealNext(editor);\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'editor.gotoNextSymbolFromResult.cancel',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    when: ctxHasSymbols,\n    primary: 9 /* KeyCode.Escape */,\n    handler(accessor) {\n        accessor.get(ISymbolNavigationService).reset();\n    }\n});\n//\nlet EditorState = class EditorState {\n    constructor(editorService) {\n        this._listener = new Map();\n        this._disposables = new DisposableStore();\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._disposables.add(editorService.onCodeEditorRemove(this._onDidRemoveEditor, this));\n        this._disposables.add(editorService.onCodeEditorAdd(this._onDidAddEditor, this));\n        editorService.listCodeEditors().forEach(this._onDidAddEditor, this);\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._onDidChange.dispose();\n        dispose(this._listener.values());\n    }\n    _onDidAddEditor(editor) {\n        this._listener.set(editor, combinedDisposable(editor.onDidChangeCursorPosition(_ => this._onDidChange.fire({ editor })), editor.onDidChangeModelContent(_ => this._onDidChange.fire({ editor }))));\n    }\n    _onDidRemoveEditor(editor) {\n        this._listener.get(editor)?.dispose();\n        this._listener.delete(editor);\n    }\n};\nEditorState = __decorate([\n    __param(0, ICodeEditorService)\n], EditorState);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { matchesSomeScheme, Schemas } from '../../../../base/common/network.js';\nimport { registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ReferencesModel } from './referencesModel.js';\nfunction shouldIncludeLocationLink(sourceModel, loc) {\n    // Always allow the location if the request comes from a document with the same scheme.\n    if (loc.uri.scheme === sourceModel.uri.scheme) {\n        return true;\n    }\n    // Otherwise filter out locations from internal schemes\n    if (matchesSomeScheme(loc.uri, Schemas.walkThroughSnippet, Schemas.vscodeChatCodeBlock, Schemas.vscodeChatCodeCompareBlock)) {\n        return false;\n    }\n    return true;\n}\nasync function getLocationLinks(model, position, registry, recursive, provide) {\n    const provider = registry.ordered(model, recursive);\n    // get results\n    const promises = provider.map((provider) => {\n        return Promise.resolve(provide(provider, model, position)).then(undefined, err => {\n            onUnexpectedExternalError(err);\n            return undefined;\n        });\n    });\n    const values = await Promise.all(promises);\n    return coalesce(values.flat()).filter(loc => shouldIncludeLocationLink(model, loc));\n}\nexport function getDefinitionsAtPosition(registry, model, position, recursive, token) {\n    return getLocationLinks(model, position, registry, recursive, (provider, model, position) => {\n        return provider.provideDefinition(model, position, token);\n    });\n}\nexport function getDeclarationsAtPosition(registry, model, position, recursive, token) {\n    return getLocationLinks(model, position, registry, recursive, (provider, model, position) => {\n        return provider.provideDeclaration(model, position, token);\n    });\n}\nexport function getImplementationsAtPosition(registry, model, position, recursive, token) {\n    return getLocationLinks(model, position, registry, recursive, (provider, model, position) => {\n        return provider.provideImplementation(model, position, token);\n    });\n}\nexport function getTypeDefinitionsAtPosition(registry, model, position, recursive, token) {\n    return getLocationLinks(model, position, registry, recursive, (provider, model, position) => {\n        return provider.provideTypeDefinition(model, position, token);\n    });\n}\nexport function getReferencesAtPosition(registry, model, position, compact, recursive, token) {\n    return getLocationLinks(model, position, registry, recursive, async (provider, model, position) => {\n        const result = (await provider.provideReferences(model, position, { includeDeclaration: true }, token))?.filter(ref => shouldIncludeLocationLink(model, ref));\n        if (!compact || !result || result.length !== 2) {\n            return result;\n        }\n        const resultWithoutDeclaration = (await provider.provideReferences(model, position, { includeDeclaration: false }, token))?.filter(ref => shouldIncludeLocationLink(model, ref));\n        if (resultWithoutDeclaration && resultWithoutDeclaration.length === 1) {\n            return resultWithoutDeclaration;\n        }\n        return result;\n    });\n}\n// -- API commands ----\nasync function _sortedAndDeduped(callback) {\n    const rawLinks = await callback();\n    const model = new ReferencesModel(rawLinks, '');\n    const modelLinks = model.references.map(ref => ref.link);\n    model.dispose();\n    return modelLinks;\n}\nregisterModelAndPositionCommand('_executeDefinitionProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, position, false, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeDefinitionProvider_recursive', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, position, true, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeTypeDefinitionProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, position, false, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeTypeDefinitionProvider_recursive', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, position, true, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeDeclarationProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, position, false, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeDeclarationProvider_recursive', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, position, true, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeReferenceProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, false, false, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeReferenceProvider_recursive', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, false, true, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeImplementationProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, position, false, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeImplementationProvider_recursive', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, position, true, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { createCancelablePromise, raceCancellation } from '../../../../base/common/async.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\nimport { EditorAction2 } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/codeEditor/embeddedCodeEditorWidget.js';\nimport * as corePosition from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { isLocationLink } from '../../../common/languages.js';\nimport { ReferencesController } from './peek/referencesController.js';\nimport { ReferencesModel } from './referencesModel.js';\nimport { ISymbolNavigationService } from './symbolNavigation.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport { PeekContext } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId, MenuRegistry, registerAction2 } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { getDeclarationsAtPosition, getDefinitionsAtPosition, getImplementationsAtPosition, getReferencesAtPosition, getTypeDefinitionsAtPosition } from './goToSymbol.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { IsWebContext } from '../../../../platform/contextkey/common/contextkeys.js';\nMenuRegistry.appendMenuItem(MenuId.EditorContext, {\n    submenu: MenuId.EditorContextPeek,\n    title: nls.localize('peek.submenu', \"Peek\"),\n    group: 'navigation',\n    order: 100\n});\nexport class SymbolNavigationAnchor {\n    static is(thing) {\n        if (!thing || typeof thing !== 'object') {\n            return false;\n        }\n        if (thing instanceof SymbolNavigationAnchor) {\n            return true;\n        }\n        if (corePosition.Position.isIPosition(thing.position) && thing.model) {\n            return true;\n        }\n        return false;\n    }\n    constructor(model, position) {\n        this.model = model;\n        this.position = position;\n    }\n}\nexport class SymbolNavigationAction extends EditorAction2 {\n    static { this._allSymbolNavigationCommands = new Map(); }\n    static { this._activeAlternativeCommands = new Set(); }\n    static all() {\n        return SymbolNavigationAction._allSymbolNavigationCommands.values();\n    }\n    static _patchConfig(opts) {\n        const result = { ...opts, f1: true };\n        // patch context menu when clause\n        if (result.menu) {\n            for (const item of Iterable.wrap(result.menu)) {\n                if (item.id === MenuId.EditorContext || item.id === MenuId.EditorContextPeek) {\n                    item.when = ContextKeyExpr.and(opts.precondition, item.when);\n                }\n            }\n        }\n        return result;\n    }\n    constructor(configuration, opts) {\n        super(SymbolNavigationAction._patchConfig(opts));\n        this.configuration = configuration;\n        SymbolNavigationAction._allSymbolNavigationCommands.set(opts.id, this);\n    }\n    runEditorCommand(accessor, editor, arg, range) {\n        if (!editor.hasModel()) {\n            return Promise.resolve(undefined);\n        }\n        const notificationService = accessor.get(INotificationService);\n        const editorService = accessor.get(ICodeEditorService);\n        const progressService = accessor.get(IEditorProgressService);\n        const symbolNavService = accessor.get(ISymbolNavigationService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const instaService = accessor.get(IInstantiationService);\n        const model = editor.getModel();\n        const position = editor.getPosition();\n        const anchor = SymbolNavigationAnchor.is(arg) ? arg : new SymbolNavigationAnchor(model, position);\n        const cts = new EditorStateCancellationTokenSource(editor, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */);\n        const promise = raceCancellation(this._getLocationModel(languageFeaturesService, anchor.model, anchor.position, cts.token), cts.token).then(async (references) => {\n            if (!references || cts.token.isCancellationRequested) {\n                return;\n            }\n            alert(references.ariaMessage);\n            let altAction;\n            if (references.referenceAt(model.uri, position)) {\n                const altActionId = this._getAlternativeCommand(editor);\n                if (!SymbolNavigationAction._activeAlternativeCommands.has(altActionId) && SymbolNavigationAction._allSymbolNavigationCommands.has(altActionId)) {\n                    altAction = SymbolNavigationAction._allSymbolNavigationCommands.get(altActionId);\n                }\n            }\n            const referenceCount = references.references.length;\n            if (referenceCount === 0) {\n                // no result -> show message\n                if (!this.configuration.muteMessage) {\n                    const info = model.getWordAtPosition(position);\n                    MessageController.get(editor)?.showMessage(this._getNoResultFoundMessage(info), position);\n                }\n            }\n            else if (referenceCount === 1 && altAction) {\n                // already at the only result, run alternative\n                SymbolNavigationAction._activeAlternativeCommands.add(this.desc.id);\n                instaService.invokeFunction((accessor) => altAction.runEditorCommand(accessor, editor, arg, range).finally(() => {\n                    SymbolNavigationAction._activeAlternativeCommands.delete(this.desc.id);\n                }));\n            }\n            else {\n                // normal results handling\n                return this._onResult(editorService, symbolNavService, editor, references, range);\n            }\n        }, (err) => {\n            // report an error\n            notificationService.error(err);\n        }).finally(() => {\n            cts.dispose();\n        });\n        progressService.showWhile(promise, 250);\n        return promise;\n    }\n    async _onResult(editorService, symbolNavService, editor, model, range) {\n        const gotoLocation = this._getGoToPreference(editor);\n        if (!(editor instanceof EmbeddedCodeEditorWidget) && (this.configuration.openInPeek || (gotoLocation === 'peek' && model.references.length > 1))) {\n            this._openInPeek(editor, model, range);\n        }\n        else {\n            const next = model.firstReference();\n            const peek = model.references.length > 1 && gotoLocation === 'gotoAndPeek';\n            const targetEditor = await this._openReference(editor, editorService, next, this.configuration.openToSide, !peek);\n            if (peek && targetEditor) {\n                this._openInPeek(targetEditor, model, range);\n            }\n            else {\n                model.dispose();\n            }\n            // keep remaining locations around when using\n            // 'goto'-mode\n            if (gotoLocation === 'goto') {\n                symbolNavService.put(next);\n            }\n        }\n    }\n    async _openReference(editor, editorService, reference, sideBySide, highlight) {\n        // range is the target-selection-range when we have one\n        // and the fallback is the 'full' range\n        let range = undefined;\n        if (isLocationLink(reference)) {\n            range = reference.targetSelectionRange;\n        }\n        if (!range) {\n            range = reference.range;\n        }\n        if (!range) {\n            return undefined;\n        }\n        const targetEditor = await editorService.openCodeEditor({\n            resource: reference.uri,\n            options: {\n                selection: Range.collapseToStart(range),\n                selectionRevealType: 3 /* TextEditorSelectionRevealType.NearTopIfOutsideViewport */,\n                selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */\n            }\n        }, editor, sideBySide);\n        if (!targetEditor) {\n            return undefined;\n        }\n        if (highlight) {\n            const modelNow = targetEditor.getModel();\n            const decorations = targetEditor.createDecorationsCollection([{ range, options: { description: 'symbol-navigate-action-highlight', className: 'symbolHighlight' } }]);\n            setTimeout(() => {\n                if (targetEditor.getModel() === modelNow) {\n                    decorations.clear();\n                }\n            }, 350);\n        }\n        return targetEditor;\n    }\n    _openInPeek(target, model, range) {\n        const controller = ReferencesController.get(target);\n        if (controller && target.hasModel()) {\n            controller.toggleWidget(range ?? target.getSelection(), createCancelablePromise(_ => Promise.resolve(model)), this.configuration.openInPeek);\n        }\n        else {\n            model.dispose();\n        }\n    }\n}\n//#region --- DEFINITION\nexport class DefinitionAction extends SymbolNavigationAction {\n    async _getLocationModel(languageFeaturesService, model, position, token) {\n        return new ReferencesModel(await getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, position, false, token), nls.localize('def.title', 'Definitions'));\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('noResultWord', \"No definition found for '{0}'\", info.word)\n            : nls.localize('generic.noResults', \"No definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleDefinitions;\n    }\n}\nregisterAction2(class GoToDefinitionAction extends DefinitionAction {\n    static { this.id = 'editor.action.revealDefinition'; }\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: false,\n            muteMessage: false\n        }, {\n            id: GoToDefinitionAction.id,\n            title: {\n                ...nls.localize2('actions.goToDecl.label', \"Go to Definition\"),\n                mnemonicTitle: nls.localize({ key: 'miGotoDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Definition\"),\n            },\n            precondition: EditorContextKeys.hasDefinitionProvider,\n            keybinding: [{\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 70 /* KeyCode.F12 */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }, {\n                    when: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, IsWebContext),\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }],\n            menu: [{\n                    id: MenuId.EditorContext,\n                    group: 'navigation',\n                    order: 1.1\n                }, {\n                    id: MenuId.MenubarGoMenu,\n                    precondition: null,\n                    group: '4_symbol_nav',\n                    order: 2,\n                }]\n        });\n        CommandsRegistry.registerCommandAlias('editor.action.goToDeclaration', GoToDefinitionAction.id);\n    }\n});\nregisterAction2(class OpenDefinitionToSideAction extends DefinitionAction {\n    static { this.id = 'editor.action.revealDefinitionAside'; }\n    constructor() {\n        super({\n            openToSide: true,\n            openInPeek: false,\n            muteMessage: false\n        }, {\n            id: OpenDefinitionToSideAction.id,\n            title: nls.localize2('actions.goToDeclToSide.label', \"Open Definition to the Side\"),\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n            keybinding: [{\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 70 /* KeyCode.F12 */),\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }, {\n                    when: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, IsWebContext),\n                    primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */),\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }]\n        });\n        CommandsRegistry.registerCommandAlias('editor.action.openDeclarationToTheSide', OpenDefinitionToSideAction.id);\n    }\n});\nregisterAction2(class PeekDefinitionAction extends DefinitionAction {\n    static { this.id = 'editor.action.peekDefinition'; }\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: PeekDefinitionAction.id,\n            title: nls.localize2('actions.previewDecl.label', \"Peek Definition\"),\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n            keybinding: {\n                when: EditorContextKeys.editorTextFocus,\n                primary: 512 /* KeyMod.Alt */ | 70 /* KeyCode.F12 */,\n                linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 68 /* KeyCode.F10 */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menu: {\n                id: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 2\n            }\n        });\n        CommandsRegistry.registerCommandAlias('editor.action.previewDeclaration', PeekDefinitionAction.id);\n    }\n});\n//#endregion\n//#region --- DECLARATION\nclass DeclarationAction extends SymbolNavigationAction {\n    async _getLocationModel(languageFeaturesService, model, position, token) {\n        return new ReferencesModel(await getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, position, false, token), nls.localize('decl.title', 'Declarations'));\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n            : nls.localize('decl.generic.noResults', \"No declaration found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeDeclarationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleDeclarations;\n    }\n}\nregisterAction2(class GoToDeclarationAction extends DeclarationAction {\n    static { this.id = 'editor.action.revealDeclaration'; }\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: false,\n            muteMessage: false\n        }, {\n            id: GoToDeclarationAction.id,\n            title: {\n                ...nls.localize2('actions.goToDeclaration.label', \"Go to Declaration\"),\n                mnemonicTitle: nls.localize({ key: 'miGotoDeclaration', comment: ['&& denotes a mnemonic'] }, \"Go to &&Declaration\"),\n            },\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n            menu: [{\n                    id: MenuId.EditorContext,\n                    group: 'navigation',\n                    order: 1.3\n                }, {\n                    id: MenuId.MenubarGoMenu,\n                    precondition: null,\n                    group: '4_symbol_nav',\n                    order: 3,\n                }],\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n            : nls.localize('decl.generic.noResults', \"No declaration found\");\n    }\n});\nregisterAction2(class PeekDeclarationAction extends DeclarationAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.peekDeclaration',\n            title: nls.localize2('actions.peekDecl.label', \"Peek Declaration\"),\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n            menu: {\n                id: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 3\n            }\n        });\n    }\n});\n//#endregion\n//#region --- TYPE DEFINITION\nclass TypeDefinitionAction extends SymbolNavigationAction {\n    async _getLocationModel(languageFeaturesService, model, position, token) {\n        return new ReferencesModel(await getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, position, false, token), nls.localize('typedef.title', 'Type Definitions'));\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToTypeDefinition.noResultWord', \"No type definition found for '{0}'\", info.word)\n            : nls.localize('goToTypeDefinition.generic.noResults', \"No type definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeTypeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleTypeDefinitions;\n    }\n}\nregisterAction2(class GoToTypeDefinitionAction extends TypeDefinitionAction {\n    static { this.ID = 'editor.action.goToTypeDefinition'; }\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: false,\n            muteMessage: false\n        }, {\n            id: GoToTypeDefinitionAction.ID,\n            title: {\n                ...nls.localize2('actions.goToTypeDefinition.label', \"Go to Type Definition\"),\n                mnemonicTitle: nls.localize({ key: 'miGotoTypeDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Type Definition\"),\n            },\n            precondition: EditorContextKeys.hasTypeDefinitionProvider,\n            keybinding: {\n                when: EditorContextKeys.editorTextFocus,\n                primary: 0,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menu: [{\n                    id: MenuId.EditorContext,\n                    group: 'navigation',\n                    order: 1.4\n                }, {\n                    id: MenuId.MenubarGoMenu,\n                    precondition: null,\n                    group: '4_symbol_nav',\n                    order: 3,\n                }]\n        });\n    }\n});\nregisterAction2(class PeekTypeDefinitionAction extends TypeDefinitionAction {\n    static { this.ID = 'editor.action.peekTypeDefinition'; }\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: PeekTypeDefinitionAction.ID,\n            title: nls.localize2('actions.peekTypeDefinition.label', \"Peek Type Definition\"),\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n            menu: {\n                id: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 4\n            }\n        });\n    }\n});\n//#endregion\n//#region --- IMPLEMENTATION\nclass ImplementationAction extends SymbolNavigationAction {\n    async _getLocationModel(languageFeaturesService, model, position, token) {\n        return new ReferencesModel(await getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, position, false, token), nls.localize('impl.title', 'Implementations'));\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToImplementation.noResultWord', \"No implementation found for '{0}'\", info.word)\n            : nls.localize('goToImplementation.generic.noResults', \"No implementation found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeImplementationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleImplementations;\n    }\n}\nregisterAction2(class GoToImplementationAction extends ImplementationAction {\n    static { this.ID = 'editor.action.goToImplementation'; }\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: false,\n            muteMessage: false\n        }, {\n            id: GoToImplementationAction.ID,\n            title: {\n                ...nls.localize2('actions.goToImplementation.label', \"Go to Implementations\"),\n                mnemonicTitle: nls.localize({ key: 'miGotoImplementation', comment: ['&& denotes a mnemonic'] }, \"Go to &&Implementations\"),\n            },\n            precondition: EditorContextKeys.hasImplementationProvider,\n            keybinding: {\n                when: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menu: [{\n                    id: MenuId.EditorContext,\n                    group: 'navigation',\n                    order: 1.45\n                }, {\n                    id: MenuId.MenubarGoMenu,\n                    precondition: null,\n                    group: '4_symbol_nav',\n                    order: 4,\n                }]\n        });\n    }\n});\nregisterAction2(class PeekImplementationAction extends ImplementationAction {\n    static { this.ID = 'editor.action.peekImplementation'; }\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: PeekImplementationAction.ID,\n            title: nls.localize2('actions.peekImplementation.label', \"Peek Implementations\"),\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n            keybinding: {\n                when: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menu: {\n                id: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 5\n            }\n        });\n    }\n});\n//#endregion\n//#region --- REFERENCES\nclass ReferencesAction extends SymbolNavigationAction {\n    _getNoResultFoundMessage(info) {\n        return info\n            ? nls.localize('references.no', \"No references found for '{0}'\", info.word)\n            : nls.localize('references.noGeneric', \"No references found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeReferenceCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleReferences;\n    }\n}\nregisterAction2(class GoToReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: false,\n            muteMessage: false\n        }, {\n            id: 'editor.action.goToReferences',\n            title: {\n                ...nls.localize2('goToReferences.label', \"Go to References\"),\n                mnemonicTitle: nls.localize({ key: 'miGotoReference', comment: ['&& denotes a mnemonic'] }, \"Go to &&References\"),\n            },\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n            keybinding: {\n                when: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menu: [{\n                    id: MenuId.EditorContext,\n                    group: 'navigation',\n                    order: 1.45\n                }, {\n                    id: MenuId.MenubarGoMenu,\n                    precondition: null,\n                    group: '4_symbol_nav',\n                    order: 5,\n                }]\n        });\n    }\n    async _getLocationModel(languageFeaturesService, model, position, token) {\n        return new ReferencesModel(await getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, true, false, token), nls.localize('ref.title', 'References'));\n    }\n});\nregisterAction2(class PeekReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.referenceSearch.trigger',\n            title: nls.localize2('references.action.label', \"Peek References\"),\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n            menu: {\n                id: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 6\n            }\n        });\n    }\n    async _getLocationModel(languageFeaturesService, model, position, token) {\n        return new ReferencesModel(await getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, false, false, token), nls.localize('ref.title', 'References'));\n    }\n});\n//#endregion\n//#region --- GENERIC goto symbols command\nclass GenericGoToLocationAction extends SymbolNavigationAction {\n    constructor(config, _references, _gotoMultipleBehaviour) {\n        super(config, {\n            id: 'editor.action.goToLocation',\n            title: nls.localize2('label.generic', \"Go to Any Symbol\"),\n            precondition: ContextKeyExpr.and(PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n        });\n        this._references = _references;\n        this._gotoMultipleBehaviour = _gotoMultipleBehaviour;\n    }\n    async _getLocationModel(languageFeaturesService, _model, _position, _token) {\n        return new ReferencesModel(this._references, nls.localize('generic.title', 'Locations'));\n    }\n    _getNoResultFoundMessage(info) {\n        return info && nls.localize('generic.noResult', \"No results for '{0}'\", info.word) || '';\n    }\n    _getGoToPreference(editor) {\n        return this._gotoMultipleBehaviour ?? editor.getOption(58 /* EditorOption.gotoLocation */).multipleReferences;\n    }\n    _getAlternativeCommand() { return ''; }\n}\nCommandsRegistry.registerCommand({\n    id: 'editor.action.goToLocations',\n    metadata: {\n        description: 'Go to locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto`' },\n            { name: 'noResultsMessage', description: 'Human readable message that shows when locations is empty.' },\n        ]\n    },\n    handler: async (accessor, resource, position, references, multiple, noResultsMessage, openInPeek) => {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        assertType(Array.isArray(references));\n        assertType(typeof multiple === 'undefined' || typeof multiple === 'string');\n        assertType(typeof openInPeek === 'undefined' || typeof openInPeek === 'boolean');\n        const editorService = accessor.get(ICodeEditorService);\n        const editor = await editorService.openCodeEditor({ resource }, editorService.getFocusedCodeEditor());\n        if (isCodeEditor(editor)) {\n            editor.setPosition(position);\n            editor.revealPositionInCenterIfOutsideViewport(position, 0 /* ScrollType.Smooth */);\n            return editor.invokeWithinContext(accessor => {\n                const command = new class extends GenericGoToLocationAction {\n                    _getNoResultFoundMessage(info) {\n                        return noResultsMessage || super._getNoResultFoundMessage(info);\n                    }\n                }({\n                    muteMessage: !Boolean(noResultsMessage),\n                    openInPeek: Boolean(openInPeek),\n                    openToSide: false\n                }, references, multiple);\n                accessor.get(IInstantiationService).invokeFunction(command.run.bind(command), editor);\n            });\n        }\n    }\n});\nCommandsRegistry.registerCommand({\n    id: 'editor.action.peekLocations',\n    metadata: {\n        description: 'Peek locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto`' },\n        ]\n    },\n    handler: async (accessor, resource, position, references, multiple) => {\n        accessor.get(ICommandService).executeCommand('editor.action.goToLocations', resource, position, references, multiple, undefined, true);\n    }\n});\n//#endregion\n//#region --- REFERENCE search special commands\nCommandsRegistry.registerCommand({\n    id: 'editor.action.findReferences',\n    handler: (accessor, resource, position) => {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const codeEditorService = accessor.get(ICodeEditorService);\n        return codeEditorService.openCodeEditor({ resource }, codeEditorService.getFocusedCodeEditor()).then(control => {\n            if (!isCodeEditor(control) || !control.hasModel()) {\n                return undefined;\n            }\n            const controller = ReferencesController.get(control);\n            if (!controller) {\n                return undefined;\n            }\n            const references = createCancelablePromise(token => getReferencesAtPosition(languageFeaturesService.referenceProvider, control.getModel(), corePosition.Position.lift(position), false, false, token).then(references => new ReferencesModel(references, nls.localize('ref.title', 'References'))));\n            const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n            return Promise.resolve(controller.toggleWidget(range, references, false));\n        });\n    }\n});\n// use NEW command\nCommandsRegistry.registerCommandAlias('editor.action.showReferences', 'editor.action.peekLocations');\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Action, Separator } from '../../../../base/common/actions.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { DefinitionAction, SymbolNavigationAction, SymbolNavigationAnchor } from '../../gotoSymbol/browser/goToCommands.js';\nimport { PeekContext } from '../../peekView/browser/peekView.js';\nimport { isIMenuItem, MenuId, MenuItemAction, MenuRegistry } from '../../../../platform/actions/common/actions.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nexport async function showGoToContextMenu(accessor, editor, anchor, part) {\n    const resolverService = accessor.get(ITextModelService);\n    const contextMenuService = accessor.get(IContextMenuService);\n    const commandService = accessor.get(ICommandService);\n    const instaService = accessor.get(IInstantiationService);\n    const notificationService = accessor.get(INotificationService);\n    await part.item.resolve(CancellationToken.None);\n    if (!part.part.location) {\n        return;\n    }\n    const location = part.part.location;\n    const menuActions = [];\n    // from all registered (not active) context menu actions select those\n    // that are a symbol navigation actions\n    const filter = new Set(MenuRegistry.getMenuItems(MenuId.EditorContext)\n        .map(item => isIMenuItem(item) ? item.command.id : generateUuid()));\n    for (const delegate of SymbolNavigationAction.all()) {\n        if (filter.has(delegate.desc.id)) {\n            menuActions.push(new Action(delegate.desc.id, MenuItemAction.label(delegate.desc, { renderShortTitle: true }), undefined, true, async () => {\n                const ref = await resolverService.createModelReference(location.uri);\n                try {\n                    const symbolAnchor = new SymbolNavigationAnchor(ref.object.textEditorModel, Range.getStartPosition(location.range));\n                    const range = part.item.anchor.range;\n                    await instaService.invokeFunction(delegate.runEditorCommand.bind(delegate), editor, symbolAnchor, range);\n                }\n                finally {\n                    ref.dispose();\n                }\n            }));\n        }\n    }\n    if (part.part.command) {\n        const { command } = part.part;\n        menuActions.push(new Separator());\n        menuActions.push(new Action(command.id, command.title, undefined, true, async () => {\n            try {\n                await commandService.executeCommand(command.id, ...(command.arguments ?? []));\n            }\n            catch (err) {\n                notificationService.notify({\n                    severity: Severity.Error,\n                    source: part.item.provider.displayName,\n                    message: err\n                });\n            }\n        }));\n    }\n    // show context menu\n    const useShadowDOM = editor.getOption(128 /* EditorOption.useShadowDOM */);\n    contextMenuService.showContextMenu({\n        domForShadowRoot: useShadowDOM ? editor.getDomNode() ?? undefined : undefined,\n        getAnchor: () => {\n            const box = dom.getDomNodePagePosition(anchor);\n            return { x: box.left, y: box.top + box.height + 8 };\n        },\n        getActions: () => menuActions,\n        onHide: () => {\n            editor.focus();\n        },\n        autoSelectFirstItem: true,\n    });\n}\nexport async function goToDefinitionWithLocation(accessor, event, editor, location) {\n    const resolverService = accessor.get(ITextModelService);\n    const ref = await resolverService.createModelReference(location.uri);\n    await editor.invokeWithinContext(async (accessor) => {\n        const openToSide = event.hasSideBySideModifier;\n        const contextKeyService = accessor.get(IContextKeyService);\n        const isInPeek = PeekContext.inPeekEditor.getValue(contextKeyService);\n        const canPeek = !openToSide && editor.getOption(89 /* EditorOption.definitionLinkOpensInPeek */) && !isInPeek;\n        const action = new DefinitionAction({ openToSide, openInPeek: canPeek, muteMessage: true }, { title: { value: '', original: '' }, id: '', precondition: undefined });\n        return action.run(accessor, new SymbolNavigationAnchor(ref.object.textEditorModel, Range.getStartPosition(location.range)), Range.lift(location.range));\n    });\n    ref.dispose();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InlayHintsController_1;\nimport { isHTMLElement, ModifierKeyEmitter } from '../../../../base/browser/dom.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { LRUCache } from '../../../../base/common/map.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { DynamicCssRules } from '../../../browser/editorDom.js';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EDITOR_FONT_DEFAULTS } from '../../../common/config/editorOptions.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport * as languages from '../../../common/languages.js';\nimport { InjectedTextCursorStops } from '../../../common/model.js';\nimport { ModelDecorationInjectedTextOptions } from '../../../common/model/textModel.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { ClickLinkGesture } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { InlayHintAnchor, InlayHintsFragments } from './inlayHints.js';\nimport { goToDefinitionWithLocation, showGoToContextMenu } from './inlayHintsLocations.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator, IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nimport * as colors from '../../../../platform/theme/common/colorRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\n// --- hint caching service (per session)\nclass InlayHintsCache {\n    constructor() {\n        this._entries = new LRUCache(50);\n    }\n    get(model) {\n        const key = InlayHintsCache._key(model);\n        return this._entries.get(key);\n    }\n    set(model, value) {\n        const key = InlayHintsCache._key(model);\n        this._entries.set(key, value);\n    }\n    static _key(model) {\n        return `${model.uri.toString()}/${model.getVersionId()}`;\n    }\n}\nconst IInlayHintsCache = createDecorator('IInlayHintsCache');\nregisterSingleton(IInlayHintsCache, InlayHintsCache, 1 /* InstantiationType.Delayed */);\n// --- rendered label\nexport class RenderedInlayHintLabelPart {\n    constructor(item, index) {\n        this.item = item;\n        this.index = index;\n    }\n    get part() {\n        const label = this.item.hint.label;\n        if (typeof label === 'string') {\n            return { label };\n        }\n        else {\n            return label[this.index];\n        }\n    }\n}\nclass ActiveInlayHintInfo {\n    constructor(part, hasTriggerModifier) {\n        this.part = part;\n        this.hasTriggerModifier = hasTriggerModifier;\n    }\n}\n// --- controller\nlet InlayHintsController = class InlayHintsController {\n    static { InlayHintsController_1 = this; }\n    static { this.ID = 'editor.contrib.InlayHints'; }\n    static { this._MAX_DECORATORS = 1500; }\n    static { this._MAX_LABEL_LEN = 43; }\n    static get(editor) {\n        return editor.getContribution(InlayHintsController_1.ID) ?? undefined;\n    }\n    constructor(_editor, _languageFeaturesService, _featureDebounce, _inlayHintsCache, _commandService, _notificationService, _instaService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._inlayHintsCache = _inlayHintsCache;\n        this._commandService = _commandService;\n        this._notificationService = _notificationService;\n        this._instaService = _instaService;\n        this._disposables = new DisposableStore();\n        this._sessionDisposables = new DisposableStore();\n        this._decorationsMetadata = new Map();\n        this._ruleFactory = new DynamicCssRules(this._editor);\n        this._activeRenderMode = 0 /* RenderMode.Normal */;\n        this._debounceInfo = _featureDebounce.for(_languageFeaturesService.inlayHintsProvider, 'InlayHint', { min: 25 });\n        this._disposables.add(_languageFeaturesService.inlayHintsProvider.onDidChange(() => this._update()));\n        this._disposables.add(_editor.onDidChangeModel(() => this._update()));\n        this._disposables.add(_editor.onDidChangeModelLanguage(() => this._update()));\n        this._disposables.add(_editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(142 /* EditorOption.inlayHints */)) {\n                this._update();\n            }\n        }));\n        this._update();\n    }\n    dispose() {\n        this._sessionDisposables.dispose();\n        this._removeAllDecorations();\n        this._disposables.dispose();\n    }\n    _update() {\n        this._sessionDisposables.clear();\n        this._removeAllDecorations();\n        const options = this._editor.getOption(142 /* EditorOption.inlayHints */);\n        if (options.enabled === 'off') {\n            return;\n        }\n        const model = this._editor.getModel();\n        if (!model || !this._languageFeaturesService.inlayHintsProvider.has(model)) {\n            return;\n        }\n        if (options.enabled === 'on') {\n            // different \"on\" modes: always\n            this._activeRenderMode = 0 /* RenderMode.Normal */;\n        }\n        else {\n            // different \"on\" modes: offUnlessPressed, or onUnlessPressed\n            let defaultMode;\n            let altMode;\n            if (options.enabled === 'onUnlessPressed') {\n                defaultMode = 0 /* RenderMode.Normal */;\n                altMode = 1 /* RenderMode.Invisible */;\n            }\n            else {\n                defaultMode = 1 /* RenderMode.Invisible */;\n                altMode = 0 /* RenderMode.Normal */;\n            }\n            this._activeRenderMode = defaultMode;\n            this._sessionDisposables.add(ModifierKeyEmitter.getInstance().event(e => {\n                if (!this._editor.hasModel()) {\n                    return;\n                }\n                const newRenderMode = e.altKey && e.ctrlKey && !(e.shiftKey || e.metaKey) ? altMode : defaultMode;\n                if (newRenderMode !== this._activeRenderMode) {\n                    this._activeRenderMode = newRenderMode;\n                    const model = this._editor.getModel();\n                    const copies = this._copyInlayHintsWithCurrentAnchor(model);\n                    this._updateHintsDecorators([model.getFullModelRange()], copies);\n                    scheduler.schedule(0);\n                }\n            }));\n        }\n        // iff possible, quickly update from cache\n        const cached = this._inlayHintsCache.get(model);\n        if (cached) {\n            this._updateHintsDecorators([model.getFullModelRange()], cached);\n        }\n        this._sessionDisposables.add(toDisposable(() => {\n            // cache items when switching files etc\n            if (!model.isDisposed()) {\n                this._cacheHintsForFastRestore(model);\n            }\n        }));\n        let cts;\n        const watchedProviders = new Set();\n        const scheduler = new RunOnceScheduler(async () => {\n            const t1 = Date.now();\n            cts?.dispose(true);\n            cts = new CancellationTokenSource();\n            const listener = model.onWillDispose(() => cts?.cancel());\n            try {\n                const myToken = cts.token;\n                const inlayHints = await InlayHintsFragments.create(this._languageFeaturesService.inlayHintsProvider, model, this._getHintsRanges(), myToken);\n                scheduler.delay = this._debounceInfo.update(model, Date.now() - t1);\n                if (myToken.isCancellationRequested) {\n                    inlayHints.dispose();\n                    return;\n                }\n                // listen to provider changes\n                for (const provider of inlayHints.provider) {\n                    if (typeof provider.onDidChangeInlayHints === 'function' && !watchedProviders.has(provider)) {\n                        watchedProviders.add(provider);\n                        this._sessionDisposables.add(provider.onDidChangeInlayHints(() => {\n                            if (!scheduler.isScheduled()) { // ignore event when request is already scheduled\n                                scheduler.schedule();\n                            }\n                        }));\n                    }\n                }\n                this._sessionDisposables.add(inlayHints);\n                this._updateHintsDecorators(inlayHints.ranges, inlayHints.items);\n                this._cacheHintsForFastRestore(model);\n            }\n            catch (err) {\n                onUnexpectedError(err);\n            }\n            finally {\n                cts.dispose();\n                listener.dispose();\n            }\n        }, this._debounceInfo.get(model));\n        this._sessionDisposables.add(scheduler);\n        this._sessionDisposables.add(toDisposable(() => cts?.dispose(true)));\n        scheduler.schedule(0);\n        this._sessionDisposables.add(this._editor.onDidScrollChange((e) => {\n            // update when scroll position changes\n            // uses scrollTopChanged has weak heuristic to differenatiate between scrolling due to\n            // typing or due to \"actual\" scrolling\n            if (e.scrollTopChanged || !scheduler.isScheduled()) {\n                scheduler.schedule();\n            }\n        }));\n        this._sessionDisposables.add(this._editor.onDidChangeModelContent((e) => {\n            cts?.cancel();\n            // update less aggressive when typing\n            const delay = Math.max(scheduler.delay, 1250);\n            scheduler.schedule(delay);\n        }));\n        // mouse gestures\n        this._sessionDisposables.add(this._installDblClickGesture(() => scheduler.schedule(0)));\n        this._sessionDisposables.add(this._installLinkGesture());\n        this._sessionDisposables.add(this._installContextMenu());\n    }\n    _installLinkGesture() {\n        const store = new DisposableStore();\n        const gesture = store.add(new ClickLinkGesture(this._editor));\n        // let removeHighlight = () => { };\n        const sessionStore = new DisposableStore();\n        store.add(sessionStore);\n        store.add(gesture.onMouseMoveOrRelevantKeyDown(e => {\n            const [mouseEvent] = e;\n            const labelPart = this._getInlayHintLabelPart(mouseEvent);\n            const model = this._editor.getModel();\n            if (!labelPart || !model) {\n                sessionStore.clear();\n                return;\n            }\n            // resolve the item\n            const cts = new CancellationTokenSource();\n            sessionStore.add(toDisposable(() => cts.dispose(true)));\n            labelPart.item.resolve(cts.token);\n            // render link => when the modifier is pressed and when there is a command or location\n            this._activeInlayHintPart = labelPart.part.command || labelPart.part.location\n                ? new ActiveInlayHintInfo(labelPart, mouseEvent.hasTriggerModifier)\n                : undefined;\n            const lineNumber = model.validatePosition(labelPart.item.hint.position).lineNumber;\n            const range = new Range(lineNumber, 1, lineNumber, model.getLineMaxColumn(lineNumber));\n            const lineHints = this._getInlineHintsForRange(range);\n            this._updateHintsDecorators([range], lineHints);\n            sessionStore.add(toDisposable(() => {\n                this._activeInlayHintPart = undefined;\n                this._updateHintsDecorators([range], lineHints);\n            }));\n        }));\n        store.add(gesture.onCancel(() => sessionStore.clear()));\n        store.add(gesture.onExecute(async (e) => {\n            const label = this._getInlayHintLabelPart(e);\n            if (label) {\n                const part = label.part;\n                if (part.location) {\n                    // location -> execute go to def\n                    this._instaService.invokeFunction(goToDefinitionWithLocation, e, this._editor, part.location);\n                }\n                else if (languages.Command.is(part.command)) {\n                    // command -> execute it\n                    await this._invokeCommand(part.command, label.item);\n                }\n            }\n        }));\n        return store;\n    }\n    _getInlineHintsForRange(range) {\n        const lineHints = new Set();\n        for (const data of this._decorationsMetadata.values()) {\n            if (range.containsRange(data.item.anchor.range)) {\n                lineHints.add(data.item);\n            }\n        }\n        return Array.from(lineHints);\n    }\n    _installDblClickGesture(updateInlayHints) {\n        return this._editor.onMouseUp(async (e) => {\n            if (e.event.detail !== 2) {\n                return;\n            }\n            const part = this._getInlayHintLabelPart(e);\n            if (!part) {\n                return;\n            }\n            e.event.preventDefault();\n            await part.item.resolve(CancellationToken.None);\n            if (isNonEmptyArray(part.item.hint.textEdits)) {\n                const edits = part.item.hint.textEdits.map(edit => EditOperation.replace(Range.lift(edit.range), edit.text));\n                this._editor.executeEdits('inlayHint.default', edits);\n                updateInlayHints();\n            }\n        });\n    }\n    _installContextMenu() {\n        return this._editor.onContextMenu(async (e) => {\n            if (!(isHTMLElement(e.event.target))) {\n                return;\n            }\n            const part = this._getInlayHintLabelPart(e);\n            if (part) {\n                await this._instaService.invokeFunction(showGoToContextMenu, this._editor, e.event.target, part);\n            }\n        });\n    }\n    _getInlayHintLabelPart(e) {\n        if (e.target.type !== 6 /* MouseTargetType.CONTENT_TEXT */) {\n            return undefined;\n        }\n        const options = e.target.detail.injectedText?.options;\n        if (options instanceof ModelDecorationInjectedTextOptions && options?.attachedData instanceof RenderedInlayHintLabelPart) {\n            return options.attachedData;\n        }\n        return undefined;\n    }\n    async _invokeCommand(command, item) {\n        try {\n            await this._commandService.executeCommand(command.id, ...(command.arguments ?? []));\n        }\n        catch (err) {\n            this._notificationService.notify({\n                severity: Severity.Error,\n                source: item.provider.displayName,\n                message: err\n            });\n        }\n    }\n    _cacheHintsForFastRestore(model) {\n        const hints = this._copyInlayHintsWithCurrentAnchor(model);\n        this._inlayHintsCache.set(model, hints);\n    }\n    // return inlay hints but with an anchor that reflects \"updates\"\n    // that happened after receiving them, e.g adding new lines before a hint\n    _copyInlayHintsWithCurrentAnchor(model) {\n        const items = new Map();\n        for (const [id, obj] of this._decorationsMetadata) {\n            if (items.has(obj.item)) {\n                // an inlay item can be rendered as multiple decorations\n                // but they will all uses the same range\n                continue;\n            }\n            const range = model.getDecorationRange(id);\n            if (range) {\n                // update range with whatever the editor has tweaked it to\n                const anchor = new InlayHintAnchor(range, obj.item.anchor.direction);\n                const copy = obj.item.with({ anchor });\n                items.set(obj.item, copy);\n            }\n        }\n        return Array.from(items.values());\n    }\n    _getHintsRanges() {\n        const extra = 30;\n        const model = this._editor.getModel();\n        const visibleRanges = this._editor.getVisibleRangesPlusViewportAboveBelow();\n        const result = [];\n        for (const range of visibleRanges.sort(Range.compareRangesUsingStarts)) {\n            const extendedRange = model.validateRange(new Range(range.startLineNumber - extra, range.startColumn, range.endLineNumber + extra, range.endColumn));\n            if (result.length === 0 || !Range.areIntersectingOrTouching(result[result.length - 1], extendedRange)) {\n                result.push(extendedRange);\n            }\n            else {\n                result[result.length - 1] = Range.plusRange(result[result.length - 1], extendedRange);\n            }\n        }\n        return result;\n    }\n    _updateHintsDecorators(ranges, items) {\n        // utils to collect/create injected text decorations\n        const newDecorationsData = [];\n        const addInjectedText = (item, ref, content, cursorStops, attachedData) => {\n            const opts = {\n                content,\n                inlineClassNameAffectsLetterSpacing: true,\n                inlineClassName: ref.className,\n                cursorStops,\n                attachedData\n            };\n            newDecorationsData.push({\n                item,\n                classNameRef: ref,\n                decoration: {\n                    range: item.anchor.range,\n                    options: {\n                        // className: \"rangeHighlight\", // DEBUG highlight to see to what range a hint is attached\n                        description: 'InlayHint',\n                        showIfCollapsed: item.anchor.range.isEmpty(), // \"original\" range is empty\n                        collapseOnReplaceEdit: !item.anchor.range.isEmpty(),\n                        stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n                        [item.anchor.direction]: this._activeRenderMode === 0 /* RenderMode.Normal */ ? opts : undefined\n                    }\n                }\n            });\n        };\n        const addInjectedWhitespace = (item, isLast) => {\n            const marginRule = this._ruleFactory.createClassNameRef({\n                width: `${(fontSize / 3) | 0}px`,\n                display: 'inline-block'\n            });\n            addInjectedText(item, marginRule, '\\u200a', isLast ? InjectedTextCursorStops.Right : InjectedTextCursorStops.None);\n        };\n        //\n        const { fontSize, fontFamily, padding, isUniform } = this._getLayoutInfo();\n        const fontFamilyVar = '--code-editorInlayHintsFontFamily';\n        this._editor.getContainerDomNode().style.setProperty(fontFamilyVar, fontFamily);\n        let currentLineInfo = { line: 0, totalLen: 0 };\n        for (const item of items) {\n            if (currentLineInfo.line !== item.anchor.range.startLineNumber) {\n                currentLineInfo = { line: item.anchor.range.startLineNumber, totalLen: 0 };\n            }\n            if (currentLineInfo.totalLen > InlayHintsController_1._MAX_LABEL_LEN) {\n                continue;\n            }\n            // whitespace leading the actual label\n            if (item.hint.paddingLeft) {\n                addInjectedWhitespace(item, false);\n            }\n            // the label with its parts\n            const parts = typeof item.hint.label === 'string'\n                ? [{ label: item.hint.label }]\n                : item.hint.label;\n            for (let i = 0; i < parts.length; i++) {\n                const part = parts[i];\n                const isFirst = i === 0;\n                const isLast = i === parts.length - 1;\n                const cssProperties = {\n                    fontSize: `${fontSize}px`,\n                    fontFamily: `var(${fontFamilyVar}), ${EDITOR_FONT_DEFAULTS.fontFamily}`,\n                    verticalAlign: isUniform ? 'baseline' : 'middle',\n                    unicodeBidi: 'isolate'\n                };\n                if (isNonEmptyArray(item.hint.textEdits)) {\n                    cssProperties.cursor = 'default';\n                }\n                this._fillInColors(cssProperties, item.hint);\n                if ((part.command || part.location) && this._activeInlayHintPart?.part.item === item && this._activeInlayHintPart.part.index === i) {\n                    // active link!\n                    cssProperties.textDecoration = 'underline';\n                    if (this._activeInlayHintPart.hasTriggerModifier) {\n                        cssProperties.color = themeColorFromId(colors.editorActiveLinkForeground);\n                        cssProperties.cursor = 'pointer';\n                    }\n                }\n                if (padding) {\n                    if (isFirst && isLast) {\n                        // only element\n                        cssProperties.padding = `1px ${Math.max(1, fontSize / 4) | 0}px`;\n                        cssProperties.borderRadius = `${(fontSize / 4) | 0}px`;\n                    }\n                    else if (isFirst) {\n                        // first element\n                        cssProperties.padding = `1px 0 1px ${Math.max(1, fontSize / 4) | 0}px`;\n                        cssProperties.borderRadius = `${(fontSize / 4) | 0}px 0 0 ${(fontSize / 4) | 0}px`;\n                    }\n                    else if (isLast) {\n                        // last element\n                        cssProperties.padding = `1px ${Math.max(1, fontSize / 4) | 0}px 1px 0`;\n                        cssProperties.borderRadius = `0 ${(fontSize / 4) | 0}px ${(fontSize / 4) | 0}px 0`;\n                    }\n                    else {\n                        cssProperties.padding = `1px 0 1px 0`;\n                    }\n                }\n                let textlabel = part.label;\n                currentLineInfo.totalLen += textlabel.length;\n                let tooLong = false;\n                const over = currentLineInfo.totalLen - InlayHintsController_1._MAX_LABEL_LEN;\n                if (over > 0) {\n                    textlabel = textlabel.slice(0, -over) + '…';\n                    tooLong = true;\n                }\n                addInjectedText(item, this._ruleFactory.createClassNameRef(cssProperties), fixSpace(textlabel), isLast && !item.hint.paddingRight ? InjectedTextCursorStops.Right : InjectedTextCursorStops.None, new RenderedInlayHintLabelPart(item, i));\n                if (tooLong) {\n                    break;\n                }\n            }\n            // whitespace trailing the actual label\n            if (item.hint.paddingRight) {\n                addInjectedWhitespace(item, true);\n            }\n            if (newDecorationsData.length > InlayHintsController_1._MAX_DECORATORS) {\n                break;\n            }\n        }\n        // collect all decoration ids that are affected by the ranges\n        // and only update those decorations\n        const decorationIdsToReplace = [];\n        for (const [id, metadata] of this._decorationsMetadata) {\n            const range = this._editor.getModel()?.getDecorationRange(id);\n            if (range && ranges.some(r => r.containsRange(range))) {\n                decorationIdsToReplace.push(id);\n                metadata.classNameRef.dispose();\n                this._decorationsMetadata.delete(id);\n            }\n        }\n        const scrollState = StableEditorScrollState.capture(this._editor);\n        this._editor.changeDecorations(accessor => {\n            const newDecorationIds = accessor.deltaDecorations(decorationIdsToReplace, newDecorationsData.map(d => d.decoration));\n            for (let i = 0; i < newDecorationIds.length; i++) {\n                const data = newDecorationsData[i];\n                this._decorationsMetadata.set(newDecorationIds[i], data);\n            }\n        });\n        scrollState.restore(this._editor);\n    }\n    _fillInColors(props, hint) {\n        if (hint.kind === languages.InlayHintKind.Parameter) {\n            props.backgroundColor = themeColorFromId(colors.editorInlayHintParameterBackground);\n            props.color = themeColorFromId(colors.editorInlayHintParameterForeground);\n        }\n        else if (hint.kind === languages.InlayHintKind.Type) {\n            props.backgroundColor = themeColorFromId(colors.editorInlayHintTypeBackground);\n            props.color = themeColorFromId(colors.editorInlayHintTypeForeground);\n        }\n        else {\n            props.backgroundColor = themeColorFromId(colors.editorInlayHintBackground);\n            props.color = themeColorFromId(colors.editorInlayHintForeground);\n        }\n    }\n    _getLayoutInfo() {\n        const options = this._editor.getOption(142 /* EditorOption.inlayHints */);\n        const padding = options.padding;\n        const editorFontSize = this._editor.getOption(52 /* EditorOption.fontSize */);\n        const editorFontFamily = this._editor.getOption(49 /* EditorOption.fontFamily */);\n        let fontSize = options.fontSize;\n        if (!fontSize || fontSize < 5 || fontSize > editorFontSize) {\n            fontSize = editorFontSize;\n        }\n        const fontFamily = options.fontFamily || editorFontFamily;\n        const isUniform = !padding\n            && fontFamily === editorFontFamily\n            && fontSize === editorFontSize;\n        return { fontSize, fontFamily, padding, isUniform };\n    }\n    _removeAllDecorations() {\n        this._editor.removeDecorations(Array.from(this._decorationsMetadata.keys()));\n        for (const obj of this._decorationsMetadata.values()) {\n            obj.classNameRef.dispose();\n        }\n        this._decorationsMetadata.clear();\n    }\n};\nInlayHintsController = InlayHintsController_1 = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, ILanguageFeatureDebounceService),\n    __param(3, IInlayHintsCache),\n    __param(4, ICommandService),\n    __param(5, INotificationService),\n    __param(6, IInstantiationService)\n], InlayHintsController);\nexport { InlayHintsController };\n// Prevents the view from potentially visible whitespace\nfunction fixSpace(str) {\n    const noBreakWhitespace = '\\xa0';\n    return str.replace(/[ \\t]/g, noBreakWhitespace);\n}\nCommandsRegistry.registerCommand('_executeInlayHintProvider', async (accessor, ...args) => {\n    const [uri, range] = args;\n    assertType(URI.isUri(uri));\n    assertType(Range.isIRange(range));\n    const { inlayHintsProvider } = accessor.get(ILanguageFeaturesService);\n    const ref = await accessor.get(ITextModelService).createModelReference(uri);\n    try {\n        const model = await InlayHintsFragments.create(inlayHintsProvider, ref.object.textEditorModel, [Range.lift(range)], CancellationToken.None);\n        const result = model.items.map(i => i.hint);\n        setTimeout(() => model.dispose(), 0); // dispose after sending to ext host\n        return result;\n    }\n    finally {\n        ref.dispose();\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { isEmptyMarkdownString, MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Position } from '../../../common/core/position.js';\nimport { ModelDecorationInjectedTextOptions } from '../../../common/model/textModel.js';\nimport { HoverForeignElementAnchor } from '../../hover/browser/hoverTypes.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { getHoverProviderResultsAsAsyncIterable } from '../../hover/browser/getHover.js';\nimport { MarkdownHover, MarkdownHoverParticipant } from '../../hover/browser/markdownHoverParticipant.js';\nimport { RenderedInlayHintLabelPart, InlayHintsController } from './inlayHintsController.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { localize } from '../../../../nls.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { asCommandLink } from './inlayHints.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { IHoverService } from '../../../../platform/hover/browser/hover.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nclass InlayHintsHoverAnchor extends HoverForeignElementAnchor {\n    constructor(part, owner, initialMousePosX, initialMousePosY) {\n        super(10, owner, part.item.anchor.range, initialMousePosX, initialMousePosY, true);\n        this.part = part;\n    }\n}\nlet InlayHintsHover = class InlayHintsHover extends MarkdownHoverParticipant {\n    constructor(editor, languageService, openerService, keybindingService, hoverService, configurationService, _resolverService, languageFeaturesService, commandService) {\n        super(editor, languageService, openerService, configurationService, languageFeaturesService, keybindingService, hoverService, commandService);\n        this._resolverService = _resolverService;\n        this.hoverOrdinal = 6;\n    }\n    suggestHoverAnchor(mouseEvent) {\n        const controller = InlayHintsController.get(this._editor);\n        if (!controller) {\n            return null;\n        }\n        if (mouseEvent.target.type !== 6 /* MouseTargetType.CONTENT_TEXT */) {\n            return null;\n        }\n        const options = mouseEvent.target.detail.injectedText?.options;\n        if (!(options instanceof ModelDecorationInjectedTextOptions && options.attachedData instanceof RenderedInlayHintLabelPart)) {\n            return null;\n        }\n        return new InlayHintsHoverAnchor(options.attachedData, this, mouseEvent.event.posx, mouseEvent.event.posy);\n    }\n    computeSync() {\n        return [];\n    }\n    computeAsync(anchor, _lineDecorations, token) {\n        if (!(anchor instanceof InlayHintsHoverAnchor)) {\n            return AsyncIterableObject.EMPTY;\n        }\n        return new AsyncIterableObject(async (executor) => {\n            const { part } = anchor;\n            await part.item.resolve(token);\n            if (token.isCancellationRequested) {\n                return;\n            }\n            // (1) Inlay Tooltip\n            let itemTooltip;\n            if (typeof part.item.hint.tooltip === 'string') {\n                itemTooltip = new MarkdownString().appendText(part.item.hint.tooltip);\n            }\n            else if (part.item.hint.tooltip) {\n                itemTooltip = part.item.hint.tooltip;\n            }\n            if (itemTooltip) {\n                executor.emitOne(new MarkdownHover(this, anchor.range, [itemTooltip], false, 0));\n            }\n            // (1.2) Inlay dbl-click gesture\n            if (isNonEmptyArray(part.item.hint.textEdits)) {\n                executor.emitOne(new MarkdownHover(this, anchor.range, [new MarkdownString().appendText(localize('hint.dbl', \"Double-click to insert\"))], false, 10001));\n            }\n            // (2) Inlay Label Part Tooltip\n            let partTooltip;\n            if (typeof part.part.tooltip === 'string') {\n                partTooltip = new MarkdownString().appendText(part.part.tooltip);\n            }\n            else if (part.part.tooltip) {\n                partTooltip = part.part.tooltip;\n            }\n            if (partTooltip) {\n                executor.emitOne(new MarkdownHover(this, anchor.range, [partTooltip], false, 1));\n            }\n            // (2.2) Inlay Label Part Help Hover\n            if (part.part.location || part.part.command) {\n                let linkHint;\n                const useMetaKey = this._editor.getOption(78 /* EditorOption.multiCursorModifier */) === 'altKey';\n                const kb = useMetaKey\n                    ? platform.isMacintosh\n                        ? localize('links.navigate.kb.meta.mac', \"cmd + click\")\n                        : localize('links.navigate.kb.meta', \"ctrl + click\")\n                    : platform.isMacintosh\n                        ? localize('links.navigate.kb.alt.mac', \"option + click\")\n                        : localize('links.navigate.kb.alt', \"alt + click\");\n                if (part.part.location && part.part.command) {\n                    linkHint = new MarkdownString().appendText(localize('hint.defAndCommand', 'Go to Definition ({0}), right click for more', kb));\n                }\n                else if (part.part.location) {\n                    linkHint = new MarkdownString().appendText(localize('hint.def', 'Go to Definition ({0})', kb));\n                }\n                else if (part.part.command) {\n                    linkHint = new MarkdownString(`[${localize('hint.cmd', \"Execute Command\")}](${asCommandLink(part.part.command)} \"${part.part.command.title}\") (${kb})`, { isTrusted: true });\n                }\n                if (linkHint) {\n                    executor.emitOne(new MarkdownHover(this, anchor.range, [linkHint], false, 10000));\n                }\n            }\n            // (3) Inlay Label Part Location tooltip\n            const iterable = await this._resolveInlayHintLabelPartHover(part, token);\n            for await (const item of iterable) {\n                executor.emitOne(item);\n            }\n        });\n    }\n    async _resolveInlayHintLabelPartHover(part, token) {\n        if (!part.part.location) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const { uri, range } = part.part.location;\n        const ref = await this._resolverService.createModelReference(uri);\n        try {\n            const model = ref.object.textEditorModel;\n            if (!this._languageFeaturesService.hoverProvider.has(model)) {\n                return AsyncIterableObject.EMPTY;\n            }\n            return getHoverProviderResultsAsAsyncIterable(this._languageFeaturesService.hoverProvider, model, new Position(range.startLineNumber, range.startColumn), token)\n                .filter(item => !isEmptyMarkdownString(item.hover.contents))\n                .map(item => new MarkdownHover(this, part.item.anchor.range, item.hover.contents, false, 2 + item.ordinal));\n        }\n        finally {\n            ref.dispose();\n        }\n    }\n};\nInlayHintsHover = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IOpenerService),\n    __param(3, IKeybindingService),\n    __param(4, IHoverService),\n    __param(5, IConfigurationService),\n    __param(6, ITextModelService),\n    __param(7, ILanguageFeaturesService),\n    __param(8, ICommandService)\n], InlayHintsHover);\nexport { InlayHintsHover };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { RenderedHoverParts } from './hoverTypes.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { EditorHoverStatusBar } from './contentHoverStatusBar.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { MarkdownHoverParticipant } from './markdownHoverParticipant.js';\nimport { ColorHoverParticipant } from '../../colorPicker/browser/colorHoverParticipant.js';\nimport { InlayHintsHover } from '../../inlayHints/browser/inlayHintsHover.js';\nimport { BugIndicatingError } from '../../../../base/common/errors.js';\nexport class RenderedContentHover extends Disposable {\n    constructor(editor, hoverResult, participants, computer, context, keybindingService) {\n        super();\n        const anchor = hoverResult.anchor;\n        const parts = hoverResult.hoverParts;\n        this._renderedHoverParts = this._register(new RenderedContentHoverParts(editor, participants, parts, keybindingService, context));\n        const { showAtPosition, showAtSecondaryPosition } = RenderedContentHover.computeHoverPositions(editor, anchor.range, parts);\n        this.shouldAppearBeforeContent = parts.some(m => m.isBeforeContent);\n        this.showAtPosition = showAtPosition;\n        this.showAtSecondaryPosition = showAtSecondaryPosition;\n        this.initialMousePosX = anchor.initialMousePosX;\n        this.initialMousePosY = anchor.initialMousePosY;\n        this.shouldFocus = computer.shouldFocus;\n        this.source = computer.source;\n    }\n    get domNode() {\n        return this._renderedHoverParts.domNode;\n    }\n    get domNodeHasChildren() {\n        return this._renderedHoverParts.domNodeHasChildren;\n    }\n    get focusedHoverPartIndex() {\n        return this._renderedHoverParts.focusedHoverPartIndex;\n    }\n    async updateHoverVerbosityLevel(action, index, focus) {\n        this._renderedHoverParts.updateHoverVerbosityLevel(action, index, focus);\n    }\n    isColorPickerVisible() {\n        return this._renderedHoverParts.isColorPickerVisible();\n    }\n    static computeHoverPositions(editor, anchorRange, hoverParts) {\n        let startColumnBoundary = 1;\n        if (editor.hasModel()) {\n            // Ensure the range is on the current view line\n            const viewModel = editor._getViewModel();\n            const coordinatesConverter = viewModel.coordinatesConverter;\n            const anchorViewRange = coordinatesConverter.convertModelRangeToViewRange(anchorRange);\n            const anchorViewMinColumn = viewModel.getLineMinColumn(anchorViewRange.startLineNumber);\n            const anchorViewRangeStart = new Position(anchorViewRange.startLineNumber, anchorViewMinColumn);\n            startColumnBoundary = coordinatesConverter.convertViewPositionToModelPosition(anchorViewRangeStart).column;\n        }\n        // The anchor range is always on a single line\n        const anchorStartLineNumber = anchorRange.startLineNumber;\n        let secondaryPositionColumn = anchorRange.startColumn;\n        let forceShowAtRange;\n        for (const hoverPart of hoverParts) {\n            const hoverPartRange = hoverPart.range;\n            const hoverPartRangeOnAnchorStartLine = hoverPartRange.startLineNumber === anchorStartLineNumber;\n            const hoverPartRangeOnAnchorEndLine = hoverPartRange.endLineNumber === anchorStartLineNumber;\n            const hoverPartRangeIsOnAnchorLine = hoverPartRangeOnAnchorStartLine && hoverPartRangeOnAnchorEndLine;\n            if (hoverPartRangeIsOnAnchorLine) {\n                // this message has a range that is completely sitting on the line of the anchor\n                const hoverPartStartColumn = hoverPartRange.startColumn;\n                const minSecondaryPositionColumn = Math.min(secondaryPositionColumn, hoverPartStartColumn);\n                secondaryPositionColumn = Math.max(minSecondaryPositionColumn, startColumnBoundary);\n            }\n            if (hoverPart.forceShowAtRange) {\n                forceShowAtRange = hoverPartRange;\n            }\n        }\n        let showAtPosition;\n        let showAtSecondaryPosition;\n        if (forceShowAtRange) {\n            const forceShowAtPosition = forceShowAtRange.getStartPosition();\n            showAtPosition = forceShowAtPosition;\n            showAtSecondaryPosition = forceShowAtPosition;\n        }\n        else {\n            showAtPosition = anchorRange.getStartPosition();\n            showAtSecondaryPosition = new Position(anchorStartLineNumber, secondaryPositionColumn);\n        }\n        return {\n            showAtPosition,\n            showAtSecondaryPosition,\n        };\n    }\n}\nclass RenderedStatusBar {\n    constructor(fragment, _statusBar) {\n        this._statusBar = _statusBar;\n        fragment.appendChild(this._statusBar.hoverElement);\n    }\n    get hoverElement() {\n        return this._statusBar.hoverElement;\n    }\n    get actions() {\n        return this._statusBar.actions;\n    }\n    dispose() {\n        this._statusBar.dispose();\n    }\n}\nclass RenderedContentHoverParts extends Disposable {\n    static { this._DECORATION_OPTIONS = ModelDecorationOptions.register({\n        description: 'content-hover-highlight',\n        className: 'hoverHighlight'\n    }); }\n    constructor(editor, participants, hoverParts, keybindingService, context) {\n        super();\n        this._renderedParts = [];\n        this._focusedHoverPartIndex = -1;\n        this._context = context;\n        this._fragment = document.createDocumentFragment();\n        this._register(this._renderParts(participants, hoverParts, context, keybindingService));\n        this._register(this._registerListenersOnRenderedParts());\n        this._register(this._createEditorDecorations(editor, hoverParts));\n        this._updateMarkdownAndColorParticipantInfo(participants);\n    }\n    _createEditorDecorations(editor, hoverParts) {\n        if (hoverParts.length === 0) {\n            return Disposable.None;\n        }\n        let highlightRange = hoverParts[0].range;\n        for (const hoverPart of hoverParts) {\n            const hoverPartRange = hoverPart.range;\n            highlightRange = Range.plusRange(highlightRange, hoverPartRange);\n        }\n        const highlightDecoration = editor.createDecorationsCollection();\n        highlightDecoration.set([{\n                range: highlightRange,\n                options: RenderedContentHoverParts._DECORATION_OPTIONS\n            }]);\n        return toDisposable(() => {\n            highlightDecoration.clear();\n        });\n    }\n    _renderParts(participants, hoverParts, hoverContext, keybindingService) {\n        const statusBar = new EditorHoverStatusBar(keybindingService);\n        const hoverRenderingContext = {\n            fragment: this._fragment,\n            statusBar,\n            ...hoverContext\n        };\n        const disposables = new DisposableStore();\n        for (const participant of participants) {\n            const renderedHoverParts = this._renderHoverPartsForParticipant(hoverParts, participant, hoverRenderingContext);\n            disposables.add(renderedHoverParts);\n            for (const renderedHoverPart of renderedHoverParts.renderedHoverParts) {\n                this._renderedParts.push({\n                    type: 'hoverPart',\n                    participant,\n                    hoverPart: renderedHoverPart.hoverPart,\n                    hoverElement: renderedHoverPart.hoverElement,\n                });\n            }\n        }\n        const renderedStatusBar = this._renderStatusBar(this._fragment, statusBar);\n        if (renderedStatusBar) {\n            disposables.add(renderedStatusBar);\n            this._renderedParts.push({\n                type: 'statusBar',\n                hoverElement: renderedStatusBar.hoverElement,\n                actions: renderedStatusBar.actions,\n            });\n        }\n        return toDisposable(() => { disposables.dispose(); });\n    }\n    _renderHoverPartsForParticipant(hoverParts, participant, hoverRenderingContext) {\n        const hoverPartsForParticipant = hoverParts.filter(hoverPart => hoverPart.owner === participant);\n        const hasHoverPartsForParticipant = hoverPartsForParticipant.length > 0;\n        if (!hasHoverPartsForParticipant) {\n            return new RenderedHoverParts([]);\n        }\n        return participant.renderHoverParts(hoverRenderingContext, hoverPartsForParticipant);\n    }\n    _renderStatusBar(fragment, statusBar) {\n        if (!statusBar.hasContent) {\n            return undefined;\n        }\n        return new RenderedStatusBar(fragment, statusBar);\n    }\n    _registerListenersOnRenderedParts() {\n        const disposables = new DisposableStore();\n        this._renderedParts.forEach((renderedPart, index) => {\n            const element = renderedPart.hoverElement;\n            element.tabIndex = 0;\n            disposables.add(dom.addDisposableListener(element, dom.EventType.FOCUS_IN, (event) => {\n                event.stopPropagation();\n                this._focusedHoverPartIndex = index;\n            }));\n            disposables.add(dom.addDisposableListener(element, dom.EventType.FOCUS_OUT, (event) => {\n                event.stopPropagation();\n                this._focusedHoverPartIndex = -1;\n            }));\n        });\n        return disposables;\n    }\n    _updateMarkdownAndColorParticipantInfo(participants) {\n        const markdownHoverParticipant = participants.find(p => {\n            return (p instanceof MarkdownHoverParticipant) && !(p instanceof InlayHintsHover);\n        });\n        if (markdownHoverParticipant) {\n            this._markdownHoverParticipant = markdownHoverParticipant;\n        }\n        this._colorHoverParticipant = participants.find(p => p instanceof ColorHoverParticipant);\n    }\n    async updateHoverVerbosityLevel(action, index, focus) {\n        if (!this._markdownHoverParticipant) {\n            return;\n        }\n        const normalizedMarkdownHoverIndex = this._normalizedIndexToMarkdownHoverIndexRange(this._markdownHoverParticipant, index);\n        if (normalizedMarkdownHoverIndex === undefined) {\n            return;\n        }\n        const renderedPart = await this._markdownHoverParticipant.updateMarkdownHoverVerbosityLevel(action, normalizedMarkdownHoverIndex, focus);\n        if (!renderedPart) {\n            return;\n        }\n        this._renderedParts[index] = {\n            type: 'hoverPart',\n            participant: this._markdownHoverParticipant,\n            hoverPart: renderedPart.hoverPart,\n            hoverElement: renderedPart.hoverElement,\n        };\n        this._context.onContentsChanged();\n    }\n    isColorPickerVisible() {\n        return this._colorHoverParticipant?.isColorPickerVisible() ?? false;\n    }\n    _normalizedIndexToMarkdownHoverIndexRange(markdownHoverParticipant, index) {\n        const renderedPart = this._renderedParts[index];\n        if (!renderedPart || renderedPart.type !== 'hoverPart') {\n            return undefined;\n        }\n        const isHoverPartMarkdownHover = renderedPart.participant === markdownHoverParticipant;\n        if (!isHoverPartMarkdownHover) {\n            return undefined;\n        }\n        const firstIndexOfMarkdownHovers = this._renderedParts.findIndex(renderedPart => renderedPart.type === 'hoverPart'\n            && renderedPart.participant === markdownHoverParticipant);\n        if (firstIndexOfMarkdownHovers === -1) {\n            throw new BugIndicatingError();\n        }\n        return index - firstIndexOfMarkdownHovers;\n    }\n    get domNode() {\n        return this._fragment;\n    }\n    get domNodeHasChildren() {\n        return this._fragment.hasChildNodes();\n    }\n    get focusedHoverPartIndex() {\n        return this._focusedHoverPartIndex;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { TokenizationRegistry } from '../../../common/languages.js';\nimport { HoverOperation } from './hoverOperation.js';\nimport { HoverParticipantRegistry, HoverRangeAnchor } from './hoverTypes.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ContentHoverWidget } from './contentHoverWidget.js';\nimport { ContentHoverComputer } from './contentHoverComputer.js';\nimport { HoverResult } from './contentHoverTypes.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { RenderedContentHover } from './contentHoverRendered.js';\nimport { isMousePositionWithinElement } from './hoverUtils.js';\nlet ContentHoverWidgetWrapper = class ContentHoverWidgetWrapper extends Disposable {\n    constructor(_editor, _instantiationService, _keybindingService) {\n        super();\n        this._editor = _editor;\n        this._instantiationService = _instantiationService;\n        this._keybindingService = _keybindingService;\n        this._currentResult = null;\n        this._onContentsChanged = this._register(new Emitter());\n        this.onContentsChanged = this._onContentsChanged.event;\n        this._contentHoverWidget = this._register(this._instantiationService.createInstance(ContentHoverWidget, this._editor));\n        this._participants = this._initializeHoverParticipants();\n        this._computer = new ContentHoverComputer(this._editor, this._participants);\n        this._hoverOperation = this._register(new HoverOperation(this._editor, this._computer));\n        this._registerListeners();\n    }\n    _initializeHoverParticipants() {\n        const participants = [];\n        for (const participant of HoverParticipantRegistry.getAll()) {\n            const participantInstance = this._instantiationService.createInstance(participant, this._editor);\n            participants.push(participantInstance);\n        }\n        participants.sort((p1, p2) => p1.hoverOrdinal - p2.hoverOrdinal);\n        this._register(this._contentHoverWidget.onDidResize(() => {\n            this._participants.forEach(participant => participant.handleResize?.());\n        }));\n        return participants;\n    }\n    _registerListeners() {\n        this._register(this._hoverOperation.onResult((result) => {\n            if (!this._computer.anchor) {\n                // invalid state, ignore result\n                return;\n            }\n            const messages = (result.hasLoadingMessage ? this._addLoadingMessage(result.value) : result.value);\n            this._withResult(new HoverResult(this._computer.anchor, messages, result.isComplete));\n        }));\n        const contentHoverWidgetNode = this._contentHoverWidget.getDomNode();\n        this._register(dom.addStandardDisposableListener(contentHoverWidgetNode, 'keydown', (e) => {\n            if (e.equals(9 /* KeyCode.Escape */)) {\n                this.hide();\n            }\n        }));\n        this._register(dom.addStandardDisposableListener(contentHoverWidgetNode, 'mouseleave', (e) => {\n            this._onMouseLeave(e);\n        }));\n        this._register(TokenizationRegistry.onDidChange(() => {\n            if (this._contentHoverWidget.position && this._currentResult) {\n                this._setCurrentResult(this._currentResult); // render again\n            }\n        }));\n    }\n    /**\n     * Returns true if the hover shows now or will show.\n     */\n    _startShowingOrUpdateHover(anchor, mode, source, focus, mouseEvent) {\n        const contentHoverIsVisible = this._contentHoverWidget.position && this._currentResult;\n        if (!contentHoverIsVisible) {\n            if (anchor) {\n                this._startHoverOperationIfNecessary(anchor, mode, source, focus, false);\n                return true;\n            }\n            return false;\n        }\n        const isHoverSticky = this._editor.getOption(60 /* EditorOption.hover */).sticky;\n        const isMouseGettingCloser = mouseEvent && this._contentHoverWidget.isMouseGettingCloser(mouseEvent.event.posx, mouseEvent.event.posy);\n        const isHoverStickyAndIsMouseGettingCloser = isHoverSticky && isMouseGettingCloser;\n        // The mouse is getting closer to the hover, so we will keep the hover untouched\n        // But we will kick off a hover update at the new anchor, insisting on keeping the hover visible.\n        if (isHoverStickyAndIsMouseGettingCloser) {\n            if (anchor) {\n                this._startHoverOperationIfNecessary(anchor, mode, source, focus, true);\n            }\n            return true;\n        }\n        // If mouse is not getting closer and anchor not defined, hide the hover\n        if (!anchor) {\n            this._setCurrentResult(null);\n            return false;\n        }\n        // If mouse if not getting closer and anchor is defined, and the new anchor is the same as the previous anchor\n        const currentAnchorEqualsPreviousAnchor = this._currentResult.anchor.equals(anchor);\n        if (currentAnchorEqualsPreviousAnchor) {\n            return true;\n        }\n        // If mouse if not getting closer and anchor is defined, and the new anchor is not compatible with the previous anchor\n        const currentAnchorCompatibleWithPreviousAnchor = anchor.canAdoptVisibleHover(this._currentResult.anchor, this._contentHoverWidget.position);\n        if (!currentAnchorCompatibleWithPreviousAnchor) {\n            this._setCurrentResult(null);\n            this._startHoverOperationIfNecessary(anchor, mode, source, focus, false);\n            return true;\n        }\n        // We aren't getting any closer to the hover, so we will filter existing results\n        // and keep those which also apply to the new anchor.\n        this._setCurrentResult(this._currentResult.filter(anchor));\n        this._startHoverOperationIfNecessary(anchor, mode, source, focus, false);\n        return true;\n    }\n    _startHoverOperationIfNecessary(anchor, mode, source, focus, insistOnKeepingHoverVisible) {\n        const currentAnchorEqualToPreviousHover = this._computer.anchor && this._computer.anchor.equals(anchor);\n        if (currentAnchorEqualToPreviousHover) {\n            return;\n        }\n        this._hoverOperation.cancel();\n        this._computer.anchor = anchor;\n        this._computer.shouldFocus = focus;\n        this._computer.source = source;\n        this._computer.insistOnKeepingHoverVisible = insistOnKeepingHoverVisible;\n        this._hoverOperation.start(mode);\n    }\n    _setCurrentResult(hoverResult) {\n        let currentHoverResult = hoverResult;\n        const currentResultEqualToPreviousResult = this._currentResult === currentHoverResult;\n        if (currentResultEqualToPreviousResult) {\n            return;\n        }\n        const currentHoverResultIsEmpty = currentHoverResult && currentHoverResult.hoverParts.length === 0;\n        if (currentHoverResultIsEmpty) {\n            currentHoverResult = null;\n        }\n        this._currentResult = currentHoverResult;\n        if (this._currentResult) {\n            this._showHover(this._currentResult);\n        }\n        else {\n            this._hideHover();\n        }\n    }\n    _addLoadingMessage(result) {\n        if (!this._computer.anchor) {\n            return result;\n        }\n        for (const participant of this._participants) {\n            if (!participant.createLoadingMessage) {\n                continue;\n            }\n            const loadingMessage = participant.createLoadingMessage(this._computer.anchor);\n            if (!loadingMessage) {\n                continue;\n            }\n            return result.slice(0).concat([loadingMessage]);\n        }\n        return result;\n    }\n    _withResult(hoverResult) {\n        const previousHoverIsVisibleWithCompleteResult = this._contentHoverWidget.position && this._currentResult && this._currentResult.isComplete;\n        if (!previousHoverIsVisibleWithCompleteResult) {\n            this._setCurrentResult(hoverResult);\n        }\n        // The hover is visible with a previous complete result.\n        const isCurrentHoverResultComplete = hoverResult.isComplete;\n        if (!isCurrentHoverResultComplete) {\n            // Instead of rendering the new partial result, we wait for the result to be complete.\n            return;\n        }\n        const currentHoverResultIsEmpty = hoverResult.hoverParts.length === 0;\n        const insistOnKeepingPreviousHoverVisible = this._computer.insistOnKeepingHoverVisible;\n        const shouldKeepPreviousHoverVisible = currentHoverResultIsEmpty && insistOnKeepingPreviousHoverVisible;\n        if (shouldKeepPreviousHoverVisible) {\n            // The hover would now hide normally, so we'll keep the previous messages\n            return;\n        }\n        this._setCurrentResult(hoverResult);\n    }\n    _showHover(hoverResult) {\n        const context = this._getHoverContext();\n        this._renderedContentHover = new RenderedContentHover(this._editor, hoverResult, this._participants, this._computer, context, this._keybindingService);\n        if (this._renderedContentHover.domNodeHasChildren) {\n            this._contentHoverWidget.show(this._renderedContentHover);\n        }\n        else {\n            this._renderedContentHover.dispose();\n        }\n    }\n    _hideHover() {\n        this._contentHoverWidget.hide();\n    }\n    _getHoverContext() {\n        const hide = () => {\n            this.hide();\n        };\n        const onContentsChanged = () => {\n            this._onContentsChanged.fire();\n            this._contentHoverWidget.onContentsChanged();\n        };\n        const setMinimumDimensions = (dimensions) => {\n            this._contentHoverWidget.setMinimumDimensions(dimensions);\n        };\n        return { hide, onContentsChanged, setMinimumDimensions };\n    }\n    showsOrWillShow(mouseEvent) {\n        const isContentWidgetResizing = this._contentHoverWidget.isResizing;\n        if (isContentWidgetResizing) {\n            return true;\n        }\n        const anchorCandidates = this._findHoverAnchorCandidates(mouseEvent);\n        const anchorCandidatesExist = anchorCandidates.length > 0;\n        if (!anchorCandidatesExist) {\n            return this._startShowingOrUpdateHover(null, 0 /* HoverStartMode.Delayed */, 0 /* HoverStartSource.Mouse */, false, mouseEvent);\n        }\n        const anchor = anchorCandidates[0];\n        return this._startShowingOrUpdateHover(anchor, 0 /* HoverStartMode.Delayed */, 0 /* HoverStartSource.Mouse */, false, mouseEvent);\n    }\n    _findHoverAnchorCandidates(mouseEvent) {\n        const anchorCandidates = [];\n        for (const participant of this._participants) {\n            if (!participant.suggestHoverAnchor) {\n                continue;\n            }\n            const anchor = participant.suggestHoverAnchor(mouseEvent);\n            if (!anchor) {\n                continue;\n            }\n            anchorCandidates.push(anchor);\n        }\n        const target = mouseEvent.target;\n        switch (target.type) {\n            case 6 /* MouseTargetType.CONTENT_TEXT */: {\n                anchorCandidates.push(new HoverRangeAnchor(0, target.range, mouseEvent.event.posx, mouseEvent.event.posy));\n                break;\n            }\n            case 7 /* MouseTargetType.CONTENT_EMPTY */: {\n                const epsilon = this._editor.getOption(50 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth / 2;\n                // Let hover kick in even when the mouse is technically in the empty area after a line, given the distance is small enough\n                const mouseIsWithinLinesAndCloseToHover = !target.detail.isAfterLines\n                    && typeof target.detail.horizontalDistanceToText === 'number'\n                    && target.detail.horizontalDistanceToText < epsilon;\n                if (!mouseIsWithinLinesAndCloseToHover) {\n                    break;\n                }\n                anchorCandidates.push(new HoverRangeAnchor(0, target.range, mouseEvent.event.posx, mouseEvent.event.posy));\n                break;\n            }\n        }\n        anchorCandidates.sort((a, b) => b.priority - a.priority);\n        return anchorCandidates;\n    }\n    _onMouseLeave(e) {\n        const editorDomNode = this._editor.getDomNode();\n        const isMousePositionOutsideOfEditor = !editorDomNode || !isMousePositionWithinElement(editorDomNode, e.x, e.y);\n        if (isMousePositionOutsideOfEditor) {\n            this.hide();\n        }\n    }\n    startShowingAtRange(range, mode, source, focus) {\n        this._startShowingOrUpdateHover(new HoverRangeAnchor(0, range, undefined, undefined), mode, source, focus, null);\n    }\n    async updateHoverVerbosityLevel(action, index, focus) {\n        this._renderedContentHover?.updateHoverVerbosityLevel(action, index, focus);\n    }\n    focusedHoverPartIndex() {\n        return this._renderedContentHover?.focusedHoverPartIndex ?? -1;\n    }\n    containsNode(node) {\n        return (node ? this._contentHoverWidget.getDomNode().contains(node) : false);\n    }\n    focus() {\n        this._contentHoverWidget.focus();\n    }\n    scrollUp() {\n        this._contentHoverWidget.scrollUp();\n    }\n    scrollDown() {\n        this._contentHoverWidget.scrollDown();\n    }\n    scrollLeft() {\n        this._contentHoverWidget.scrollLeft();\n    }\n    scrollRight() {\n        this._contentHoverWidget.scrollRight();\n    }\n    pageUp() {\n        this._contentHoverWidget.pageUp();\n    }\n    pageDown() {\n        this._contentHoverWidget.pageDown();\n    }\n    goToTop() {\n        this._contentHoverWidget.goToTop();\n    }\n    goToBottom() {\n        this._contentHoverWidget.goToBottom();\n    }\n    hide() {\n        this._computer.anchor = null;\n        this._hoverOperation.cancel();\n        this._setCurrentResult(null);\n    }\n    getDomNode() {\n        return this._contentHoverWidget.getDomNode();\n    }\n    get isColorPickerVisible() {\n        return this._renderedContentHover?.isColorPickerVisible() ?? false;\n    }\n    get isVisibleFromKeyboard() {\n        return this._contentHoverWidget.isVisibleFromKeyboard;\n    }\n    get isVisible() {\n        return this._contentHoverWidget.isVisible;\n    }\n    get isFocused() {\n        return this._contentHoverWidget.isFocused;\n    }\n    get isResizing() {\n        return this._contentHoverWidget.isResizing;\n    }\n    get widget() {\n        return this._contentHoverWidget;\n    }\n};\nContentHoverWidgetWrapper = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IKeybindingService)\n], ContentHoverWidgetWrapper);\nexport { ContentHoverWidgetWrapper };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ContentHoverController_1;\nimport { DECREASE_HOVER_VERBOSITY_ACTION_ID, INCREASE_HOVER_VERBOSITY_ACTION_ID, SHOW_OR_FOCUS_HOVER_ACTION_ID } from './hoverActionIds.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { InlineSuggestionHintsContentWidget } from '../../inlineCompletions/browser/hintsWidget/inlineCompletionsHintsWidget.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { isMousePositionWithinElement } from './hoverUtils.js';\nimport { ContentHoverWidgetWrapper } from './contentHoverWidgetWrapper.js';\nimport './hover.css';\nimport { Emitter } from '../../../../base/common/event.js';\n// sticky hover widget which doesn't disappear on focus out and such\nconst _sticky = false;\nlet ContentHoverController = class ContentHoverController extends Disposable {\n    static { ContentHoverController_1 = this; }\n    static { this.ID = 'editor.contrib.contentHover'; }\n    constructor(_editor, _instantiationService, _keybindingService) {\n        super();\n        this._editor = _editor;\n        this._instantiationService = _instantiationService;\n        this._keybindingService = _keybindingService;\n        this._onHoverContentsChanged = this._register(new Emitter());\n        this.shouldKeepOpenOnEditorMouseMoveOrLeave = false;\n        this._listenersStore = new DisposableStore();\n        this._hoverState = {\n            mouseDown: false,\n            activatedByDecoratorClick: false\n        };\n        this._reactToEditorMouseMoveRunner = this._register(new RunOnceScheduler(() => this._reactToEditorMouseMove(this._mouseMoveEvent), 0));\n        this._hookListeners();\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(60 /* EditorOption.hover */)) {\n                this._unhookListeners();\n                this._hookListeners();\n            }\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(ContentHoverController_1.ID);\n    }\n    _hookListeners() {\n        const hoverOpts = this._editor.getOption(60 /* EditorOption.hover */);\n        this._hoverSettings = {\n            enabled: hoverOpts.enabled,\n            sticky: hoverOpts.sticky,\n            hidingDelay: hoverOpts.hidingDelay\n        };\n        if (hoverOpts.enabled) {\n            this._listenersStore.add(this._editor.onMouseDown((e) => this._onEditorMouseDown(e)));\n            this._listenersStore.add(this._editor.onMouseUp(() => this._onEditorMouseUp()));\n            this._listenersStore.add(this._editor.onMouseMove((e) => this._onEditorMouseMove(e)));\n            this._listenersStore.add(this._editor.onKeyDown((e) => this._onKeyDown(e)));\n        }\n        else {\n            this._listenersStore.add(this._editor.onMouseMove((e) => this._onEditorMouseMove(e)));\n            this._listenersStore.add(this._editor.onKeyDown((e) => this._onKeyDown(e)));\n        }\n        this._listenersStore.add(this._editor.onMouseLeave((e) => this._onEditorMouseLeave(e)));\n        this._listenersStore.add(this._editor.onDidChangeModel(() => {\n            this._cancelScheduler();\n            this._hideWidgets();\n        }));\n        this._listenersStore.add(this._editor.onDidChangeModelContent(() => this._cancelScheduler()));\n        this._listenersStore.add(this._editor.onDidScrollChange((e) => this._onEditorScrollChanged(e)));\n    }\n    _unhookListeners() {\n        this._listenersStore.clear();\n    }\n    _cancelScheduler() {\n        this._mouseMoveEvent = undefined;\n        this._reactToEditorMouseMoveRunner.cancel();\n    }\n    _onEditorScrollChanged(e) {\n        if (e.scrollTopChanged || e.scrollLeftChanged) {\n            this._hideWidgets();\n        }\n    }\n    _onEditorMouseDown(mouseEvent) {\n        this._hoverState.mouseDown = true;\n        const shouldNotHideCurrentHoverWidget = this._shouldNotHideCurrentHoverWidget(mouseEvent);\n        if (shouldNotHideCurrentHoverWidget) {\n            return;\n        }\n        this._hideWidgets();\n    }\n    _shouldNotHideCurrentHoverWidget(mouseEvent) {\n        return this._isMouseOnContentHoverWidget(mouseEvent) || this._isContentWidgetResizing();\n    }\n    _isMouseOnContentHoverWidget(mouseEvent) {\n        const contentWidgetNode = this._contentWidget?.getDomNode();\n        if (contentWidgetNode) {\n            return isMousePositionWithinElement(contentWidgetNode, mouseEvent.event.posx, mouseEvent.event.posy);\n        }\n        return false;\n    }\n    _onEditorMouseUp() {\n        this._hoverState.mouseDown = false;\n    }\n    _onEditorMouseLeave(mouseEvent) {\n        if (this.shouldKeepOpenOnEditorMouseMoveOrLeave) {\n            return;\n        }\n        this._cancelScheduler();\n        const shouldNotHideCurrentHoverWidget = this._shouldNotHideCurrentHoverWidget(mouseEvent);\n        if (shouldNotHideCurrentHoverWidget) {\n            return;\n        }\n        if (_sticky) {\n            return;\n        }\n        this._hideWidgets();\n    }\n    _shouldNotRecomputeCurrentHoverWidget(mouseEvent) {\n        const isHoverSticky = this._hoverSettings.sticky;\n        const isMouseOnStickyContentHoverWidget = (mouseEvent, isHoverSticky) => {\n            const isMouseOnContentHoverWidget = this._isMouseOnContentHoverWidget(mouseEvent);\n            return isHoverSticky && isMouseOnContentHoverWidget;\n        };\n        const isMouseOnColorPicker = (mouseEvent) => {\n            const isMouseOnContentHoverWidget = this._isMouseOnContentHoverWidget(mouseEvent);\n            const isColorPickerVisible = this._contentWidget?.isColorPickerVisible ?? false;\n            return isMouseOnContentHoverWidget && isColorPickerVisible;\n        };\n        // TODO@aiday-mar verify if the following is necessary code\n        const isTextSelectedWithinContentHoverWidget = (mouseEvent, sticky) => {\n            return (sticky\n                && this._contentWidget?.containsNode(mouseEvent.event.browserEvent.view?.document.activeElement)\n                && !mouseEvent.event.browserEvent.view?.getSelection()?.isCollapsed) ?? false;\n        };\n        return isMouseOnStickyContentHoverWidget(mouseEvent, isHoverSticky)\n            || isMouseOnColorPicker(mouseEvent)\n            || isTextSelectedWithinContentHoverWidget(mouseEvent, isHoverSticky);\n    }\n    _onEditorMouseMove(mouseEvent) {\n        if (this.shouldKeepOpenOnEditorMouseMoveOrLeave) {\n            return;\n        }\n        this._mouseMoveEvent = mouseEvent;\n        if (this._contentWidget?.isFocused || this._contentWidget?.isResizing) {\n            return;\n        }\n        const sticky = this._hoverSettings.sticky;\n        if (sticky && this._contentWidget?.isVisibleFromKeyboard) {\n            // Sticky mode is on and the hover has been shown via keyboard\n            // so moving the mouse has no effect\n            return;\n        }\n        const shouldNotRecomputeCurrentHoverWidget = this._shouldNotRecomputeCurrentHoverWidget(mouseEvent);\n        if (shouldNotRecomputeCurrentHoverWidget) {\n            this._reactToEditorMouseMoveRunner.cancel();\n            return;\n        }\n        const hidingDelay = this._hoverSettings.hidingDelay;\n        const isContentHoverWidgetVisible = this._contentWidget?.isVisible;\n        // If the mouse is not over the widget, and if sticky is on,\n        // then give it a grace period before reacting to the mouse event\n        const shouldRescheduleHoverComputation = isContentHoverWidgetVisible && sticky && hidingDelay > 0;\n        if (shouldRescheduleHoverComputation) {\n            if (!this._reactToEditorMouseMoveRunner.isScheduled()) {\n                this._reactToEditorMouseMoveRunner.schedule(hidingDelay);\n            }\n            return;\n        }\n        this._reactToEditorMouseMove(mouseEvent);\n    }\n    _reactToEditorMouseMove(mouseEvent) {\n        if (!mouseEvent) {\n            return;\n        }\n        const target = mouseEvent.target;\n        const mouseOnDecorator = target.element?.classList.contains('colorpicker-color-decoration');\n        const decoratorActivatedOn = this._editor.getOption(149 /* EditorOption.colorDecoratorsActivatedOn */);\n        const enabled = this._hoverSettings.enabled;\n        const activatedByDecoratorClick = this._hoverState.activatedByDecoratorClick;\n        if ((mouseOnDecorator && ((decoratorActivatedOn === 'click' && !activatedByDecoratorClick) ||\n            (decoratorActivatedOn === 'hover' && !enabled && !_sticky) ||\n            (decoratorActivatedOn === 'clickAndHover' && !enabled && !activatedByDecoratorClick))) || (!mouseOnDecorator && !enabled && !activatedByDecoratorClick)) {\n            this._hideWidgets();\n            return;\n        }\n        const contentHoverShowsOrWillShow = this._tryShowHoverWidget(mouseEvent);\n        if (contentHoverShowsOrWillShow) {\n            return;\n        }\n        if (_sticky) {\n            return;\n        }\n        this._hideWidgets();\n    }\n    _tryShowHoverWidget(mouseEvent) {\n        const contentWidget = this._getOrCreateContentWidget();\n        return contentWidget.showsOrWillShow(mouseEvent);\n    }\n    _onKeyDown(e) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const resolvedKeyboardEvent = this._keybindingService.softDispatch(e, this._editor.getDomNode());\n        // If the beginning of a multi-chord keybinding is pressed,\n        // or the command aims to focus the hover,\n        // set the variable to true, otherwise false\n        const shouldKeepHoverVisible = (resolvedKeyboardEvent.kind === 1 /* ResultKind.MoreChordsNeeded */ ||\n            (resolvedKeyboardEvent.kind === 2 /* ResultKind.KbFound */\n                && (resolvedKeyboardEvent.commandId === SHOW_OR_FOCUS_HOVER_ACTION_ID\n                    || resolvedKeyboardEvent.commandId === INCREASE_HOVER_VERBOSITY_ACTION_ID\n                    || resolvedKeyboardEvent.commandId === DECREASE_HOVER_VERBOSITY_ACTION_ID)\n                && this._contentWidget?.isVisible));\n        if (e.keyCode === 5 /* KeyCode.Ctrl */\n            || e.keyCode === 6 /* KeyCode.Alt */\n            || e.keyCode === 57 /* KeyCode.Meta */\n            || e.keyCode === 4 /* KeyCode.Shift */\n            || shouldKeepHoverVisible) {\n            // Do not hide hover when a modifier key is pressed\n            return;\n        }\n        this._hideWidgets();\n    }\n    _hideWidgets() {\n        if (_sticky) {\n            return;\n        }\n        if ((this._hoverState.mouseDown\n            && this._contentWidget?.isColorPickerVisible) || InlineSuggestionHintsContentWidget.dropDownVisible) {\n            return;\n        }\n        this._hoverState.activatedByDecoratorClick = false;\n        this._contentWidget?.hide();\n    }\n    _getOrCreateContentWidget() {\n        if (!this._contentWidget) {\n            this._contentWidget = this._instantiationService.createInstance(ContentHoverWidgetWrapper, this._editor);\n            this._listenersStore.add(this._contentWidget.onContentsChanged(() => this._onHoverContentsChanged.fire()));\n        }\n        return this._contentWidget;\n    }\n    showContentHover(range, mode, source, focus, activatedByColorDecoratorClick = false) {\n        this._hoverState.activatedByDecoratorClick = activatedByColorDecoratorClick;\n        this._getOrCreateContentWidget().startShowingAtRange(range, mode, source, focus);\n    }\n    _isContentWidgetResizing() {\n        return this._contentWidget?.widget.isResizing || false;\n    }\n    focusedHoverPartIndex() {\n        return this._getOrCreateContentWidget().focusedHoverPartIndex();\n    }\n    updateHoverVerbosityLevel(action, index, focus) {\n        this._getOrCreateContentWidget().updateHoverVerbosityLevel(action, index, focus);\n    }\n    focus() {\n        this._contentWidget?.focus();\n    }\n    scrollUp() {\n        this._contentWidget?.scrollUp();\n    }\n    scrollDown() {\n        this._contentWidget?.scrollDown();\n    }\n    scrollLeft() {\n        this._contentWidget?.scrollLeft();\n    }\n    scrollRight() {\n        this._contentWidget?.scrollRight();\n    }\n    pageUp() {\n        this._contentWidget?.pageUp();\n    }\n    pageDown() {\n        this._contentWidget?.pageDown();\n    }\n    goToTop() {\n        this._contentWidget?.goToTop();\n    }\n    goToBottom() {\n        this._contentWidget?.goToBottom();\n    }\n    get isColorPickerVisible() {\n        return this._contentWidget?.isColorPickerVisible;\n    }\n    get isHoverVisible() {\n        return this._contentWidget?.isVisible;\n    }\n    dispose() {\n        super.dispose();\n        this._unhookListeners();\n        this._listenersStore.dispose();\n        this._contentWidget?.dispose();\n    }\n};\nContentHoverController = ContentHoverController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IKeybindingService)\n], ContentHoverController);\nexport { ContentHoverController };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ColorDecorationInjectedTextMarker } from './colorDetector.js';\nimport { ColorHoverParticipant } from './colorHoverParticipant.js';\nimport { ContentHoverController } from '../../hover/browser/contentHoverController2.js';\nimport { HoverParticipantRegistry } from '../../hover/browser/hoverTypes.js';\nexport class ColorContribution extends Disposable {\n    static { this.ID = 'editor.contrib.colorContribution'; } // ms\n    constructor(_editor) {\n        super();\n        this._editor = _editor;\n        this._register(_editor.onMouseDown((e) => this.onMouseDown(e)));\n    }\n    dispose() {\n        super.dispose();\n    }\n    onMouseDown(mouseEvent) {\n        const colorDecoratorsActivatedOn = this._editor.getOption(149 /* EditorOption.colorDecoratorsActivatedOn */);\n        if (colorDecoratorsActivatedOn !== 'click' && colorDecoratorsActivatedOn !== 'clickAndHover') {\n            return;\n        }\n        const target = mouseEvent.target;\n        if (target.type !== 6 /* MouseTargetType.CONTENT_TEXT */) {\n            return;\n        }\n        if (!target.detail.injectedText) {\n            return;\n        }\n        if (target.detail.injectedText.options.attachedData !== ColorDecorationInjectedTextMarker) {\n            return;\n        }\n        if (!target.range) {\n            return;\n        }\n        const hoverController = this._editor.getContribution(ContentHoverController.ID);\n        if (!hoverController) {\n            return;\n        }\n        if (!hoverController.isColorPickerVisible) {\n            const range = new Range(target.range.startLineNumber, target.range.startColumn + 1, target.range.endLineNumber, target.range.endColumn + 1);\n            hoverController.showContentHover(range, 1 /* HoverStartMode.Immediate */, 0 /* HoverStartSource.Mouse */, false, true);\n        }\n    }\n}\nregisterEditorContribution(ColorContribution.ID, ColorContribution, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nHoverParticipantRegistry.register(ColorHoverParticipant);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar StandaloneColorPickerController_1, StandaloneColorPickerWidget_1;\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { StandaloneColorPickerParticipant } from './colorHoverParticipant.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { EditorHoverStatusBar } from '../../hover/browser/contentHoverStatusBar.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { DefaultDocumentColorProvider } from './defaultDocumentColorProvider.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport './colorPicker.css';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nlet StandaloneColorPickerController = class StandaloneColorPickerController extends Disposable {\n    static { StandaloneColorPickerController_1 = this; }\n    static { this.ID = 'editor.contrib.standaloneColorPickerController'; }\n    constructor(_editor, _contextKeyService, _instantiationService) {\n        super();\n        this._editor = _editor;\n        this._instantiationService = _instantiationService;\n        this._standaloneColorPickerWidget = null;\n        this._standaloneColorPickerVisible = EditorContextKeys.standaloneColorPickerVisible.bindTo(_contextKeyService);\n        this._standaloneColorPickerFocused = EditorContextKeys.standaloneColorPickerFocused.bindTo(_contextKeyService);\n    }\n    showOrFocus() {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (!this._standaloneColorPickerVisible.get()) {\n            this._standaloneColorPickerWidget = this._instantiationService.createInstance(StandaloneColorPickerWidget, this._editor, this._standaloneColorPickerVisible, this._standaloneColorPickerFocused);\n        }\n        else if (!this._standaloneColorPickerFocused.get()) {\n            this._standaloneColorPickerWidget?.focus();\n        }\n    }\n    hide() {\n        this._standaloneColorPickerFocused.set(false);\n        this._standaloneColorPickerVisible.set(false);\n        this._standaloneColorPickerWidget?.hide();\n        this._editor.focus();\n    }\n    insertColor() {\n        this._standaloneColorPickerWidget?.updateEditor();\n        this.hide();\n    }\n    static get(editor) {\n        return editor.getContribution(StandaloneColorPickerController_1.ID);\n    }\n};\nStandaloneColorPickerController = StandaloneColorPickerController_1 = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, IInstantiationService)\n], StandaloneColorPickerController);\nexport { StandaloneColorPickerController };\nregisterEditorContribution(StandaloneColorPickerController.ID, StandaloneColorPickerController, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nconst PADDING = 8;\nconst CLOSE_BUTTON_WIDTH = 22;\nlet StandaloneColorPickerWidget = class StandaloneColorPickerWidget extends Disposable {\n    static { StandaloneColorPickerWidget_1 = this; }\n    static { this.ID = 'editor.contrib.standaloneColorPickerWidget'; }\n    constructor(_editor, _standaloneColorPickerVisible, _standaloneColorPickerFocused, _instantiationService, _keybindingService, _languageFeaturesService, _editorWorkerService) {\n        super();\n        this._editor = _editor;\n        this._standaloneColorPickerVisible = _standaloneColorPickerVisible;\n        this._standaloneColorPickerFocused = _standaloneColorPickerFocused;\n        this._keybindingService = _keybindingService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._editorWorkerService = _editorWorkerService;\n        this.allowEditorOverflow = true;\n        this._position = undefined;\n        this._body = document.createElement('div');\n        this._colorHover = null;\n        this._selectionSetInEditor = false;\n        this._onResult = this._register(new Emitter());\n        this.onResult = this._onResult.event;\n        this._standaloneColorPickerVisible.set(true);\n        this._standaloneColorPickerParticipant = _instantiationService.createInstance(StandaloneColorPickerParticipant, this._editor);\n        this._position = this._editor._getViewModel()?.getPrimaryCursorState().modelState.position;\n        const editorSelection = this._editor.getSelection();\n        const selection = editorSelection ?\n            {\n                startLineNumber: editorSelection.startLineNumber,\n                startColumn: editorSelection.startColumn,\n                endLineNumber: editorSelection.endLineNumber,\n                endColumn: editorSelection.endColumn\n            } : { startLineNumber: 0, endLineNumber: 0, endColumn: 0, startColumn: 0 };\n        const focusTracker = this._register(dom.trackFocus(this._body));\n        this._register(focusTracker.onDidBlur(_ => {\n            this.hide();\n        }));\n        this._register(focusTracker.onDidFocus(_ => {\n            this.focus();\n        }));\n        // When the cursor position changes, hide the color picker\n        this._register(this._editor.onDidChangeCursorPosition(() => {\n            // Do not hide the color picker when the cursor changes position due to the keybindings\n            if (!this._selectionSetInEditor) {\n                this.hide();\n            }\n            else {\n                this._selectionSetInEditor = false;\n            }\n        }));\n        this._register(this._editor.onMouseMove((e) => {\n            const classList = e.target.element?.classList;\n            if (classList && classList.contains('colorpicker-color-decoration')) {\n                this.hide();\n            }\n        }));\n        this._register(this.onResult((result) => {\n            this._render(result.value, result.foundInEditor);\n        }));\n        this._start(selection);\n        this._body.style.zIndex = '50';\n        this._editor.addContentWidget(this);\n    }\n    updateEditor() {\n        if (this._colorHover) {\n            this._standaloneColorPickerParticipant.updateEditorModel(this._colorHover);\n        }\n    }\n    getId() {\n        return StandaloneColorPickerWidget_1.ID;\n    }\n    getDomNode() {\n        return this._body;\n    }\n    getPosition() {\n        if (!this._position) {\n            return null;\n        }\n        const positionPreference = this._editor.getOption(60 /* EditorOption.hover */).above;\n        return {\n            position: this._position,\n            secondaryPosition: this._position,\n            preference: positionPreference ? [1 /* ContentWidgetPositionPreference.ABOVE */, 2 /* ContentWidgetPositionPreference.BELOW */] : [2 /* ContentWidgetPositionPreference.BELOW */, 1 /* ContentWidgetPositionPreference.ABOVE */],\n            positionAffinity: 2 /* PositionAffinity.None */\n        };\n    }\n    hide() {\n        this.dispose();\n        this._standaloneColorPickerVisible.set(false);\n        this._standaloneColorPickerFocused.set(false);\n        this._editor.removeContentWidget(this);\n        this._editor.focus();\n    }\n    focus() {\n        this._standaloneColorPickerFocused.set(true);\n        this._body.focus();\n    }\n    async _start(selection) {\n        const computeAsyncResult = await this._computeAsync(selection);\n        if (!computeAsyncResult) {\n            return;\n        }\n        this._onResult.fire(new StandaloneColorPickerResult(computeAsyncResult.result, computeAsyncResult.foundInEditor));\n    }\n    async _computeAsync(range) {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        const colorInfo = {\n            range: range,\n            color: { red: 0, green: 0, blue: 0, alpha: 1 }\n        };\n        const colorHoverResult = await this._standaloneColorPickerParticipant.createColorHover(colorInfo, new DefaultDocumentColorProvider(this._editorWorkerService), this._languageFeaturesService.colorProvider);\n        if (!colorHoverResult) {\n            return null;\n        }\n        return { result: colorHoverResult.colorHover, foundInEditor: colorHoverResult.foundInEditor };\n    }\n    _render(colorHover, foundInEditor) {\n        const fragment = document.createDocumentFragment();\n        const statusBar = this._register(new EditorHoverStatusBar(this._keybindingService));\n        const context = {\n            fragment,\n            statusBar,\n            onContentsChanged: () => { },\n            hide: () => this.hide()\n        };\n        this._colorHover = colorHover;\n        const renderedHoverPart = this._standaloneColorPickerParticipant.renderHoverParts(context, [colorHover]);\n        if (!renderedHoverPart) {\n            return;\n        }\n        this._register(renderedHoverPart.disposables);\n        const colorPicker = renderedHoverPart.colorPicker;\n        this._body.classList.add('standalone-colorpicker-body');\n        this._body.style.maxHeight = Math.max(this._editor.getLayoutInfo().height / 4, 250) + 'px';\n        this._body.style.maxWidth = Math.max(this._editor.getLayoutInfo().width * 0.66, 500) + 'px';\n        this._body.tabIndex = 0;\n        this._body.appendChild(fragment);\n        colorPicker.layout();\n        const colorPickerBody = colorPicker.body;\n        const saturationBoxWidth = colorPickerBody.saturationBox.domNode.clientWidth;\n        const widthOfOriginalColorBox = colorPickerBody.domNode.clientWidth - saturationBoxWidth - CLOSE_BUTTON_WIDTH - PADDING;\n        const enterButton = colorPicker.body.enterButton;\n        enterButton?.onClicked(() => {\n            this.updateEditor();\n            this.hide();\n        });\n        const colorPickerHeader = colorPicker.header;\n        const pickedColorNode = colorPickerHeader.pickedColorNode;\n        pickedColorNode.style.width = saturationBoxWidth + PADDING + 'px';\n        const originalColorNode = colorPickerHeader.originalColorNode;\n        originalColorNode.style.width = widthOfOriginalColorBox + 'px';\n        const closeButton = colorPicker.header.closeButton;\n        closeButton?.onClicked(() => {\n            this.hide();\n        });\n        // When found in the editor, highlight the selection in the editor\n        if (foundInEditor) {\n            if (enterButton) {\n                enterButton.button.textContent = 'Replace';\n            }\n            this._selectionSetInEditor = true;\n            this._editor.setSelection(colorHover.range);\n        }\n        this._editor.layoutContentWidget(this);\n    }\n};\nStandaloneColorPickerWidget = StandaloneColorPickerWidget_1 = __decorate([\n    __param(3, IInstantiationService),\n    __param(4, IKeybindingService),\n    __param(5, ILanguageFeaturesService),\n    __param(6, IEditorWorkerService)\n], StandaloneColorPickerWidget);\nexport { StandaloneColorPickerWidget };\nclass StandaloneColorPickerResult {\n    // The color picker result consists of: an array of color results and a boolean indicating if the color was found in the editor\n    constructor(value, foundInEditor) {\n        this.value = value;\n        this.foundInEditor = foundInEditor;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, EditorAction2, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { localize, localize2 } from '../../../../nls.js';\nimport { StandaloneColorPickerController } from './standaloneColorPickerWidget.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { MenuId, registerAction2 } from '../../../../platform/actions/common/actions.js';\nimport './colorPicker.css';\nexport class ShowOrFocusStandaloneColorPicker extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.showOrFocusStandaloneColorPicker',\n            title: {\n                ...localize2('showOrFocusStandaloneColorPicker', \"Show or Focus Standalone Color Picker\"),\n                mnemonicTitle: localize({ key: 'mishowOrFocusStandaloneColorPicker', comment: ['&& denotes a mnemonic'] }, \"&&Show or Focus Standalone Color Picker\"),\n            },\n            precondition: undefined,\n            menu: [\n                { id: MenuId.CommandPalette },\n            ],\n            metadata: {\n                description: localize2('showOrFocusStandaloneColorPickerDescription', \"Show or focus a standalone color picker which uses the default color provider. It displays hex/rgb/hsl colors.\"),\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        StandaloneColorPickerController.get(editor)?.showOrFocus();\n    }\n}\nclass HideStandaloneColorPicker extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.hideColorPicker',\n            label: localize({\n                key: 'hideColorPicker',\n                comment: [\n                    'Action that hides the color picker'\n                ]\n            }, \"Hide the Color Picker\"),\n            alias: 'Hide the Color Picker',\n            precondition: EditorContextKeys.standaloneColorPickerVisible.isEqualTo(true),\n            kbOpts: {\n                primary: 9 /* KeyCode.Escape */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: localize2('hideColorPickerDescription', \"Hide the standalone color picker.\"),\n            }\n        });\n    }\n    run(_accessor, editor) {\n        StandaloneColorPickerController.get(editor)?.hide();\n    }\n}\nclass InsertColorWithStandaloneColorPicker extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.insertColorWithStandaloneColorPicker',\n            label: localize({\n                key: 'insertColorWithStandaloneColorPicker',\n                comment: [\n                    'Action that inserts color with standalone color picker'\n                ]\n            }, \"Insert Color with Standalone Color Picker\"),\n            alias: 'Insert Color with Standalone Color Picker',\n            precondition: EditorContextKeys.standaloneColorPickerFocused.isEqualTo(true),\n            kbOpts: {\n                primary: 3 /* KeyCode.Enter */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: localize2('insertColorWithStandaloneColorPickerDescription', \"Insert hex/rgb/hsl colors with the focused standalone color picker.\"),\n            }\n        });\n    }\n    run(_accessor, editor) {\n        StandaloneColorPickerController.get(editor)?.insertColor();\n    }\n}\nregisterEditorAction(HideStandaloneColorPicker);\nregisterEditorAction(InsertColorWithStandaloneColorPicker);\nregisterAction2(ShowOrFocusStandaloneColorPicker);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nexport class BlockCommentCommand {\n    constructor(selection, insertSpace, languageConfigurationService) {\n        this.languageConfigurationService = languageConfigurationService;\n        this._selection = selection;\n        this._insertSpace = insertSpace;\n        this._usedEndToken = null;\n    }\n    static _haystackHasNeedleAtOffset(haystack, needle, offset) {\n        if (offset < 0) {\n            return false;\n        }\n        const needleLength = needle.length;\n        const haystackLength = haystack.length;\n        if (offset + needleLength > haystackLength) {\n            return false;\n        }\n        for (let i = 0; i < needleLength; i++) {\n            const codeA = haystack.charCodeAt(offset + i);\n            const codeB = needle.charCodeAt(i);\n            if (codeA === codeB) {\n                continue;\n            }\n            if (codeA >= 65 /* CharCode.A */ && codeA <= 90 /* CharCode.Z */ && codeA + 32 === codeB) {\n                // codeA is upper-case variant of codeB\n                continue;\n            }\n            if (codeB >= 65 /* CharCode.A */ && codeB <= 90 /* CharCode.Z */ && codeB + 32 === codeA) {\n                // codeB is upper-case variant of codeA\n                continue;\n            }\n            return false;\n        }\n        return true;\n    }\n    _createOperationsForBlockComment(selection, startToken, endToken, insertSpace, model, builder) {\n        const startLineNumber = selection.startLineNumber;\n        const startColumn = selection.startColumn;\n        const endLineNumber = selection.endLineNumber;\n        const endColumn = selection.endColumn;\n        const startLineText = model.getLineContent(startLineNumber);\n        const endLineText = model.getLineContent(endLineNumber);\n        let startTokenIndex = startLineText.lastIndexOf(startToken, startColumn - 1 + startToken.length);\n        let endTokenIndex = endLineText.indexOf(endToken, endColumn - 1 - endToken.length);\n        if (startTokenIndex !== -1 && endTokenIndex !== -1) {\n            if (startLineNumber === endLineNumber) {\n                const lineBetweenTokens = startLineText.substring(startTokenIndex + startToken.length, endTokenIndex);\n                if (lineBetweenTokens.indexOf(endToken) >= 0) {\n                    // force to add a block comment\n                    startTokenIndex = -1;\n                    endTokenIndex = -1;\n                }\n            }\n            else {\n                const startLineAfterStartToken = startLineText.substring(startTokenIndex + startToken.length);\n                const endLineBeforeEndToken = endLineText.substring(0, endTokenIndex);\n                if (startLineAfterStartToken.indexOf(endToken) >= 0 || endLineBeforeEndToken.indexOf(endToken) >= 0) {\n                    // force to add a block comment\n                    startTokenIndex = -1;\n                    endTokenIndex = -1;\n                }\n            }\n        }\n        let ops;\n        if (startTokenIndex !== -1 && endTokenIndex !== -1) {\n            // Consider spaces as part of the comment tokens\n            if (insertSpace && startTokenIndex + startToken.length < startLineText.length && startLineText.charCodeAt(startTokenIndex + startToken.length) === 32 /* CharCode.Space */) {\n                // Pretend the start token contains a trailing space\n                startToken = startToken + ' ';\n            }\n            if (insertSpace && endTokenIndex > 0 && endLineText.charCodeAt(endTokenIndex - 1) === 32 /* CharCode.Space */) {\n                // Pretend the end token contains a leading space\n                endToken = ' ' + endToken;\n                endTokenIndex -= 1;\n            }\n            ops = BlockCommentCommand._createRemoveBlockCommentOperations(new Range(startLineNumber, startTokenIndex + startToken.length + 1, endLineNumber, endTokenIndex + 1), startToken, endToken);\n        }\n        else {\n            ops = BlockCommentCommand._createAddBlockCommentOperations(selection, startToken, endToken, this._insertSpace);\n            this._usedEndToken = ops.length === 1 ? endToken : null;\n        }\n        for (const op of ops) {\n            builder.addTrackedEditOperation(op.range, op.text);\n        }\n    }\n    static _createRemoveBlockCommentOperations(r, startToken, endToken) {\n        const res = [];\n        if (!Range.isEmpty(r)) {\n            // Remove block comment start\n            res.push(EditOperation.delete(new Range(r.startLineNumber, r.startColumn - startToken.length, r.startLineNumber, r.startColumn)));\n            // Remove block comment end\n            res.push(EditOperation.delete(new Range(r.endLineNumber, r.endColumn, r.endLineNumber, r.endColumn + endToken.length)));\n        }\n        else {\n            // Remove both continuously\n            res.push(EditOperation.delete(new Range(r.startLineNumber, r.startColumn - startToken.length, r.endLineNumber, r.endColumn + endToken.length)));\n        }\n        return res;\n    }\n    static _createAddBlockCommentOperations(r, startToken, endToken, insertSpace) {\n        const res = [];\n        if (!Range.isEmpty(r)) {\n            // Insert block comment start\n            res.push(EditOperation.insert(new Position(r.startLineNumber, r.startColumn), startToken + (insertSpace ? ' ' : '')));\n            // Insert block comment end\n            res.push(EditOperation.insert(new Position(r.endLineNumber, r.endColumn), (insertSpace ? ' ' : '') + endToken));\n        }\n        else {\n            // Insert both continuously\n            res.push(EditOperation.replace(new Range(r.startLineNumber, r.startColumn, r.endLineNumber, r.endColumn), startToken + '  ' + endToken));\n        }\n        return res;\n    }\n    getEditOperations(model, builder) {\n        const startLineNumber = this._selection.startLineNumber;\n        const startColumn = this._selection.startColumn;\n        model.tokenization.tokenizeIfCheap(startLineNumber);\n        const languageId = model.getLanguageIdAtPosition(startLineNumber, startColumn);\n        const config = this.languageConfigurationService.getLanguageConfiguration(languageId).comments;\n        if (!config || !config.blockCommentStartToken || !config.blockCommentEndToken) {\n            // Mode does not support block comments\n            return;\n        }\n        this._createOperationsForBlockComment(this._selection, config.blockCommentStartToken, config.blockCommentEndToken, this._insertSpace, model, builder);\n    }\n    computeCursorState(model, helper) {\n        const inverseEditOperations = helper.getInverseEditOperations();\n        if (inverseEditOperations.length === 2) {\n            const startTokenEditOperation = inverseEditOperations[0];\n            const endTokenEditOperation = inverseEditOperations[1];\n            return new Selection(startTokenEditOperation.range.endLineNumber, startTokenEditOperation.range.endColumn, endTokenEditOperation.range.startLineNumber, endTokenEditOperation.range.startColumn);\n        }\n        else {\n            const srcRange = inverseEditOperations[0].range;\n            const deltaColumn = this._usedEndToken ? -this._usedEndToken.length - 1 : 0; // minus 1 space before endToken\n            return new Selection(srcRange.endLineNumber, srcRange.endColumn + deltaColumn, srcRange.endLineNumber, srcRange.endColumn + deltaColumn);\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as strings from '../../../../base/common/strings.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { BlockCommentCommand } from './blockCommentCommand.js';\nexport class LineCommentCommand {\n    constructor(languageConfigurationService, selection, indentSize, type, insertSpace, ignoreEmptyLines, ignoreFirstLine) {\n        this.languageConfigurationService = languageConfigurationService;\n        this._selection = selection;\n        this._indentSize = indentSize;\n        this._type = type;\n        this._insertSpace = insertSpace;\n        this._selectionId = null;\n        this._deltaColumn = 0;\n        this._moveEndPositionDown = false;\n        this._ignoreEmptyLines = ignoreEmptyLines;\n        this._ignoreFirstLine = ignoreFirstLine || false;\n    }\n    /**\n     * Do an initial pass over the lines and gather info about the line comment string.\n     * Returns null if any of the lines doesn't support a line comment string.\n     */\n    static _gatherPreflightCommentStrings(model, startLineNumber, endLineNumber, languageConfigurationService) {\n        model.tokenization.tokenizeIfCheap(startLineNumber);\n        const languageId = model.getLanguageIdAtPosition(startLineNumber, 1);\n        const config = languageConfigurationService.getLanguageConfiguration(languageId).comments;\n        const commentStr = (config ? config.lineCommentToken : null);\n        if (!commentStr) {\n            // Mode does not support line comments\n            return null;\n        }\n        const lines = [];\n        for (let i = 0, lineCount = endLineNumber - startLineNumber + 1; i < lineCount; i++) {\n            lines[i] = {\n                ignore: false,\n                commentStr: commentStr,\n                commentStrOffset: 0,\n                commentStrLength: commentStr.length\n            };\n        }\n        return lines;\n    }\n    /**\n     * Analyze lines and decide which lines are relevant and what the toggle should do.\n     * Also, build up several offsets and lengths useful in the generation of editor operations.\n     */\n    static _analyzeLines(type, insertSpace, model, lines, startLineNumber, ignoreEmptyLines, ignoreFirstLine, languageConfigurationService) {\n        let onlyWhitespaceLines = true;\n        let shouldRemoveComments;\n        if (type === 0 /* Type.Toggle */) {\n            shouldRemoveComments = true;\n        }\n        else if (type === 1 /* Type.ForceAdd */) {\n            shouldRemoveComments = false;\n        }\n        else {\n            shouldRemoveComments = true;\n        }\n        for (let i = 0, lineCount = lines.length; i < lineCount; i++) {\n            const lineData = lines[i];\n            const lineNumber = startLineNumber + i;\n            if (lineNumber === startLineNumber && ignoreFirstLine) {\n                // first line ignored\n                lineData.ignore = true;\n                continue;\n            }\n            const lineContent = model.getLineContent(lineNumber);\n            const lineContentStartOffset = strings.firstNonWhitespaceIndex(lineContent);\n            if (lineContentStartOffset === -1) {\n                // Empty or whitespace only line\n                lineData.ignore = ignoreEmptyLines;\n                lineData.commentStrOffset = lineContent.length;\n                continue;\n            }\n            onlyWhitespaceLines = false;\n            lineData.ignore = false;\n            lineData.commentStrOffset = lineContentStartOffset;\n            if (shouldRemoveComments && !BlockCommentCommand._haystackHasNeedleAtOffset(lineContent, lineData.commentStr, lineContentStartOffset)) {\n                if (type === 0 /* Type.Toggle */) {\n                    // Every line so far has been a line comment, but this one is not\n                    shouldRemoveComments = false;\n                }\n                else if (type === 1 /* Type.ForceAdd */) {\n                    // Will not happen\n                }\n                else {\n                    lineData.ignore = true;\n                }\n            }\n            if (shouldRemoveComments && insertSpace) {\n                // Remove a following space if present\n                const commentStrEndOffset = lineContentStartOffset + lineData.commentStrLength;\n                if (commentStrEndOffset < lineContent.length && lineContent.charCodeAt(commentStrEndOffset) === 32 /* CharCode.Space */) {\n                    lineData.commentStrLength += 1;\n                }\n            }\n        }\n        if (type === 0 /* Type.Toggle */ && onlyWhitespaceLines) {\n            // For only whitespace lines, we insert comments\n            shouldRemoveComments = false;\n            // Also, no longer ignore them\n            for (let i = 0, lineCount = lines.length; i < lineCount; i++) {\n                lines[i].ignore = false;\n            }\n        }\n        return {\n            supported: true,\n            shouldRemoveComments: shouldRemoveComments,\n            lines: lines\n        };\n    }\n    /**\n     * Analyze all lines and decide exactly what to do => not supported | insert line comments | remove line comments\n     */\n    static _gatherPreflightData(type, insertSpace, model, startLineNumber, endLineNumber, ignoreEmptyLines, ignoreFirstLine, languageConfigurationService) {\n        const lines = LineCommentCommand._gatherPreflightCommentStrings(model, startLineNumber, endLineNumber, languageConfigurationService);\n        if (lines === null) {\n            return {\n                supported: false\n            };\n        }\n        return LineCommentCommand._analyzeLines(type, insertSpace, model, lines, startLineNumber, ignoreEmptyLines, ignoreFirstLine, languageConfigurationService);\n    }\n    /**\n     * Given a successful analysis, execute either insert line comments, either remove line comments\n     */\n    _executeLineComments(model, builder, data, s) {\n        let ops;\n        if (data.shouldRemoveComments) {\n            ops = LineCommentCommand._createRemoveLineCommentsOperations(data.lines, s.startLineNumber);\n        }\n        else {\n            LineCommentCommand._normalizeInsertionPoint(model, data.lines, s.startLineNumber, this._indentSize);\n            ops = this._createAddLineCommentsOperations(data.lines, s.startLineNumber);\n        }\n        const cursorPosition = new Position(s.positionLineNumber, s.positionColumn);\n        for (let i = 0, len = ops.length; i < len; i++) {\n            builder.addEditOperation(ops[i].range, ops[i].text);\n            if (Range.isEmpty(ops[i].range) && Range.getStartPosition(ops[i].range).equals(cursorPosition)) {\n                const lineContent = model.getLineContent(cursorPosition.lineNumber);\n                if (lineContent.length + 1 === cursorPosition.column) {\n                    this._deltaColumn = (ops[i].text || '').length;\n                }\n            }\n        }\n        this._selectionId = builder.trackSelection(s);\n    }\n    _attemptRemoveBlockComment(model, s, startToken, endToken) {\n        let startLineNumber = s.startLineNumber;\n        let endLineNumber = s.endLineNumber;\n        const startTokenAllowedBeforeColumn = endToken.length + Math.max(model.getLineFirstNonWhitespaceColumn(s.startLineNumber), s.startColumn);\n        let startTokenIndex = model.getLineContent(startLineNumber).lastIndexOf(startToken, startTokenAllowedBeforeColumn - 1);\n        let endTokenIndex = model.getLineContent(endLineNumber).indexOf(endToken, s.endColumn - 1 - startToken.length);\n        if (startTokenIndex !== -1 && endTokenIndex === -1) {\n            endTokenIndex = model.getLineContent(startLineNumber).indexOf(endToken, startTokenIndex + startToken.length);\n            endLineNumber = startLineNumber;\n        }\n        if (startTokenIndex === -1 && endTokenIndex !== -1) {\n            startTokenIndex = model.getLineContent(endLineNumber).lastIndexOf(startToken, endTokenIndex);\n            startLineNumber = endLineNumber;\n        }\n        if (s.isEmpty() && (startTokenIndex === -1 || endTokenIndex === -1)) {\n            startTokenIndex = model.getLineContent(startLineNumber).indexOf(startToken);\n            if (startTokenIndex !== -1) {\n                endTokenIndex = model.getLineContent(startLineNumber).indexOf(endToken, startTokenIndex + startToken.length);\n            }\n        }\n        // We have to adjust to possible inner white space.\n        // For Space after startToken, add Space to startToken - range math will work out.\n        if (startTokenIndex !== -1 && model.getLineContent(startLineNumber).charCodeAt(startTokenIndex + startToken.length) === 32 /* CharCode.Space */) {\n            startToken += ' ';\n        }\n        // For Space before endToken, add Space before endToken and shift index one left.\n        if (endTokenIndex !== -1 && model.getLineContent(endLineNumber).charCodeAt(endTokenIndex - 1) === 32 /* CharCode.Space */) {\n            endToken = ' ' + endToken;\n            endTokenIndex -= 1;\n        }\n        if (startTokenIndex !== -1 && endTokenIndex !== -1) {\n            return BlockCommentCommand._createRemoveBlockCommentOperations(new Range(startLineNumber, startTokenIndex + startToken.length + 1, endLineNumber, endTokenIndex + 1), startToken, endToken);\n        }\n        return null;\n    }\n    /**\n     * Given an unsuccessful analysis, delegate to the block comment command\n     */\n    _executeBlockComment(model, builder, s) {\n        model.tokenization.tokenizeIfCheap(s.startLineNumber);\n        const languageId = model.getLanguageIdAtPosition(s.startLineNumber, 1);\n        const config = this.languageConfigurationService.getLanguageConfiguration(languageId).comments;\n        if (!config || !config.blockCommentStartToken || !config.blockCommentEndToken) {\n            // Mode does not support block comments\n            return;\n        }\n        const startToken = config.blockCommentStartToken;\n        const endToken = config.blockCommentEndToken;\n        let ops = this._attemptRemoveBlockComment(model, s, startToken, endToken);\n        if (!ops) {\n            if (s.isEmpty()) {\n                const lineContent = model.getLineContent(s.startLineNumber);\n                let firstNonWhitespaceIndex = strings.firstNonWhitespaceIndex(lineContent);\n                if (firstNonWhitespaceIndex === -1) {\n                    // Line is empty or contains only whitespace\n                    firstNonWhitespaceIndex = lineContent.length;\n                }\n                ops = BlockCommentCommand._createAddBlockCommentOperations(new Range(s.startLineNumber, firstNonWhitespaceIndex + 1, s.startLineNumber, lineContent.length + 1), startToken, endToken, this._insertSpace);\n            }\n            else {\n                ops = BlockCommentCommand._createAddBlockCommentOperations(new Range(s.startLineNumber, model.getLineFirstNonWhitespaceColumn(s.startLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), startToken, endToken, this._insertSpace);\n            }\n            if (ops.length === 1) {\n                // Leave cursor after token and Space\n                this._deltaColumn = startToken.length + 1;\n            }\n        }\n        this._selectionId = builder.trackSelection(s);\n        for (const op of ops) {\n            builder.addEditOperation(op.range, op.text);\n        }\n    }\n    getEditOperations(model, builder) {\n        let s = this._selection;\n        this._moveEndPositionDown = false;\n        if (s.startLineNumber === s.endLineNumber && this._ignoreFirstLine) {\n            builder.addEditOperation(new Range(s.startLineNumber, model.getLineMaxColumn(s.startLineNumber), s.startLineNumber + 1, 1), s.startLineNumber === model.getLineCount() ? '' : '\\n');\n            this._selectionId = builder.trackSelection(s);\n            return;\n        }\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\n            this._moveEndPositionDown = true;\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\n        }\n        const data = LineCommentCommand._gatherPreflightData(this._type, this._insertSpace, model, s.startLineNumber, s.endLineNumber, this._ignoreEmptyLines, this._ignoreFirstLine, this.languageConfigurationService);\n        if (data.supported) {\n            return this._executeLineComments(model, builder, data, s);\n        }\n        return this._executeBlockComment(model, builder, s);\n    }\n    computeCursorState(model, helper) {\n        let result = helper.getTrackedSelection(this._selectionId);\n        if (this._moveEndPositionDown) {\n            result = result.setEndPosition(result.endLineNumber + 1, 1);\n        }\n        return new Selection(result.selectionStartLineNumber, result.selectionStartColumn + this._deltaColumn, result.positionLineNumber, result.positionColumn + this._deltaColumn);\n    }\n    /**\n     * Generate edit operations in the remove line comment case\n     */\n    static _createRemoveLineCommentsOperations(lines, startLineNumber) {\n        const res = [];\n        for (let i = 0, len = lines.length; i < len; i++) {\n            const lineData = lines[i];\n            if (lineData.ignore) {\n                continue;\n            }\n            res.push(EditOperation.delete(new Range(startLineNumber + i, lineData.commentStrOffset + 1, startLineNumber + i, lineData.commentStrOffset + lineData.commentStrLength + 1)));\n        }\n        return res;\n    }\n    /**\n     * Generate edit operations in the add line comment case\n     */\n    _createAddLineCommentsOperations(lines, startLineNumber) {\n        const res = [];\n        const afterCommentStr = this._insertSpace ? ' ' : '';\n        for (let i = 0, len = lines.length; i < len; i++) {\n            const lineData = lines[i];\n            if (lineData.ignore) {\n                continue;\n            }\n            res.push(EditOperation.insert(new Position(startLineNumber + i, lineData.commentStrOffset + 1), lineData.commentStr + afterCommentStr));\n        }\n        return res;\n    }\n    static nextVisibleColumn(currentVisibleColumn, indentSize, isTab, columnSize) {\n        if (isTab) {\n            return currentVisibleColumn + (indentSize - (currentVisibleColumn % indentSize));\n        }\n        return currentVisibleColumn + columnSize;\n    }\n    /**\n     * Adjust insertion points to have them vertically aligned in the add line comment case\n     */\n    static _normalizeInsertionPoint(model, lines, startLineNumber, indentSize) {\n        let minVisibleColumn = 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */;\n        let j;\n        let lenJ;\n        for (let i = 0, len = lines.length; i < len; i++) {\n            if (lines[i].ignore) {\n                continue;\n            }\n            const lineContent = model.getLineContent(startLineNumber + i);\n            let currentVisibleColumn = 0;\n            for (let j = 0, lenJ = lines[i].commentStrOffset; currentVisibleColumn < minVisibleColumn && j < lenJ; j++) {\n                currentVisibleColumn = LineCommentCommand.nextVisibleColumn(currentVisibleColumn, indentSize, lineContent.charCodeAt(j) === 9 /* CharCode.Tab */, 1);\n            }\n            if (currentVisibleColumn < minVisibleColumn) {\n                minVisibleColumn = currentVisibleColumn;\n            }\n        }\n        minVisibleColumn = Math.floor(minVisibleColumn / indentSize) * indentSize;\n        for (let i = 0, len = lines.length; i < len; i++) {\n            if (lines[i].ignore) {\n                continue;\n            }\n            const lineContent = model.getLineContent(startLineNumber + i);\n            let currentVisibleColumn = 0;\n            for (j = 0, lenJ = lines[i].commentStrOffset; currentVisibleColumn < minVisibleColumn && j < lenJ; j++) {\n                currentVisibleColumn = LineCommentCommand.nextVisibleColumn(currentVisibleColumn, indentSize, lineContent.charCodeAt(j) === 9 /* CharCode.Tab */, 1);\n            }\n            if (currentVisibleColumn > minVisibleColumn) {\n                lines[i].commentStrOffset = j - 1;\n            }\n            else {\n                lines[i].commentStrOffset = j;\n            }\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { BlockCommentCommand } from './blockCommentCommand.js';\nimport { LineCommentCommand } from './lineCommentCommand.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nclass CommentLineAction extends EditorAction {\n    constructor(type, opts) {\n        super(opts);\n        this._type = type;\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        if (!editor.hasModel()) {\n            return;\n        }\n        const model = editor.getModel();\n        const commands = [];\n        const modelOptions = model.getOptions();\n        const commentsOptions = editor.getOption(23 /* EditorOption.comments */);\n        const selections = editor.getSelections().map((selection, index) => ({ selection, index, ignoreFirstLine: false }));\n        selections.sort((a, b) => Range.compareRangesUsingStarts(a.selection, b.selection));\n        // Remove selections that would result in copying the same line\n        let prev = selections[0];\n        for (let i = 1; i < selections.length; i++) {\n            const curr = selections[i];\n            if (prev.selection.endLineNumber === curr.selection.startLineNumber) {\n                // these two selections would copy the same line\n                if (prev.index < curr.index) {\n                    // prev wins\n                    curr.ignoreFirstLine = true;\n                }\n                else {\n                    // curr wins\n                    prev.ignoreFirstLine = true;\n                    prev = curr;\n                }\n            }\n        }\n        for (const selection of selections) {\n            commands.push(new LineCommentCommand(languageConfigurationService, selection.selection, modelOptions.indentSize, this._type, commentsOptions.insertSpace, commentsOptions.ignoreEmptyLines, selection.ignoreFirstLine));\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nclass ToggleCommentLineAction extends CommentLineAction {\n    constructor() {\n        super(0 /* Type.Toggle */, {\n            id: 'editor.action.commentLine',\n            label: nls.localize('comment.line', \"Toggle Line Comment\"),\n            alias: 'Toggle Line Comment',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 90 /* KeyCode.Slash */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarEditMenu,\n                group: '5_insert',\n                title: nls.localize({ key: 'miToggleLineComment', comment: ['&& denotes a mnemonic'] }, \"&&Toggle Line Comment\"),\n                order: 1\n            }\n        });\n    }\n}\nclass AddLineCommentAction extends CommentLineAction {\n    constructor() {\n        super(1 /* Type.ForceAdd */, {\n            id: 'editor.action.addCommentLine',\n            label: nls.localize('comment.line.add', \"Add Line Comment\"),\n            alias: 'Add Line Comment',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 33 /* KeyCode.KeyC */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nclass RemoveLineCommentAction extends CommentLineAction {\n    constructor() {\n        super(2 /* Type.ForceRemove */, {\n            id: 'editor.action.removeCommentLine',\n            label: nls.localize('comment.line.remove', \"Remove Line Comment\"),\n            alias: 'Remove Line Comment',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 51 /* KeyCode.KeyU */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nclass BlockCommentAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.blockComment',\n            label: nls.localize('comment.block', \"Toggle Block Comment\"),\n            alias: 'Toggle Block Comment',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 31 /* KeyCode.KeyA */,\n                linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 31 /* KeyCode.KeyA */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarEditMenu,\n                group: '5_insert',\n                title: nls.localize({ key: 'miToggleBlockComment', comment: ['&& denotes a mnemonic'] }, \"Toggle &&Block Comment\"),\n                order: 2\n            }\n        });\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        if (!editor.hasModel()) {\n            return;\n        }\n        const commentsOptions = editor.getOption(23 /* EditorOption.comments */);\n        const commands = [];\n        const selections = editor.getSelections();\n        for (const selection of selections) {\n            commands.push(new BlockCommentCommand(selection, commentsOptions.insertSpace, languageConfigurationService));\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nregisterEditorAction(ToggleCommentLineAction);\nregisterEditorAction(AddLineCommentAction);\nregisterEditorAction(RemoveLineCommentAction);\nregisterEditorAction(BlockCommentAction);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ContextMenuController_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ActionViewItem } from '../../../../base/browser/ui/actionbar/actionViewItems.js';\nimport { Separator, SubmenuAction } from '../../../../base/common/actions.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { isIOS } from '../../../../base/common/platform.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport * as nls from '../../../../nls.js';\nimport { IMenuService, SubmenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService, IContextViewService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IWorkspaceContextService, isStandaloneEditorWorkspace } from '../../../../platform/workspace/common/workspace.js';\nlet ContextMenuController = class ContextMenuController {\n    static { ContextMenuController_1 = this; }\n    static { this.ID = 'editor.contrib.contextmenu'; }\n    static get(editor) {\n        return editor.getContribution(ContextMenuController_1.ID);\n    }\n    constructor(editor, _contextMenuService, _contextViewService, _contextKeyService, _keybindingService, _menuService, _configurationService, _workspaceContextService) {\n        this._contextMenuService = _contextMenuService;\n        this._contextViewService = _contextViewService;\n        this._contextKeyService = _contextKeyService;\n        this._keybindingService = _keybindingService;\n        this._menuService = _menuService;\n        this._configurationService = _configurationService;\n        this._workspaceContextService = _workspaceContextService;\n        this._toDispose = new DisposableStore();\n        this._contextMenuIsBeingShownCount = 0;\n        this._editor = editor;\n        this._toDispose.add(this._editor.onContextMenu((e) => this._onContextMenu(e)));\n        this._toDispose.add(this._editor.onMouseWheel((e) => {\n            if (this._contextMenuIsBeingShownCount > 0) {\n                const view = this._contextViewService.getContextViewElement();\n                const target = e.srcElement;\n                // Event triggers on shadow root host first\n                // Check if the context view is under this host before hiding it #103169\n                if (!(target.shadowRoot && dom.getShadowRoot(view) === target.shadowRoot)) {\n                    this._contextViewService.hideContextView();\n                }\n            }\n        }));\n        this._toDispose.add(this._editor.onKeyDown((e) => {\n            if (!this._editor.getOption(24 /* EditorOption.contextmenu */)) {\n                return; // Context menu is turned off through configuration\n            }\n            if (e.keyCode === 58 /* KeyCode.ContextMenu */) {\n                // Chrome is funny like that\n                e.preventDefault();\n                e.stopPropagation();\n                this.showContextMenu();\n            }\n        }));\n    }\n    _onContextMenu(e) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (!this._editor.getOption(24 /* EditorOption.contextmenu */)) {\n            this._editor.focus();\n            // Ensure the cursor is at the position of the mouse click\n            if (e.target.position && !this._editor.getSelection().containsPosition(e.target.position)) {\n                this._editor.setPosition(e.target.position);\n            }\n            return; // Context menu is turned off through configuration\n        }\n        if (e.target.type === 12 /* MouseTargetType.OVERLAY_WIDGET */) {\n            return; // allow native menu on widgets to support right click on input field for example in find\n        }\n        if (e.target.type === 6 /* MouseTargetType.CONTENT_TEXT */ && e.target.detail.injectedText) {\n            return; // allow native menu on injected text\n        }\n        e.event.preventDefault();\n        e.event.stopPropagation();\n        if (e.target.type === 11 /* MouseTargetType.SCROLLBAR */) {\n            return this._showScrollbarContextMenu(e.event);\n        }\n        if (e.target.type !== 6 /* MouseTargetType.CONTENT_TEXT */ && e.target.type !== 7 /* MouseTargetType.CONTENT_EMPTY */ && e.target.type !== 1 /* MouseTargetType.TEXTAREA */) {\n            return; // only support mouse click into text or native context menu key for now\n        }\n        // Ensure the editor gets focus if it hasn't, so the right events are being sent to other contributions\n        this._editor.focus();\n        // Ensure the cursor is at the position of the mouse click\n        if (e.target.position) {\n            let hasSelectionAtPosition = false;\n            for (const selection of this._editor.getSelections()) {\n                if (selection.containsPosition(e.target.position)) {\n                    hasSelectionAtPosition = true;\n                    break;\n                }\n            }\n            if (!hasSelectionAtPosition) {\n                this._editor.setPosition(e.target.position);\n            }\n        }\n        // Unless the user triggerd the context menu through Shift+F10, use the mouse position as menu position\n        let anchor = null;\n        if (e.target.type !== 1 /* MouseTargetType.TEXTAREA */) {\n            anchor = e.event;\n        }\n        // Show the context menu\n        this.showContextMenu(anchor);\n    }\n    showContextMenu(anchor) {\n        if (!this._editor.getOption(24 /* EditorOption.contextmenu */)) {\n            return; // Context menu is turned off through configuration\n        }\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        // Find actions available for menu\n        const menuActions = this._getMenuActions(this._editor.getModel(), this._editor.contextMenuId);\n        // Show menu if we have actions to show\n        if (menuActions.length > 0) {\n            this._doShowContextMenu(menuActions, anchor);\n        }\n    }\n    _getMenuActions(model, menuId) {\n        const result = [];\n        // get menu groups\n        const groups = this._menuService.getMenuActions(menuId, this._contextKeyService, { arg: model.uri });\n        // translate them into other actions\n        for (const group of groups) {\n            const [, actions] = group;\n            let addedItems = 0;\n            for (const action of actions) {\n                if (action instanceof SubmenuItemAction) {\n                    const subActions = this._getMenuActions(model, action.item.submenu);\n                    if (subActions.length > 0) {\n                        result.push(new SubmenuAction(action.id, action.label, subActions));\n                        addedItems++;\n                    }\n                }\n                else {\n                    result.push(action);\n                    addedItems++;\n                }\n            }\n            if (addedItems) {\n                result.push(new Separator());\n            }\n        }\n        if (result.length) {\n            result.pop(); // remove last separator\n        }\n        return result;\n    }\n    _doShowContextMenu(actions, event = null) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        // Disable hover\n        const oldHoverSetting = this._editor.getOption(60 /* EditorOption.hover */);\n        this._editor.updateOptions({\n            hover: {\n                enabled: false\n            }\n        });\n        let anchor = event;\n        if (!anchor) {\n            // Ensure selection is visible\n            this._editor.revealPosition(this._editor.getPosition(), 1 /* ScrollType.Immediate */);\n            this._editor.render();\n            const cursorCoords = this._editor.getScrolledVisiblePosition(this._editor.getPosition());\n            // Translate to absolute editor position\n            const editorCoords = dom.getDomNodePagePosition(this._editor.getDomNode());\n            const posx = editorCoords.left + cursorCoords.left;\n            const posy = editorCoords.top + cursorCoords.top + cursorCoords.height;\n            anchor = { x: posx, y: posy };\n        }\n        const useShadowDOM = this._editor.getOption(128 /* EditorOption.useShadowDOM */) && !isIOS; // Do not use shadow dom on IOS #122035\n        // Show menu\n        this._contextMenuIsBeingShownCount++;\n        this._contextMenuService.showContextMenu({\n            domForShadowRoot: useShadowDOM ? this._editor.getOverflowWidgetsDomNode() ?? this._editor.getDomNode() : undefined,\n            getAnchor: () => anchor,\n            getActions: () => actions,\n            getActionViewItem: (action) => {\n                const keybinding = this._keybindingFor(action);\n                if (keybinding) {\n                    return new ActionViewItem(action, action, { label: true, keybinding: keybinding.getLabel(), isMenu: true });\n                }\n                const customActionViewItem = action;\n                if (typeof customActionViewItem.getActionViewItem === 'function') {\n                    return customActionViewItem.getActionViewItem();\n                }\n                return new ActionViewItem(action, action, { icon: true, label: true, isMenu: true });\n            },\n            getKeyBinding: (action) => {\n                return this._keybindingFor(action);\n            },\n            onHide: (wasCancelled) => {\n                this._contextMenuIsBeingShownCount--;\n                this._editor.updateOptions({\n                    hover: oldHoverSetting\n                });\n            }\n        });\n    }\n    _showScrollbarContextMenu(anchor) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (isStandaloneEditorWorkspace(this._workspaceContextService.getWorkspace())) {\n            // can't update the configuration properly in the standalone editor\n            return;\n        }\n        const minimapOptions = this._editor.getOption(73 /* EditorOption.minimap */);\n        let lastId = 0;\n        const createAction = (opts) => {\n            return {\n                id: `menu-action-${++lastId}`,\n                label: opts.label,\n                tooltip: '',\n                class: undefined,\n                enabled: (typeof opts.enabled === 'undefined' ? true : opts.enabled),\n                checked: opts.checked,\n                run: opts.run\n            };\n        };\n        const createSubmenuAction = (label, actions) => {\n            return new SubmenuAction(`menu-action-${++lastId}`, label, actions, undefined);\n        };\n        const createEnumAction = (label, enabled, configName, configuredValue, options) => {\n            if (!enabled) {\n                return createAction({ label, enabled, run: () => { } });\n            }\n            const createRunner = (value) => {\n                return () => {\n                    this._configurationService.updateValue(configName, value);\n                };\n            };\n            const actions = [];\n            for (const option of options) {\n                actions.push(createAction({\n                    label: option.label,\n                    checked: configuredValue === option.value,\n                    run: createRunner(option.value)\n                }));\n            }\n            return createSubmenuAction(label, actions);\n        };\n        const actions = [];\n        actions.push(createAction({\n            label: nls.localize('context.minimap.minimap', \"Minimap\"),\n            checked: minimapOptions.enabled,\n            run: () => {\n                this._configurationService.updateValue(`editor.minimap.enabled`, !minimapOptions.enabled);\n            }\n        }));\n        actions.push(new Separator());\n        actions.push(createAction({\n            label: nls.localize('context.minimap.renderCharacters', \"Render Characters\"),\n            enabled: minimapOptions.enabled,\n            checked: minimapOptions.renderCharacters,\n            run: () => {\n                this._configurationService.updateValue(`editor.minimap.renderCharacters`, !minimapOptions.renderCharacters);\n            }\n        }));\n        actions.push(createEnumAction(nls.localize('context.minimap.size', \"Vertical size\"), minimapOptions.enabled, 'editor.minimap.size', minimapOptions.size, [{\n                label: nls.localize('context.minimap.size.proportional', \"Proportional\"),\n                value: 'proportional'\n            }, {\n                label: nls.localize('context.minimap.size.fill', \"Fill\"),\n                value: 'fill'\n            }, {\n                label: nls.localize('context.minimap.size.fit', \"Fit\"),\n                value: 'fit'\n            }]));\n        actions.push(createEnumAction(nls.localize('context.minimap.slider', \"Slider\"), minimapOptions.enabled, 'editor.minimap.showSlider', minimapOptions.showSlider, [{\n                label: nls.localize('context.minimap.slider.mouseover', \"Mouse Over\"),\n                value: 'mouseover'\n            }, {\n                label: nls.localize('context.minimap.slider.always', \"Always\"),\n                value: 'always'\n            }]));\n        const useShadowDOM = this._editor.getOption(128 /* EditorOption.useShadowDOM */) && !isIOS; // Do not use shadow dom on IOS #122035\n        this._contextMenuIsBeingShownCount++;\n        this._contextMenuService.showContextMenu({\n            domForShadowRoot: useShadowDOM ? this._editor.getDomNode() : undefined,\n            getAnchor: () => anchor,\n            getActions: () => actions,\n            onHide: (wasCancelled) => {\n                this._contextMenuIsBeingShownCount--;\n                this._editor.focus();\n            }\n        });\n    }\n    _keybindingFor(action) {\n        return this._keybindingService.lookupKeybinding(action.id);\n    }\n    dispose() {\n        if (this._contextMenuIsBeingShownCount > 0) {\n            this._contextViewService.hideContextView();\n        }\n        this._toDispose.dispose();\n    }\n};\nContextMenuController = ContextMenuController_1 = __decorate([\n    __param(1, IContextMenuService),\n    __param(2, IContextViewService),\n    __param(3, IContextKeyService),\n    __param(4, IKeybindingService),\n    __param(5, IMenuService),\n    __param(6, IConfigurationService),\n    __param(7, IWorkspaceContextService)\n], ContextMenuController);\nexport { ContextMenuController };\nclass ShowContextMenu extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.showContextMenu',\n            label: nls.localize('action.showContextMenu.label', \"Show Editor Context Menu\"),\n            alias: 'Show Editor Context Menu',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 1024 /* KeyMod.Shift */ | 68 /* KeyCode.F10 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        ContextMenuController.get(editor)?.showContextMenu();\n    }\n}\nregisterEditorContribution(ContextMenuController.ID, ContextMenuController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(ShowContextMenu);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport * as nls from '../../../../nls.js';\nclass CursorState {\n    constructor(selections) {\n        this.selections = selections;\n    }\n    equals(other) {\n        const thisLen = this.selections.length;\n        const otherLen = other.selections.length;\n        if (thisLen !== otherLen) {\n            return false;\n        }\n        for (let i = 0; i < thisLen; i++) {\n            if (!this.selections[i].equalsSelection(other.selections[i])) {\n                return false;\n            }\n        }\n        return true;\n    }\n}\nclass StackElement {\n    constructor(cursorState, scrollTop, scrollLeft) {\n        this.cursorState = cursorState;\n        this.scrollTop = scrollTop;\n        this.scrollLeft = scrollLeft;\n    }\n}\nexport class CursorUndoRedoController extends Disposable {\n    static { this.ID = 'editor.contrib.cursorUndoRedoController'; }\n    static get(editor) {\n        return editor.getContribution(CursorUndoRedoController.ID);\n    }\n    constructor(editor) {\n        super();\n        this._editor = editor;\n        this._isCursorUndoRedo = false;\n        this._undoStack = [];\n        this._redoStack = [];\n        this._register(editor.onDidChangeModel((e) => {\n            this._undoStack = [];\n            this._redoStack = [];\n        }));\n        this._register(editor.onDidChangeModelContent((e) => {\n            this._undoStack = [];\n            this._redoStack = [];\n        }));\n        this._register(editor.onDidChangeCursorSelection((e) => {\n            if (this._isCursorUndoRedo) {\n                return;\n            }\n            if (!e.oldSelections) {\n                return;\n            }\n            if (e.oldModelVersionId !== e.modelVersionId) {\n                return;\n            }\n            const prevState = new CursorState(e.oldSelections);\n            const isEqualToLastUndoStack = (this._undoStack.length > 0 && this._undoStack[this._undoStack.length - 1].cursorState.equals(prevState));\n            if (!isEqualToLastUndoStack) {\n                this._undoStack.push(new StackElement(prevState, editor.getScrollTop(), editor.getScrollLeft()));\n                this._redoStack = [];\n                if (this._undoStack.length > 50) {\n                    // keep the cursor undo stack bounded\n                    this._undoStack.shift();\n                }\n            }\n        }));\n    }\n    cursorUndo() {\n        if (!this._editor.hasModel() || this._undoStack.length === 0) {\n            return;\n        }\n        this._redoStack.push(new StackElement(new CursorState(this._editor.getSelections()), this._editor.getScrollTop(), this._editor.getScrollLeft()));\n        this._applyState(this._undoStack.pop());\n    }\n    cursorRedo() {\n        if (!this._editor.hasModel() || this._redoStack.length === 0) {\n            return;\n        }\n        this._undoStack.push(new StackElement(new CursorState(this._editor.getSelections()), this._editor.getScrollTop(), this._editor.getScrollLeft()));\n        this._applyState(this._redoStack.pop());\n    }\n    _applyState(stackElement) {\n        this._isCursorUndoRedo = true;\n        this._editor.setSelections(stackElement.cursorState.selections);\n        this._editor.setScrollPosition({\n            scrollTop: stackElement.scrollTop,\n            scrollLeft: stackElement.scrollLeft\n        });\n        this._isCursorUndoRedo = false;\n    }\n}\nexport class CursorUndo extends EditorAction {\n    constructor() {\n        super({\n            id: 'cursorUndo',\n            label: nls.localize('cursor.undo', \"Cursor Undo\"),\n            alias: 'Cursor Undo',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 51 /* KeyCode.KeyU */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        CursorUndoRedoController.get(editor)?.cursorUndo();\n    }\n}\nexport class CursorRedo extends EditorAction {\n    constructor() {\n        super({\n            id: 'cursorRedo',\n            label: nls.localize('cursor.redo', \"Cursor Redo\"),\n            alias: 'Cursor Redo',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor, args) {\n        CursorUndoRedoController.get(editor)?.cursorRedo();\n    }\n}\nregisterEditorContribution(CursorUndoRedoController.ID, CursorUndoRedoController, 0 /* EditorContributionInstantiation.Eager */); // eager because it needs to listen to record cursor state ASAP\nregisterEditorAction(CursorUndo);\nregisterEditorAction(CursorRedo);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nexport class DragAndDropCommand {\n    constructor(selection, targetPosition, copy) {\n        this.selection = selection;\n        this.targetPosition = targetPosition;\n        this.copy = copy;\n        this.targetSelection = null;\n    }\n    getEditOperations(model, builder) {\n        const text = model.getValueInRange(this.selection);\n        if (!this.copy) {\n            builder.addEditOperation(this.selection, null);\n        }\n        builder.addEditOperation(new Range(this.targetPosition.lineNumber, this.targetPosition.column, this.targetPosition.lineNumber, this.targetPosition.column), text);\n        if (this.selection.containsPosition(this.targetPosition) && !(this.copy && (this.selection.getEndPosition().equals(this.targetPosition) || this.selection.getStartPosition().equals(this.targetPosition)) // we allow users to paste content beside the selection\n        )) {\n            this.targetSelection = this.selection;\n            return;\n        }\n        if (this.copy) {\n            this.targetSelection = new Selection(this.targetPosition.lineNumber, this.targetPosition.column, this.selection.endLineNumber - this.selection.startLineNumber + this.targetPosition.lineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\n                this.targetPosition.column + this.selection.endColumn - this.selection.startColumn :\n                this.selection.endColumn);\n            return;\n        }\n        if (this.targetPosition.lineNumber > this.selection.endLineNumber) {\n            // Drag the selection downwards\n            this.targetSelection = new Selection(this.targetPosition.lineNumber - this.selection.endLineNumber + this.selection.startLineNumber, this.targetPosition.column, this.targetPosition.lineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\n                this.targetPosition.column + this.selection.endColumn - this.selection.startColumn :\n                this.selection.endColumn);\n            return;\n        }\n        if (this.targetPosition.lineNumber < this.selection.endLineNumber) {\n            // Drag the selection upwards\n            this.targetSelection = new Selection(this.targetPosition.lineNumber, this.targetPosition.column, this.targetPosition.lineNumber + this.selection.endLineNumber - this.selection.startLineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\n                this.targetPosition.column + this.selection.endColumn - this.selection.startColumn :\n                this.selection.endColumn);\n            return;\n        }\n        // The target position is at the same line as the selection's end position.\n        if (this.selection.endColumn <= this.targetPosition.column) {\n            // The target position is after the selection's end position\n            this.targetSelection = new Selection(this.targetPosition.lineNumber - this.selection.endLineNumber + this.selection.startLineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\n                this.targetPosition.column - this.selection.endColumn + this.selection.startColumn :\n                this.targetPosition.column - this.selection.endColumn + this.selection.startColumn, this.targetPosition.lineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\n                this.targetPosition.column :\n                this.selection.endColumn);\n        }\n        else {\n            // The target position is before the selection's end position. Since the selection doesn't contain the target position, the selection is one-line and target position is before this selection.\n            this.targetSelection = new Selection(this.targetPosition.lineNumber - this.selection.endLineNumber + this.selection.startLineNumber, this.targetPosition.column, this.targetPosition.lineNumber, this.targetPosition.column + this.selection.endColumn - this.selection.startColumn);\n        }\n    }\n    computeCursorState(model, helper) {\n        return this.targetSelection;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { isMacintosh } from '../../../../base/common/platform.js';\nimport './dnd.css';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { DragAndDropCommand } from './dragAndDropCommand.js';\nfunction hasTriggerModifier(e) {\n    if (isMacintosh) {\n        return e.altKey;\n    }\n    else {\n        return e.ctrlKey;\n    }\n}\nexport class DragAndDropController extends Disposable {\n    static { this.ID = 'editor.contrib.dragAndDrop'; }\n    static { this.TRIGGER_KEY_VALUE = isMacintosh ? 6 /* KeyCode.Alt */ : 5 /* KeyCode.Ctrl */; }\n    constructor(editor) {\n        super();\n        this._editor = editor;\n        this._dndDecorationIds = this._editor.createDecorationsCollection();\n        this._register(this._editor.onMouseDown((e) => this._onEditorMouseDown(e)));\n        this._register(this._editor.onMouseUp((e) => this._onEditorMouseUp(e)));\n        this._register(this._editor.onMouseDrag((e) => this._onEditorMouseDrag(e)));\n        this._register(this._editor.onMouseDrop((e) => this._onEditorMouseDrop(e)));\n        this._register(this._editor.onMouseDropCanceled(() => this._onEditorMouseDropCanceled()));\n        this._register(this._editor.onKeyDown((e) => this.onEditorKeyDown(e)));\n        this._register(this._editor.onKeyUp((e) => this.onEditorKeyUp(e)));\n        this._register(this._editor.onDidBlurEditorWidget(() => this.onEditorBlur()));\n        this._register(this._editor.onDidBlurEditorText(() => this.onEditorBlur()));\n        this._mouseDown = false;\n        this._modifierPressed = false;\n        this._dragSelection = null;\n    }\n    onEditorBlur() {\n        this._removeDecoration();\n        this._dragSelection = null;\n        this._mouseDown = false;\n        this._modifierPressed = false;\n    }\n    onEditorKeyDown(e) {\n        if (!this._editor.getOption(35 /* EditorOption.dragAndDrop */) || this._editor.getOption(22 /* EditorOption.columnSelection */)) {\n            return;\n        }\n        if (hasTriggerModifier(e)) {\n            this._modifierPressed = true;\n        }\n        if (this._mouseDown && hasTriggerModifier(e)) {\n            this._editor.updateOptions({\n                mouseStyle: 'copy'\n            });\n        }\n    }\n    onEditorKeyUp(e) {\n        if (!this._editor.getOption(35 /* EditorOption.dragAndDrop */) || this._editor.getOption(22 /* EditorOption.columnSelection */)) {\n            return;\n        }\n        if (hasTriggerModifier(e)) {\n            this._modifierPressed = false;\n        }\n        if (this._mouseDown && e.keyCode === DragAndDropController.TRIGGER_KEY_VALUE) {\n            this._editor.updateOptions({\n                mouseStyle: 'default'\n            });\n        }\n    }\n    _onEditorMouseDown(mouseEvent) {\n        this._mouseDown = true;\n    }\n    _onEditorMouseUp(mouseEvent) {\n        this._mouseDown = false;\n        // Whenever users release the mouse, the drag and drop operation should finish and the cursor should revert to text.\n        this._editor.updateOptions({\n            mouseStyle: 'text'\n        });\n    }\n    _onEditorMouseDrag(mouseEvent) {\n        const target = mouseEvent.target;\n        if (this._dragSelection === null) {\n            const selections = this._editor.getSelections() || [];\n            const possibleSelections = selections.filter(selection => target.position && selection.containsPosition(target.position));\n            if (possibleSelections.length === 1) {\n                this._dragSelection = possibleSelections[0];\n            }\n            else {\n                return;\n            }\n        }\n        if (hasTriggerModifier(mouseEvent.event)) {\n            this._editor.updateOptions({\n                mouseStyle: 'copy'\n            });\n        }\n        else {\n            this._editor.updateOptions({\n                mouseStyle: 'default'\n            });\n        }\n        if (target.position) {\n            if (this._dragSelection.containsPosition(target.position)) {\n                this._removeDecoration();\n            }\n            else {\n                this.showAt(target.position);\n            }\n        }\n    }\n    _onEditorMouseDropCanceled() {\n        this._editor.updateOptions({\n            mouseStyle: 'text'\n        });\n        this._removeDecoration();\n        this._dragSelection = null;\n        this._mouseDown = false;\n    }\n    _onEditorMouseDrop(mouseEvent) {\n        if (mouseEvent.target && (this._hitContent(mouseEvent.target) || this._hitMargin(mouseEvent.target)) && mouseEvent.target.position) {\n            const newCursorPosition = new Position(mouseEvent.target.position.lineNumber, mouseEvent.target.position.column);\n            if (this._dragSelection === null) {\n                let newSelections = null;\n                if (mouseEvent.event.shiftKey) {\n                    const primarySelection = this._editor.getSelection();\n                    if (primarySelection) {\n                        const { selectionStartLineNumber, selectionStartColumn } = primarySelection;\n                        newSelections = [new Selection(selectionStartLineNumber, selectionStartColumn, newCursorPosition.lineNumber, newCursorPosition.column)];\n                    }\n                }\n                else {\n                    newSelections = (this._editor.getSelections() || []).map(selection => {\n                        if (selection.containsPosition(newCursorPosition)) {\n                            return new Selection(newCursorPosition.lineNumber, newCursorPosition.column, newCursorPosition.lineNumber, newCursorPosition.column);\n                        }\n                        else {\n                            return selection;\n                        }\n                    });\n                }\n                // Use `mouse` as the source instead of `api` and setting the reason to explicit (to behave like any other mouse operation).\n                this._editor.setSelections(newSelections || [], 'mouse', 3 /* CursorChangeReason.Explicit */);\n            }\n            else if (!this._dragSelection.containsPosition(newCursorPosition) ||\n                ((hasTriggerModifier(mouseEvent.event) ||\n                    this._modifierPressed) && (this._dragSelection.getEndPosition().equals(newCursorPosition) || this._dragSelection.getStartPosition().equals(newCursorPosition)) // we allow users to paste content beside the selection\n                )) {\n                this._editor.pushUndoStop();\n                this._editor.executeCommand(DragAndDropController.ID, new DragAndDropCommand(this._dragSelection, newCursorPosition, hasTriggerModifier(mouseEvent.event) || this._modifierPressed));\n                this._editor.pushUndoStop();\n            }\n        }\n        this._editor.updateOptions({\n            mouseStyle: 'text'\n        });\n        this._removeDecoration();\n        this._dragSelection = null;\n        this._mouseDown = false;\n    }\n    static { this._DECORATION_OPTIONS = ModelDecorationOptions.register({\n        description: 'dnd-target',\n        className: 'dnd-target'\n    }); }\n    showAt(position) {\n        this._dndDecorationIds.set([{\n                range: new Range(position.lineNumber, position.column, position.lineNumber, position.column),\n                options: DragAndDropController._DECORATION_OPTIONS\n            }]);\n        this._editor.revealPosition(position, 1 /* ScrollType.Immediate */);\n    }\n    _removeDecoration() {\n        this._dndDecorationIds.clear();\n    }\n    _hitContent(target) {\n        return target.type === 6 /* MouseTargetType.CONTENT_TEXT */ ||\n            target.type === 7 /* MouseTargetType.CONTENT_EMPTY */;\n    }\n    _hitMargin(target) {\n        return target.type === 2 /* MouseTargetType.GUTTER_GLYPH_MARGIN */ ||\n            target.type === 3 /* MouseTargetType.GUTTER_LINE_NUMBERS */ ||\n            target.type === 4 /* MouseTargetType.GUTTER_LINE_DECORATIONS */;\n    }\n    dispose() {\n        this._removeDecoration();\n        this._dragSelection = null;\n        this._mouseDown = false;\n        this._modifierPressed = false;\n        super.dispose();\n    }\n}\nregisterEditorContribution(DragAndDropController.ID, DragAndDropController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { HierarchicalKind } from '../../../../base/common/hierarchicalKind.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { registerEditorFeature } from '../../../common/editorFeatures.js';\nimport { CopyPasteController, changePasteTypeCommandId, pasteWidgetVisibleCtx } from './copyPasteController.js';\nimport { DefaultPasteProvidersFeature, DefaultTextPasteOrDropEditProvider } from './defaultProviders.js';\nimport * as nls from '../../../../nls.js';\nregisterEditorContribution(CopyPasteController.ID, CopyPasteController, 0 /* EditorContributionInstantiation.Eager */); // eager because it listens to events on the container dom node of the editor\nregisterEditorFeature(DefaultPasteProvidersFeature);\nregisterEditorCommand(new class extends EditorCommand {\n    constructor() {\n        super({\n            id: changePasteTypeCommandId,\n            precondition: pasteWidgetVisibleCtx,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 89 /* KeyCode.Period */,\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        return CopyPasteController.get(editor)?.changePasteType();\n    }\n});\nregisterEditorCommand(new class extends EditorCommand {\n    constructor() {\n        super({\n            id: 'editor.hidePasteWidget',\n            precondition: pasteWidgetVisibleCtx,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */,\n                primary: 9 /* KeyCode.Escape */,\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        CopyPasteController.get(editor)?.clearWidgets();\n    }\n});\nregisterEditorAction(class PasteAsAction extends EditorAction {\n    static { this.argsSchema = {\n        type: 'object',\n        properties: {\n            kind: {\n                type: 'string',\n                description: nls.localize('pasteAs.kind', \"The kind of the paste edit to try applying. If not provided or there are multiple edits for this kind, the editor will show a picker.\"),\n            }\n        },\n    }; }\n    constructor() {\n        super({\n            id: 'editor.action.pasteAs',\n            label: nls.localize('pasteAs', \"Paste As...\"),\n            alias: 'Paste As...',\n            precondition: EditorContextKeys.writable,\n            metadata: {\n                description: 'Paste as',\n                args: [{\n                        name: 'args',\n                        schema: PasteAsAction.argsSchema\n                    }]\n            }\n        });\n    }\n    run(_accessor, editor, args) {\n        let kind = typeof args?.kind === 'string' ? args.kind : undefined;\n        if (!kind && args) {\n            // Support old id property\n            // TODO: remove this in the future\n            kind = typeof args.id === 'string' ? args.id : undefined;\n        }\n        return CopyPasteController.get(editor)?.pasteAs(kind ? new HierarchicalKind(kind) : undefined);\n    }\n});\nregisterEditorAction(class extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.pasteAsText',\n            label: nls.localize('pasteAsText', \"Paste as Text\"),\n            alias: 'Paste as Text',\n            precondition: EditorContextKeys.writable,\n        });\n    }\n    run(_accessor, editor) {\n        return CopyPasteController.get(editor)?.pasteAs({ providerId: DefaultTextPasteOrDropEditProvider.id });\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar DropIntoEditorController_1;\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { createCancelablePromise, raceCancellation } from '../../../../base/common/async.js';\nimport { VSDataTransfer, matchesMimeType } from '../../../../base/common/dataTransfer.js';\nimport { HierarchicalKind } from '../../../../base/common/hierarchicalKind.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { toExternalVSDataTransfer } from '../../../browser/dnd.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { DraggedTreeItemsIdentifier } from '../../../common/services/treeViewsDnd.js';\nimport { ITreeViewsDnDService } from '../../../common/services/treeViewsDndService.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { InlineProgressManager } from '../../inlineProgress/browser/inlineProgress.js';\nimport { localize } from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { LocalSelectionTransfer } from '../../../../platform/dnd/browser/dnd.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { sortEditsByYieldTo } from './edit.js';\nimport { PostEditWidgetManager } from './postEditWidget.js';\nexport const defaultProviderConfig = 'editor.experimental.dropIntoEditor.defaultProvider';\nexport const changeDropTypeCommandId = 'editor.changeDropType';\nexport const dropWidgetVisibleCtx = new RawContextKey('dropWidgetVisible', false, localize('dropWidgetVisible', \"Whether the drop widget is showing\"));\nlet DropIntoEditorController = class DropIntoEditorController extends Disposable {\n    static { DropIntoEditorController_1 = this; }\n    static { this.ID = 'editor.contrib.dropIntoEditorController'; }\n    static get(editor) {\n        return editor.getContribution(DropIntoEditorController_1.ID);\n    }\n    constructor(editor, instantiationService, _configService, _languageFeaturesService, _treeViewsDragAndDropService) {\n        super();\n        this._configService = _configService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._treeViewsDragAndDropService = _treeViewsDragAndDropService;\n        this.treeItemsTransfer = LocalSelectionTransfer.getInstance();\n        this._dropProgressManager = this._register(instantiationService.createInstance(InlineProgressManager, 'dropIntoEditor', editor));\n        this._postDropWidgetManager = this._register(instantiationService.createInstance(PostEditWidgetManager, 'dropIntoEditor', editor, dropWidgetVisibleCtx, { id: changeDropTypeCommandId, label: localize('postDropWidgetTitle', \"Show drop options...\") }));\n        this._register(editor.onDropIntoEditor(e => this.onDropIntoEditor(editor, e.position, e.event)));\n    }\n    clearWidgets() {\n        this._postDropWidgetManager.clear();\n    }\n    changeDropType() {\n        this._postDropWidgetManager.tryShowSelector();\n    }\n    async onDropIntoEditor(editor, position, dragEvent) {\n        if (!dragEvent.dataTransfer || !editor.hasModel()) {\n            return;\n        }\n        this._currentOperation?.cancel();\n        editor.focus();\n        editor.setPosition(position);\n        const p = createCancelablePromise(async (token) => {\n            const disposables = new DisposableStore();\n            const tokenSource = disposables.add(new EditorStateCancellationTokenSource(editor, 1 /* CodeEditorStateFlag.Value */, undefined, token));\n            try {\n                const ourDataTransfer = await this.extractDataTransferData(dragEvent);\n                if (ourDataTransfer.size === 0 || tokenSource.token.isCancellationRequested) {\n                    return;\n                }\n                const model = editor.getModel();\n                if (!model) {\n                    return;\n                }\n                const providers = this._languageFeaturesService.documentDropEditProvider\n                    .ordered(model)\n                    .filter(provider => {\n                    if (!provider.dropMimeTypes) {\n                        // Keep all providers that don't specify mime types\n                        return true;\n                    }\n                    return provider.dropMimeTypes.some(mime => ourDataTransfer.matches(mime));\n                });\n                const editSession = disposables.add(await this.getDropEdits(providers, model, position, ourDataTransfer, tokenSource));\n                if (tokenSource.token.isCancellationRequested) {\n                    return;\n                }\n                if (editSession.edits.length) {\n                    const activeEditIndex = this.getInitialActiveEditIndex(model, editSession.edits);\n                    const canShowWidget = editor.getOption(36 /* EditorOption.dropIntoEditor */).showDropSelector === 'afterDrop';\n                    // Pass in the parent token here as it tracks cancelling the entire drop operation\n                    await this._postDropWidgetManager.applyEditAndShowIfNeeded([Range.fromPositions(position)], { activeEditIndex, allEdits: editSession.edits }, canShowWidget, async (edit) => edit, token);\n                }\n            }\n            finally {\n                disposables.dispose();\n                if (this._currentOperation === p) {\n                    this._currentOperation = undefined;\n                }\n            }\n        });\n        this._dropProgressManager.showWhile(position, localize('dropIntoEditorProgress', \"Running drop handlers. Click to cancel\"), p, { cancel: () => p.cancel() });\n        this._currentOperation = p;\n    }\n    async getDropEdits(providers, model, position, dataTransfer, tokenSource) {\n        const disposables = new DisposableStore();\n        const results = await raceCancellation(Promise.all(providers.map(async (provider) => {\n            try {\n                const edits = await provider.provideDocumentDropEdits(model, position, dataTransfer, tokenSource.token);\n                if (edits) {\n                    disposables.add(edits);\n                }\n                return edits?.edits.map(edit => ({ ...edit, providerId: provider.id }));\n            }\n            catch (err) {\n                console.error(err);\n            }\n            return undefined;\n        })), tokenSource.token);\n        const edits = coalesce(results ?? []).flat();\n        return {\n            edits: sortEditsByYieldTo(edits),\n            dispose: () => disposables.dispose()\n        };\n    }\n    getInitialActiveEditIndex(model, edits) {\n        const preferredProviders = this._configService.getValue(defaultProviderConfig, { resource: model.uri });\n        for (const [configMime, desiredKindStr] of Object.entries(preferredProviders)) {\n            const desiredKind = new HierarchicalKind(desiredKindStr);\n            const editIndex = edits.findIndex(edit => desiredKind.value === edit.providerId\n                && edit.handledMimeType && matchesMimeType(configMime, [edit.handledMimeType]));\n            if (editIndex >= 0) {\n                return editIndex;\n            }\n        }\n        return 0;\n    }\n    async extractDataTransferData(dragEvent) {\n        if (!dragEvent.dataTransfer) {\n            return new VSDataTransfer();\n        }\n        const dataTransfer = toExternalVSDataTransfer(dragEvent.dataTransfer);\n        if (this.treeItemsTransfer.hasData(DraggedTreeItemsIdentifier.prototype)) {\n            const data = this.treeItemsTransfer.getData(DraggedTreeItemsIdentifier.prototype);\n            if (Array.isArray(data)) {\n                for (const id of data) {\n                    const treeDataTransfer = await this._treeViewsDragAndDropService.removeDragOperationTransfer(id.identifier);\n                    if (treeDataTransfer) {\n                        for (const [type, value] of treeDataTransfer) {\n                            dataTransfer.replace(type, value);\n                        }\n                    }\n                }\n            }\n        }\n        return dataTransfer;\n    }\n};\nDropIntoEditorController = DropIntoEditorController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IConfigurationService),\n    __param(3, ILanguageFeaturesService),\n    __param(4, ITreeViewsDnDService)\n], DropIntoEditorController);\nexport { DropIntoEditorController };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorCommand, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { editorConfigurationBaseNode } from '../../../common/config/editorConfigurationSchema.js';\nimport { registerEditorFeature } from '../../../common/editorFeatures.js';\nimport { DefaultDropProvidersFeature } from './defaultProviders.js';\nimport * as nls from '../../../../nls.js';\nimport { Extensions as ConfigurationExtensions } from '../../../../platform/configuration/common/configurationRegistry.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { DropIntoEditorController, changeDropTypeCommandId, defaultProviderConfig, dropWidgetVisibleCtx } from './dropIntoEditorController.js';\nregisterEditorContribution(DropIntoEditorController.ID, DropIntoEditorController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorFeature(DefaultDropProvidersFeature);\nregisterEditorCommand(new class extends EditorCommand {\n    constructor() {\n        super({\n            id: changeDropTypeCommandId,\n            precondition: dropWidgetVisibleCtx,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 89 /* KeyCode.Period */,\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor, _args) {\n        DropIntoEditorController.get(editor)?.changeDropType();\n    }\n});\nregisterEditorCommand(new class extends EditorCommand {\n    constructor() {\n        super({\n            id: 'editor.hideDropWidget',\n            precondition: dropWidgetVisibleCtx,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */,\n                primary: 9 /* KeyCode.Escape */,\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor, _args) {\n        DropIntoEditorController.get(editor)?.clearWidgets();\n    }\n});\nRegistry.as(ConfigurationExtensions.Configuration).registerConfiguration({\n    ...editorConfigurationBaseNode,\n    properties: {\n        [defaultProviderConfig]: {\n            type: 'object',\n            scope: 5 /* ConfigurationScope.LANGUAGE_OVERRIDABLE */,\n            description: nls.localize('defaultProviderDescription', \"Configures the default drop provider to use for content of a given mime type.\"),\n            default: {},\n            additionalProperties: {\n                type: 'string',\n            },\n        },\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Range } from '../../../common/core/range.js';\nimport { OverviewRulerLane } from '../../../common/model.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { minimapFindMatch, overviewRulerFindMatchForeground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nexport class FindDecorations {\n    constructor(editor) {\n        this._editor = editor;\n        this._decorations = [];\n        this._overviewRulerApproximateDecorations = [];\n        this._findScopeDecorationIds = [];\n        this._rangeHighlightDecorationId = null;\n        this._highlightedDecorationId = null;\n        this._startPosition = this._editor.getPosition();\n    }\n    dispose() {\n        this._editor.removeDecorations(this._allDecorations());\n        this._decorations = [];\n        this._overviewRulerApproximateDecorations = [];\n        this._findScopeDecorationIds = [];\n        this._rangeHighlightDecorationId = null;\n        this._highlightedDecorationId = null;\n    }\n    reset() {\n        this._decorations = [];\n        this._overviewRulerApproximateDecorations = [];\n        this._findScopeDecorationIds = [];\n        this._rangeHighlightDecorationId = null;\n        this._highlightedDecorationId = null;\n    }\n    getCount() {\n        return this._decorations.length;\n    }\n    /** @deprecated use getFindScopes to support multiple selections */\n    getFindScope() {\n        if (this._findScopeDecorationIds[0]) {\n            return this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]);\n        }\n        return null;\n    }\n    getFindScopes() {\n        if (this._findScopeDecorationIds.length) {\n            const scopes = this._findScopeDecorationIds.map(findScopeDecorationId => this._editor.getModel().getDecorationRange(findScopeDecorationId)).filter(element => !!element);\n            if (scopes.length) {\n                return scopes;\n            }\n        }\n        return null;\n    }\n    getStartPosition() {\n        return this._startPosition;\n    }\n    setStartPosition(newStartPosition) {\n        this._startPosition = newStartPosition;\n        this.setCurrentFindMatch(null);\n    }\n    _getDecorationIndex(decorationId) {\n        const index = this._decorations.indexOf(decorationId);\n        if (index >= 0) {\n            return index + 1;\n        }\n        return 1;\n    }\n    getDecorationRangeAt(index) {\n        const decorationId = index < this._decorations.length ? this._decorations[index] : null;\n        if (decorationId) {\n            return this._editor.getModel().getDecorationRange(decorationId);\n        }\n        return null;\n    }\n    getCurrentMatchesPosition(desiredRange) {\n        const candidates = this._editor.getModel().getDecorationsInRange(desiredRange);\n        for (const candidate of candidates) {\n            const candidateOpts = candidate.options;\n            if (candidateOpts === FindDecorations._FIND_MATCH_DECORATION || candidateOpts === FindDecorations._CURRENT_FIND_MATCH_DECORATION) {\n                return this._getDecorationIndex(candidate.id);\n            }\n        }\n        // We don't know the current match position, so returns zero to show '?' in find widget\n        return 0;\n    }\n    setCurrentFindMatch(nextMatch) {\n        let newCurrentDecorationId = null;\n        let matchPosition = 0;\n        if (nextMatch) {\n            for (let i = 0, len = this._decorations.length; i < len; i++) {\n                const range = this._editor.getModel().getDecorationRange(this._decorations[i]);\n                if (nextMatch.equalsRange(range)) {\n                    newCurrentDecorationId = this._decorations[i];\n                    matchPosition = (i + 1);\n                    break;\n                }\n            }\n        }\n        if (this._highlightedDecorationId !== null || newCurrentDecorationId !== null) {\n            this._editor.changeDecorations((changeAccessor) => {\n                if (this._highlightedDecorationId !== null) {\n                    changeAccessor.changeDecorationOptions(this._highlightedDecorationId, FindDecorations._FIND_MATCH_DECORATION);\n                    this._highlightedDecorationId = null;\n                }\n                if (newCurrentDecorationId !== null) {\n                    this._highlightedDecorationId = newCurrentDecorationId;\n                    changeAccessor.changeDecorationOptions(this._highlightedDecorationId, FindDecorations._CURRENT_FIND_MATCH_DECORATION);\n                }\n                if (this._rangeHighlightDecorationId !== null) {\n                    changeAccessor.removeDecoration(this._rangeHighlightDecorationId);\n                    this._rangeHighlightDecorationId = null;\n                }\n                if (newCurrentDecorationId !== null) {\n                    let rng = this._editor.getModel().getDecorationRange(newCurrentDecorationId);\n                    if (rng.startLineNumber !== rng.endLineNumber && rng.endColumn === 1) {\n                        const lineBeforeEnd = rng.endLineNumber - 1;\n                        const lineBeforeEndMaxColumn = this._editor.getModel().getLineMaxColumn(lineBeforeEnd);\n                        rng = new Range(rng.startLineNumber, rng.startColumn, lineBeforeEnd, lineBeforeEndMaxColumn);\n                    }\n                    this._rangeHighlightDecorationId = changeAccessor.addDecoration(rng, FindDecorations._RANGE_HIGHLIGHT_DECORATION);\n                }\n            });\n        }\n        return matchPosition;\n    }\n    set(findMatches, findScopes) {\n        this._editor.changeDecorations((accessor) => {\n            let findMatchesOptions = FindDecorations._FIND_MATCH_DECORATION;\n            const newOverviewRulerApproximateDecorations = [];\n            if (findMatches.length > 1000) {\n                // we go into a mode where the overview ruler gets \"approximate\" decorations\n                // the reason is that the overview ruler paints all the decorations in the file and we don't want to cause freezes\n                findMatchesOptions = FindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION;\n                // approximate a distance in lines where matches should be merged\n                const lineCount = this._editor.getModel().getLineCount();\n                const height = this._editor.getLayoutInfo().height;\n                const approxPixelsPerLine = height / lineCount;\n                const mergeLinesDelta = Math.max(2, Math.ceil(3 / approxPixelsPerLine));\n                // merge decorations as much as possible\n                let prevStartLineNumber = findMatches[0].range.startLineNumber;\n                let prevEndLineNumber = findMatches[0].range.endLineNumber;\n                for (let i = 1, len = findMatches.length; i < len; i++) {\n                    const range = findMatches[i].range;\n                    if (prevEndLineNumber + mergeLinesDelta >= range.startLineNumber) {\n                        if (range.endLineNumber > prevEndLineNumber) {\n                            prevEndLineNumber = range.endLineNumber;\n                        }\n                    }\n                    else {\n                        newOverviewRulerApproximateDecorations.push({\n                            range: new Range(prevStartLineNumber, 1, prevEndLineNumber, 1),\n                            options: FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION\n                        });\n                        prevStartLineNumber = range.startLineNumber;\n                        prevEndLineNumber = range.endLineNumber;\n                    }\n                }\n                newOverviewRulerApproximateDecorations.push({\n                    range: new Range(prevStartLineNumber, 1, prevEndLineNumber, 1),\n                    options: FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION\n                });\n            }\n            // Find matches\n            const newFindMatchesDecorations = new Array(findMatches.length);\n            for (let i = 0, len = findMatches.length; i < len; i++) {\n                newFindMatchesDecorations[i] = {\n                    range: findMatches[i].range,\n                    options: findMatchesOptions\n                };\n            }\n            this._decorations = accessor.deltaDecorations(this._decorations, newFindMatchesDecorations);\n            // Overview ruler approximate decorations\n            this._overviewRulerApproximateDecorations = accessor.deltaDecorations(this._overviewRulerApproximateDecorations, newOverviewRulerApproximateDecorations);\n            // Range highlight\n            if (this._rangeHighlightDecorationId) {\n                accessor.removeDecoration(this._rangeHighlightDecorationId);\n                this._rangeHighlightDecorationId = null;\n            }\n            // Find scope\n            if (this._findScopeDecorationIds.length) {\n                this._findScopeDecorationIds.forEach(findScopeDecorationId => accessor.removeDecoration(findScopeDecorationId));\n                this._findScopeDecorationIds = [];\n            }\n            if (findScopes?.length) {\n                this._findScopeDecorationIds = findScopes.map(findScope => accessor.addDecoration(findScope, FindDecorations._FIND_SCOPE_DECORATION));\n            }\n        });\n    }\n    matchBeforePosition(position) {\n        if (this._decorations.length === 0) {\n            return null;\n        }\n        for (let i = this._decorations.length - 1; i >= 0; i--) {\n            const decorationId = this._decorations[i];\n            const r = this._editor.getModel().getDecorationRange(decorationId);\n            if (!r || r.endLineNumber > position.lineNumber) {\n                continue;\n            }\n            if (r.endLineNumber < position.lineNumber) {\n                return r;\n            }\n            if (r.endColumn > position.column) {\n                continue;\n            }\n            return r;\n        }\n        return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length - 1]);\n    }\n    matchAfterPosition(position) {\n        if (this._decorations.length === 0) {\n            return null;\n        }\n        for (let i = 0, len = this._decorations.length; i < len; i++) {\n            const decorationId = this._decorations[i];\n            const r = this._editor.getModel().getDecorationRange(decorationId);\n            if (!r || r.startLineNumber < position.lineNumber) {\n                continue;\n            }\n            if (r.startLineNumber > position.lineNumber) {\n                return r;\n            }\n            if (r.startColumn < position.column) {\n                continue;\n            }\n            return r;\n        }\n        return this._editor.getModel().getDecorationRange(this._decorations[0]);\n    }\n    _allDecorations() {\n        let result = [];\n        result = result.concat(this._decorations);\n        result = result.concat(this._overviewRulerApproximateDecorations);\n        if (this._findScopeDecorationIds.length) {\n            result.push(...this._findScopeDecorationIds);\n        }\n        if (this._rangeHighlightDecorationId) {\n            result.push(this._rangeHighlightDecorationId);\n        }\n        return result;\n    }\n    static { this._CURRENT_FIND_MATCH_DECORATION = ModelDecorationOptions.register({\n        description: 'current-find-match',\n        stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n        zIndex: 13,\n        className: 'currentFindMatch',\n        inlineClassName: 'currentFindMatchInline',\n        showIfCollapsed: true,\n        overviewRuler: {\n            color: themeColorFromId(overviewRulerFindMatchForeground),\n            position: OverviewRulerLane.Center\n        },\n        minimap: {\n            color: themeColorFromId(minimapFindMatch),\n            position: 1 /* MinimapPosition.Inline */\n        }\n    }); }\n    static { this._FIND_MATCH_DECORATION = ModelDecorationOptions.register({\n        description: 'find-match',\n        stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n        zIndex: 10,\n        className: 'findMatch',\n        inlineClassName: 'findMatchInline',\n        showIfCollapsed: true,\n        overviewRuler: {\n            color: themeColorFromId(overviewRulerFindMatchForeground),\n            position: OverviewRulerLane.Center\n        },\n        minimap: {\n            color: themeColorFromId(minimapFindMatch),\n            position: 1 /* MinimapPosition.Inline */\n        }\n    }); }\n    static { this._FIND_MATCH_NO_OVERVIEW_DECORATION = ModelDecorationOptions.register({\n        description: 'find-match-no-overview',\n        stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n        className: 'findMatch',\n        showIfCollapsed: true\n    }); }\n    static { this._FIND_MATCH_ONLY_OVERVIEW_DECORATION = ModelDecorationOptions.register({\n        description: 'find-match-only-overview',\n        stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n        overviewRuler: {\n            color: themeColorFromId(overviewRulerFindMatchForeground),\n            position: OverviewRulerLane.Center\n        }\n    }); }\n    static { this._RANGE_HIGHLIGHT_DECORATION = ModelDecorationOptions.register({\n        description: 'find-range-highlight',\n        stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n        className: 'rangeHighlight',\n        isWholeLine: true\n    }); }\n    static { this._FIND_SCOPE_DECORATION = ModelDecorationOptions.register({\n        description: 'find-scope',\n        className: 'findScope',\n        isWholeLine: true\n    }); }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Range } from '../../../common/core/range.js';\nexport class ReplaceAllCommand {\n    constructor(editorSelection, ranges, replaceStrings) {\n        this._editorSelection = editorSelection;\n        this._ranges = ranges;\n        this._replaceStrings = replaceStrings;\n        this._trackedEditorSelectionId = null;\n    }\n    getEditOperations(model, builder) {\n        if (this._ranges.length > 0) {\n            // Collect all edit operations\n            const ops = [];\n            for (let i = 0; i < this._ranges.length; i++) {\n                ops.push({\n                    range: this._ranges[i],\n                    text: this._replaceStrings[i]\n                });\n            }\n            // Sort them in ascending order by range starts\n            ops.sort((o1, o2) => {\n                return Range.compareRangesUsingStarts(o1.range, o2.range);\n            });\n            // Merge operations that touch each other\n            const resultOps = [];\n            let previousOp = ops[0];\n            for (let i = 1; i < ops.length; i++) {\n                if (previousOp.range.endLineNumber === ops[i].range.startLineNumber && previousOp.range.endColumn === ops[i].range.startColumn) {\n                    // These operations are one after another and can be merged\n                    previousOp.range = previousOp.range.plusRange(ops[i].range);\n                    previousOp.text = previousOp.text + ops[i].text;\n                }\n                else {\n                    resultOps.push(previousOp);\n                    previousOp = ops[i];\n                }\n            }\n            resultOps.push(previousOp);\n            for (const op of resultOps) {\n                builder.addEditOperation(op.range, op.text);\n            }\n        }\n        this._trackedEditorSelectionId = builder.trackSelection(this._editorSelection);\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this._trackedEditorSelectionId);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { buildReplaceStringWithCasePreserved } from '../../../../base/common/search.js';\n/**\n * Assigned when the replace pattern is entirely static.\n */\nclass StaticValueReplacePattern {\n    constructor(staticValue) {\n        this.staticValue = staticValue;\n        this.kind = 0 /* ReplacePatternKind.StaticValue */;\n    }\n}\n/**\n * Assigned when the replace pattern has replacement patterns.\n */\nclass DynamicPiecesReplacePattern {\n    constructor(pieces) {\n        this.pieces = pieces;\n        this.kind = 1 /* ReplacePatternKind.DynamicPieces */;\n    }\n}\nexport class ReplacePattern {\n    static fromStaticValue(value) {\n        return new ReplacePattern([ReplacePiece.staticValue(value)]);\n    }\n    get hasReplacementPatterns() {\n        return (this._state.kind === 1 /* ReplacePatternKind.DynamicPieces */);\n    }\n    constructor(pieces) {\n        if (!pieces || pieces.length === 0) {\n            this._state = new StaticValueReplacePattern('');\n        }\n        else if (pieces.length === 1 && pieces[0].staticValue !== null) {\n            this._state = new StaticValueReplacePattern(pieces[0].staticValue);\n        }\n        else {\n            this._state = new DynamicPiecesReplacePattern(pieces);\n        }\n    }\n    buildReplaceString(matches, preserveCase) {\n        if (this._state.kind === 0 /* ReplacePatternKind.StaticValue */) {\n            if (preserveCase) {\n                return buildReplaceStringWithCasePreserved(matches, this._state.staticValue);\n            }\n            else {\n                return this._state.staticValue;\n            }\n        }\n        let result = '';\n        for (let i = 0, len = this._state.pieces.length; i < len; i++) {\n            const piece = this._state.pieces[i];\n            if (piece.staticValue !== null) {\n                // static value ReplacePiece\n                result += piece.staticValue;\n                continue;\n            }\n            // match index ReplacePiece\n            let match = ReplacePattern._substitute(piece.matchIndex, matches);\n            if (piece.caseOps !== null && piece.caseOps.length > 0) {\n                const repl = [];\n                const lenOps = piece.caseOps.length;\n                let opIdx = 0;\n                for (let idx = 0, len = match.length; idx < len; idx++) {\n                    if (opIdx >= lenOps) {\n                        repl.push(match.slice(idx));\n                        break;\n                    }\n                    switch (piece.caseOps[opIdx]) {\n                        case 'U':\n                            repl.push(match[idx].toUpperCase());\n                            break;\n                        case 'u':\n                            repl.push(match[idx].toUpperCase());\n                            opIdx++;\n                            break;\n                        case 'L':\n                            repl.push(match[idx].toLowerCase());\n                            break;\n                        case 'l':\n                            repl.push(match[idx].toLowerCase());\n                            opIdx++;\n                            break;\n                        default:\n                            repl.push(match[idx]);\n                    }\n                }\n                match = repl.join('');\n            }\n            result += match;\n        }\n        return result;\n    }\n    static _substitute(matchIndex, matches) {\n        if (matches === null) {\n            return '';\n        }\n        if (matchIndex === 0) {\n            return matches[0];\n        }\n        let remainder = '';\n        while (matchIndex > 0) {\n            if (matchIndex < matches.length) {\n                // A match can be undefined\n                const match = (matches[matchIndex] || '');\n                return match + remainder;\n            }\n            remainder = String(matchIndex % 10) + remainder;\n            matchIndex = Math.floor(matchIndex / 10);\n        }\n        return '$' + remainder;\n    }\n}\n/**\n * A replace piece can either be a static string or an index to a specific match.\n */\nexport class ReplacePiece {\n    static staticValue(value) {\n        return new ReplacePiece(value, -1, null);\n    }\n    static caseOps(index, caseOps) {\n        return new ReplacePiece(null, index, caseOps);\n    }\n    constructor(staticValue, matchIndex, caseOps) {\n        this.staticValue = staticValue;\n        this.matchIndex = matchIndex;\n        if (!caseOps || caseOps.length === 0) {\n            this.caseOps = null;\n        }\n        else {\n            this.caseOps = caseOps.slice(0);\n        }\n    }\n}\nclass ReplacePieceBuilder {\n    constructor(source) {\n        this._source = source;\n        this._lastCharIndex = 0;\n        this._result = [];\n        this._resultLen = 0;\n        this._currentStaticPiece = '';\n    }\n    emitUnchanged(toCharIndex) {\n        this._emitStatic(this._source.substring(this._lastCharIndex, toCharIndex));\n        this._lastCharIndex = toCharIndex;\n    }\n    emitStatic(value, toCharIndex) {\n        this._emitStatic(value);\n        this._lastCharIndex = toCharIndex;\n    }\n    _emitStatic(value) {\n        if (value.length === 0) {\n            return;\n        }\n        this._currentStaticPiece += value;\n    }\n    emitMatchIndex(index, toCharIndex, caseOps) {\n        if (this._currentStaticPiece.length !== 0) {\n            this._result[this._resultLen++] = ReplacePiece.staticValue(this._currentStaticPiece);\n            this._currentStaticPiece = '';\n        }\n        this._result[this._resultLen++] = ReplacePiece.caseOps(index, caseOps);\n        this._lastCharIndex = toCharIndex;\n    }\n    finalize() {\n        this.emitUnchanged(this._source.length);\n        if (this._currentStaticPiece.length !== 0) {\n            this._result[this._resultLen++] = ReplacePiece.staticValue(this._currentStaticPiece);\n            this._currentStaticPiece = '';\n        }\n        return new ReplacePattern(this._result);\n    }\n}\n/**\n * \\n\t\t\t=> inserts a LF\n * \\t\t\t\t=> inserts a TAB\n * \\\\\t\t\t=> inserts a \"\\\".\n * \\u\t\t\t=> upper-cases one character in a match.\n * \\U\t\t\t=> upper-cases ALL remaining characters in a match.\n * \\l\t\t\t=> lower-cases one character in a match.\n * \\L\t\t\t=> lower-cases ALL remaining characters in a match.\n * $$\t\t\t=> inserts a \"$\".\n * $& and $0\t=> inserts the matched substring.\n * $n\t\t\t=> Where n is a non-negative integer lesser than 100, inserts the nth parenthesized submatch string\n * everything else stays untouched\n *\n * Also see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace#Specifying_a_string_as_a_parameter\n */\nexport function parseReplaceString(replaceString) {\n    if (!replaceString || replaceString.length === 0) {\n        return new ReplacePattern(null);\n    }\n    const caseOps = [];\n    const result = new ReplacePieceBuilder(replaceString);\n    for (let i = 0, len = replaceString.length; i < len; i++) {\n        const chCode = replaceString.charCodeAt(i);\n        if (chCode === 92 /* CharCode.Backslash */) {\n            // move to next char\n            i++;\n            if (i >= len) {\n                // string ends with a \\\n                break;\n            }\n            const nextChCode = replaceString.charCodeAt(i);\n            // let replaceWithCharacter: string | null = null;\n            switch (nextChCode) {\n                case 92 /* CharCode.Backslash */:\n                    // \\\\ => inserts a \"\\\"\n                    result.emitUnchanged(i - 1);\n                    result.emitStatic('\\\\', i + 1);\n                    break;\n                case 110 /* CharCode.n */:\n                    // \\n => inserts a LF\n                    result.emitUnchanged(i - 1);\n                    result.emitStatic('\\n', i + 1);\n                    break;\n                case 116 /* CharCode.t */:\n                    // \\t => inserts a TAB\n                    result.emitUnchanged(i - 1);\n                    result.emitStatic('\\t', i + 1);\n                    break;\n                // Case modification of string replacements, patterned after Boost, but only applied\n                // to the replacement text, not subsequent content.\n                case 117 /* CharCode.u */:\n                // \\u => upper-cases one character.\n                case 85 /* CharCode.U */:\n                // \\U => upper-cases ALL following characters.\n                case 108 /* CharCode.l */:\n                // \\l => lower-cases one character.\n                case 76 /* CharCode.L */:\n                    // \\L => lower-cases ALL following characters.\n                    result.emitUnchanged(i - 1);\n                    result.emitStatic('', i + 1);\n                    caseOps.push(String.fromCharCode(nextChCode));\n                    break;\n            }\n            continue;\n        }\n        if (chCode === 36 /* CharCode.DollarSign */) {\n            // move to next char\n            i++;\n            if (i >= len) {\n                // string ends with a $\n                break;\n            }\n            const nextChCode = replaceString.charCodeAt(i);\n            if (nextChCode === 36 /* CharCode.DollarSign */) {\n                // $$ => inserts a \"$\"\n                result.emitUnchanged(i - 1);\n                result.emitStatic('$', i + 1);\n                continue;\n            }\n            if (nextChCode === 48 /* CharCode.Digit0 */ || nextChCode === 38 /* CharCode.Ampersand */) {\n                // $& and $0 => inserts the matched substring.\n                result.emitUnchanged(i - 1);\n                result.emitMatchIndex(0, i + 1, caseOps);\n                caseOps.length = 0;\n                continue;\n            }\n            if (49 /* CharCode.Digit1 */ <= nextChCode && nextChCode <= 57 /* CharCode.Digit9 */) {\n                // $n\n                let matchIndex = nextChCode - 48 /* CharCode.Digit0 */;\n                // peek next char to probe for $nn\n                if (i + 1 < len) {\n                    const nextNextChCode = replaceString.charCodeAt(i + 1);\n                    if (48 /* CharCode.Digit0 */ <= nextNextChCode && nextNextChCode <= 57 /* CharCode.Digit9 */) {\n                        // $nn\n                        // move to next char\n                        i++;\n                        matchIndex = matchIndex * 10 + (nextNextChCode - 48 /* CharCode.Digit0 */);\n                        result.emitUnchanged(i - 2);\n                        result.emitMatchIndex(matchIndex, i + 1, caseOps);\n                        caseOps.length = 0;\n                        continue;\n                    }\n                }\n                result.emitUnchanged(i - 1);\n                result.emitMatchIndex(matchIndex, i + 1, caseOps);\n                caseOps.length = 0;\n                continue;\n            }\n        }\n    }\n    return result.finalize();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { findFirstIdxMonotonousOrArrLen } from '../../../../base/common/arraysFind.js';\nimport { RunOnceScheduler, TimeoutTimer } from '../../../../base/common/async.js';\nimport { DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { ReplaceCommand, ReplaceCommandThatPreservesSelection } from '../../../common/commands/replaceCommand.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { SearchParams } from '../../../common/model/textModelSearch.js';\nimport { FindDecorations } from './findDecorations.js';\nimport { ReplaceAllCommand } from './replaceAllCommand.js';\nimport { parseReplaceString, ReplacePattern } from './replacePattern.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nexport const CONTEXT_FIND_WIDGET_VISIBLE = new RawContextKey('findWidgetVisible', false);\nexport const CONTEXT_FIND_WIDGET_NOT_VISIBLE = CONTEXT_FIND_WIDGET_VISIBLE.toNegated();\n// Keep ContextKey use of 'Focussed' to not break when clauses\nexport const CONTEXT_FIND_INPUT_FOCUSED = new RawContextKey('findInputFocussed', false);\nexport const CONTEXT_REPLACE_INPUT_FOCUSED = new RawContextKey('replaceInputFocussed', false);\nexport const ToggleCaseSensitiveKeybinding = {\n    primary: 512 /* KeyMod.Alt */ | 33 /* KeyCode.KeyC */,\n    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 33 /* KeyCode.KeyC */ }\n};\nexport const ToggleWholeWordKeybinding = {\n    primary: 512 /* KeyMod.Alt */ | 53 /* KeyCode.KeyW */,\n    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 53 /* KeyCode.KeyW */ }\n};\nexport const ToggleRegexKeybinding = {\n    primary: 512 /* KeyMod.Alt */ | 48 /* KeyCode.KeyR */,\n    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 48 /* KeyCode.KeyR */ }\n};\nexport const ToggleSearchScopeKeybinding = {\n    primary: 512 /* KeyMod.Alt */ | 42 /* KeyCode.KeyL */,\n    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 42 /* KeyCode.KeyL */ }\n};\nexport const TogglePreserveCaseKeybinding = {\n    primary: 512 /* KeyMod.Alt */ | 46 /* KeyCode.KeyP */,\n    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 46 /* KeyCode.KeyP */ }\n};\nexport const FIND_IDS = {\n    StartFindAction: 'actions.find',\n    StartFindWithSelection: 'actions.findWithSelection',\n    StartFindWithArgs: 'editor.actions.findWithArgs',\n    NextMatchFindAction: 'editor.action.nextMatchFindAction',\n    PreviousMatchFindAction: 'editor.action.previousMatchFindAction',\n    GoToMatchFindAction: 'editor.action.goToMatchFindAction',\n    NextSelectionMatchFindAction: 'editor.action.nextSelectionMatchFindAction',\n    PreviousSelectionMatchFindAction: 'editor.action.previousSelectionMatchFindAction',\n    StartFindReplaceAction: 'editor.action.startFindReplaceAction',\n    CloseFindWidgetCommand: 'closeFindWidget',\n    ToggleCaseSensitiveCommand: 'toggleFindCaseSensitive',\n    ToggleWholeWordCommand: 'toggleFindWholeWord',\n    ToggleRegexCommand: 'toggleFindRegex',\n    ToggleSearchScopeCommand: 'toggleFindInSelection',\n    TogglePreserveCaseCommand: 'togglePreserveCase',\n    ReplaceOneAction: 'editor.action.replaceOne',\n    ReplaceAllAction: 'editor.action.replaceAll',\n    SelectAllMatchesAction: 'editor.action.selectAllMatches'\n};\nexport const MATCHES_LIMIT = 19999;\nconst RESEARCH_DELAY = 240;\nexport class FindModelBoundToEditorModel {\n    constructor(editor, state) {\n        this._toDispose = new DisposableStore();\n        this._editor = editor;\n        this._state = state;\n        this._isDisposed = false;\n        this._startSearchingTimer = new TimeoutTimer();\n        this._decorations = new FindDecorations(editor);\n        this._toDispose.add(this._decorations);\n        this._updateDecorationsScheduler = new RunOnceScheduler(() => {\n            if (!this._editor.hasModel()) {\n                return;\n            }\n            return this.research(false);\n        }, 100);\n        this._toDispose.add(this._updateDecorationsScheduler);\n        this._toDispose.add(this._editor.onDidChangeCursorPosition((e) => {\n            if (e.reason === 3 /* CursorChangeReason.Explicit */\n                || e.reason === 5 /* CursorChangeReason.Undo */\n                || e.reason === 6 /* CursorChangeReason.Redo */) {\n                this._decorations.setStartPosition(this._editor.getPosition());\n            }\n        }));\n        this._ignoreModelContentChanged = false;\n        this._toDispose.add(this._editor.onDidChangeModelContent((e) => {\n            if (this._ignoreModelContentChanged) {\n                return;\n            }\n            if (e.isFlush) {\n                // a model.setValue() was called\n                this._decorations.reset();\n            }\n            this._decorations.setStartPosition(this._editor.getPosition());\n            this._updateDecorationsScheduler.schedule();\n        }));\n        this._toDispose.add(this._state.onFindReplaceStateChange((e) => this._onStateChanged(e)));\n        this.research(false, this._state.searchScope);\n    }\n    dispose() {\n        this._isDisposed = true;\n        dispose(this._startSearchingTimer);\n        this._toDispose.dispose();\n    }\n    _onStateChanged(e) {\n        if (this._isDisposed) {\n            // The find model is disposed during a find state changed event\n            return;\n        }\n        if (!this._editor.hasModel()) {\n            // The find model will be disposed momentarily\n            return;\n        }\n        if (e.searchString || e.isReplaceRevealed || e.isRegex || e.wholeWord || e.matchCase || e.searchScope) {\n            const model = this._editor.getModel();\n            if (model.isTooLargeForSyncing()) {\n                this._startSearchingTimer.cancel();\n                this._startSearchingTimer.setIfNotSet(() => {\n                    if (e.searchScope) {\n                        this.research(e.moveCursor, this._state.searchScope);\n                    }\n                    else {\n                        this.research(e.moveCursor);\n                    }\n                }, RESEARCH_DELAY);\n            }\n            else {\n                if (e.searchScope) {\n                    this.research(e.moveCursor, this._state.searchScope);\n                }\n                else {\n                    this.research(e.moveCursor);\n                }\n            }\n        }\n    }\n    static _getSearchRange(model, findScope) {\n        // If we have set now or before a find scope, use it for computing the search range\n        if (findScope) {\n            return findScope;\n        }\n        return model.getFullModelRange();\n    }\n    research(moveCursor, newFindScope) {\n        let findScopes = null;\n        if (typeof newFindScope !== 'undefined') {\n            if (newFindScope !== null) {\n                if (!Array.isArray(newFindScope)) {\n                    findScopes = [newFindScope];\n                }\n                else {\n                    findScopes = newFindScope;\n                }\n            }\n        }\n        else {\n            findScopes = this._decorations.getFindScopes();\n        }\n        if (findScopes !== null) {\n            findScopes = findScopes.map(findScope => {\n                if (findScope.startLineNumber !== findScope.endLineNumber) {\n                    let endLineNumber = findScope.endLineNumber;\n                    if (findScope.endColumn === 1) {\n                        endLineNumber = endLineNumber - 1;\n                    }\n                    return new Range(findScope.startLineNumber, 1, endLineNumber, this._editor.getModel().getLineMaxColumn(endLineNumber));\n                }\n                return findScope;\n            });\n        }\n        const findMatches = this._findMatches(findScopes, false, MATCHES_LIMIT);\n        this._decorations.set(findMatches, findScopes);\n        const editorSelection = this._editor.getSelection();\n        let currentMatchesPosition = this._decorations.getCurrentMatchesPosition(editorSelection);\n        if (currentMatchesPosition === 0 && findMatches.length > 0) {\n            // current selection is not on top of a match\n            // try to find its nearest result from the top of the document\n            const matchAfterSelection = findFirstIdxMonotonousOrArrLen(findMatches.map(match => match.range), range => Range.compareRangesUsingStarts(range, editorSelection) >= 0);\n            currentMatchesPosition = matchAfterSelection > 0 ? matchAfterSelection - 1 + 1 /** match position is one based */ : currentMatchesPosition;\n        }\n        this._state.changeMatchInfo(currentMatchesPosition, this._decorations.getCount(), undefined);\n        if (moveCursor && this._editor.getOption(41 /* EditorOption.find */).cursorMoveOnType) {\n            this._moveToNextMatch(this._decorations.getStartPosition());\n        }\n    }\n    _hasMatches() {\n        return (this._state.matchesCount > 0);\n    }\n    _cannotFind() {\n        if (!this._hasMatches()) {\n            const findScope = this._decorations.getFindScope();\n            if (findScope) {\n                // Reveal the selection so user is reminded that 'selection find' is on.\n                this._editor.revealRangeInCenterIfOutsideViewport(findScope, 0 /* ScrollType.Smooth */);\n            }\n            return true;\n        }\n        return false;\n    }\n    _setCurrentFindMatch(match) {\n        const matchesPosition = this._decorations.setCurrentFindMatch(match);\n        this._state.changeMatchInfo(matchesPosition, this._decorations.getCount(), match);\n        this._editor.setSelection(match);\n        this._editor.revealRangeInCenterIfOutsideViewport(match, 0 /* ScrollType.Smooth */);\n    }\n    _prevSearchPosition(before) {\n        const isUsingLineStops = this._state.isRegex && (this._state.searchString.indexOf('^') >= 0\n            || this._state.searchString.indexOf('$') >= 0);\n        let { lineNumber, column } = before;\n        const model = this._editor.getModel();\n        if (isUsingLineStops || column === 1) {\n            if (lineNumber === 1) {\n                lineNumber = model.getLineCount();\n            }\n            else {\n                lineNumber--;\n            }\n            column = model.getLineMaxColumn(lineNumber);\n        }\n        else {\n            column--;\n        }\n        return new Position(lineNumber, column);\n    }\n    _moveToPrevMatch(before, isRecursed = false) {\n        if (!this._state.canNavigateBack()) {\n            // we are beyond the first matched find result\n            // instead of doing nothing, we should refocus the first item\n            const nextMatchRange = this._decorations.matchAfterPosition(before);\n            if (nextMatchRange) {\n                this._setCurrentFindMatch(nextMatchRange);\n            }\n            return;\n        }\n        if (this._decorations.getCount() < MATCHES_LIMIT) {\n            let prevMatchRange = this._decorations.matchBeforePosition(before);\n            if (prevMatchRange && prevMatchRange.isEmpty() && prevMatchRange.getStartPosition().equals(before)) {\n                before = this._prevSearchPosition(before);\n                prevMatchRange = this._decorations.matchBeforePosition(before);\n            }\n            if (prevMatchRange) {\n                this._setCurrentFindMatch(prevMatchRange);\n            }\n            return;\n        }\n        if (this._cannotFind()) {\n            return;\n        }\n        const findScope = this._decorations.getFindScope();\n        const searchRange = FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(), findScope);\n        // ...(----)...|...\n        if (searchRange.getEndPosition().isBefore(before)) {\n            before = searchRange.getEndPosition();\n        }\n        // ...|...(----)...\n        if (before.isBefore(searchRange.getStartPosition())) {\n            before = searchRange.getEndPosition();\n        }\n        const { lineNumber, column } = before;\n        const model = this._editor.getModel();\n        let position = new Position(lineNumber, column);\n        let prevMatch = model.findPreviousMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(132 /* EditorOption.wordSeparators */) : null, false);\n        if (prevMatch && prevMatch.range.isEmpty() && prevMatch.range.getStartPosition().equals(position)) {\n            // Looks like we're stuck at this position, unacceptable!\n            position = this._prevSearchPosition(position);\n            prevMatch = model.findPreviousMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(132 /* EditorOption.wordSeparators */) : null, false);\n        }\n        if (!prevMatch) {\n            // there is precisely one match and selection is on top of it\n            return;\n        }\n        if (!isRecursed && !searchRange.containsRange(prevMatch.range)) {\n            return this._moveToPrevMatch(prevMatch.range.getStartPosition(), true);\n        }\n        this._setCurrentFindMatch(prevMatch.range);\n    }\n    moveToPrevMatch() {\n        this._moveToPrevMatch(this._editor.getSelection().getStartPosition());\n    }\n    _nextSearchPosition(after) {\n        const isUsingLineStops = this._state.isRegex && (this._state.searchString.indexOf('^') >= 0\n            || this._state.searchString.indexOf('$') >= 0);\n        let { lineNumber, column } = after;\n        const model = this._editor.getModel();\n        if (isUsingLineStops || column === model.getLineMaxColumn(lineNumber)) {\n            if (lineNumber === model.getLineCount()) {\n                lineNumber = 1;\n            }\n            else {\n                lineNumber++;\n            }\n            column = 1;\n        }\n        else {\n            column++;\n        }\n        return new Position(lineNumber, column);\n    }\n    _moveToNextMatch(after) {\n        if (!this._state.canNavigateForward()) {\n            // we are beyond the last matched find result\n            // instead of doing nothing, we should refocus the last item\n            const prevMatchRange = this._decorations.matchBeforePosition(after);\n            if (prevMatchRange) {\n                this._setCurrentFindMatch(prevMatchRange);\n            }\n            return;\n        }\n        if (this._decorations.getCount() < MATCHES_LIMIT) {\n            let nextMatchRange = this._decorations.matchAfterPosition(after);\n            if (nextMatchRange && nextMatchRange.isEmpty() && nextMatchRange.getStartPosition().equals(after)) {\n                // Looks like we're stuck at this position, unacceptable!\n                after = this._nextSearchPosition(after);\n                nextMatchRange = this._decorations.matchAfterPosition(after);\n            }\n            if (nextMatchRange) {\n                this._setCurrentFindMatch(nextMatchRange);\n            }\n            return;\n        }\n        const nextMatch = this._getNextMatch(after, false, true);\n        if (nextMatch) {\n            this._setCurrentFindMatch(nextMatch.range);\n        }\n    }\n    _getNextMatch(after, captureMatches, forceMove, isRecursed = false) {\n        if (this._cannotFind()) {\n            return null;\n        }\n        const findScope = this._decorations.getFindScope();\n        const searchRange = FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(), findScope);\n        // ...(----)...|...\n        if (searchRange.getEndPosition().isBefore(after)) {\n            after = searchRange.getStartPosition();\n        }\n        // ...|...(----)...\n        if (after.isBefore(searchRange.getStartPosition())) {\n            after = searchRange.getStartPosition();\n        }\n        const { lineNumber, column } = after;\n        const model = this._editor.getModel();\n        let position = new Position(lineNumber, column);\n        let nextMatch = model.findNextMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(132 /* EditorOption.wordSeparators */) : null, captureMatches);\n        if (forceMove && nextMatch && nextMatch.range.isEmpty() && nextMatch.range.getStartPosition().equals(position)) {\n            // Looks like we're stuck at this position, unacceptable!\n            position = this._nextSearchPosition(position);\n            nextMatch = model.findNextMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(132 /* EditorOption.wordSeparators */) : null, captureMatches);\n        }\n        if (!nextMatch) {\n            // there is precisely one match and selection is on top of it\n            return null;\n        }\n        if (!isRecursed && !searchRange.containsRange(nextMatch.range)) {\n            return this._getNextMatch(nextMatch.range.getEndPosition(), captureMatches, forceMove, true);\n        }\n        return nextMatch;\n    }\n    moveToNextMatch() {\n        this._moveToNextMatch(this._editor.getSelection().getEndPosition());\n    }\n    _moveToMatch(index) {\n        const decorationRange = this._decorations.getDecorationRangeAt(index);\n        if (decorationRange) {\n            this._setCurrentFindMatch(decorationRange);\n        }\n    }\n    moveToMatch(index) {\n        this._moveToMatch(index);\n    }\n    _getReplacePattern() {\n        if (this._state.isRegex) {\n            return parseReplaceString(this._state.replaceString);\n        }\n        return ReplacePattern.fromStaticValue(this._state.replaceString);\n    }\n    replace() {\n        if (!this._hasMatches()) {\n            return;\n        }\n        const replacePattern = this._getReplacePattern();\n        const selection = this._editor.getSelection();\n        const nextMatch = this._getNextMatch(selection.getStartPosition(), true, false);\n        if (nextMatch) {\n            if (selection.equalsRange(nextMatch.range)) {\n                // selection sits on a find match => replace it!\n                const replaceString = replacePattern.buildReplaceString(nextMatch.matches, this._state.preserveCase);\n                const command = new ReplaceCommand(selection, replaceString);\n                this._executeEditorCommand('replace', command);\n                this._decorations.setStartPosition(new Position(selection.startLineNumber, selection.startColumn + replaceString.length));\n                this.research(true);\n            }\n            else {\n                this._decorations.setStartPosition(this._editor.getPosition());\n                this._setCurrentFindMatch(nextMatch.range);\n            }\n        }\n    }\n    _findMatches(findScopes, captureMatches, limitResultCount) {\n        const searchRanges = (findScopes || [null]).map((scope) => FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(), scope));\n        return this._editor.getModel().findMatches(this._state.searchString, searchRanges, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(132 /* EditorOption.wordSeparators */) : null, captureMatches, limitResultCount);\n    }\n    replaceAll() {\n        if (!this._hasMatches()) {\n            return;\n        }\n        const findScopes = this._decorations.getFindScopes();\n        if (findScopes === null && this._state.matchesCount >= MATCHES_LIMIT) {\n            // Doing a replace on the entire file that is over ${MATCHES_LIMIT} matches\n            this._largeReplaceAll();\n        }\n        else {\n            this._regularReplaceAll(findScopes);\n        }\n        this.research(false);\n    }\n    _largeReplaceAll() {\n        const searchParams = new SearchParams(this._state.searchString, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(132 /* EditorOption.wordSeparators */) : null);\n        const searchData = searchParams.parseSearchRequest();\n        if (!searchData) {\n            return;\n        }\n        let searchRegex = searchData.regex;\n        if (!searchRegex.multiline) {\n            let mod = 'mu';\n            if (searchRegex.ignoreCase) {\n                mod += 'i';\n            }\n            if (searchRegex.global) {\n                mod += 'g';\n            }\n            searchRegex = new RegExp(searchRegex.source, mod);\n        }\n        const model = this._editor.getModel();\n        const modelText = model.getValue(1 /* EndOfLinePreference.LF */);\n        const fullModelRange = model.getFullModelRange();\n        const replacePattern = this._getReplacePattern();\n        let resultText;\n        const preserveCase = this._state.preserveCase;\n        if (replacePattern.hasReplacementPatterns || preserveCase) {\n            resultText = modelText.replace(searchRegex, function () {\n                return replacePattern.buildReplaceString(arguments, preserveCase);\n            });\n        }\n        else {\n            resultText = modelText.replace(searchRegex, replacePattern.buildReplaceString(null, preserveCase));\n        }\n        const command = new ReplaceCommandThatPreservesSelection(fullModelRange, resultText, this._editor.getSelection());\n        this._executeEditorCommand('replaceAll', command);\n    }\n    _regularReplaceAll(findScopes) {\n        const replacePattern = this._getReplacePattern();\n        // Get all the ranges (even more than the highlighted ones)\n        const matches = this._findMatches(findScopes, replacePattern.hasReplacementPatterns || this._state.preserveCase, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n        const replaceStrings = [];\n        for (let i = 0, len = matches.length; i < len; i++) {\n            replaceStrings[i] = replacePattern.buildReplaceString(matches[i].matches, this._state.preserveCase);\n        }\n        const command = new ReplaceAllCommand(this._editor.getSelection(), matches.map(m => m.range), replaceStrings);\n        this._executeEditorCommand('replaceAll', command);\n    }\n    selectAllMatches() {\n        if (!this._hasMatches()) {\n            return;\n        }\n        const findScopes = this._decorations.getFindScopes();\n        // Get all the ranges (even more than the highlighted ones)\n        const matches = this._findMatches(findScopes, false, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n        let selections = matches.map(m => new Selection(m.range.startLineNumber, m.range.startColumn, m.range.endLineNumber, m.range.endColumn));\n        // If one of the ranges is the editor selection, then maintain it as primary\n        const editorSelection = this._editor.getSelection();\n        for (let i = 0, len = selections.length; i < len; i++) {\n            const sel = selections[i];\n            if (sel.equalsRange(editorSelection)) {\n                selections = [editorSelection].concat(selections.slice(0, i)).concat(selections.slice(i + 1));\n                break;\n            }\n        }\n        this._editor.setSelections(selections);\n    }\n    _executeEditorCommand(source, command) {\n        try {\n            this._ignoreModelContentChanged = true;\n            this._editor.pushUndoStop();\n            this._editor.executeCommand(source, command);\n            this._editor.pushUndoStop();\n        }\n        finally {\n            this._ignoreModelContentChanged = false;\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport './findOptionsWidget.css';\nimport { CaseSensitiveToggle, RegexToggle, WholeWordsToggle } from '../../../../base/browser/ui/findinput/findInputToggles.js';\nimport { Widget } from '../../../../base/browser/ui/widget.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { FIND_IDS } from './findModel.js';\nimport { asCssVariable, inputActiveOptionBackground, inputActiveOptionBorder, inputActiveOptionForeground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { createInstantHoverDelegate } from '../../../../base/browser/ui/hover/hoverDelegateFactory.js';\nexport class FindOptionsWidget extends Widget {\n    static { this.ID = 'editor.contrib.findOptionsWidget'; }\n    constructor(editor, state, keybindingService) {\n        super();\n        this._hideSoon = this._register(new RunOnceScheduler(() => this._hide(), 2000));\n        this._isVisible = false;\n        this._editor = editor;\n        this._state = state;\n        this._keybindingService = keybindingService;\n        this._domNode = document.createElement('div');\n        this._domNode.className = 'findOptionsWidget';\n        this._domNode.style.display = 'none';\n        this._domNode.style.top = '10px';\n        this._domNode.style.zIndex = '12';\n        this._domNode.setAttribute('role', 'presentation');\n        this._domNode.setAttribute('aria-hidden', 'true');\n        const toggleStyles = {\n            inputActiveOptionBorder: asCssVariable(inputActiveOptionBorder),\n            inputActiveOptionForeground: asCssVariable(inputActiveOptionForeground),\n            inputActiveOptionBackground: asCssVariable(inputActiveOptionBackground),\n        };\n        const hoverDelegate = this._register(createInstantHoverDelegate());\n        this.caseSensitive = this._register(new CaseSensitiveToggle({\n            appendTitle: this._keybindingLabelFor(FIND_IDS.ToggleCaseSensitiveCommand),\n            isChecked: this._state.matchCase,\n            hoverDelegate,\n            ...toggleStyles\n        }));\n        this._domNode.appendChild(this.caseSensitive.domNode);\n        this._register(this.caseSensitive.onChange(() => {\n            this._state.change({\n                matchCase: this.caseSensitive.checked\n            }, false);\n        }));\n        this.wholeWords = this._register(new WholeWordsToggle({\n            appendTitle: this._keybindingLabelFor(FIND_IDS.ToggleWholeWordCommand),\n            isChecked: this._state.wholeWord,\n            hoverDelegate,\n            ...toggleStyles\n        }));\n        this._domNode.appendChild(this.wholeWords.domNode);\n        this._register(this.wholeWords.onChange(() => {\n            this._state.change({\n                wholeWord: this.wholeWords.checked\n            }, false);\n        }));\n        this.regex = this._register(new RegexToggle({\n            appendTitle: this._keybindingLabelFor(FIND_IDS.ToggleRegexCommand),\n            isChecked: this._state.isRegex,\n            hoverDelegate,\n            ...toggleStyles\n        }));\n        this._domNode.appendChild(this.regex.domNode);\n        this._register(this.regex.onChange(() => {\n            this._state.change({\n                isRegex: this.regex.checked\n            }, false);\n        }));\n        this._editor.addOverlayWidget(this);\n        this._register(this._state.onFindReplaceStateChange((e) => {\n            let somethingChanged = false;\n            if (e.isRegex) {\n                this.regex.checked = this._state.isRegex;\n                somethingChanged = true;\n            }\n            if (e.wholeWord) {\n                this.wholeWords.checked = this._state.wholeWord;\n                somethingChanged = true;\n            }\n            if (e.matchCase) {\n                this.caseSensitive.checked = this._state.matchCase;\n                somethingChanged = true;\n            }\n            if (!this._state.isRevealed && somethingChanged) {\n                this._revealTemporarily();\n            }\n        }));\n        this._register(dom.addDisposableListener(this._domNode, dom.EventType.MOUSE_LEAVE, (e) => this._onMouseLeave()));\n        this._register(dom.addDisposableListener(this._domNode, 'mouseover', (e) => this._onMouseOver()));\n    }\n    _keybindingLabelFor(actionId) {\n        const kb = this._keybindingService.lookupKeybinding(actionId);\n        if (!kb) {\n            return '';\n        }\n        return ` (${kb.getLabel()})`;\n    }\n    dispose() {\n        this._editor.removeOverlayWidget(this);\n        super.dispose();\n    }\n    // ----- IOverlayWidget API\n    getId() {\n        return FindOptionsWidget.ID;\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        return {\n            preference: 0 /* OverlayWidgetPositionPreference.TOP_RIGHT_CORNER */\n        };\n    }\n    highlightFindOptions() {\n        this._revealTemporarily();\n    }\n    _revealTemporarily() {\n        this._show();\n        this._hideSoon.schedule();\n    }\n    _onMouseLeave() {\n        this._hideSoon.schedule();\n    }\n    _onMouseOver() {\n        this._hideSoon.cancel();\n    }\n    _show() {\n        if (this._isVisible) {\n            return;\n        }\n        this._isVisible = true;\n        this._domNode.style.display = 'block';\n    }\n    _hide() {\n        if (!this._isVisible) {\n            return;\n        }\n        this._isVisible = false;\n        this._domNode.style.display = 'none';\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Range } from '../../../common/core/range.js';\nimport { MATCHES_LIMIT } from './findModel.js';\nfunction effectiveOptionValue(override, value) {\n    if (override === 1 /* FindOptionOverride.True */) {\n        return true;\n    }\n    if (override === 2 /* FindOptionOverride.False */) {\n        return false;\n    }\n    return value;\n}\nexport class FindReplaceState extends Disposable {\n    get searchString() { return this._searchString; }\n    get replaceString() { return this._replaceString; }\n    get isRevealed() { return this._isRevealed; }\n    get isReplaceRevealed() { return this._isReplaceRevealed; }\n    get isRegex() { return effectiveOptionValue(this._isRegexOverride, this._isRegex); }\n    get wholeWord() { return effectiveOptionValue(this._wholeWordOverride, this._wholeWord); }\n    get matchCase() { return effectiveOptionValue(this._matchCaseOverride, this._matchCase); }\n    get preserveCase() { return effectiveOptionValue(this._preserveCaseOverride, this._preserveCase); }\n    get actualIsRegex() { return this._isRegex; }\n    get actualWholeWord() { return this._wholeWord; }\n    get actualMatchCase() { return this._matchCase; }\n    get actualPreserveCase() { return this._preserveCase; }\n    get searchScope() { return this._searchScope; }\n    get matchesPosition() { return this._matchesPosition; }\n    get matchesCount() { return this._matchesCount; }\n    get currentMatch() { return this._currentMatch; }\n    constructor() {\n        super();\n        this._onFindReplaceStateChange = this._register(new Emitter());\n        this.onFindReplaceStateChange = this._onFindReplaceStateChange.event;\n        this._searchString = '';\n        this._replaceString = '';\n        this._isRevealed = false;\n        this._isReplaceRevealed = false;\n        this._isRegex = false;\n        this._isRegexOverride = 0 /* FindOptionOverride.NotSet */;\n        this._wholeWord = false;\n        this._wholeWordOverride = 0 /* FindOptionOverride.NotSet */;\n        this._matchCase = false;\n        this._matchCaseOverride = 0 /* FindOptionOverride.NotSet */;\n        this._preserveCase = false;\n        this._preserveCaseOverride = 0 /* FindOptionOverride.NotSet */;\n        this._searchScope = null;\n        this._matchesPosition = 0;\n        this._matchesCount = 0;\n        this._currentMatch = null;\n        this._loop = true;\n        this._isSearching = false;\n        this._filters = null;\n    }\n    changeMatchInfo(matchesPosition, matchesCount, currentMatch) {\n        const changeEvent = {\n            moveCursor: false,\n            updateHistory: false,\n            searchString: false,\n            replaceString: false,\n            isRevealed: false,\n            isReplaceRevealed: false,\n            isRegex: false,\n            wholeWord: false,\n            matchCase: false,\n            preserveCase: false,\n            searchScope: false,\n            matchesPosition: false,\n            matchesCount: false,\n            currentMatch: false,\n            loop: false,\n            isSearching: false,\n            filters: false\n        };\n        let somethingChanged = false;\n        if (matchesCount === 0) {\n            matchesPosition = 0;\n        }\n        if (matchesPosition > matchesCount) {\n            matchesPosition = matchesCount;\n        }\n        if (this._matchesPosition !== matchesPosition) {\n            this._matchesPosition = matchesPosition;\n            changeEvent.matchesPosition = true;\n            somethingChanged = true;\n        }\n        if (this._matchesCount !== matchesCount) {\n            this._matchesCount = matchesCount;\n            changeEvent.matchesCount = true;\n            somethingChanged = true;\n        }\n        if (typeof currentMatch !== 'undefined') {\n            if (!Range.equalsRange(this._currentMatch, currentMatch)) {\n                this._currentMatch = currentMatch;\n                changeEvent.currentMatch = true;\n                somethingChanged = true;\n            }\n        }\n        if (somethingChanged) {\n            this._onFindReplaceStateChange.fire(changeEvent);\n        }\n    }\n    change(newState, moveCursor, updateHistory = true) {\n        const changeEvent = {\n            moveCursor: moveCursor,\n            updateHistory: updateHistory,\n            searchString: false,\n            replaceString: false,\n            isRevealed: false,\n            isReplaceRevealed: false,\n            isRegex: false,\n            wholeWord: false,\n            matchCase: false,\n            preserveCase: false,\n            searchScope: false,\n            matchesPosition: false,\n            matchesCount: false,\n            currentMatch: false,\n            loop: false,\n            isSearching: false,\n            filters: false\n        };\n        let somethingChanged = false;\n        const oldEffectiveIsRegex = this.isRegex;\n        const oldEffectiveWholeWords = this.wholeWord;\n        const oldEffectiveMatchCase = this.matchCase;\n        const oldEffectivePreserveCase = this.preserveCase;\n        if (typeof newState.searchString !== 'undefined') {\n            if (this._searchString !== newState.searchString) {\n                this._searchString = newState.searchString;\n                changeEvent.searchString = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.replaceString !== 'undefined') {\n            if (this._replaceString !== newState.replaceString) {\n                this._replaceString = newState.replaceString;\n                changeEvent.replaceString = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.isRevealed !== 'undefined') {\n            if (this._isRevealed !== newState.isRevealed) {\n                this._isRevealed = newState.isRevealed;\n                changeEvent.isRevealed = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.isReplaceRevealed !== 'undefined') {\n            if (this._isReplaceRevealed !== newState.isReplaceRevealed) {\n                this._isReplaceRevealed = newState.isReplaceRevealed;\n                changeEvent.isReplaceRevealed = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.isRegex !== 'undefined') {\n            this._isRegex = newState.isRegex;\n        }\n        if (typeof newState.wholeWord !== 'undefined') {\n            this._wholeWord = newState.wholeWord;\n        }\n        if (typeof newState.matchCase !== 'undefined') {\n            this._matchCase = newState.matchCase;\n        }\n        if (typeof newState.preserveCase !== 'undefined') {\n            this._preserveCase = newState.preserveCase;\n        }\n        if (typeof newState.searchScope !== 'undefined') {\n            if (!newState.searchScope?.every((newSearchScope) => {\n                return this._searchScope?.some(existingSearchScope => {\n                    return !Range.equalsRange(existingSearchScope, newSearchScope);\n                });\n            })) {\n                this._searchScope = newState.searchScope;\n                changeEvent.searchScope = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.loop !== 'undefined') {\n            if (this._loop !== newState.loop) {\n                this._loop = newState.loop;\n                changeEvent.loop = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.isSearching !== 'undefined') {\n            if (this._isSearching !== newState.isSearching) {\n                this._isSearching = newState.isSearching;\n                changeEvent.isSearching = true;\n                somethingChanged = true;\n            }\n        }\n        if (typeof newState.filters !== 'undefined') {\n            if (this._filters) {\n                this._filters.update(newState.filters);\n            }\n            else {\n                this._filters = newState.filters;\n            }\n            changeEvent.filters = true;\n            somethingChanged = true;\n        }\n        // Overrides get set when they explicitly come in and get reset anytime something else changes\n        this._isRegexOverride = (typeof newState.isRegexOverride !== 'undefined' ? newState.isRegexOverride : 0 /* FindOptionOverride.NotSet */);\n        this._wholeWordOverride = (typeof newState.wholeWordOverride !== 'undefined' ? newState.wholeWordOverride : 0 /* FindOptionOverride.NotSet */);\n        this._matchCaseOverride = (typeof newState.matchCaseOverride !== 'undefined' ? newState.matchCaseOverride : 0 /* FindOptionOverride.NotSet */);\n        this._preserveCaseOverride = (typeof newState.preserveCaseOverride !== 'undefined' ? newState.preserveCaseOverride : 0 /* FindOptionOverride.NotSet */);\n        if (oldEffectiveIsRegex !== this.isRegex) {\n            somethingChanged = true;\n            changeEvent.isRegex = true;\n        }\n        if (oldEffectiveWholeWords !== this.wholeWord) {\n            somethingChanged = true;\n            changeEvent.wholeWord = true;\n        }\n        if (oldEffectiveMatchCase !== this.matchCase) {\n            somethingChanged = true;\n            changeEvent.matchCase = true;\n        }\n        if (oldEffectivePreserveCase !== this.preserveCase) {\n            somethingChanged = true;\n            changeEvent.preserveCase = true;\n        }\n        if (somethingChanged) {\n            this._onFindReplaceStateChange.fire(changeEvent);\n        }\n    }\n    canNavigateBack() {\n        return this.canNavigateInLoop() || (this.matchesPosition !== 1);\n    }\n    canNavigateForward() {\n        return this.canNavigateInLoop() || (this.matchesPosition < this.matchesCount);\n    }\n    canNavigateInLoop() {\n        return this._loop || (this.matchesCount >= MATCHES_LIMIT);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { alert as alertFn } from '../../../../base/browser/ui/aria/aria.js';\nimport { Toggle } from '../../../../base/browser/ui/toggle/toggle.js';\nimport { Sash } from '../../../../base/browser/ui/sash/sash.js';\nimport { Widget } from '../../../../base/browser/ui/widget.js';\nimport { Delayer } from '../../../../base/common/async.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { toDisposable } from '../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport './findWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { CONTEXT_FIND_INPUT_FOCUSED, CONTEXT_REPLACE_INPUT_FOCUSED, FIND_IDS, MATCHES_LIMIT } from './findModel.js';\nimport * as nls from '../../../../nls.js';\nimport { ContextScopedFindInput, ContextScopedReplaceInput } from '../../../../platform/history/browser/contextScopedHistoryWidget.js';\nimport { showHistoryKeybindingHint } from '../../../../platform/history/browser/historyWidgetKeybindingHint.js';\nimport { asCssVariable, contrastBorder, editorFindMatchForeground, editorFindMatchHighlightBorder, editorFindMatchHighlightForeground, editorFindRangeHighlightBorder, inputActiveOptionBackground, inputActiveOptionBorder, inputActiveOptionForeground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerIcon, widgetClose } from '../../../../platform/theme/common/iconRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nimport { assertIsDefined } from '../../../../base/common/types.js';\nimport { defaultInputBoxStyles, defaultToggleStyles } from '../../../../platform/theme/browser/defaultStyles.js';\nimport { createInstantHoverDelegate, getDefaultHoverDelegate } from '../../../../base/browser/ui/hover/hoverDelegateFactory.js';\nconst findCollapsedIcon = registerIcon('find-collapsed', Codicon.chevronRight, nls.localize('findCollapsedIcon', 'Icon to indicate that the editor find widget is collapsed.'));\nconst findExpandedIcon = registerIcon('find-expanded', Codicon.chevronDown, nls.localize('findExpandedIcon', 'Icon to indicate that the editor find widget is expanded.'));\nexport const findSelectionIcon = registerIcon('find-selection', Codicon.selection, nls.localize('findSelectionIcon', 'Icon for \\'Find in Selection\\' in the editor find widget.'));\nexport const findReplaceIcon = registerIcon('find-replace', Codicon.replace, nls.localize('findReplaceIcon', 'Icon for \\'Replace\\' in the editor find widget.'));\nexport const findReplaceAllIcon = registerIcon('find-replace-all', Codicon.replaceAll, nls.localize('findReplaceAllIcon', 'Icon for \\'Replace All\\' in the editor find widget.'));\nexport const findPreviousMatchIcon = registerIcon('find-previous-match', Codicon.arrowUp, nls.localize('findPreviousMatchIcon', 'Icon for \\'Find Previous\\' in the editor find widget.'));\nexport const findNextMatchIcon = registerIcon('find-next-match', Codicon.arrowDown, nls.localize('findNextMatchIcon', 'Icon for \\'Find Next\\' in the editor find widget.'));\nconst NLS_FIND_DIALOG_LABEL = nls.localize('label.findDialog', \"Find / Replace\");\nconst NLS_FIND_INPUT_LABEL = nls.localize('label.find', \"Find\");\nconst NLS_FIND_INPUT_PLACEHOLDER = nls.localize('placeholder.find', \"Find\");\nconst NLS_PREVIOUS_MATCH_BTN_LABEL = nls.localize('label.previousMatchButton', \"Previous Match\");\nconst NLS_NEXT_MATCH_BTN_LABEL = nls.localize('label.nextMatchButton', \"Next Match\");\nconst NLS_TOGGLE_SELECTION_FIND_TITLE = nls.localize('label.toggleSelectionFind', \"Find in Selection\");\nconst NLS_CLOSE_BTN_LABEL = nls.localize('label.closeButton', \"Close\");\nconst NLS_REPLACE_INPUT_LABEL = nls.localize('label.replace', \"Replace\");\nconst NLS_REPLACE_INPUT_PLACEHOLDER = nls.localize('placeholder.replace', \"Replace\");\nconst NLS_REPLACE_BTN_LABEL = nls.localize('label.replaceButton', \"Replace\");\nconst NLS_REPLACE_ALL_BTN_LABEL = nls.localize('label.replaceAllButton', \"Replace All\");\nconst NLS_TOGGLE_REPLACE_MODE_BTN_LABEL = nls.localize('label.toggleReplaceButton', \"Toggle Replace\");\nconst NLS_MATCHES_COUNT_LIMIT_TITLE = nls.localize('title.matchesCountLimit', \"Only the first {0} results are highlighted, but all find operations work on the entire text.\", MATCHES_LIMIT);\nexport const NLS_MATCHES_LOCATION = nls.localize('label.matchesLocation', \"{0} of {1}\");\nexport const NLS_NO_RESULTS = nls.localize('label.noResults', \"No results\");\nconst FIND_WIDGET_INITIAL_WIDTH = 419;\nconst PART_WIDTH = 275;\nconst FIND_INPUT_AREA_WIDTH = PART_WIDTH - 54;\nlet MAX_MATCHES_COUNT_WIDTH = 69;\n// let FIND_ALL_CONTROLS_WIDTH = 17/** Find Input margin-left */ + (MAX_MATCHES_COUNT_WIDTH + 3 + 1) /** Match Results */ + 23 /** Button */ * 4 + 2/** sash */;\nconst FIND_INPUT_AREA_HEIGHT = 33; // The height of Find Widget when Replace Input is not visible.\nconst ctrlEnterReplaceAllWarningPromptedKey = 'ctrlEnterReplaceAll.windows.donotask';\nconst ctrlKeyMod = (platform.isMacintosh ? 256 /* KeyMod.WinCtrl */ : 2048 /* KeyMod.CtrlCmd */);\nexport class FindWidgetViewZone {\n    constructor(afterLineNumber) {\n        this.afterLineNumber = afterLineNumber;\n        this.heightInPx = FIND_INPUT_AREA_HEIGHT;\n        this.suppressMouseDown = false;\n        this.domNode = document.createElement('div');\n        this.domNode.className = 'dock-find-viewzone';\n    }\n}\nfunction stopPropagationForMultiLineUpwards(event, value, textarea) {\n    const isMultiline = !!value.match(/\\n/);\n    if (textarea && isMultiline && textarea.selectionStart > 0) {\n        event.stopPropagation();\n        return;\n    }\n}\nfunction stopPropagationForMultiLineDownwards(event, value, textarea) {\n    const isMultiline = !!value.match(/\\n/);\n    if (textarea && isMultiline && textarea.selectionEnd < textarea.value.length) {\n        event.stopPropagation();\n        return;\n    }\n}\nexport class FindWidget extends Widget {\n    static { this.ID = 'editor.contrib.findWidget'; }\n    constructor(codeEditor, controller, state, contextViewProvider, keybindingService, contextKeyService, themeService, storageService, notificationService, _hoverService) {\n        super();\n        this._hoverService = _hoverService;\n        this._cachedHeight = null;\n        this._revealTimeouts = [];\n        this._codeEditor = codeEditor;\n        this._controller = controller;\n        this._state = state;\n        this._contextViewProvider = contextViewProvider;\n        this._keybindingService = keybindingService;\n        this._contextKeyService = contextKeyService;\n        this._storageService = storageService;\n        this._notificationService = notificationService;\n        this._ctrlEnterReplaceAllWarningPrompted = !!storageService.getBoolean(ctrlEnterReplaceAllWarningPromptedKey, 0 /* StorageScope.PROFILE */);\n        this._isVisible = false;\n        this._isReplaceVisible = false;\n        this._ignoreChangeEvent = false;\n        this._updateHistoryDelayer = new Delayer(500);\n        this._register(toDisposable(() => this._updateHistoryDelayer.cancel()));\n        this._register(this._state.onFindReplaceStateChange((e) => this._onStateChanged(e)));\n        this._buildDomNode();\n        this._updateButtons();\n        this._tryUpdateWidgetWidth();\n        this._findInput.inputBox.layout();\n        this._register(this._codeEditor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(92 /* EditorOption.readOnly */)) {\n                if (this._codeEditor.getOption(92 /* EditorOption.readOnly */)) {\n                    // Hide replace part if editor becomes read only\n                    this._state.change({ isReplaceRevealed: false }, false);\n                }\n                this._updateButtons();\n            }\n            if (e.hasChanged(146 /* EditorOption.layoutInfo */)) {\n                this._tryUpdateWidgetWidth();\n            }\n            if (e.hasChanged(2 /* EditorOption.accessibilitySupport */)) {\n                this.updateAccessibilitySupport();\n            }\n            if (e.hasChanged(41 /* EditorOption.find */)) {\n                const supportLoop = this._codeEditor.getOption(41 /* EditorOption.find */).loop;\n                this._state.change({ loop: supportLoop }, false);\n                const addExtraSpaceOnTop = this._codeEditor.getOption(41 /* EditorOption.find */).addExtraSpaceOnTop;\n                if (addExtraSpaceOnTop && !this._viewZone) {\n                    this._viewZone = new FindWidgetViewZone(0);\n                    this._showViewZone();\n                }\n                if (!addExtraSpaceOnTop && this._viewZone) {\n                    this._removeViewZone();\n                }\n            }\n        }));\n        this.updateAccessibilitySupport();\n        this._register(this._codeEditor.onDidChangeCursorSelection(() => {\n            if (this._isVisible) {\n                this._updateToggleSelectionFindButton();\n            }\n        }));\n        this._register(this._codeEditor.onDidFocusEditorWidget(async () => {\n            if (this._isVisible) {\n                const globalBufferTerm = await this._controller.getGlobalBufferTerm();\n                if (globalBufferTerm && globalBufferTerm !== this._state.searchString) {\n                    this._state.change({ searchString: globalBufferTerm }, false);\n                    this._findInput.select();\n                }\n            }\n        }));\n        this._findInputFocused = CONTEXT_FIND_INPUT_FOCUSED.bindTo(contextKeyService);\n        this._findFocusTracker = this._register(dom.trackFocus(this._findInput.inputBox.inputElement));\n        this._register(this._findFocusTracker.onDidFocus(() => {\n            this._findInputFocused.set(true);\n            this._updateSearchScope();\n        }));\n        this._register(this._findFocusTracker.onDidBlur(() => {\n            this._findInputFocused.set(false);\n        }));\n        this._replaceInputFocused = CONTEXT_REPLACE_INPUT_FOCUSED.bindTo(contextKeyService);\n        this._replaceFocusTracker = this._register(dom.trackFocus(this._replaceInput.inputBox.inputElement));\n        this._register(this._replaceFocusTracker.onDidFocus(() => {\n            this._replaceInputFocused.set(true);\n            this._updateSearchScope();\n        }));\n        this._register(this._replaceFocusTracker.onDidBlur(() => {\n            this._replaceInputFocused.set(false);\n        }));\n        this._codeEditor.addOverlayWidget(this);\n        if (this._codeEditor.getOption(41 /* EditorOption.find */).addExtraSpaceOnTop) {\n            this._viewZone = new FindWidgetViewZone(0); // Put it before the first line then users can scroll beyond the first line.\n        }\n        this._register(this._codeEditor.onDidChangeModel(() => {\n            if (!this._isVisible) {\n                return;\n            }\n            this._viewZoneId = undefined;\n        }));\n        this._register(this._codeEditor.onDidScrollChange((e) => {\n            if (e.scrollTopChanged) {\n                this._layoutViewZone();\n                return;\n            }\n            // for other scroll changes, layout the viewzone in next tick to avoid ruining current rendering.\n            setTimeout(() => {\n                this._layoutViewZone();\n            }, 0);\n        }));\n    }\n    // ----- IOverlayWidget API\n    getId() {\n        return FindWidget.ID;\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        if (this._isVisible) {\n            return {\n                preference: 0 /* OverlayWidgetPositionPreference.TOP_RIGHT_CORNER */\n            };\n        }\n        return null;\n    }\n    // ----- React to state changes\n    _onStateChanged(e) {\n        if (e.searchString) {\n            try {\n                this._ignoreChangeEvent = true;\n                this._findInput.setValue(this._state.searchString);\n            }\n            finally {\n                this._ignoreChangeEvent = false;\n            }\n            this._updateButtons();\n        }\n        if (e.replaceString) {\n            this._replaceInput.inputBox.value = this._state.replaceString;\n        }\n        if (e.isRevealed) {\n            if (this._state.isRevealed) {\n                this._reveal();\n            }\n            else {\n                this._hide(true);\n            }\n        }\n        if (e.isReplaceRevealed) {\n            if (this._state.isReplaceRevealed) {\n                if (!this._codeEditor.getOption(92 /* EditorOption.readOnly */) && !this._isReplaceVisible) {\n                    this._isReplaceVisible = true;\n                    this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\n                    this._updateButtons();\n                    this._replaceInput.inputBox.layout();\n                }\n            }\n            else {\n                if (this._isReplaceVisible) {\n                    this._isReplaceVisible = false;\n                    this._updateButtons();\n                }\n            }\n        }\n        if ((e.isRevealed || e.isReplaceRevealed) && (this._state.isRevealed || this._state.isReplaceRevealed)) {\n            if (this._tryUpdateHeight()) {\n                this._showViewZone();\n            }\n        }\n        if (e.isRegex) {\n            this._findInput.setRegex(this._state.isRegex);\n        }\n        if (e.wholeWord) {\n            this._findInput.setWholeWords(this._state.wholeWord);\n        }\n        if (e.matchCase) {\n            this._findInput.setCaseSensitive(this._state.matchCase);\n        }\n        if (e.preserveCase) {\n            this._replaceInput.setPreserveCase(this._state.preserveCase);\n        }\n        if (e.searchScope) {\n            if (this._state.searchScope) {\n                this._toggleSelectionFind.checked = true;\n            }\n            else {\n                this._toggleSelectionFind.checked = false;\n            }\n            this._updateToggleSelectionFindButton();\n        }\n        if (e.searchString || e.matchesCount || e.matchesPosition) {\n            const showRedOutline = (this._state.searchString.length > 0 && this._state.matchesCount === 0);\n            this._domNode.classList.toggle('no-results', showRedOutline);\n            this._updateMatchesCount();\n            this._updateButtons();\n        }\n        if (e.searchString || e.currentMatch) {\n            this._layoutViewZone();\n        }\n        if (e.updateHistory) {\n            this._delayedUpdateHistory();\n        }\n        if (e.loop) {\n            this._updateButtons();\n        }\n    }\n    _delayedUpdateHistory() {\n        this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(undefined, onUnexpectedError);\n    }\n    _updateHistory() {\n        if (this._state.searchString) {\n            this._findInput.inputBox.addToHistory();\n        }\n        if (this._state.replaceString) {\n            this._replaceInput.inputBox.addToHistory();\n        }\n    }\n    _updateMatchesCount() {\n        this._matchesCount.style.minWidth = MAX_MATCHES_COUNT_WIDTH + 'px';\n        if (this._state.matchesCount >= MATCHES_LIMIT) {\n            this._matchesCount.title = NLS_MATCHES_COUNT_LIMIT_TITLE;\n        }\n        else {\n            this._matchesCount.title = '';\n        }\n        // remove previous content\n        this._matchesCount.firstChild?.remove();\n        let label;\n        if (this._state.matchesCount > 0) {\n            let matchesCount = String(this._state.matchesCount);\n            if (this._state.matchesCount >= MATCHES_LIMIT) {\n                matchesCount += '+';\n            }\n            let matchesPosition = String(this._state.matchesPosition);\n            if (matchesPosition === '0') {\n                matchesPosition = '?';\n            }\n            label = strings.format(NLS_MATCHES_LOCATION, matchesPosition, matchesCount);\n        }\n        else {\n            label = NLS_NO_RESULTS;\n        }\n        this._matchesCount.appendChild(document.createTextNode(label));\n        alertFn(this._getAriaLabel(label, this._state.currentMatch, this._state.searchString));\n        MAX_MATCHES_COUNT_WIDTH = Math.max(MAX_MATCHES_COUNT_WIDTH, this._matchesCount.clientWidth);\n    }\n    // ----- actions\n    _getAriaLabel(label, currentMatch, searchString) {\n        if (label === NLS_NO_RESULTS) {\n            return searchString === ''\n                ? nls.localize('ariaSearchNoResultEmpty', \"{0} found\", label)\n                : nls.localize('ariaSearchNoResult', \"{0} found for '{1}'\", label, searchString);\n        }\n        if (currentMatch) {\n            const ariaLabel = nls.localize('ariaSearchNoResultWithLineNum', \"{0} found for '{1}', at {2}\", label, searchString, currentMatch.startLineNumber + ':' + currentMatch.startColumn);\n            const model = this._codeEditor.getModel();\n            if (model && (currentMatch.startLineNumber <= model.getLineCount()) && (currentMatch.startLineNumber >= 1)) {\n                const lineContent = model.getLineContent(currentMatch.startLineNumber);\n                return `${lineContent}, ${ariaLabel}`;\n            }\n            return ariaLabel;\n        }\n        return nls.localize('ariaSearchNoResultWithLineNumNoCurrentMatch', \"{0} found for '{1}'\", label, searchString);\n    }\n    /**\n     * If 'selection find' is ON we should not disable the button (its function is to cancel 'selection find').\n     * If 'selection find' is OFF we enable the button only if there is a selection.\n     */\n    _updateToggleSelectionFindButton() {\n        const selection = this._codeEditor.getSelection();\n        const isSelection = selection ? (selection.startLineNumber !== selection.endLineNumber || selection.startColumn !== selection.endColumn) : false;\n        const isChecked = this._toggleSelectionFind.checked;\n        if (this._isVisible && (isChecked || isSelection)) {\n            this._toggleSelectionFind.enable();\n        }\n        else {\n            this._toggleSelectionFind.disable();\n        }\n    }\n    _updateButtons() {\n        this._findInput.setEnabled(this._isVisible);\n        this._replaceInput.setEnabled(this._isVisible && this._isReplaceVisible);\n        this._updateToggleSelectionFindButton();\n        this._closeBtn.setEnabled(this._isVisible);\n        const findInputIsNonEmpty = (this._state.searchString.length > 0);\n        const matchesCount = this._state.matchesCount ? true : false;\n        this._prevBtn.setEnabled(this._isVisible && findInputIsNonEmpty && matchesCount && this._state.canNavigateBack());\n        this._nextBtn.setEnabled(this._isVisible && findInputIsNonEmpty && matchesCount && this._state.canNavigateForward());\n        this._replaceBtn.setEnabled(this._isVisible && this._isReplaceVisible && findInputIsNonEmpty);\n        this._replaceAllBtn.setEnabled(this._isVisible && this._isReplaceVisible && findInputIsNonEmpty);\n        this._domNode.classList.toggle('replaceToggled', this._isReplaceVisible);\n        this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);\n        const canReplace = !this._codeEditor.getOption(92 /* EditorOption.readOnly */);\n        this._toggleReplaceBtn.setEnabled(this._isVisible && canReplace);\n    }\n    _reveal() {\n        this._revealTimeouts.forEach(e => {\n            clearTimeout(e);\n        });\n        this._revealTimeouts = [];\n        if (!this._isVisible) {\n            this._isVisible = true;\n            const selection = this._codeEditor.getSelection();\n            switch (this._codeEditor.getOption(41 /* EditorOption.find */).autoFindInSelection) {\n                case 'always':\n                    this._toggleSelectionFind.checked = true;\n                    break;\n                case 'never':\n                    this._toggleSelectionFind.checked = false;\n                    break;\n                case 'multiline': {\n                    const isSelectionMultipleLine = !!selection && selection.startLineNumber !== selection.endLineNumber;\n                    this._toggleSelectionFind.checked = isSelectionMultipleLine;\n                    break;\n                }\n                default:\n                    break;\n            }\n            this._tryUpdateWidgetWidth();\n            this._updateButtons();\n            this._revealTimeouts.push(setTimeout(() => {\n                this._domNode.classList.add('visible');\n                this._domNode.setAttribute('aria-hidden', 'false');\n            }, 0));\n            // validate query again as it's being dismissed when we hide the find widget.\n            this._revealTimeouts.push(setTimeout(() => {\n                this._findInput.validate();\n            }, 200));\n            this._codeEditor.layoutOverlayWidget(this);\n            let adjustEditorScrollTop = true;\n            if (this._codeEditor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection && selection) {\n                const domNode = this._codeEditor.getDomNode();\n                if (domNode) {\n                    const editorCoords = dom.getDomNodePagePosition(domNode);\n                    const startCoords = this._codeEditor.getScrolledVisiblePosition(selection.getStartPosition());\n                    const startLeft = editorCoords.left + (startCoords ? startCoords.left : 0);\n                    const startTop = startCoords ? startCoords.top : 0;\n                    if (this._viewZone && startTop < this._viewZone.heightInPx) {\n                        if (selection.endLineNumber > selection.startLineNumber) {\n                            adjustEditorScrollTop = false;\n                        }\n                        const leftOfFindWidget = dom.getTopLeftOffset(this._domNode).left;\n                        if (startLeft > leftOfFindWidget) {\n                            adjustEditorScrollTop = false;\n                        }\n                        const endCoords = this._codeEditor.getScrolledVisiblePosition(selection.getEndPosition());\n                        const endLeft = editorCoords.left + (endCoords ? endCoords.left : 0);\n                        if (endLeft > leftOfFindWidget) {\n                            adjustEditorScrollTop = false;\n                        }\n                    }\n                }\n            }\n            this._showViewZone(adjustEditorScrollTop);\n        }\n    }\n    _hide(focusTheEditor) {\n        this._revealTimeouts.forEach(e => {\n            clearTimeout(e);\n        });\n        this._revealTimeouts = [];\n        if (this._isVisible) {\n            this._isVisible = false;\n            this._updateButtons();\n            this._domNode.classList.remove('visible');\n            this._domNode.setAttribute('aria-hidden', 'true');\n            this._findInput.clearMessage();\n            if (focusTheEditor) {\n                this._codeEditor.focus();\n            }\n            this._codeEditor.layoutOverlayWidget(this);\n            this._removeViewZone();\n        }\n    }\n    _layoutViewZone(targetScrollTop) {\n        const addExtraSpaceOnTop = this._codeEditor.getOption(41 /* EditorOption.find */).addExtraSpaceOnTop;\n        if (!addExtraSpaceOnTop) {\n            this._removeViewZone();\n            return;\n        }\n        if (!this._isVisible) {\n            return;\n        }\n        const viewZone = this._viewZone;\n        if (this._viewZoneId !== undefined || !viewZone) {\n            return;\n        }\n        this._codeEditor.changeViewZones((accessor) => {\n            viewZone.heightInPx = this._getHeight();\n            this._viewZoneId = accessor.addZone(viewZone);\n            // scroll top adjust to make sure the editor doesn't scroll when adding viewzone at the beginning.\n            this._codeEditor.setScrollTop(targetScrollTop || this._codeEditor.getScrollTop() + viewZone.heightInPx);\n        });\n    }\n    _showViewZone(adjustScroll = true) {\n        if (!this._isVisible) {\n            return;\n        }\n        const addExtraSpaceOnTop = this._codeEditor.getOption(41 /* EditorOption.find */).addExtraSpaceOnTop;\n        if (!addExtraSpaceOnTop) {\n            return;\n        }\n        if (this._viewZone === undefined) {\n            this._viewZone = new FindWidgetViewZone(0);\n        }\n        const viewZone = this._viewZone;\n        this._codeEditor.changeViewZones((accessor) => {\n            if (this._viewZoneId !== undefined) {\n                // the view zone already exists, we need to update the height\n                const newHeight = this._getHeight();\n                if (newHeight === viewZone.heightInPx) {\n                    return;\n                }\n                const scrollAdjustment = newHeight - viewZone.heightInPx;\n                viewZone.heightInPx = newHeight;\n                accessor.layoutZone(this._viewZoneId);\n                if (adjustScroll) {\n                    this._codeEditor.setScrollTop(this._codeEditor.getScrollTop() + scrollAdjustment);\n                }\n                return;\n            }\n            else {\n                let scrollAdjustment = this._getHeight();\n                // if the editor has top padding, factor that into the zone height\n                scrollAdjustment -= this._codeEditor.getOption(84 /* EditorOption.padding */).top;\n                if (scrollAdjustment <= 0) {\n                    return;\n                }\n                viewZone.heightInPx = scrollAdjustment;\n                this._viewZoneId = accessor.addZone(viewZone);\n                if (adjustScroll) {\n                    this._codeEditor.setScrollTop(this._codeEditor.getScrollTop() + scrollAdjustment);\n                }\n            }\n        });\n    }\n    _removeViewZone() {\n        this._codeEditor.changeViewZones((accessor) => {\n            if (this._viewZoneId !== undefined) {\n                accessor.removeZone(this._viewZoneId);\n                this._viewZoneId = undefined;\n                if (this._viewZone) {\n                    this._codeEditor.setScrollTop(this._codeEditor.getScrollTop() - this._viewZone.heightInPx);\n                    this._viewZone = undefined;\n                }\n            }\n        });\n    }\n    _tryUpdateWidgetWidth() {\n        if (!this._isVisible) {\n            return;\n        }\n        if (!this._domNode.isConnected) {\n            // the widget is not in the DOM\n            return;\n        }\n        const layoutInfo = this._codeEditor.getLayoutInfo();\n        const editorContentWidth = layoutInfo.contentWidth;\n        if (editorContentWidth <= 0) {\n            // for example, diff view original editor\n            this._domNode.classList.add('hiddenEditor');\n            return;\n        }\n        else if (this._domNode.classList.contains('hiddenEditor')) {\n            this._domNode.classList.remove('hiddenEditor');\n        }\n        const editorWidth = layoutInfo.width;\n        const minimapWidth = layoutInfo.minimap.minimapWidth;\n        let collapsedFindWidget = false;\n        let reducedFindWidget = false;\n        let narrowFindWidget = false;\n        if (this._resized) {\n            const widgetWidth = dom.getTotalWidth(this._domNode);\n            if (widgetWidth > FIND_WIDGET_INITIAL_WIDTH) {\n                // as the widget is resized by users, we may need to change the max width of the widget as the editor width changes.\n                this._domNode.style.maxWidth = `${editorWidth - 28 - minimapWidth - 15}px`;\n                this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\n                return;\n            }\n        }\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth >= editorWidth) {\n            reducedFindWidget = true;\n        }\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth - MAX_MATCHES_COUNT_WIDTH >= editorWidth) {\n            narrowFindWidget = true;\n        }\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth - MAX_MATCHES_COUNT_WIDTH >= editorWidth + 50) {\n            collapsedFindWidget = true;\n        }\n        this._domNode.classList.toggle('collapsed-find-widget', collapsedFindWidget);\n        this._domNode.classList.toggle('narrow-find-widget', narrowFindWidget);\n        this._domNode.classList.toggle('reduced-find-widget', reducedFindWidget);\n        if (!narrowFindWidget && !collapsedFindWidget) {\n            // the minimal left offset of findwidget is 15px.\n            this._domNode.style.maxWidth = `${editorWidth - 28 - minimapWidth - 15}px`;\n        }\n        this._findInput.layout({ collapsedFindWidget, narrowFindWidget, reducedFindWidget });\n        if (this._resized) {\n            const findInputWidth = this._findInput.inputBox.element.clientWidth;\n            if (findInputWidth > 0) {\n                this._replaceInput.width = findInputWidth;\n            }\n        }\n        else if (this._isReplaceVisible) {\n            this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\n        }\n    }\n    _getHeight() {\n        let totalheight = 0;\n        // find input margin top\n        totalheight += 4;\n        // find input height\n        totalheight += this._findInput.inputBox.height + 2 /** input box border */;\n        if (this._isReplaceVisible) {\n            // replace input margin\n            totalheight += 4;\n            totalheight += this._replaceInput.inputBox.height + 2 /** input box border */;\n        }\n        // margin bottom\n        totalheight += 4;\n        return totalheight;\n    }\n    _tryUpdateHeight() {\n        const totalHeight = this._getHeight();\n        if (this._cachedHeight !== null && this._cachedHeight === totalHeight) {\n            return false;\n        }\n        this._cachedHeight = totalHeight;\n        this._domNode.style.height = `${totalHeight}px`;\n        return true;\n    }\n    // ----- Public\n    focusFindInput() {\n        this._findInput.select();\n        // Edge browser requires focus() in addition to select()\n        this._findInput.focus();\n    }\n    focusReplaceInput() {\n        this._replaceInput.select();\n        // Edge browser requires focus() in addition to select()\n        this._replaceInput.focus();\n    }\n    highlightFindOptions() {\n        this._findInput.highlightFindOptions();\n    }\n    _updateSearchScope() {\n        if (!this._codeEditor.hasModel()) {\n            return;\n        }\n        if (this._toggleSelectionFind.checked) {\n            const selections = this._codeEditor.getSelections();\n            selections.map(selection => {\n                if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\n                    selection = selection.setEndPosition(selection.endLineNumber - 1, this._codeEditor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\n                }\n                const currentMatch = this._state.currentMatch;\n                if (selection.startLineNumber !== selection.endLineNumber) {\n                    if (!Range.equalsRange(selection, currentMatch)) {\n                        return selection;\n                    }\n                }\n                return null;\n            }).filter(element => !!element);\n            if (selections.length) {\n                this._state.change({ searchScope: selections }, true);\n            }\n        }\n    }\n    _onFindInputMouseDown(e) {\n        // on linux, middle key does pasting.\n        if (e.middleButton) {\n            e.stopPropagation();\n        }\n    }\n    _onFindInputKeyDown(e) {\n        if (e.equals(ctrlKeyMod | 3 /* KeyCode.Enter */)) {\n            if (this._keybindingService.dispatchEvent(e, e.target)) {\n                e.preventDefault();\n                return;\n            }\n            else {\n                this._findInput.inputBox.insertAtCursor('\\n');\n                e.preventDefault();\n                return;\n            }\n        }\n        if (e.equals(2 /* KeyCode.Tab */)) {\n            if (this._isReplaceVisible) {\n                this._replaceInput.focus();\n            }\n            else {\n                this._findInput.focusOnCaseSensitive();\n            }\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */)) {\n            this._codeEditor.focus();\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(16 /* KeyCode.UpArrow */)) {\n            return stopPropagationForMultiLineUpwards(e, this._findInput.getValue(), this._findInput.domNode.querySelector('textarea'));\n        }\n        if (e.equals(18 /* KeyCode.DownArrow */)) {\n            return stopPropagationForMultiLineDownwards(e, this._findInput.getValue(), this._findInput.domNode.querySelector('textarea'));\n        }\n    }\n    _onReplaceInputKeyDown(e) {\n        if (e.equals(ctrlKeyMod | 3 /* KeyCode.Enter */)) {\n            if (this._keybindingService.dispatchEvent(e, e.target)) {\n                e.preventDefault();\n                return;\n            }\n            else {\n                if (platform.isWindows && platform.isNative && !this._ctrlEnterReplaceAllWarningPrompted) {\n                    // this is the first time when users press Ctrl + Enter to replace all\n                    this._notificationService.info(nls.localize('ctrlEnter.keybindingChanged', 'Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.'));\n                    this._ctrlEnterReplaceAllWarningPrompted = true;\n                    this._storageService.store(ctrlEnterReplaceAllWarningPromptedKey, true, 0 /* StorageScope.PROFILE */, 0 /* StorageTarget.USER */);\n                }\n                this._replaceInput.inputBox.insertAtCursor('\\n');\n                e.preventDefault();\n                return;\n            }\n        }\n        if (e.equals(2 /* KeyCode.Tab */)) {\n            this._findInput.focusOnCaseSensitive();\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */)) {\n            this._findInput.focus();\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */)) {\n            this._codeEditor.focus();\n            e.preventDefault();\n            return;\n        }\n        if (e.equals(16 /* KeyCode.UpArrow */)) {\n            return stopPropagationForMultiLineUpwards(e, this._replaceInput.inputBox.value, this._replaceInput.inputBox.element.querySelector('textarea'));\n        }\n        if (e.equals(18 /* KeyCode.DownArrow */)) {\n            return stopPropagationForMultiLineDownwards(e, this._replaceInput.inputBox.value, this._replaceInput.inputBox.element.querySelector('textarea'));\n        }\n    }\n    // ----- sash\n    getVerticalSashLeft(_sash) {\n        return 0;\n    }\n    // ----- initialization\n    _keybindingLabelFor(actionId) {\n        const kb = this._keybindingService.lookupKeybinding(actionId);\n        if (!kb) {\n            return '';\n        }\n        return ` (${kb.getLabel()})`;\n    }\n    _buildDomNode() {\n        const flexibleHeight = true;\n        const flexibleWidth = true;\n        // Find input\n        this._findInput = this._register(new ContextScopedFindInput(null, this._contextViewProvider, {\n            width: FIND_INPUT_AREA_WIDTH,\n            label: NLS_FIND_INPUT_LABEL,\n            placeholder: NLS_FIND_INPUT_PLACEHOLDER,\n            appendCaseSensitiveLabel: this._keybindingLabelFor(FIND_IDS.ToggleCaseSensitiveCommand),\n            appendWholeWordsLabel: this._keybindingLabelFor(FIND_IDS.ToggleWholeWordCommand),\n            appendRegexLabel: this._keybindingLabelFor(FIND_IDS.ToggleRegexCommand),\n            validation: (value) => {\n                if (value.length === 0 || !this._findInput.getRegex()) {\n                    return null;\n                }\n                try {\n                    // use `g` and `u` which are also used by the TextModel search\n                    new RegExp(value, 'gu');\n                    return null;\n                }\n                catch (e) {\n                    return { content: e.message };\n                }\n            },\n            flexibleHeight,\n            flexibleWidth,\n            flexibleMaxHeight: 118,\n            showCommonFindToggles: true,\n            showHistoryHint: () => showHistoryKeybindingHint(this._keybindingService),\n            inputBoxStyles: defaultInputBoxStyles,\n            toggleStyles: defaultToggleStyles\n        }, this._contextKeyService));\n        this._findInput.setRegex(!!this._state.isRegex);\n        this._findInput.setCaseSensitive(!!this._state.matchCase);\n        this._findInput.setWholeWords(!!this._state.wholeWord);\n        this._register(this._findInput.onKeyDown((e) => this._onFindInputKeyDown(e)));\n        this._register(this._findInput.inputBox.onDidChange(() => {\n            if (this._ignoreChangeEvent) {\n                return;\n            }\n            this._state.change({ searchString: this._findInput.getValue() }, true);\n        }));\n        this._register(this._findInput.onDidOptionChange(() => {\n            this._state.change({\n                isRegex: this._findInput.getRegex(),\n                wholeWord: this._findInput.getWholeWords(),\n                matchCase: this._findInput.getCaseSensitive()\n            }, true);\n        }));\n        this._register(this._findInput.onCaseSensitiveKeyDown((e) => {\n            if (e.equals(1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */)) {\n                if (this._isReplaceVisible) {\n                    this._replaceInput.focus();\n                    e.preventDefault();\n                }\n            }\n        }));\n        this._register(this._findInput.onRegexKeyDown((e) => {\n            if (e.equals(2 /* KeyCode.Tab */)) {\n                if (this._isReplaceVisible) {\n                    this._replaceInput.focusOnPreserve();\n                    e.preventDefault();\n                }\n            }\n        }));\n        this._register(this._findInput.inputBox.onDidHeightChange((e) => {\n            if (this._tryUpdateHeight()) {\n                this._showViewZone();\n            }\n        }));\n        if (platform.isLinux) {\n            this._register(this._findInput.onMouseDown((e) => this._onFindInputMouseDown(e)));\n        }\n        this._matchesCount = document.createElement('div');\n        this._matchesCount.className = 'matchesCount';\n        this._updateMatchesCount();\n        // Create a scoped hover delegate for all find related buttons\n        const hoverDelegate = this._register(createInstantHoverDelegate());\n        // Previous button\n        this._prevBtn = this._register(new SimpleButton({\n            label: NLS_PREVIOUS_MATCH_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.PreviousMatchFindAction),\n            icon: findPreviousMatchIcon,\n            hoverDelegate,\n            onTrigger: () => {\n                assertIsDefined(this._codeEditor.getAction(FIND_IDS.PreviousMatchFindAction)).run().then(undefined, onUnexpectedError);\n            }\n        }, this._hoverService));\n        // Next button\n        this._nextBtn = this._register(new SimpleButton({\n            label: NLS_NEXT_MATCH_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.NextMatchFindAction),\n            icon: findNextMatchIcon,\n            hoverDelegate,\n            onTrigger: () => {\n                assertIsDefined(this._codeEditor.getAction(FIND_IDS.NextMatchFindAction)).run().then(undefined, onUnexpectedError);\n            }\n        }, this._hoverService));\n        const findPart = document.createElement('div');\n        findPart.className = 'find-part';\n        findPart.appendChild(this._findInput.domNode);\n        const actionsContainer = document.createElement('div');\n        actionsContainer.className = 'find-actions';\n        findPart.appendChild(actionsContainer);\n        actionsContainer.appendChild(this._matchesCount);\n        actionsContainer.appendChild(this._prevBtn.domNode);\n        actionsContainer.appendChild(this._nextBtn.domNode);\n        // Toggle selection button\n        this._toggleSelectionFind = this._register(new Toggle({\n            icon: findSelectionIcon,\n            title: NLS_TOGGLE_SELECTION_FIND_TITLE + this._keybindingLabelFor(FIND_IDS.ToggleSearchScopeCommand),\n            isChecked: false,\n            hoverDelegate: hoverDelegate,\n            inputActiveOptionBackground: asCssVariable(inputActiveOptionBackground),\n            inputActiveOptionBorder: asCssVariable(inputActiveOptionBorder),\n            inputActiveOptionForeground: asCssVariable(inputActiveOptionForeground),\n        }));\n        this._register(this._toggleSelectionFind.onChange(() => {\n            if (this._toggleSelectionFind.checked) {\n                if (this._codeEditor.hasModel()) {\n                    let selections = this._codeEditor.getSelections();\n                    selections = selections.map(selection => {\n                        if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\n                            selection = selection.setEndPosition(selection.endLineNumber - 1, this._codeEditor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\n                        }\n                        if (!selection.isEmpty()) {\n                            return selection;\n                        }\n                        return null;\n                    }).filter((element) => !!element);\n                    if (selections.length) {\n                        this._state.change({ searchScope: selections }, true);\n                    }\n                }\n            }\n            else {\n                this._state.change({ searchScope: null }, true);\n            }\n        }));\n        actionsContainer.appendChild(this._toggleSelectionFind.domNode);\n        // Close button\n        this._closeBtn = this._register(new SimpleButton({\n            label: NLS_CLOSE_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.CloseFindWidgetCommand),\n            icon: widgetClose,\n            hoverDelegate,\n            onTrigger: () => {\n                this._state.change({ isRevealed: false, searchScope: null }, false);\n            },\n            onKeyDown: (e) => {\n                if (e.equals(2 /* KeyCode.Tab */)) {\n                    if (this._isReplaceVisible) {\n                        if (this._replaceBtn.isEnabled()) {\n                            this._replaceBtn.focus();\n                        }\n                        else {\n                            this._codeEditor.focus();\n                        }\n                        e.preventDefault();\n                    }\n                }\n            }\n        }, this._hoverService));\n        // Replace input\n        this._replaceInput = this._register(new ContextScopedReplaceInput(null, undefined, {\n            label: NLS_REPLACE_INPUT_LABEL,\n            placeholder: NLS_REPLACE_INPUT_PLACEHOLDER,\n            appendPreserveCaseLabel: this._keybindingLabelFor(FIND_IDS.TogglePreserveCaseCommand),\n            history: [],\n            flexibleHeight,\n            flexibleWidth,\n            flexibleMaxHeight: 118,\n            showHistoryHint: () => showHistoryKeybindingHint(this._keybindingService),\n            inputBoxStyles: defaultInputBoxStyles,\n            toggleStyles: defaultToggleStyles\n        }, this._contextKeyService, true));\n        this._replaceInput.setPreserveCase(!!this._state.preserveCase);\n        this._register(this._replaceInput.onKeyDown((e) => this._onReplaceInputKeyDown(e)));\n        this._register(this._replaceInput.inputBox.onDidChange(() => {\n            this._state.change({ replaceString: this._replaceInput.inputBox.value }, false);\n        }));\n        this._register(this._replaceInput.inputBox.onDidHeightChange((e) => {\n            if (this._isReplaceVisible && this._tryUpdateHeight()) {\n                this._showViewZone();\n            }\n        }));\n        this._register(this._replaceInput.onDidOptionChange(() => {\n            this._state.change({\n                preserveCase: this._replaceInput.getPreserveCase()\n            }, true);\n        }));\n        this._register(this._replaceInput.onPreserveCaseKeyDown((e) => {\n            if (e.equals(2 /* KeyCode.Tab */)) {\n                if (this._prevBtn.isEnabled()) {\n                    this._prevBtn.focus();\n                }\n                else if (this._nextBtn.isEnabled()) {\n                    this._nextBtn.focus();\n                }\n                else if (this._toggleSelectionFind.enabled) {\n                    this._toggleSelectionFind.focus();\n                }\n                else if (this._closeBtn.isEnabled()) {\n                    this._closeBtn.focus();\n                }\n                e.preventDefault();\n            }\n        }));\n        // Create scoped hover delegate for replace actions\n        const replaceHoverDelegate = this._register(createInstantHoverDelegate());\n        // Replace one button\n        this._replaceBtn = this._register(new SimpleButton({\n            label: NLS_REPLACE_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.ReplaceOneAction),\n            icon: findReplaceIcon,\n            hoverDelegate: replaceHoverDelegate,\n            onTrigger: () => {\n                this._controller.replace();\n            },\n            onKeyDown: (e) => {\n                if (e.equals(1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */)) {\n                    this._closeBtn.focus();\n                    e.preventDefault();\n                }\n            }\n        }, this._hoverService));\n        // Replace all button\n        this._replaceAllBtn = this._register(new SimpleButton({\n            label: NLS_REPLACE_ALL_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.ReplaceAllAction),\n            icon: findReplaceAllIcon,\n            hoverDelegate: replaceHoverDelegate,\n            onTrigger: () => {\n                this._controller.replaceAll();\n            }\n        }, this._hoverService));\n        const replacePart = document.createElement('div');\n        replacePart.className = 'replace-part';\n        replacePart.appendChild(this._replaceInput.domNode);\n        const replaceActionsContainer = document.createElement('div');\n        replaceActionsContainer.className = 'replace-actions';\n        replacePart.appendChild(replaceActionsContainer);\n        replaceActionsContainer.appendChild(this._replaceBtn.domNode);\n        replaceActionsContainer.appendChild(this._replaceAllBtn.domNode);\n        // Toggle replace button\n        this._toggleReplaceBtn = this._register(new SimpleButton({\n            label: NLS_TOGGLE_REPLACE_MODE_BTN_LABEL,\n            className: 'codicon toggle left',\n            onTrigger: () => {\n                this._state.change({ isReplaceRevealed: !this._isReplaceVisible }, false);\n                if (this._isReplaceVisible) {\n                    this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\n                    this._replaceInput.inputBox.layout();\n                }\n                this._showViewZone();\n            }\n        }, this._hoverService));\n        this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);\n        // Widget\n        this._domNode = document.createElement('div');\n        this._domNode.className = 'editor-widget find-widget';\n        this._domNode.setAttribute('aria-hidden', 'true');\n        this._domNode.ariaLabel = NLS_FIND_DIALOG_LABEL;\n        this._domNode.role = 'dialog';\n        // We need to set this explicitly, otherwise on IE11, the width inheritence of flex doesn't work.\n        this._domNode.style.width = `${FIND_WIDGET_INITIAL_WIDTH}px`;\n        this._domNode.appendChild(this._toggleReplaceBtn.domNode);\n        this._domNode.appendChild(findPart);\n        this._domNode.appendChild(this._closeBtn.domNode);\n        this._domNode.appendChild(replacePart);\n        this._resizeSash = this._register(new Sash(this._domNode, this, { orientation: 0 /* Orientation.VERTICAL */, size: 2 }));\n        this._resized = false;\n        let originalWidth = FIND_WIDGET_INITIAL_WIDTH;\n        this._register(this._resizeSash.onDidStart(() => {\n            originalWidth = dom.getTotalWidth(this._domNode);\n        }));\n        this._register(this._resizeSash.onDidChange((evt) => {\n            this._resized = true;\n            const width = originalWidth + evt.startX - evt.currentX;\n            if (width < FIND_WIDGET_INITIAL_WIDTH) {\n                // narrow down the find widget should be handled by CSS.\n                return;\n            }\n            const maxWidth = parseFloat(dom.getComputedStyle(this._domNode).maxWidth) || 0;\n            if (width > maxWidth) {\n                return;\n            }\n            this._domNode.style.width = `${width}px`;\n            if (this._isReplaceVisible) {\n                this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\n            }\n            this._findInput.inputBox.layout();\n            this._tryUpdateHeight();\n        }));\n        this._register(this._resizeSash.onDidReset(() => {\n            // users double click on the sash\n            const currentWidth = dom.getTotalWidth(this._domNode);\n            if (currentWidth < FIND_WIDGET_INITIAL_WIDTH) {\n                // The editor is narrow and the width of the find widget is controlled fully by CSS.\n                return;\n            }\n            let width = FIND_WIDGET_INITIAL_WIDTH;\n            if (!this._resized || currentWidth === FIND_WIDGET_INITIAL_WIDTH) {\n                // 1. never resized before, double click should maximizes it\n                // 2. users resized it already but its width is the same as default\n                const layoutInfo = this._codeEditor.getLayoutInfo();\n                width = layoutInfo.width - 28 - layoutInfo.minimap.minimapWidth - 15;\n                this._resized = true;\n            }\n            else {\n                /**\n                 * no op, the find widget should be shrinked to its default size.\n                 */\n            }\n            this._domNode.style.width = `${width}px`;\n            if (this._isReplaceVisible) {\n                this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\n            }\n            this._findInput.inputBox.layout();\n        }));\n    }\n    updateAccessibilitySupport() {\n        const value = this._codeEditor.getOption(2 /* EditorOption.accessibilitySupport */);\n        this._findInput.setFocusInputOnOptionClick(value !== 2 /* AccessibilitySupport.Enabled */);\n    }\n}\nexport class SimpleButton extends Widget {\n    constructor(opts, hoverService) {\n        super();\n        this._opts = opts;\n        let className = 'button';\n        if (this._opts.className) {\n            className = className + ' ' + this._opts.className;\n        }\n        if (this._opts.icon) {\n            className = className + ' ' + ThemeIcon.asClassName(this._opts.icon);\n        }\n        this._domNode = document.createElement('div');\n        this._domNode.tabIndex = 0;\n        this._domNode.className = className;\n        this._domNode.setAttribute('role', 'button');\n        this._domNode.setAttribute('aria-label', this._opts.label);\n        this._register(hoverService.setupManagedHover(opts.hoverDelegate ?? getDefaultHoverDelegate('element'), this._domNode, this._opts.label));\n        this.onclick(this._domNode, (e) => {\n            this._opts.onTrigger();\n            e.preventDefault();\n        });\n        this.onkeydown(this._domNode, (e) => {\n            if (e.equals(10 /* KeyCode.Space */) || e.equals(3 /* KeyCode.Enter */)) {\n                this._opts.onTrigger();\n                e.preventDefault();\n                return;\n            }\n            this._opts.onKeyDown?.(e);\n        });\n    }\n    get domNode() {\n        return this._domNode;\n    }\n    isEnabled() {\n        return (this._domNode.tabIndex >= 0);\n    }\n    focus() {\n        this._domNode.focus();\n    }\n    setEnabled(enabled) {\n        this._domNode.classList.toggle('disabled', !enabled);\n        this._domNode.setAttribute('aria-disabled', String(!enabled));\n        this._domNode.tabIndex = enabled ? 0 : -1;\n    }\n    setExpanded(expanded) {\n        this._domNode.setAttribute('aria-expanded', String(!!expanded));\n        if (expanded) {\n            this._domNode.classList.remove(...ThemeIcon.asClassNameArray(findCollapsedIcon));\n            this._domNode.classList.add(...ThemeIcon.asClassNameArray(findExpandedIcon));\n        }\n        else {\n            this._domNode.classList.remove(...ThemeIcon.asClassNameArray(findExpandedIcon));\n            this._domNode.classList.add(...ThemeIcon.asClassNameArray(findCollapsedIcon));\n        }\n    }\n}\n// theming\nregisterThemingParticipant((theme, collector) => {\n    const findMatchHighlightBorder = theme.getColor(editorFindMatchHighlightBorder);\n    if (findMatchHighlightBorder) {\n        collector.addRule(`.monaco-editor .findMatch { border: 1px ${isHighContrast(theme.type) ? 'dotted' : 'solid'} ${findMatchHighlightBorder}; box-sizing: border-box; }`);\n    }\n    const findRangeHighlightBorder = theme.getColor(editorFindRangeHighlightBorder);\n    if (findRangeHighlightBorder) {\n        collector.addRule(`.monaco-editor .findScope { border: 1px ${isHighContrast(theme.type) ? 'dashed' : 'solid'} ${findRangeHighlightBorder}; }`);\n    }\n    const hcBorder = theme.getColor(contrastBorder);\n    if (hcBorder) {\n        collector.addRule(`.monaco-editor .find-widget { border: 1px solid ${hcBorder}; }`);\n    }\n    const findMatchForeground = theme.getColor(editorFindMatchForeground);\n    if (findMatchForeground) {\n        collector.addRule(`.monaco-editor .findMatchInline { color: ${findMatchForeground}; }`);\n    }\n    const findMatchHighlightForeground = theme.getColor(editorFindMatchHighlightForeground);\n    if (findMatchHighlightForeground) {\n        collector.addRule(`.monaco-editor .currentFindMatchInline { color: ${findMatchHighlightForeground}; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar CommonFindController_1;\nimport { Delayer } from '../../../../base/common/async.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { EditorAction, EditorCommand, MultiEditorAction, registerEditorAction, registerEditorCommand, registerEditorContribution, registerMultiEditorAction } from '../../../browser/editorExtensions.js';\nimport { overviewRulerRangeHighlight } from '../../../common/core/editorColorRegistry.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { OverviewRulerLane } from '../../../common/model.js';\nimport { CONTEXT_FIND_INPUT_FOCUSED, CONTEXT_FIND_WIDGET_VISIBLE, CONTEXT_REPLACE_INPUT_FOCUSED, FindModelBoundToEditorModel, FIND_IDS, ToggleCaseSensitiveKeybinding, TogglePreserveCaseKeybinding, ToggleRegexKeybinding, ToggleSearchScopeKeybinding, ToggleWholeWordKeybinding } from './findModel.js';\nimport { FindOptionsWidget } from './findOptionsWidget.js';\nimport { FindReplaceState } from './findState.js';\nimport { FindWidget } from './findWidget.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextViewService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nimport { IThemeService, themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nimport { IHoverService } from '../../../../platform/hover/browser/hover.js';\nconst SEARCH_STRING_MAX_LENGTH = 524288;\nexport function getSelectionSearchString(editor, seedSearchStringFromSelection = 'single', seedSearchStringFromNonEmptySelection = false) {\n    if (!editor.hasModel()) {\n        return null;\n    }\n    const selection = editor.getSelection();\n    // if selection spans multiple lines, default search string to empty\n    if ((seedSearchStringFromSelection === 'single' && selection.startLineNumber === selection.endLineNumber)\n        || seedSearchStringFromSelection === 'multiple') {\n        if (selection.isEmpty()) {\n            const wordAtPosition = editor.getConfiguredWordAtPosition(selection.getStartPosition());\n            if (wordAtPosition && (false === seedSearchStringFromNonEmptySelection)) {\n                return wordAtPosition.word;\n            }\n        }\n        else {\n            if (editor.getModel().getValueLengthInRange(selection) < SEARCH_STRING_MAX_LENGTH) {\n                return editor.getModel().getValueInRange(selection);\n            }\n        }\n    }\n    return null;\n}\nlet CommonFindController = class CommonFindController extends Disposable {\n    static { CommonFindController_1 = this; }\n    static { this.ID = 'editor.contrib.findController'; }\n    get editor() {\n        return this._editor;\n    }\n    static get(editor) {\n        return editor.getContribution(CommonFindController_1.ID);\n    }\n    constructor(editor, contextKeyService, storageService, clipboardService, notificationService, hoverService) {\n        super();\n        this._editor = editor;\n        this._findWidgetVisible = CONTEXT_FIND_WIDGET_VISIBLE.bindTo(contextKeyService);\n        this._contextKeyService = contextKeyService;\n        this._storageService = storageService;\n        this._clipboardService = clipboardService;\n        this._notificationService = notificationService;\n        this._hoverService = hoverService;\n        this._updateHistoryDelayer = new Delayer(500);\n        this._state = this._register(new FindReplaceState());\n        this.loadQueryState();\n        this._register(this._state.onFindReplaceStateChange((e) => this._onStateChanged(e)));\n        this._model = null;\n        this._register(this._editor.onDidChangeModel(() => {\n            const shouldRestartFind = (this._editor.getModel() && this._state.isRevealed);\n            this.disposeModel();\n            this._state.change({\n                searchScope: null,\n                matchCase: this._storageService.getBoolean('editor.matchCase', 1 /* StorageScope.WORKSPACE */, false),\n                wholeWord: this._storageService.getBoolean('editor.wholeWord', 1 /* StorageScope.WORKSPACE */, false),\n                isRegex: this._storageService.getBoolean('editor.isRegex', 1 /* StorageScope.WORKSPACE */, false),\n                preserveCase: this._storageService.getBoolean('editor.preserveCase', 1 /* StorageScope.WORKSPACE */, false)\n            }, false);\n            if (shouldRestartFind) {\n                this._start({\n                    forceRevealReplace: false,\n                    seedSearchStringFromSelection: 'none',\n                    seedSearchStringFromNonEmptySelection: false,\n                    seedSearchStringFromGlobalClipboard: false,\n                    shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n                    shouldAnimate: false,\n                    updateSearchScope: false,\n                    loop: this._editor.getOption(41 /* EditorOption.find */).loop\n                });\n            }\n        }));\n    }\n    dispose() {\n        this.disposeModel();\n        super.dispose();\n    }\n    disposeModel() {\n        if (this._model) {\n            this._model.dispose();\n            this._model = null;\n        }\n    }\n    _onStateChanged(e) {\n        this.saveQueryState(e);\n        if (e.isRevealed) {\n            if (this._state.isRevealed) {\n                this._findWidgetVisible.set(true);\n            }\n            else {\n                this._findWidgetVisible.reset();\n                this.disposeModel();\n            }\n        }\n        if (e.searchString) {\n            this.setGlobalBufferTerm(this._state.searchString);\n        }\n    }\n    saveQueryState(e) {\n        if (e.isRegex) {\n            this._storageService.store('editor.isRegex', this._state.actualIsRegex, 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n        }\n        if (e.wholeWord) {\n            this._storageService.store('editor.wholeWord', this._state.actualWholeWord, 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n        }\n        if (e.matchCase) {\n            this._storageService.store('editor.matchCase', this._state.actualMatchCase, 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n        }\n        if (e.preserveCase) {\n            this._storageService.store('editor.preserveCase', this._state.actualPreserveCase, 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n        }\n    }\n    loadQueryState() {\n        this._state.change({\n            matchCase: this._storageService.getBoolean('editor.matchCase', 1 /* StorageScope.WORKSPACE */, this._state.matchCase),\n            wholeWord: this._storageService.getBoolean('editor.wholeWord', 1 /* StorageScope.WORKSPACE */, this._state.wholeWord),\n            isRegex: this._storageService.getBoolean('editor.isRegex', 1 /* StorageScope.WORKSPACE */, this._state.isRegex),\n            preserveCase: this._storageService.getBoolean('editor.preserveCase', 1 /* StorageScope.WORKSPACE */, this._state.preserveCase)\n        }, false);\n    }\n    isFindInputFocused() {\n        return !!CONTEXT_FIND_INPUT_FOCUSED.getValue(this._contextKeyService);\n    }\n    getState() {\n        return this._state;\n    }\n    closeFindWidget() {\n        this._state.change({\n            isRevealed: false,\n            searchScope: null\n        }, false);\n        this._editor.focus();\n    }\n    toggleCaseSensitive() {\n        this._state.change({ matchCase: !this._state.matchCase }, false);\n        if (!this._state.isRevealed) {\n            this.highlightFindOptions();\n        }\n    }\n    toggleWholeWords() {\n        this._state.change({ wholeWord: !this._state.wholeWord }, false);\n        if (!this._state.isRevealed) {\n            this.highlightFindOptions();\n        }\n    }\n    toggleRegex() {\n        this._state.change({ isRegex: !this._state.isRegex }, false);\n        if (!this._state.isRevealed) {\n            this.highlightFindOptions();\n        }\n    }\n    togglePreserveCase() {\n        this._state.change({ preserveCase: !this._state.preserveCase }, false);\n        if (!this._state.isRevealed) {\n            this.highlightFindOptions();\n        }\n    }\n    toggleSearchScope() {\n        if (this._state.searchScope) {\n            this._state.change({ searchScope: null }, true);\n        }\n        else {\n            if (this._editor.hasModel()) {\n                let selections = this._editor.getSelections();\n                selections = selections.map(selection => {\n                    if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\n                        selection = selection.setEndPosition(selection.endLineNumber - 1, this._editor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\n                    }\n                    if (!selection.isEmpty()) {\n                        return selection;\n                    }\n                    return null;\n                }).filter((element) => !!element);\n                if (selections.length) {\n                    this._state.change({ searchScope: selections }, true);\n                }\n            }\n        }\n    }\n    setSearchString(searchString) {\n        if (this._state.isRegex) {\n            searchString = strings.escapeRegExpCharacters(searchString);\n        }\n        this._state.change({ searchString: searchString }, false);\n    }\n    highlightFindOptions(ignoreWhenVisible = false) {\n        // overwritten in subclass\n    }\n    async _start(opts, newState) {\n        this.disposeModel();\n        if (!this._editor.hasModel()) {\n            // cannot do anything with an editor that doesn't have a model...\n            return;\n        }\n        const stateChanges = {\n            ...newState,\n            isRevealed: true\n        };\n        if (opts.seedSearchStringFromSelection === 'single') {\n            const selectionSearchString = getSelectionSearchString(this._editor, opts.seedSearchStringFromSelection, opts.seedSearchStringFromNonEmptySelection);\n            if (selectionSearchString) {\n                if (this._state.isRegex) {\n                    stateChanges.searchString = strings.escapeRegExpCharacters(selectionSearchString);\n                }\n                else {\n                    stateChanges.searchString = selectionSearchString;\n                }\n            }\n        }\n        else if (opts.seedSearchStringFromSelection === 'multiple' && !opts.updateSearchScope) {\n            const selectionSearchString = getSelectionSearchString(this._editor, opts.seedSearchStringFromSelection);\n            if (selectionSearchString) {\n                stateChanges.searchString = selectionSearchString;\n            }\n        }\n        if (!stateChanges.searchString && opts.seedSearchStringFromGlobalClipboard) {\n            const selectionSearchString = await this.getGlobalBufferTerm();\n            if (!this._editor.hasModel()) {\n                // the editor has lost its model in the meantime\n                return;\n            }\n            if (selectionSearchString) {\n                stateChanges.searchString = selectionSearchString;\n            }\n        }\n        // Overwrite isReplaceRevealed\n        if (opts.forceRevealReplace || stateChanges.isReplaceRevealed) {\n            stateChanges.isReplaceRevealed = true;\n        }\n        else if (!this._findWidgetVisible.get()) {\n            stateChanges.isReplaceRevealed = false;\n        }\n        if (opts.updateSearchScope) {\n            const currentSelections = this._editor.getSelections();\n            if (currentSelections.some(selection => !selection.isEmpty())) {\n                stateChanges.searchScope = currentSelections;\n            }\n        }\n        stateChanges.loop = opts.loop;\n        this._state.change(stateChanges, false);\n        if (!this._model) {\n            this._model = new FindModelBoundToEditorModel(this._editor, this._state);\n        }\n    }\n    start(opts, newState) {\n        return this._start(opts, newState);\n    }\n    moveToNextMatch() {\n        if (this._model) {\n            this._model.moveToNextMatch();\n            return true;\n        }\n        return false;\n    }\n    moveToPrevMatch() {\n        if (this._model) {\n            this._model.moveToPrevMatch();\n            return true;\n        }\n        return false;\n    }\n    goToMatch(index) {\n        if (this._model) {\n            this._model.moveToMatch(index);\n            return true;\n        }\n        return false;\n    }\n    replace() {\n        if (this._model) {\n            this._model.replace();\n            return true;\n        }\n        return false;\n    }\n    replaceAll() {\n        if (this._model) {\n            if (this._editor.getModel()?.isTooLargeForHeapOperation()) {\n                this._notificationService.warn(nls.localize('too.large.for.replaceall', \"The file is too large to perform a replace all operation.\"));\n                return false;\n            }\n            this._model.replaceAll();\n            return true;\n        }\n        return false;\n    }\n    selectAllMatches() {\n        if (this._model) {\n            this._model.selectAllMatches();\n            this._editor.focus();\n            return true;\n        }\n        return false;\n    }\n    async getGlobalBufferTerm() {\n        if (this._editor.getOption(41 /* EditorOption.find */).globalFindClipboard\n            && this._editor.hasModel()\n            && !this._editor.getModel().isTooLargeForSyncing()) {\n            return this._clipboardService.readFindText();\n        }\n        return '';\n    }\n    setGlobalBufferTerm(text) {\n        if (this._editor.getOption(41 /* EditorOption.find */).globalFindClipboard\n            && this._editor.hasModel()\n            && !this._editor.getModel().isTooLargeForSyncing()) {\n            // intentionally not awaited\n            this._clipboardService.writeFindText(text);\n        }\n    }\n};\nCommonFindController = CommonFindController_1 = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, IStorageService),\n    __param(3, IClipboardService),\n    __param(4, INotificationService),\n    __param(5, IHoverService)\n], CommonFindController);\nexport { CommonFindController };\nlet FindController = class FindController extends CommonFindController {\n    constructor(editor, _contextViewService, _contextKeyService, _keybindingService, _themeService, notificationService, _storageService, clipboardService, hoverService) {\n        super(editor, _contextKeyService, _storageService, clipboardService, notificationService, hoverService);\n        this._contextViewService = _contextViewService;\n        this._keybindingService = _keybindingService;\n        this._themeService = _themeService;\n        this._widget = null;\n        this._findOptionsWidget = null;\n    }\n    async _start(opts, newState) {\n        if (!this._widget) {\n            this._createFindWidget();\n        }\n        const selection = this._editor.getSelection();\n        let updateSearchScope = false;\n        switch (this._editor.getOption(41 /* EditorOption.find */).autoFindInSelection) {\n            case 'always':\n                updateSearchScope = true;\n                break;\n            case 'never':\n                updateSearchScope = false;\n                break;\n            case 'multiline': {\n                const isSelectionMultipleLine = !!selection && selection.startLineNumber !== selection.endLineNumber;\n                updateSearchScope = isSelectionMultipleLine;\n                break;\n            }\n            default:\n                break;\n        }\n        opts.updateSearchScope = opts.updateSearchScope || updateSearchScope;\n        await super._start(opts, newState);\n        if (this._widget) {\n            if (opts.shouldFocus === 2 /* FindStartFocusAction.FocusReplaceInput */) {\n                this._widget.focusReplaceInput();\n            }\n            else if (opts.shouldFocus === 1 /* FindStartFocusAction.FocusFindInput */) {\n                this._widget.focusFindInput();\n            }\n        }\n    }\n    highlightFindOptions(ignoreWhenVisible = false) {\n        if (!this._widget) {\n            this._createFindWidget();\n        }\n        if (this._state.isRevealed && !ignoreWhenVisible) {\n            this._widget.highlightFindOptions();\n        }\n        else {\n            this._findOptionsWidget.highlightFindOptions();\n        }\n    }\n    _createFindWidget() {\n        this._widget = this._register(new FindWidget(this._editor, this, this._state, this._contextViewService, this._keybindingService, this._contextKeyService, this._themeService, this._storageService, this._notificationService, this._hoverService));\n        this._findOptionsWidget = this._register(new FindOptionsWidget(this._editor, this._state, this._keybindingService));\n    }\n};\nFindController = __decorate([\n    __param(1, IContextViewService),\n    __param(2, IContextKeyService),\n    __param(3, IKeybindingService),\n    __param(4, IThemeService),\n    __param(5, INotificationService),\n    __param(6, IStorageService),\n    __param(7, IClipboardService),\n    __param(8, IHoverService)\n], FindController);\nexport { FindController };\nexport const StartFindAction = registerMultiEditorAction(new MultiEditorAction({\n    id: FIND_IDS.StartFindAction,\n    label: nls.localize('startFindAction', \"Find\"),\n    alias: 'Find',\n    precondition: ContextKeyExpr.or(EditorContextKeys.focus, ContextKeyExpr.has('editorIsOpen')),\n    kbOpts: {\n        kbExpr: null,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 36 /* KeyCode.KeyF */,\n        weight: 100 /* KeybindingWeight.EditorContrib */\n    },\n    menuOpts: {\n        menuId: MenuId.MenubarEditMenu,\n        group: '3_find',\n        title: nls.localize({ key: 'miFind', comment: ['&& denotes a mnemonic'] }, \"&&Find\"),\n        order: 1\n    }\n}));\nStartFindAction.addImplementation(0, (accessor, editor, args) => {\n    const controller = CommonFindController.get(editor);\n    if (!controller) {\n        return false;\n    }\n    return controller.start({\n        forceRevealReplace: false,\n        seedSearchStringFromSelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\n        seedSearchStringFromNonEmptySelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n        seedSearchStringFromGlobalClipboard: editor.getOption(41 /* EditorOption.find */).globalFindClipboard,\n        shouldFocus: 1 /* FindStartFocusAction.FocusFindInput */,\n        shouldAnimate: true,\n        updateSearchScope: false,\n        loop: editor.getOption(41 /* EditorOption.find */).loop\n    });\n});\nconst findArgDescription = {\n    description: 'Open a new In-Editor Find Widget.',\n    args: [{\n            name: 'Open a new In-Editor Find Widget args',\n            schema: {\n                properties: {\n                    searchString: { type: 'string' },\n                    replaceString: { type: 'string' },\n                    isRegex: { type: 'boolean' },\n                    matchWholeWord: { type: 'boolean' },\n                    isCaseSensitive: { type: 'boolean' },\n                    preserveCase: { type: 'boolean' },\n                    findInSelection: { type: 'boolean' },\n                }\n            }\n        }]\n};\nexport class StartFindWithArgsAction extends EditorAction {\n    constructor() {\n        super({\n            id: FIND_IDS.StartFindWithArgs,\n            label: nls.localize('startFindWithArgsAction', \"Find With Arguments\"),\n            alias: 'Find With Arguments',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: null,\n                primary: 0,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: findArgDescription\n        });\n    }\n    async run(accessor, editor, args) {\n        const controller = CommonFindController.get(editor);\n        if (controller) {\n            const newState = args ? {\n                searchString: args.searchString,\n                replaceString: args.replaceString,\n                isReplaceRevealed: args.replaceString !== undefined,\n                isRegex: args.isRegex,\n                // isRegexOverride: args.regexOverride,\n                wholeWord: args.matchWholeWord,\n                // wholeWordOverride: args.wholeWordOverride,\n                matchCase: args.isCaseSensitive,\n                // matchCaseOverride: args.matchCaseOverride,\n                preserveCase: args.preserveCase,\n                // preserveCaseOverride: args.preserveCaseOverride,\n            } : {};\n            await controller.start({\n                forceRevealReplace: false,\n                seedSearchStringFromSelection: (controller.getState().searchString.length === 0) && editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\n                seedSearchStringFromNonEmptySelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n                seedSearchStringFromGlobalClipboard: true,\n                shouldFocus: 1 /* FindStartFocusAction.FocusFindInput */,\n                shouldAnimate: true,\n                updateSearchScope: args?.findInSelection || false,\n                loop: editor.getOption(41 /* EditorOption.find */).loop\n            }, newState);\n            controller.setGlobalBufferTerm(controller.getState().searchString);\n        }\n    }\n}\nexport class StartFindWithSelectionAction extends EditorAction {\n    constructor() {\n        super({\n            id: FIND_IDS.StartFindWithSelection,\n            label: nls.localize('startFindWithSelectionAction', \"Find With Selection\"),\n            alias: 'Find With Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: null,\n                primary: 0,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 35 /* KeyCode.KeyE */,\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    async run(accessor, editor) {\n        const controller = CommonFindController.get(editor);\n        if (controller) {\n            await controller.start({\n                forceRevealReplace: false,\n                seedSearchStringFromSelection: 'multiple',\n                seedSearchStringFromNonEmptySelection: false,\n                seedSearchStringFromGlobalClipboard: false,\n                shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n                shouldAnimate: true,\n                updateSearchScope: false,\n                loop: editor.getOption(41 /* EditorOption.find */).loop\n            });\n            controller.setGlobalBufferTerm(controller.getState().searchString);\n        }\n    }\n}\nexport class MatchFindAction extends EditorAction {\n    async run(accessor, editor) {\n        const controller = CommonFindController.get(editor);\n        if (controller && !this._run(controller)) {\n            await controller.start({\n                forceRevealReplace: false,\n                seedSearchStringFromSelection: (controller.getState().searchString.length === 0) && editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\n                seedSearchStringFromNonEmptySelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n                seedSearchStringFromGlobalClipboard: true,\n                shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n                shouldAnimate: true,\n                updateSearchScope: false,\n                loop: editor.getOption(41 /* EditorOption.find */).loop\n            });\n            this._run(controller);\n        }\n    }\n}\nexport class NextMatchFindAction extends MatchFindAction {\n    constructor() {\n        super({\n            id: FIND_IDS.NextMatchFindAction,\n            label: nls.localize('findNextMatchAction', \"Find Next\"),\n            alias: 'Find Next',\n            precondition: undefined,\n            kbOpts: [{\n                    kbExpr: EditorContextKeys.focus,\n                    primary: 61 /* KeyCode.F3 */,\n                    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 37 /* KeyCode.KeyG */, secondary: [61 /* KeyCode.F3 */] },\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }, {\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_FIND_INPUT_FOCUSED),\n                    primary: 3 /* KeyCode.Enter */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }]\n        });\n    }\n    _run(controller) {\n        const result = controller.moveToNextMatch();\n        if (result) {\n            controller.editor.pushUndoStop();\n            return true;\n        }\n        return false;\n    }\n}\nexport class PreviousMatchFindAction extends MatchFindAction {\n    constructor() {\n        super({\n            id: FIND_IDS.PreviousMatchFindAction,\n            label: nls.localize('findPreviousMatchAction', \"Find Previous\"),\n            alias: 'Find Previous',\n            precondition: undefined,\n            kbOpts: [{\n                    kbExpr: EditorContextKeys.focus,\n                    primary: 1024 /* KeyMod.Shift */ | 61 /* KeyCode.F3 */,\n                    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 37 /* KeyCode.KeyG */, secondary: [1024 /* KeyMod.Shift */ | 61 /* KeyCode.F3 */] },\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }, {\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_FIND_INPUT_FOCUSED),\n                    primary: 1024 /* KeyMod.Shift */ | 3 /* KeyCode.Enter */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }\n            ]\n        });\n    }\n    _run(controller) {\n        return controller.moveToPrevMatch();\n    }\n}\nexport class MoveToMatchFindAction extends EditorAction {\n    constructor() {\n        super({\n            id: FIND_IDS.GoToMatchFindAction,\n            label: nls.localize('findMatchAction.goToMatch', \"Go to Match...\"),\n            alias: 'Go to Match...',\n            precondition: CONTEXT_FIND_WIDGET_VISIBLE\n        });\n        this._highlightDecorations = [];\n    }\n    run(accessor, editor, args) {\n        const controller = CommonFindController.get(editor);\n        if (!controller) {\n            return;\n        }\n        const matchesCount = controller.getState().matchesCount;\n        if (matchesCount < 1) {\n            const notificationService = accessor.get(INotificationService);\n            notificationService.notify({\n                severity: Severity.Warning,\n                message: nls.localize('findMatchAction.noResults', \"No matches. Try searching for something else.\")\n            });\n            return;\n        }\n        const quickInputService = accessor.get(IQuickInputService);\n        const disposables = new DisposableStore();\n        const inputBox = disposables.add(quickInputService.createInputBox());\n        inputBox.placeholder = nls.localize('findMatchAction.inputPlaceHolder', \"Type a number to go to a specific match (between 1 and {0})\", matchesCount);\n        const toFindMatchIndex = (value) => {\n            const index = parseInt(value);\n            if (isNaN(index)) {\n                return undefined;\n            }\n            const matchCount = controller.getState().matchesCount;\n            if (index > 0 && index <= matchCount) {\n                return index - 1; // zero based\n            }\n            else if (index < 0 && index >= -matchCount) {\n                return matchCount + index;\n            }\n            return undefined;\n        };\n        const updatePickerAndEditor = (value) => {\n            const index = toFindMatchIndex(value);\n            if (typeof index === 'number') {\n                // valid\n                inputBox.validationMessage = undefined;\n                controller.goToMatch(index);\n                const currentMatch = controller.getState().currentMatch;\n                if (currentMatch) {\n                    this.addDecorations(editor, currentMatch);\n                }\n            }\n            else {\n                inputBox.validationMessage = nls.localize('findMatchAction.inputValidationMessage', \"Please type a number between 1 and {0}\", controller.getState().matchesCount);\n                this.clearDecorations(editor);\n            }\n        };\n        disposables.add(inputBox.onDidChangeValue(value => {\n            updatePickerAndEditor(value);\n        }));\n        disposables.add(inputBox.onDidAccept(() => {\n            const index = toFindMatchIndex(inputBox.value);\n            if (typeof index === 'number') {\n                controller.goToMatch(index);\n                inputBox.hide();\n            }\n            else {\n                inputBox.validationMessage = nls.localize('findMatchAction.inputValidationMessage', \"Please type a number between 1 and {0}\", controller.getState().matchesCount);\n            }\n        }));\n        disposables.add(inputBox.onDidHide(() => {\n            this.clearDecorations(editor);\n            disposables.dispose();\n        }));\n        inputBox.show();\n    }\n    clearDecorations(editor) {\n        editor.changeDecorations(changeAccessor => {\n            this._highlightDecorations = changeAccessor.deltaDecorations(this._highlightDecorations, []);\n        });\n    }\n    addDecorations(editor, range) {\n        editor.changeDecorations(changeAccessor => {\n            this._highlightDecorations = changeAccessor.deltaDecorations(this._highlightDecorations, [\n                {\n                    range,\n                    options: {\n                        description: 'find-match-quick-access-range-highlight',\n                        className: 'rangeHighlight',\n                        isWholeLine: true\n                    }\n                },\n                {\n                    range,\n                    options: {\n                        description: 'find-match-quick-access-range-highlight-overview',\n                        overviewRuler: {\n                            color: themeColorFromId(overviewRulerRangeHighlight),\n                            position: OverviewRulerLane.Full\n                        }\n                    }\n                }\n            ]);\n        });\n    }\n}\nexport class SelectionMatchFindAction extends EditorAction {\n    async run(accessor, editor) {\n        const controller = CommonFindController.get(editor);\n        if (!controller) {\n            return;\n        }\n        const selectionSearchString = getSelectionSearchString(editor, 'single', false);\n        if (selectionSearchString) {\n            controller.setSearchString(selectionSearchString);\n        }\n        if (!this._run(controller)) {\n            await controller.start({\n                forceRevealReplace: false,\n                seedSearchStringFromSelection: 'none',\n                seedSearchStringFromNonEmptySelection: false,\n                seedSearchStringFromGlobalClipboard: false,\n                shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n                shouldAnimate: true,\n                updateSearchScope: false,\n                loop: editor.getOption(41 /* EditorOption.find */).loop\n            });\n            this._run(controller);\n        }\n    }\n}\nexport class NextSelectionMatchFindAction extends SelectionMatchFindAction {\n    constructor() {\n        super({\n            id: FIND_IDS.NextSelectionMatchFindAction,\n            label: nls.localize('nextSelectionMatchFindAction', \"Find Next Selection\"),\n            alias: 'Find Next Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 61 /* KeyCode.F3 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _run(controller) {\n        return controller.moveToNextMatch();\n    }\n}\nexport class PreviousSelectionMatchFindAction extends SelectionMatchFindAction {\n    constructor() {\n        super({\n            id: FIND_IDS.PreviousSelectionMatchFindAction,\n            label: nls.localize('previousSelectionMatchFindAction', \"Find Previous Selection\"),\n            alias: 'Find Previous Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 61 /* KeyCode.F3 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _run(controller) {\n        return controller.moveToPrevMatch();\n    }\n}\nexport const StartFindReplaceAction = registerMultiEditorAction(new MultiEditorAction({\n    id: FIND_IDS.StartFindReplaceAction,\n    label: nls.localize('startReplace', \"Replace\"),\n    alias: 'Replace',\n    precondition: ContextKeyExpr.or(EditorContextKeys.focus, ContextKeyExpr.has('editorIsOpen')),\n    kbOpts: {\n        kbExpr: null,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 38 /* KeyCode.KeyH */,\n        mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 36 /* KeyCode.KeyF */ },\n        weight: 100 /* KeybindingWeight.EditorContrib */\n    },\n    menuOpts: {\n        menuId: MenuId.MenubarEditMenu,\n        group: '3_find',\n        title: nls.localize({ key: 'miReplace', comment: ['&& denotes a mnemonic'] }, \"&&Replace\"),\n        order: 2\n    }\n}));\nStartFindReplaceAction.addImplementation(0, (accessor, editor, args) => {\n    if (!editor.hasModel() || editor.getOption(92 /* EditorOption.readOnly */)) {\n        return false;\n    }\n    const controller = CommonFindController.get(editor);\n    if (!controller) {\n        return false;\n    }\n    const currentSelection = editor.getSelection();\n    const findInputFocused = controller.isFindInputFocused();\n    // we only seed search string from selection when the current selection is single line and not empty,\n    // + the find input is not focused\n    const seedSearchStringFromSelection = !currentSelection.isEmpty()\n        && currentSelection.startLineNumber === currentSelection.endLineNumber\n        && (editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never')\n        && !findInputFocused;\n    /*\n    * if the existing search string in find widget is empty and we don't seed search string from selection, it means the Find Input is still empty, so we should focus the Find Input instead of Replace Input.\n\n    * findInputFocused true -> seedSearchStringFromSelection false, FocusReplaceInput\n    * findInputFocused false, seedSearchStringFromSelection true FocusReplaceInput\n    * findInputFocused false seedSearchStringFromSelection false FocusFindInput\n    */\n    const shouldFocus = (findInputFocused || seedSearchStringFromSelection) ?\n        2 /* FindStartFocusAction.FocusReplaceInput */ : 1 /* FindStartFocusAction.FocusFindInput */;\n    return controller.start({\n        forceRevealReplace: true,\n        seedSearchStringFromSelection: seedSearchStringFromSelection ? 'single' : 'none',\n        seedSearchStringFromNonEmptySelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n        seedSearchStringFromGlobalClipboard: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never',\n        shouldFocus: shouldFocus,\n        shouldAnimate: true,\n        updateSearchScope: false,\n        loop: editor.getOption(41 /* EditorOption.find */).loop\n    });\n});\nregisterEditorContribution(CommonFindController.ID, FindController, 0 /* EditorContributionInstantiation.Eager */); // eager because it uses `saveViewState`/`restoreViewState`\nregisterEditorAction(StartFindWithArgsAction);\nregisterEditorAction(StartFindWithSelectionAction);\nregisterEditorAction(NextMatchFindAction);\nregisterEditorAction(PreviousMatchFindAction);\nregisterEditorAction(MoveToMatchFindAction);\nregisterEditorAction(NextSelectionMatchFindAction);\nregisterEditorAction(PreviousSelectionMatchFindAction);\nconst FindCommand = EditorCommand.bindToContribution(CommonFindController.get);\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.CloseFindWidgetCommand,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.closeFindWidget(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, ContextKeyExpr.not('isComposing')),\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ToggleCaseSensitiveCommand,\n    precondition: undefined,\n    handler: x => x.toggleCaseSensitive(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: ToggleCaseSensitiveKeybinding.primary,\n        mac: ToggleCaseSensitiveKeybinding.mac,\n        win: ToggleCaseSensitiveKeybinding.win,\n        linux: ToggleCaseSensitiveKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ToggleWholeWordCommand,\n    precondition: undefined,\n    handler: x => x.toggleWholeWords(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: ToggleWholeWordKeybinding.primary,\n        mac: ToggleWholeWordKeybinding.mac,\n        win: ToggleWholeWordKeybinding.win,\n        linux: ToggleWholeWordKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ToggleRegexCommand,\n    precondition: undefined,\n    handler: x => x.toggleRegex(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: ToggleRegexKeybinding.primary,\n        mac: ToggleRegexKeybinding.mac,\n        win: ToggleRegexKeybinding.win,\n        linux: ToggleRegexKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ToggleSearchScopeCommand,\n    precondition: undefined,\n    handler: x => x.toggleSearchScope(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: ToggleSearchScopeKeybinding.primary,\n        mac: ToggleSearchScopeKeybinding.mac,\n        win: ToggleSearchScopeKeybinding.win,\n        linux: ToggleSearchScopeKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.TogglePreserveCaseCommand,\n    precondition: undefined,\n    handler: x => x.togglePreserveCase(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: TogglePreserveCaseKeybinding.primary,\n        mac: TogglePreserveCaseKeybinding.mac,\n        win: TogglePreserveCaseKeybinding.win,\n        linux: TogglePreserveCaseKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ReplaceOneAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.replace(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 22 /* KeyCode.Digit1 */\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ReplaceOneAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.replace(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_REPLACE_INPUT_FOCUSED),\n        primary: 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ReplaceAllAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.replaceAll(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ReplaceAllAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.replaceAll(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_REPLACE_INPUT_FOCUSED),\n        primary: undefined,\n        mac: {\n            primary: 2048 /* KeyMod.CtrlCmd */ | 3 /* KeyCode.Enter */,\n        }\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.SelectAllMatchesAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.selectAllMatches(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: 512 /* KeyMod.Alt */ | 3 /* KeyCode.Enter */\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport const foldSourceAbbr = {\n    [0 /* FoldSource.provider */]: ' ',\n    [1 /* FoldSource.userDefined */]: 'u',\n    [2 /* FoldSource.recovered */]: 'r',\n};\nexport const MAX_FOLDING_REGIONS = 0xFFFF;\nexport const MAX_LINE_NUMBER = 0xFFFFFF;\nconst MASK_INDENT = 0xFF000000;\nclass BitField {\n    constructor(size) {\n        const numWords = Math.ceil(size / 32);\n        this._states = new Uint32Array(numWords);\n    }\n    get(index) {\n        const arrayIndex = (index / 32) | 0;\n        const bit = index % 32;\n        return (this._states[arrayIndex] & (1 << bit)) !== 0;\n    }\n    set(index, newState) {\n        const arrayIndex = (index / 32) | 0;\n        const bit = index % 32;\n        const value = this._states[arrayIndex];\n        if (newState) {\n            this._states[arrayIndex] = value | (1 << bit);\n        }\n        else {\n            this._states[arrayIndex] = value & ~(1 << bit);\n        }\n    }\n}\nexport class FoldingRegions {\n    constructor(startIndexes, endIndexes, types) {\n        if (startIndexes.length !== endIndexes.length || startIndexes.length > MAX_FOLDING_REGIONS) {\n            throw new Error('invalid startIndexes or endIndexes size');\n        }\n        this._startIndexes = startIndexes;\n        this._endIndexes = endIndexes;\n        this._collapseStates = new BitField(startIndexes.length);\n        this._userDefinedStates = new BitField(startIndexes.length);\n        this._recoveredStates = new BitField(startIndexes.length);\n        this._types = types;\n        this._parentsComputed = false;\n    }\n    ensureParentIndices() {\n        if (!this._parentsComputed) {\n            this._parentsComputed = true;\n            const parentIndexes = [];\n            const isInsideLast = (startLineNumber, endLineNumber) => {\n                const index = parentIndexes[parentIndexes.length - 1];\n                return this.getStartLineNumber(index) <= startLineNumber && this.getEndLineNumber(index) >= endLineNumber;\n            };\n            for (let i = 0, len = this._startIndexes.length; i < len; i++) {\n                const startLineNumber = this._startIndexes[i];\n                const endLineNumber = this._endIndexes[i];\n                if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\n                    throw new Error('startLineNumber or endLineNumber must not exceed ' + MAX_LINE_NUMBER);\n                }\n                while (parentIndexes.length > 0 && !isInsideLast(startLineNumber, endLineNumber)) {\n                    parentIndexes.pop();\n                }\n                const parentIndex = parentIndexes.length > 0 ? parentIndexes[parentIndexes.length - 1] : -1;\n                parentIndexes.push(i);\n                this._startIndexes[i] = startLineNumber + ((parentIndex & 0xFF) << 24);\n                this._endIndexes[i] = endLineNumber + ((parentIndex & 0xFF00) << 16);\n            }\n        }\n    }\n    get length() {\n        return this._startIndexes.length;\n    }\n    getStartLineNumber(index) {\n        return this._startIndexes[index] & MAX_LINE_NUMBER;\n    }\n    getEndLineNumber(index) {\n        return this._endIndexes[index] & MAX_LINE_NUMBER;\n    }\n    getType(index) {\n        return this._types ? this._types[index] : undefined;\n    }\n    hasTypes() {\n        return !!this._types;\n    }\n    isCollapsed(index) {\n        return this._collapseStates.get(index);\n    }\n    setCollapsed(index, newState) {\n        this._collapseStates.set(index, newState);\n    }\n    isUserDefined(index) {\n        return this._userDefinedStates.get(index);\n    }\n    setUserDefined(index, newState) {\n        return this._userDefinedStates.set(index, newState);\n    }\n    isRecovered(index) {\n        return this._recoveredStates.get(index);\n    }\n    setRecovered(index, newState) {\n        return this._recoveredStates.set(index, newState);\n    }\n    getSource(index) {\n        if (this.isUserDefined(index)) {\n            return 1 /* FoldSource.userDefined */;\n        }\n        else if (this.isRecovered(index)) {\n            return 2 /* FoldSource.recovered */;\n        }\n        return 0 /* FoldSource.provider */;\n    }\n    setSource(index, source) {\n        if (source === 1 /* FoldSource.userDefined */) {\n            this.setUserDefined(index, true);\n            this.setRecovered(index, false);\n        }\n        else if (source === 2 /* FoldSource.recovered */) {\n            this.setUserDefined(index, false);\n            this.setRecovered(index, true);\n        }\n        else {\n            this.setUserDefined(index, false);\n            this.setRecovered(index, false);\n        }\n    }\n    setCollapsedAllOfType(type, newState) {\n        let hasChanged = false;\n        if (this._types) {\n            for (let i = 0; i < this._types.length; i++) {\n                if (this._types[i] === type) {\n                    this.setCollapsed(i, newState);\n                    hasChanged = true;\n                }\n            }\n        }\n        return hasChanged;\n    }\n    toRegion(index) {\n        return new FoldingRegion(this, index);\n    }\n    getParentIndex(index) {\n        this.ensureParentIndices();\n        const parent = ((this._startIndexes[index] & MASK_INDENT) >>> 24) + ((this._endIndexes[index] & MASK_INDENT) >>> 16);\n        if (parent === MAX_FOLDING_REGIONS) {\n            return -1;\n        }\n        return parent;\n    }\n    contains(index, line) {\n        return this.getStartLineNumber(index) <= line && this.getEndLineNumber(index) >= line;\n    }\n    findIndex(line) {\n        let low = 0, high = this._startIndexes.length;\n        if (high === 0) {\n            return -1; // no children\n        }\n        while (low < high) {\n            const mid = Math.floor((low + high) / 2);\n            if (line < this.getStartLineNumber(mid)) {\n                high = mid;\n            }\n            else {\n                low = mid + 1;\n            }\n        }\n        return low - 1;\n    }\n    findRange(line) {\n        let index = this.findIndex(line);\n        if (index >= 0) {\n            const endLineNumber = this.getEndLineNumber(index);\n            if (endLineNumber >= line) {\n                return index;\n            }\n            index = this.getParentIndex(index);\n            while (index !== -1) {\n                if (this.contains(index, line)) {\n                    return index;\n                }\n                index = this.getParentIndex(index);\n            }\n        }\n        return -1;\n    }\n    toString() {\n        const res = [];\n        for (let i = 0; i < this.length; i++) {\n            res[i] = `[${foldSourceAbbr[this.getSource(i)]}${this.isCollapsed(i) ? '+' : '-'}] ${this.getStartLineNumber(i)}/${this.getEndLineNumber(i)}`;\n        }\n        return res.join(', ');\n    }\n    toFoldRange(index) {\n        return {\n            startLineNumber: this._startIndexes[index] & MAX_LINE_NUMBER,\n            endLineNumber: this._endIndexes[index] & MAX_LINE_NUMBER,\n            type: this._types ? this._types[index] : undefined,\n            isCollapsed: this.isCollapsed(index),\n            source: this.getSource(index)\n        };\n    }\n    static fromFoldRanges(ranges) {\n        const rangesLength = ranges.length;\n        const startIndexes = new Uint32Array(rangesLength);\n        const endIndexes = new Uint32Array(rangesLength);\n        let types = [];\n        let gotTypes = false;\n        for (let i = 0; i < rangesLength; i++) {\n            const range = ranges[i];\n            startIndexes[i] = range.startLineNumber;\n            endIndexes[i] = range.endLineNumber;\n            types.push(range.type);\n            if (range.type) {\n                gotTypes = true;\n            }\n        }\n        if (!gotTypes) {\n            types = undefined;\n        }\n        const regions = new FoldingRegions(startIndexes, endIndexes, types);\n        for (let i = 0; i < rangesLength; i++) {\n            if (ranges[i].isCollapsed) {\n                regions.setCollapsed(i, true);\n            }\n            regions.setSource(i, ranges[i].source);\n        }\n        return regions;\n    }\n    /**\n     * Two inputs, each a FoldingRegions or a FoldRange[], are merged.\n     * Each input must be pre-sorted on startLineNumber.\n     * The first list is assumed to always include all regions currently defined by range providers.\n     * The second list only contains the previously collapsed and all manual ranges.\n     * If the line position matches, the range of the new range is taken, and the range is no longer manual\n     * When an entry in one list overlaps an entry in the other, the second list's entry \"wins\" and\n     * overlapping entries in the first list are discarded.\n     * Invalid entries are discarded. An entry is invalid if:\n     * \t\tthe start and end line numbers aren't a valid range of line numbers,\n     * \t\tit is out of sequence or has the same start line as a preceding entry,\n     * \t\tit overlaps a preceding entry and is not fully contained by that entry.\n     */\n    static sanitizeAndMerge(rangesA, rangesB, maxLineNumber, selection) {\n        maxLineNumber = maxLineNumber ?? Number.MAX_VALUE;\n        const getIndexedFunction = (r, limit) => {\n            return Array.isArray(r)\n                ? ((i) => { return (i < limit) ? r[i] : undefined; })\n                : ((i) => { return (i < limit) ? r.toFoldRange(i) : undefined; });\n        };\n        const getA = getIndexedFunction(rangesA, rangesA.length);\n        const getB = getIndexedFunction(rangesB, rangesB.length);\n        let indexA = 0;\n        let indexB = 0;\n        let nextA = getA(0);\n        let nextB = getB(0);\n        const stackedRanges = [];\n        let topStackedRange;\n        let prevLineNumber = 0;\n        const resultRanges = [];\n        while (nextA || nextB) {\n            let useRange = undefined;\n            if (nextB && (!nextA || nextA.startLineNumber >= nextB.startLineNumber)) {\n                if (nextA && nextA.startLineNumber === nextB.startLineNumber) {\n                    if (nextB.source === 1 /* FoldSource.userDefined */) {\n                        // a user defined range (possibly unfolded)\n                        useRange = nextB;\n                    }\n                    else {\n                        // a previously folded range or a (possibly unfolded) recovered range\n                        useRange = nextA;\n                        // stays collapsed if the range still has the same number of lines or the selection is not in the range or after it\n                        useRange.isCollapsed = nextB.isCollapsed && (nextA.endLineNumber === nextB.endLineNumber || !selection?.startsInside(nextA.startLineNumber + 1, nextA.endLineNumber + 1));\n                        useRange.source = 0 /* FoldSource.provider */;\n                    }\n                    nextA = getA(++indexA); // not necessary, just for speed\n                }\n                else {\n                    useRange = nextB;\n                    if (nextB.isCollapsed && nextB.source === 0 /* FoldSource.provider */) {\n                        // a previously collapsed range\n                        useRange.source = 2 /* FoldSource.recovered */;\n                    }\n                }\n                nextB = getB(++indexB);\n            }\n            else {\n                // nextA is next. The user folded B set takes precedence and we sometimes need to look\n                // ahead in it to check for an upcoming conflict.\n                let scanIndex = indexB;\n                let prescanB = nextB;\n                while (true) {\n                    if (!prescanB || prescanB.startLineNumber > nextA.endLineNumber) {\n                        useRange = nextA;\n                        break; // no conflict, use this nextA\n                    }\n                    if (prescanB.source === 1 /* FoldSource.userDefined */ && prescanB.endLineNumber > nextA.endLineNumber) {\n                        // we found a user folded range, it wins\n                        break; // without setting nextResult, so this nextA gets skipped\n                    }\n                    prescanB = getB(++scanIndex);\n                }\n                nextA = getA(++indexA);\n            }\n            if (useRange) {\n                while (topStackedRange\n                    && topStackedRange.endLineNumber < useRange.startLineNumber) {\n                    topStackedRange = stackedRanges.pop();\n                }\n                if (useRange.endLineNumber > useRange.startLineNumber\n                    && useRange.startLineNumber > prevLineNumber\n                    && useRange.endLineNumber <= maxLineNumber\n                    && (!topStackedRange\n                        || topStackedRange.endLineNumber >= useRange.endLineNumber)) {\n                    resultRanges.push(useRange);\n                    prevLineNumber = useRange.startLineNumber;\n                    if (topStackedRange) {\n                        stackedRanges.push(topStackedRange);\n                    }\n                    topStackedRange = useRange;\n                }\n            }\n        }\n        return resultRanges;\n    }\n}\nexport class FoldingRegion {\n    constructor(ranges, index) {\n        this.ranges = ranges;\n        this.index = index;\n    }\n    get startLineNumber() {\n        return this.ranges.getStartLineNumber(this.index);\n    }\n    get endLineNumber() {\n        return this.ranges.getEndLineNumber(this.index);\n    }\n    get regionIndex() {\n        return this.index;\n    }\n    get parentIndex() {\n        return this.ranges.getParentIndex(this.index);\n    }\n    get isCollapsed() {\n        return this.ranges.isCollapsed(this.index);\n    }\n    containedBy(range) {\n        return range.startLineNumber <= this.startLineNumber && range.endLineNumber >= this.endLineNumber;\n    }\n    containsLine(lineNumber) {\n        return this.startLineNumber <= lineNumber && lineNumber <= this.endLineNumber;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../base/common/event.js';\nimport { FoldingRegions } from './foldingRanges.js';\nimport { hash } from '../../../../base/common/hash.js';\nexport class FoldingModel {\n    get regions() { return this._regions; }\n    get textModel() { return this._textModel; }\n    constructor(textModel, decorationProvider) {\n        this._updateEventEmitter = new Emitter();\n        this.onDidChange = this._updateEventEmitter.event;\n        this._textModel = textModel;\n        this._decorationProvider = decorationProvider;\n        this._regions = new FoldingRegions(new Uint32Array(0), new Uint32Array(0));\n        this._editorDecorationIds = [];\n    }\n    toggleCollapseState(toggledRegions) {\n        if (!toggledRegions.length) {\n            return;\n        }\n        toggledRegions = toggledRegions.sort((r1, r2) => r1.regionIndex - r2.regionIndex);\n        const processed = {};\n        this._decorationProvider.changeDecorations(accessor => {\n            let k = 0; // index from [0 ... this.regions.length]\n            let dirtyRegionEndLine = -1; // end of the range where decorations need to be updated\n            let lastHiddenLine = -1; // the end of the last hidden lines\n            const updateDecorationsUntil = (index) => {\n                while (k < index) {\n                    const endLineNumber = this._regions.getEndLineNumber(k);\n                    const isCollapsed = this._regions.isCollapsed(k);\n                    if (endLineNumber <= dirtyRegionEndLine) {\n                        const isManual = this.regions.getSource(k) !== 0 /* FoldSource.provider */;\n                        accessor.changeDecorationOptions(this._editorDecorationIds[k], this._decorationProvider.getDecorationOption(isCollapsed, endLineNumber <= lastHiddenLine, isManual));\n                    }\n                    if (isCollapsed && endLineNumber > lastHiddenLine) {\n                        lastHiddenLine = endLineNumber;\n                    }\n                    k++;\n                }\n            };\n            for (const region of toggledRegions) {\n                const index = region.regionIndex;\n                const editorDecorationId = this._editorDecorationIds[index];\n                if (editorDecorationId && !processed[editorDecorationId]) {\n                    processed[editorDecorationId] = true;\n                    updateDecorationsUntil(index); // update all decorations up to current index using the old dirtyRegionEndLine\n                    const newCollapseState = !this._regions.isCollapsed(index);\n                    this._regions.setCollapsed(index, newCollapseState);\n                    dirtyRegionEndLine = Math.max(dirtyRegionEndLine, this._regions.getEndLineNumber(index));\n                }\n            }\n            updateDecorationsUntil(this._regions.length);\n        });\n        this._updateEventEmitter.fire({ model: this, collapseStateChanged: toggledRegions });\n    }\n    removeManualRanges(ranges) {\n        const newFoldingRanges = new Array();\n        const intersects = (foldRange) => {\n            for (const range of ranges) {\n                if (!(range.startLineNumber > foldRange.endLineNumber || foldRange.startLineNumber > range.endLineNumber)) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        for (let i = 0; i < this._regions.length; i++) {\n            const foldRange = this._regions.toFoldRange(i);\n            if (foldRange.source === 0 /* FoldSource.provider */ || !intersects(foldRange)) {\n                newFoldingRanges.push(foldRange);\n            }\n        }\n        this.updatePost(FoldingRegions.fromFoldRanges(newFoldingRanges));\n    }\n    update(newRegions, selection) {\n        const foldedOrManualRanges = this._currentFoldedOrManualRanges(selection);\n        const newRanges = FoldingRegions.sanitizeAndMerge(newRegions, foldedOrManualRanges, this._textModel.getLineCount(), selection);\n        this.updatePost(FoldingRegions.fromFoldRanges(newRanges));\n    }\n    updatePost(newRegions) {\n        const newEditorDecorations = [];\n        let lastHiddenLine = -1;\n        for (let index = 0, limit = newRegions.length; index < limit; index++) {\n            const startLineNumber = newRegions.getStartLineNumber(index);\n            const endLineNumber = newRegions.getEndLineNumber(index);\n            const isCollapsed = newRegions.isCollapsed(index);\n            const isManual = newRegions.getSource(index) !== 0 /* FoldSource.provider */;\n            const decorationRange = {\n                startLineNumber: startLineNumber,\n                startColumn: this._textModel.getLineMaxColumn(startLineNumber),\n                endLineNumber: endLineNumber,\n                endColumn: this._textModel.getLineMaxColumn(endLineNumber) + 1\n            };\n            newEditorDecorations.push({ range: decorationRange, options: this._decorationProvider.getDecorationOption(isCollapsed, endLineNumber <= lastHiddenLine, isManual) });\n            if (isCollapsed && endLineNumber > lastHiddenLine) {\n                lastHiddenLine = endLineNumber;\n            }\n        }\n        this._decorationProvider.changeDecorations(accessor => this._editorDecorationIds = accessor.deltaDecorations(this._editorDecorationIds, newEditorDecorations));\n        this._regions = newRegions;\n        this._updateEventEmitter.fire({ model: this });\n    }\n    _currentFoldedOrManualRanges(selection) {\n        const foldedRanges = [];\n        for (let i = 0, limit = this._regions.length; i < limit; i++) {\n            let isCollapsed = this.regions.isCollapsed(i);\n            const source = this.regions.getSource(i);\n            if (isCollapsed || source !== 0 /* FoldSource.provider */) {\n                const foldRange = this._regions.toFoldRange(i);\n                const decRange = this._textModel.getDecorationRange(this._editorDecorationIds[i]);\n                if (decRange) {\n                    if (isCollapsed && selection?.startsInside(decRange.startLineNumber + 1, decRange.endLineNumber)) {\n                        isCollapsed = false; // uncollapse is the range is blocked\n                    }\n                    foldedRanges.push({\n                        startLineNumber: decRange.startLineNumber,\n                        endLineNumber: decRange.endLineNumber,\n                        type: foldRange.type,\n                        isCollapsed,\n                        source\n                    });\n                }\n            }\n        }\n        return foldedRanges;\n    }\n    /**\n     * Collapse state memento, for persistence only\n     */\n    getMemento() {\n        const foldedOrManualRanges = this._currentFoldedOrManualRanges();\n        const result = [];\n        const maxLineNumber = this._textModel.getLineCount();\n        for (let i = 0, limit = foldedOrManualRanges.length; i < limit; i++) {\n            const range = foldedOrManualRanges[i];\n            if (range.startLineNumber >= range.endLineNumber || range.startLineNumber < 1 || range.endLineNumber > maxLineNumber) {\n                continue;\n            }\n            const checksum = this._getLinesChecksum(range.startLineNumber + 1, range.endLineNumber);\n            result.push({\n                startLineNumber: range.startLineNumber,\n                endLineNumber: range.endLineNumber,\n                isCollapsed: range.isCollapsed,\n                source: range.source,\n                checksum: checksum\n            });\n        }\n        return (result.length > 0) ? result : undefined;\n    }\n    /**\n     * Apply persisted state, for persistence only\n     */\n    applyMemento(state) {\n        if (!Array.isArray(state)) {\n            return;\n        }\n        const rangesToRestore = [];\n        const maxLineNumber = this._textModel.getLineCount();\n        for (const range of state) {\n            if (range.startLineNumber >= range.endLineNumber || range.startLineNumber < 1 || range.endLineNumber > maxLineNumber) {\n                continue;\n            }\n            const checksum = this._getLinesChecksum(range.startLineNumber + 1, range.endLineNumber);\n            if (!range.checksum || checksum === range.checksum) {\n                rangesToRestore.push({\n                    startLineNumber: range.startLineNumber,\n                    endLineNumber: range.endLineNumber,\n                    type: undefined,\n                    isCollapsed: range.isCollapsed ?? true,\n                    source: range.source ?? 0 /* FoldSource.provider */\n                });\n            }\n        }\n        const newRanges = FoldingRegions.sanitizeAndMerge(this._regions, rangesToRestore, maxLineNumber);\n        this.updatePost(FoldingRegions.fromFoldRanges(newRanges));\n    }\n    _getLinesChecksum(lineNumber1, lineNumber2) {\n        const h = hash(this._textModel.getLineContent(lineNumber1)\n            + this._textModel.getLineContent(lineNumber2));\n        return h % 1000000; // 6 digits is plenty\n    }\n    dispose() {\n        this._decorationProvider.removeDecorations(this._editorDecorationIds);\n    }\n    getAllRegionsAtLine(lineNumber, filter) {\n        const result = [];\n        if (this._regions) {\n            let index = this._regions.findRange(lineNumber);\n            let level = 1;\n            while (index >= 0) {\n                const current = this._regions.toRegion(index);\n                if (!filter || filter(current, level)) {\n                    result.push(current);\n                }\n                level++;\n                index = current.parentIndex;\n            }\n        }\n        return result;\n    }\n    getRegionAtLine(lineNumber) {\n        if (this._regions) {\n            const index = this._regions.findRange(lineNumber);\n            if (index >= 0) {\n                return this._regions.toRegion(index);\n            }\n        }\n        return null;\n    }\n    getRegionsInside(region, filter) {\n        const result = [];\n        const index = region ? region.regionIndex + 1 : 0;\n        const endLineNumber = region ? region.endLineNumber : Number.MAX_VALUE;\n        if (filter && filter.length === 2) {\n            const levelStack = [];\n            for (let i = index, len = this._regions.length; i < len; i++) {\n                const current = this._regions.toRegion(i);\n                if (this._regions.getStartLineNumber(i) < endLineNumber) {\n                    while (levelStack.length > 0 && !current.containedBy(levelStack[levelStack.length - 1])) {\n                        levelStack.pop();\n                    }\n                    levelStack.push(current);\n                    if (filter(current, levelStack.length)) {\n                        result.push(current);\n                    }\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        else {\n            for (let i = index, len = this._regions.length; i < len; i++) {\n                const current = this._regions.toRegion(i);\n                if (this._regions.getStartLineNumber(i) < endLineNumber) {\n                    if (!filter || filter(current)) {\n                        result.push(current);\n                    }\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        return result;\n    }\n}\n/**\n * Collapse or expand the regions at the given locations\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\n */\nexport function toggleCollapseState(foldingModel, levels, lineNumbers) {\n    const toToggle = [];\n    for (const lineNumber of lineNumbers) {\n        const region = foldingModel.getRegionAtLine(lineNumber);\n        if (region) {\n            const doCollapse = !region.isCollapsed;\n            toToggle.push(region);\n            if (levels > 1) {\n                const regionsInside = foldingModel.getRegionsInside(region, (r, level) => r.isCollapsed !== doCollapse && level < levels);\n                toToggle.push(...regionsInside);\n            }\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Collapse or expand the regions at the given locations including all children.\n * @param doCollapse Whether to collapse or expand\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\n */\nexport function setCollapseStateLevelsDown(foldingModel, doCollapse, levels = Number.MAX_VALUE, lineNumbers) {\n    const toToggle = [];\n    if (lineNumbers && lineNumbers.length > 0) {\n        for (const lineNumber of lineNumbers) {\n            const region = foldingModel.getRegionAtLine(lineNumber);\n            if (region) {\n                if (region.isCollapsed !== doCollapse) {\n                    toToggle.push(region);\n                }\n                if (levels > 1) {\n                    const regionsInside = foldingModel.getRegionsInside(region, (r, level) => r.isCollapsed !== doCollapse && level < levels);\n                    toToggle.push(...regionsInside);\n                }\n            }\n        }\n    }\n    else {\n        const regionsInside = foldingModel.getRegionsInside(null, (r, level) => r.isCollapsed !== doCollapse && level < levels);\n        toToggle.push(...regionsInside);\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Collapse or expand the regions at the given locations including all parents.\n * @param doCollapse Whether to collapse or expand\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\n * @param lineNumbers the location of the regions to collapse or expand.\n */\nexport function setCollapseStateLevelsUp(foldingModel, doCollapse, levels, lineNumbers) {\n    const toToggle = [];\n    for (const lineNumber of lineNumbers) {\n        const regions = foldingModel.getAllRegionsAtLine(lineNumber, (region, level) => region.isCollapsed !== doCollapse && level <= levels);\n        toToggle.push(...regions);\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Collapse or expand a region at the given locations. If the inner most region is already collapsed/expanded, uses the first parent instead.\n * @param doCollapse Whether to collapse or expand\n * @param lineNumbers the location of the regions to collapse or expand.\n */\nexport function setCollapseStateUp(foldingModel, doCollapse, lineNumbers) {\n    const toToggle = [];\n    for (const lineNumber of lineNumbers) {\n        const regions = foldingModel.getAllRegionsAtLine(lineNumber, (region) => region.isCollapsed !== doCollapse);\n        if (regions.length > 0) {\n            toToggle.push(regions[0]);\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds or unfolds all regions that have a given level, except if they contain one of the blocked lines.\n * @param foldLevel level. Level == 1 is the top level\n * @param doCollapse Whether to collapse or expand\n*/\nexport function setCollapseStateAtLevel(foldingModel, foldLevel, doCollapse, blockedLineNumbers) {\n    const filter = (region, level) => level === foldLevel && region.isCollapsed !== doCollapse && !blockedLineNumbers.some(line => region.containsLine(line));\n    const toToggle = foldingModel.getRegionsInside(null, filter);\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds or unfolds all regions, except if they contain or are contained by a region of one of the blocked lines.\n * @param doCollapse Whether to collapse or expand\n * @param blockedLineNumbers the location of regions to not collapse or expand\n */\nexport function setCollapseStateForRest(foldingModel, doCollapse, blockedLineNumbers) {\n    const filteredRegions = [];\n    for (const lineNumber of blockedLineNumbers) {\n        const regions = foldingModel.getAllRegionsAtLine(lineNumber, undefined);\n        if (regions.length > 0) {\n            filteredRegions.push(regions[0]);\n        }\n    }\n    const filter = (region) => filteredRegions.every((filteredRegion) => !filteredRegion.containedBy(region) && !region.containedBy(filteredRegion)) && region.isCollapsed !== doCollapse;\n    const toToggle = foldingModel.getRegionsInside(null, filter);\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds all regions for which the lines start with a given regex\n * @param foldingModel the folding model\n */\nexport function setCollapseStateForMatchingLines(foldingModel, regExp, doCollapse) {\n    const editorModel = foldingModel.textModel;\n    const regions = foldingModel.regions;\n    const toToggle = [];\n    for (let i = regions.length - 1; i >= 0; i--) {\n        if (doCollapse !== regions.isCollapsed(i)) {\n            const startLineNumber = regions.getStartLineNumber(i);\n            if (regExp.test(editorModel.getLineContent(startLineNumber))) {\n                toToggle.push(regions.toRegion(i));\n            }\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds all regions of the given type\n * @param foldingModel the folding model\n */\nexport function setCollapseStateForType(foldingModel, type, doCollapse) {\n    const regions = foldingModel.regions;\n    const toToggle = [];\n    for (let i = regions.length - 1; i >= 0; i--) {\n        if (doCollapse !== regions.isCollapsed(i) && type === regions.getType(i)) {\n            toToggle.push(regions.toRegion(i));\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Get line to go to for parent fold of current line\n * @param lineNumber the current line number\n * @param foldingModel the folding model\n *\n * @return Parent fold start line\n */\nexport function getParentFoldLine(lineNumber, foldingModel) {\n    let startLineNumber = null;\n    const foldingRegion = foldingModel.getRegionAtLine(lineNumber);\n    if (foldingRegion !== null) {\n        startLineNumber = foldingRegion.startLineNumber;\n        // If current line is not the start of the current fold, go to top line of current fold. If not, go to parent fold\n        if (lineNumber === startLineNumber) {\n            const parentFoldingIdx = foldingRegion.parentIndex;\n            if (parentFoldingIdx !== -1) {\n                startLineNumber = foldingModel.regions.getStartLineNumber(parentFoldingIdx);\n            }\n            else {\n                startLineNumber = null;\n            }\n        }\n    }\n    return startLineNumber;\n}\n/**\n * Get line to go to for previous fold at the same level of current line\n * @param lineNumber the current line number\n * @param foldingModel the folding model\n *\n * @return Previous fold start line\n */\nexport function getPreviousFoldLine(lineNumber, foldingModel) {\n    let foldingRegion = foldingModel.getRegionAtLine(lineNumber);\n    // If on the folding range start line, go to previous sibling.\n    if (foldingRegion !== null && foldingRegion.startLineNumber === lineNumber) {\n        // If current line is not the start of the current fold, go to top line of current fold. If not, go to previous fold.\n        if (lineNumber !== foldingRegion.startLineNumber) {\n            return foldingRegion.startLineNumber;\n        }\n        else {\n            // Find min line number to stay within parent.\n            const expectedParentIndex = foldingRegion.parentIndex;\n            let minLineNumber = 0;\n            if (expectedParentIndex !== -1) {\n                minLineNumber = foldingModel.regions.getStartLineNumber(foldingRegion.parentIndex);\n            }\n            // Find fold at same level.\n            while (foldingRegion !== null) {\n                if (foldingRegion.regionIndex > 0) {\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex - 1);\n                    // Keep at same level.\n                    if (foldingRegion.startLineNumber <= minLineNumber) {\n                        return null;\n                    }\n                    else if (foldingRegion.parentIndex === expectedParentIndex) {\n                        return foldingRegion.startLineNumber;\n                    }\n                }\n                else {\n                    return null;\n                }\n            }\n        }\n    }\n    else {\n        // Go to last fold that's before the current line.\n        if (foldingModel.regions.length > 0) {\n            foldingRegion = foldingModel.regions.toRegion(foldingModel.regions.length - 1);\n            while (foldingRegion !== null) {\n                // Found fold before current line.\n                if (foldingRegion.startLineNumber < lineNumber) {\n                    return foldingRegion.startLineNumber;\n                }\n                if (foldingRegion.regionIndex > 0) {\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex - 1);\n                }\n                else {\n                    foldingRegion = null;\n                }\n            }\n        }\n    }\n    return null;\n}\n/**\n * Get line to go to next fold at the same level of current line\n * @param lineNumber the current line number\n * @param foldingModel the folding model\n *\n * @return Next fold start line\n */\nexport function getNextFoldLine(lineNumber, foldingModel) {\n    let foldingRegion = foldingModel.getRegionAtLine(lineNumber);\n    // If on the folding range start line, go to next sibling.\n    if (foldingRegion !== null && foldingRegion.startLineNumber === lineNumber) {\n        // Find max line number to stay within parent.\n        const expectedParentIndex = foldingRegion.parentIndex;\n        let maxLineNumber = 0;\n        if (expectedParentIndex !== -1) {\n            maxLineNumber = foldingModel.regions.getEndLineNumber(foldingRegion.parentIndex);\n        }\n        else if (foldingModel.regions.length === 0) {\n            return null;\n        }\n        else {\n            maxLineNumber = foldingModel.regions.getEndLineNumber(foldingModel.regions.length - 1);\n        }\n        // Find fold at same level.\n        while (foldingRegion !== null) {\n            if (foldingRegion.regionIndex < foldingModel.regions.length) {\n                foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex + 1);\n                // Keep at same level.\n                if (foldingRegion.startLineNumber >= maxLineNumber) {\n                    return null;\n                }\n                else if (foldingRegion.parentIndex === expectedParentIndex) {\n                    return foldingRegion.startLineNumber;\n                }\n            }\n            else {\n                return null;\n            }\n        }\n    }\n    else {\n        // Go to first fold that's after the current line.\n        if (foldingModel.regions.length > 0) {\n            foldingRegion = foldingModel.regions.toRegion(0);\n            while (foldingRegion !== null) {\n                // Found fold after current line.\n                if (foldingRegion.startLineNumber > lineNumber) {\n                    return foldingRegion.startLineNumber;\n                }\n                if (foldingRegion.regionIndex < foldingModel.regions.length) {\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex + 1);\n                }\n                else {\n                    foldingRegion = null;\n                }\n            }\n        }\n    }\n    return null;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { findFirstIdxMonotonousOrArrLen } from '../../../../base/common/arraysFind.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Range } from '../../../common/core/range.js';\nimport { countEOL } from '../../../common/core/eolCounter.js';\nexport class HiddenRangeModel {\n    get onDidChange() { return this._updateEventEmitter.event; }\n    get hiddenRanges() { return this._hiddenRanges; }\n    constructor(model) {\n        this._updateEventEmitter = new Emitter();\n        this._hasLineChanges = false;\n        this._foldingModel = model;\n        this._foldingModelListener = model.onDidChange(_ => this.updateHiddenRanges());\n        this._hiddenRanges = [];\n        if (model.regions.length) {\n            this.updateHiddenRanges();\n        }\n    }\n    notifyChangeModelContent(e) {\n        if (this._hiddenRanges.length && !this._hasLineChanges) {\n            this._hasLineChanges = e.changes.some(change => {\n                return change.range.endLineNumber !== change.range.startLineNumber || countEOL(change.text)[0] !== 0;\n            });\n        }\n    }\n    updateHiddenRanges() {\n        let updateHiddenAreas = false;\n        const newHiddenAreas = [];\n        let i = 0; // index into hidden\n        let k = 0;\n        let lastCollapsedStart = Number.MAX_VALUE;\n        let lastCollapsedEnd = -1;\n        const ranges = this._foldingModel.regions;\n        for (; i < ranges.length; i++) {\n            if (!ranges.isCollapsed(i)) {\n                continue;\n            }\n            const startLineNumber = ranges.getStartLineNumber(i) + 1; // the first line is not hidden\n            const endLineNumber = ranges.getEndLineNumber(i);\n            if (lastCollapsedStart <= startLineNumber && endLineNumber <= lastCollapsedEnd) {\n                // ignore ranges contained in collapsed regions\n                continue;\n            }\n            if (!updateHiddenAreas && k < this._hiddenRanges.length && this._hiddenRanges[k].startLineNumber === startLineNumber && this._hiddenRanges[k].endLineNumber === endLineNumber) {\n                // reuse the old ranges\n                newHiddenAreas.push(this._hiddenRanges[k]);\n                k++;\n            }\n            else {\n                updateHiddenAreas = true;\n                newHiddenAreas.push(new Range(startLineNumber, 1, endLineNumber, 1));\n            }\n            lastCollapsedStart = startLineNumber;\n            lastCollapsedEnd = endLineNumber;\n        }\n        if (this._hasLineChanges || updateHiddenAreas || k < this._hiddenRanges.length) {\n            this.applyHiddenRanges(newHiddenAreas);\n        }\n    }\n    applyHiddenRanges(newHiddenAreas) {\n        this._hiddenRanges = newHiddenAreas;\n        this._hasLineChanges = false;\n        this._updateEventEmitter.fire(newHiddenAreas);\n    }\n    hasRanges() {\n        return this._hiddenRanges.length > 0;\n    }\n    isHidden(line) {\n        return findRange(this._hiddenRanges, line) !== null;\n    }\n    adjustSelections(selections) {\n        let hasChanges = false;\n        const editorModel = this._foldingModel.textModel;\n        let lastRange = null;\n        const adjustLine = (line) => {\n            if (!lastRange || !isInside(line, lastRange)) {\n                lastRange = findRange(this._hiddenRanges, line);\n            }\n            if (lastRange) {\n                return lastRange.startLineNumber - 1;\n            }\n            return null;\n        };\n        for (let i = 0, len = selections.length; i < len; i++) {\n            let selection = selections[i];\n            const adjustedStartLine = adjustLine(selection.startLineNumber);\n            if (adjustedStartLine) {\n                selection = selection.setStartPosition(adjustedStartLine, editorModel.getLineMaxColumn(adjustedStartLine));\n                hasChanges = true;\n            }\n            const adjustedEndLine = adjustLine(selection.endLineNumber);\n            if (adjustedEndLine) {\n                selection = selection.setEndPosition(adjustedEndLine, editorModel.getLineMaxColumn(adjustedEndLine));\n                hasChanges = true;\n            }\n            selections[i] = selection;\n        }\n        return hasChanges;\n    }\n    dispose() {\n        if (this.hiddenRanges.length > 0) {\n            this._hiddenRanges = [];\n            this._updateEventEmitter.fire(this._hiddenRanges);\n        }\n        if (this._foldingModelListener) {\n            this._foldingModelListener.dispose();\n            this._foldingModelListener = null;\n        }\n    }\n}\nfunction isInside(line, range) {\n    return line >= range.startLineNumber && line <= range.endLineNumber;\n}\nfunction findRange(ranges, line) {\n    const i = findFirstIdxMonotonousOrArrLen(ranges, r => line < r.startLineNumber) - 1;\n    if (i >= 0 && ranges[i].endLineNumber >= line) {\n        return ranges[i];\n    }\n    return null;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { computeIndentLevel } from '../../../common/model/utils.js';\nimport { FoldingRegions, MAX_LINE_NUMBER } from './foldingRanges.js';\nconst MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT = 5000;\nconst ID_INDENT_PROVIDER = 'indent';\nexport class IndentRangeProvider {\n    constructor(editorModel, languageConfigurationService, foldingRangesLimit) {\n        this.editorModel = editorModel;\n        this.languageConfigurationService = languageConfigurationService;\n        this.foldingRangesLimit = foldingRangesLimit;\n        this.id = ID_INDENT_PROVIDER;\n    }\n    dispose() { }\n    compute(cancelationToken) {\n        const foldingRules = this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules;\n        const offSide = foldingRules && !!foldingRules.offSide;\n        const markers = foldingRules && foldingRules.markers;\n        return Promise.resolve(computeRanges(this.editorModel, offSide, markers, this.foldingRangesLimit));\n    }\n}\n// public only for testing\nexport class RangesCollector {\n    constructor(foldingRangesLimit) {\n        this._startIndexes = [];\n        this._endIndexes = [];\n        this._indentOccurrences = [];\n        this._length = 0;\n        this._foldingRangesLimit = foldingRangesLimit;\n    }\n    insertFirst(startLineNumber, endLineNumber, indent) {\n        if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\n            return;\n        }\n        const index = this._length;\n        this._startIndexes[index] = startLineNumber;\n        this._endIndexes[index] = endLineNumber;\n        this._length++;\n        if (indent < 1000) {\n            this._indentOccurrences[indent] = (this._indentOccurrences[indent] || 0) + 1;\n        }\n    }\n    toIndentRanges(model) {\n        const limit = this._foldingRangesLimit.limit;\n        if (this._length <= limit) {\n            this._foldingRangesLimit.update(this._length, false);\n            // reverse and create arrays of the exact length\n            const startIndexes = new Uint32Array(this._length);\n            const endIndexes = new Uint32Array(this._length);\n            for (let i = this._length - 1, k = 0; i >= 0; i--, k++) {\n                startIndexes[k] = this._startIndexes[i];\n                endIndexes[k] = this._endIndexes[i];\n            }\n            return new FoldingRegions(startIndexes, endIndexes);\n        }\n        else {\n            this._foldingRangesLimit.update(this._length, limit);\n            let entries = 0;\n            let maxIndent = this._indentOccurrences.length;\n            for (let i = 0; i < this._indentOccurrences.length; i++) {\n                const n = this._indentOccurrences[i];\n                if (n) {\n                    if (n + entries > limit) {\n                        maxIndent = i;\n                        break;\n                    }\n                    entries += n;\n                }\n            }\n            const tabSize = model.getOptions().tabSize;\n            // reverse and create arrays of the exact length\n            const startIndexes = new Uint32Array(limit);\n            const endIndexes = new Uint32Array(limit);\n            for (let i = this._length - 1, k = 0; i >= 0; i--) {\n                const startIndex = this._startIndexes[i];\n                const lineContent = model.getLineContent(startIndex);\n                const indent = computeIndentLevel(lineContent, tabSize);\n                if (indent < maxIndent || (indent === maxIndent && entries++ < limit)) {\n                    startIndexes[k] = startIndex;\n                    endIndexes[k] = this._endIndexes[i];\n                    k++;\n                }\n            }\n            return new FoldingRegions(startIndexes, endIndexes);\n        }\n    }\n}\nconst foldingRangesLimitDefault = {\n    limit: MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT,\n    update: () => { }\n};\nexport function computeRanges(model, offSide, markers, foldingRangesLimit = foldingRangesLimitDefault) {\n    const tabSize = model.getOptions().tabSize;\n    const result = new RangesCollector(foldingRangesLimit);\n    let pattern = undefined;\n    if (markers) {\n        pattern = new RegExp(`(${markers.start.source})|(?:${markers.end.source})`);\n    }\n    const previousRegions = [];\n    const line = model.getLineCount() + 1;\n    previousRegions.push({ indent: -1, endAbove: line, line }); // sentinel, to make sure there's at least one entry\n    for (let line = model.getLineCount(); line > 0; line--) {\n        const lineContent = model.getLineContent(line);\n        const indent = computeIndentLevel(lineContent, tabSize);\n        let previous = previousRegions[previousRegions.length - 1];\n        if (indent === -1) {\n            if (offSide) {\n                // for offSide languages, empty lines are associated to the previous block\n                // note: the next block is already written to the results, so this only\n                // impacts the end position of the block before\n                previous.endAbove = line;\n            }\n            continue; // only whitespace\n        }\n        let m;\n        if (pattern && (m = lineContent.match(pattern))) {\n            // folding pattern match\n            if (m[1]) { // start pattern match\n                // discard all regions until the folding pattern\n                let i = previousRegions.length - 1;\n                while (i > 0 && previousRegions[i].indent !== -2) {\n                    i--;\n                }\n                if (i > 0) {\n                    previousRegions.length = i + 1;\n                    previous = previousRegions[i];\n                    // new folding range from pattern, includes the end line\n                    result.insertFirst(line, previous.line, indent);\n                    previous.line = line;\n                    previous.indent = indent;\n                    previous.endAbove = line;\n                    continue;\n                }\n                else {\n                    // no end marker found, treat line as a regular line\n                }\n            }\n            else { // end pattern match\n                previousRegions.push({ indent: -2, endAbove: line, line });\n                continue;\n            }\n        }\n        if (previous.indent > indent) {\n            // discard all regions with larger indent\n            do {\n                previousRegions.pop();\n                previous = previousRegions[previousRegions.length - 1];\n            } while (previous.indent > indent);\n            // new folding range\n            const endLineNumber = previous.endAbove - 1;\n            if (endLineNumber - line >= 1) { // needs at east size 1\n                result.insertFirst(line, endLineNumber, indent);\n            }\n        }\n        if (previous.indent === indent) {\n            previous.endAbove = line;\n        }\n        else { // previous.indent < indent\n            // new region with a bigger indent\n            previousRegions.push({ indent, endAbove: line, line });\n        }\n    }\n    return result.toIndentRanges(model);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { localize } from '../../../../nls.js';\nimport { editorSelectionBackground, iconForeground, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nconst foldBackground = registerColor('editor.foldBackground', { light: transparent(editorSelectionBackground, 0.3), dark: transparent(editorSelectionBackground, 0.3), hcDark: null, hcLight: null }, localize('foldBackgroundBackground', \"Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations.\"), true);\nregisterColor('editor.foldPlaceholderForeground', { light: '#808080', dark: '#808080', hcDark: null, hcLight: null }, localize('collapsedTextColor', \"Color of the collapsed text after the first line of a folded range.\"));\nregisterColor('editorGutter.foldingControlForeground', iconForeground, localize('editorGutter.foldingControlForeground', 'Color of the folding control in the editor gutter.'));\nexport const foldingExpandedIcon = registerIcon('folding-expanded', Codicon.chevronDown, localize('foldingExpandedIcon', 'Icon for expanded ranges in the editor glyph margin.'));\nexport const foldingCollapsedIcon = registerIcon('folding-collapsed', Codicon.chevronRight, localize('foldingCollapsedIcon', 'Icon for collapsed ranges in the editor glyph margin.'));\nexport const foldingManualCollapsedIcon = registerIcon('folding-manual-collapsed', foldingCollapsedIcon, localize('foldingManualCollapedIcon', 'Icon for manually collapsed ranges in the editor glyph margin.'));\nexport const foldingManualExpandedIcon = registerIcon('folding-manual-expanded', foldingExpandedIcon, localize('foldingManualExpandedIcon', 'Icon for manually expanded ranges in the editor glyph margin.'));\nconst foldedBackgroundMinimap = { color: themeColorFromId(foldBackground), position: 1 /* MinimapPosition.Inline */ };\nconst collapsed = localize('linesCollapsed', \"Click to expand the range.\");\nconst expanded = localize('linesExpanded', \"Click to collapse the range.\");\nexport class FoldingDecorationProvider {\n    static { this.COLLAPSED_VISUAL_DECORATION = ModelDecorationOptions.register({\n        description: 'folding-collapsed-visual-decoration',\n        stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n        afterContentClassName: 'inline-folded',\n        isWholeLine: true,\n        linesDecorationsTooltip: collapsed,\n        firstLineDecorationClassName: ThemeIcon.asClassName(foldingCollapsedIcon),\n    }); }\n    static { this.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION = ModelDecorationOptions.register({\n        description: 'folding-collapsed-highlighted-visual-decoration',\n        stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n        afterContentClassName: 'inline-folded',\n        className: 'folded-background',\n        minimap: foldedBackgroundMinimap,\n        isWholeLine: true,\n        linesDecorationsTooltip: collapsed,\n        firstLineDecorationClassName: ThemeIcon.asClassName(foldingCollapsedIcon)\n    }); }\n    static { this.MANUALLY_COLLAPSED_VISUAL_DECORATION = ModelDecorationOptions.register({\n        description: 'folding-manually-collapsed-visual-decoration',\n        stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n        afterContentClassName: 'inline-folded',\n        isWholeLine: true,\n        linesDecorationsTooltip: collapsed,\n        firstLineDecorationClassName: ThemeIcon.asClassName(foldingManualCollapsedIcon)\n    }); }\n    static { this.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION = ModelDecorationOptions.register({\n        description: 'folding-manually-collapsed-highlighted-visual-decoration',\n        stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n        afterContentClassName: 'inline-folded',\n        className: 'folded-background',\n        minimap: foldedBackgroundMinimap,\n        isWholeLine: true,\n        linesDecorationsTooltip: collapsed,\n        firstLineDecorationClassName: ThemeIcon.asClassName(foldingManualCollapsedIcon)\n    }); }\n    static { this.NO_CONTROLS_COLLAPSED_RANGE_DECORATION = ModelDecorationOptions.register({\n        description: 'folding-no-controls-range-decoration',\n        stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n        afterContentClassName: 'inline-folded',\n        isWholeLine: true,\n        linesDecorationsTooltip: collapsed,\n    }); }\n    static { this.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION = ModelDecorationOptions.register({\n        description: 'folding-no-controls-range-decoration',\n        stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n        afterContentClassName: 'inline-folded',\n        className: 'folded-background',\n        minimap: foldedBackgroundMinimap,\n        isWholeLine: true,\n        linesDecorationsTooltip: collapsed,\n    }); }\n    static { this.EXPANDED_VISUAL_DECORATION = ModelDecorationOptions.register({\n        description: 'folding-expanded-visual-decoration',\n        stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n        isWholeLine: true,\n        firstLineDecorationClassName: 'alwaysShowFoldIcons ' + ThemeIcon.asClassName(foldingExpandedIcon),\n        linesDecorationsTooltip: expanded,\n    }); }\n    static { this.EXPANDED_AUTO_HIDE_VISUAL_DECORATION = ModelDecorationOptions.register({\n        description: 'folding-expanded-auto-hide-visual-decoration',\n        stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n        isWholeLine: true,\n        firstLineDecorationClassName: ThemeIcon.asClassName(foldingExpandedIcon),\n        linesDecorationsTooltip: expanded,\n    }); }\n    static { this.MANUALLY_EXPANDED_VISUAL_DECORATION = ModelDecorationOptions.register({\n        description: 'folding-manually-expanded-visual-decoration',\n        stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n        isWholeLine: true,\n        firstLineDecorationClassName: 'alwaysShowFoldIcons ' + ThemeIcon.asClassName(foldingManualExpandedIcon),\n        linesDecorationsTooltip: expanded,\n    }); }\n    static { this.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION = ModelDecorationOptions.register({\n        description: 'folding-manually-expanded-auto-hide-visual-decoration',\n        stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n        isWholeLine: true,\n        firstLineDecorationClassName: ThemeIcon.asClassName(foldingManualExpandedIcon),\n        linesDecorationsTooltip: expanded,\n    }); }\n    static { this.NO_CONTROLS_EXPANDED_RANGE_DECORATION = ModelDecorationOptions.register({\n        description: 'folding-no-controls-range-decoration',\n        stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n        isWholeLine: true\n    }); }\n    static { this.HIDDEN_RANGE_DECORATION = ModelDecorationOptions.register({\n        description: 'folding-hidden-range-decoration',\n        stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */\n    }); }\n    constructor(editor) {\n        this.editor = editor;\n        this.showFoldingControls = 'mouseover';\n        this.showFoldingHighlights = true;\n    }\n    getDecorationOption(isCollapsed, isHidden, isManual) {\n        if (isHidden) { // is inside another collapsed region\n            return FoldingDecorationProvider.HIDDEN_RANGE_DECORATION;\n        }\n        if (this.showFoldingControls === 'never') {\n            if (isCollapsed) {\n                return this.showFoldingHighlights ? FoldingDecorationProvider.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION : FoldingDecorationProvider.NO_CONTROLS_COLLAPSED_RANGE_DECORATION;\n            }\n            return FoldingDecorationProvider.NO_CONTROLS_EXPANDED_RANGE_DECORATION;\n        }\n        if (isCollapsed) {\n            return isManual ?\n                (this.showFoldingHighlights ? FoldingDecorationProvider.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION : FoldingDecorationProvider.MANUALLY_COLLAPSED_VISUAL_DECORATION)\n                : (this.showFoldingHighlights ? FoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION : FoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION);\n        }\n        else if (this.showFoldingControls === 'mouseover') {\n            return isManual ? FoldingDecorationProvider.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION : FoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION;\n        }\n        else {\n            return isManual ? FoldingDecorationProvider.MANUALLY_EXPANDED_VISUAL_DECORATION : FoldingDecorationProvider.EXPANDED_VISUAL_DECORATION;\n        }\n    }\n    changeDecorations(callback) {\n        return this.editor.changeDecorations(callback);\n    }\n    removeDecorations(decorationIds) {\n        this.editor.removeDecorations(decorationIds);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { FoldingRegions, MAX_LINE_NUMBER } from './foldingRanges.js';\nconst foldingContext = {};\nconst ID_SYNTAX_PROVIDER = 'syntax';\nexport class SyntaxRangeProvider {\n    constructor(editorModel, providers, handleFoldingRangesChange, foldingRangesLimit, fallbackRangeProvider // used when all providers return null\n    ) {\n        this.editorModel = editorModel;\n        this.providers = providers;\n        this.handleFoldingRangesChange = handleFoldingRangesChange;\n        this.foldingRangesLimit = foldingRangesLimit;\n        this.fallbackRangeProvider = fallbackRangeProvider;\n        this.id = ID_SYNTAX_PROVIDER;\n        this.disposables = new DisposableStore();\n        if (fallbackRangeProvider) {\n            this.disposables.add(fallbackRangeProvider);\n        }\n        for (const provider of providers) {\n            if (typeof provider.onDidChange === 'function') {\n                this.disposables.add(provider.onDidChange(handleFoldingRangesChange));\n            }\n        }\n    }\n    compute(cancellationToken) {\n        return collectSyntaxRanges(this.providers, this.editorModel, cancellationToken).then(ranges => {\n            if (ranges) {\n                const res = sanitizeRanges(ranges, this.foldingRangesLimit);\n                return res;\n            }\n            return this.fallbackRangeProvider?.compute(cancellationToken) ?? null;\n        });\n    }\n    dispose() {\n        this.disposables.dispose();\n    }\n}\nfunction collectSyntaxRanges(providers, model, cancellationToken) {\n    let rangeData = null;\n    const promises = providers.map((provider, i) => {\n        return Promise.resolve(provider.provideFoldingRanges(model, foldingContext, cancellationToken)).then(ranges => {\n            if (cancellationToken.isCancellationRequested) {\n                return;\n            }\n            if (Array.isArray(ranges)) {\n                if (!Array.isArray(rangeData)) {\n                    rangeData = [];\n                }\n                const nLines = model.getLineCount();\n                for (const r of ranges) {\n                    if (r.start > 0 && r.end > r.start && r.end <= nLines) {\n                        rangeData.push({ start: r.start, end: r.end, rank: i, kind: r.kind });\n                    }\n                }\n            }\n        }, onUnexpectedExternalError);\n    });\n    return Promise.all(promises).then(_ => {\n        return rangeData;\n    });\n}\nclass RangesCollector {\n    constructor(foldingRangesLimit) {\n        this._startIndexes = [];\n        this._endIndexes = [];\n        this._nestingLevels = [];\n        this._nestingLevelCounts = [];\n        this._types = [];\n        this._length = 0;\n        this._foldingRangesLimit = foldingRangesLimit;\n    }\n    add(startLineNumber, endLineNumber, type, nestingLevel) {\n        if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\n            return;\n        }\n        const index = this._length;\n        this._startIndexes[index] = startLineNumber;\n        this._endIndexes[index] = endLineNumber;\n        this._nestingLevels[index] = nestingLevel;\n        this._types[index] = type;\n        this._length++;\n        if (nestingLevel < 30) {\n            this._nestingLevelCounts[nestingLevel] = (this._nestingLevelCounts[nestingLevel] || 0) + 1;\n        }\n    }\n    toIndentRanges() {\n        const limit = this._foldingRangesLimit.limit;\n        if (this._length <= limit) {\n            this._foldingRangesLimit.update(this._length, false);\n            const startIndexes = new Uint32Array(this._length);\n            const endIndexes = new Uint32Array(this._length);\n            for (let i = 0; i < this._length; i++) {\n                startIndexes[i] = this._startIndexes[i];\n                endIndexes[i] = this._endIndexes[i];\n            }\n            return new FoldingRegions(startIndexes, endIndexes, this._types);\n        }\n        else {\n            this._foldingRangesLimit.update(this._length, limit);\n            let entries = 0;\n            let maxLevel = this._nestingLevelCounts.length;\n            for (let i = 0; i < this._nestingLevelCounts.length; i++) {\n                const n = this._nestingLevelCounts[i];\n                if (n) {\n                    if (n + entries > limit) {\n                        maxLevel = i;\n                        break;\n                    }\n                    entries += n;\n                }\n            }\n            const startIndexes = new Uint32Array(limit);\n            const endIndexes = new Uint32Array(limit);\n            const types = [];\n            for (let i = 0, k = 0; i < this._length; i++) {\n                const level = this._nestingLevels[i];\n                if (level < maxLevel || (level === maxLevel && entries++ < limit)) {\n                    startIndexes[k] = this._startIndexes[i];\n                    endIndexes[k] = this._endIndexes[i];\n                    types[k] = this._types[i];\n                    k++;\n                }\n            }\n            return new FoldingRegions(startIndexes, endIndexes, types);\n        }\n    }\n}\nexport function sanitizeRanges(rangeData, foldingRangesLimit) {\n    const sorted = rangeData.sort((d1, d2) => {\n        let diff = d1.start - d2.start;\n        if (diff === 0) {\n            diff = d1.rank - d2.rank;\n        }\n        return diff;\n    });\n    const collector = new RangesCollector(foldingRangesLimit);\n    let top = undefined;\n    const previous = [];\n    for (const entry of sorted) {\n        if (!top) {\n            top = entry;\n            collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\n        }\n        else {\n            if (entry.start > top.start) {\n                if (entry.end <= top.end) {\n                    previous.push(top);\n                    top = entry;\n                    collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\n                }\n                else {\n                    if (entry.start > top.end) {\n                        do {\n                            top = previous.pop();\n                        } while (top && entry.start > top.end);\n                        if (top) {\n                            previous.push(top);\n                        }\n                        top = entry;\n                    }\n                    collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\n                }\n            }\n        }\n    }\n    return collector.toIndentRanges();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar FoldingController_1;\nimport { createCancelablePromise, Delayer, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { illegalArgument, onUnexpectedError } from '../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { escapeRegExpCharacters } from '../../../../base/common/strings.js';\nimport * as types from '../../../../base/common/types.js';\nimport './folding.css';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution, registerInstantiatedEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { FoldingRangeKind } from '../../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { FoldingModel, getNextFoldLine, getParentFoldLine as getParentFoldLine, getPreviousFoldLine, setCollapseStateAtLevel, setCollapseStateForMatchingLines, setCollapseStateForRest, setCollapseStateForType, setCollapseStateLevelsDown, setCollapseStateLevelsUp, setCollapseStateUp, toggleCollapseState } from './foldingModel.js';\nimport { HiddenRangeModel } from './hiddenRangeModel.js';\nimport { IndentRangeProvider } from './indentRangeProvider.js';\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { FoldingDecorationProvider } from './foldingDecorations.js';\nimport { FoldingRegions } from './foldingRanges.js';\nimport { SyntaxRangeProvider } from './syntaxRangeProvider.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nconst CONTEXT_FOLDING_ENABLED = new RawContextKey('foldingEnabled', false);\nlet FoldingController = class FoldingController extends Disposable {\n    static { FoldingController_1 = this; }\n    static { this.ID = 'editor.contrib.folding'; }\n    static get(editor) {\n        return editor.getContribution(FoldingController_1.ID);\n    }\n    static getFoldingRangeProviders(languageFeaturesService, model) {\n        const foldingRangeProviders = languageFeaturesService.foldingRangeProvider.ordered(model);\n        return (FoldingController_1._foldingRangeSelector?.(foldingRangeProviders, model)) ?? foldingRangeProviders;\n    }\n    constructor(editor, contextKeyService, languageConfigurationService, notificationService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this.contextKeyService = contextKeyService;\n        this.languageConfigurationService = languageConfigurationService;\n        this.languageFeaturesService = languageFeaturesService;\n        this.localToDispose = this._register(new DisposableStore());\n        this.editor = editor;\n        this._foldingLimitReporter = new RangesLimitReporter(editor);\n        const options = this.editor.getOptions();\n        this._isEnabled = options.get(43 /* EditorOption.folding */);\n        this._useFoldingProviders = options.get(44 /* EditorOption.foldingStrategy */) !== 'indentation';\n        this._unfoldOnClickAfterEndOfLine = options.get(48 /* EditorOption.unfoldOnClickAfterEndOfLine */);\n        this._restoringViewState = false;\n        this._currentModelHasFoldedImports = false;\n        this._foldingImportsByDefault = options.get(46 /* EditorOption.foldingImportsByDefault */);\n        this.updateDebounceInfo = languageFeatureDebounceService.for(languageFeaturesService.foldingRangeProvider, 'Folding', { min: 200 });\n        this.foldingModel = null;\n        this.hiddenRangeModel = null;\n        this.rangeProvider = null;\n        this.foldingRegionPromise = null;\n        this.foldingModelPromise = null;\n        this.updateScheduler = null;\n        this.cursorChangedScheduler = null;\n        this.mouseDownInfo = null;\n        this.foldingDecorationProvider = new FoldingDecorationProvider(editor);\n        this.foldingDecorationProvider.showFoldingControls = options.get(111 /* EditorOption.showFoldingControls */);\n        this.foldingDecorationProvider.showFoldingHighlights = options.get(45 /* EditorOption.foldingHighlight */);\n        this.foldingEnabled = CONTEXT_FOLDING_ENABLED.bindTo(this.contextKeyService);\n        this.foldingEnabled.set(this._isEnabled);\n        this._register(this.editor.onDidChangeModel(() => this.onModelChanged()));\n        this._register(this.editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(43 /* EditorOption.folding */)) {\n                this._isEnabled = this.editor.getOptions().get(43 /* EditorOption.folding */);\n                this.foldingEnabled.set(this._isEnabled);\n                this.onModelChanged();\n            }\n            if (e.hasChanged(47 /* EditorOption.foldingMaximumRegions */)) {\n                this.onModelChanged();\n            }\n            if (e.hasChanged(111 /* EditorOption.showFoldingControls */) || e.hasChanged(45 /* EditorOption.foldingHighlight */)) {\n                const options = this.editor.getOptions();\n                this.foldingDecorationProvider.showFoldingControls = options.get(111 /* EditorOption.showFoldingControls */);\n                this.foldingDecorationProvider.showFoldingHighlights = options.get(45 /* EditorOption.foldingHighlight */);\n                this.triggerFoldingModelChanged();\n            }\n            if (e.hasChanged(44 /* EditorOption.foldingStrategy */)) {\n                this._useFoldingProviders = this.editor.getOptions().get(44 /* EditorOption.foldingStrategy */) !== 'indentation';\n                this.onFoldingStrategyChanged();\n            }\n            if (e.hasChanged(48 /* EditorOption.unfoldOnClickAfterEndOfLine */)) {\n                this._unfoldOnClickAfterEndOfLine = this.editor.getOptions().get(48 /* EditorOption.unfoldOnClickAfterEndOfLine */);\n            }\n            if (e.hasChanged(46 /* EditorOption.foldingImportsByDefault */)) {\n                this._foldingImportsByDefault = this.editor.getOptions().get(46 /* EditorOption.foldingImportsByDefault */);\n            }\n        }));\n        this.onModelChanged();\n    }\n    /**\n     * Store view state.\n     */\n    saveViewState() {\n        const model = this.editor.getModel();\n        if (!model || !this._isEnabled || model.isTooLargeForTokenization()) {\n            return {};\n        }\n        if (this.foldingModel) { // disposed ?\n            const collapsedRegions = this.foldingModel.getMemento();\n            const provider = this.rangeProvider ? this.rangeProvider.id : undefined;\n            return { collapsedRegions, lineCount: model.getLineCount(), provider, foldedImports: this._currentModelHasFoldedImports };\n        }\n        return undefined;\n    }\n    /**\n     * Restore view state.\n     */\n    restoreViewState(state) {\n        const model = this.editor.getModel();\n        if (!model || !this._isEnabled || model.isTooLargeForTokenization() || !this.hiddenRangeModel) {\n            return;\n        }\n        if (!state) {\n            return;\n        }\n        this._currentModelHasFoldedImports = !!state.foldedImports;\n        if (state.collapsedRegions && state.collapsedRegions.length > 0 && this.foldingModel) {\n            this._restoringViewState = true;\n            try {\n                this.foldingModel.applyMemento(state.collapsedRegions);\n            }\n            finally {\n                this._restoringViewState = false;\n            }\n        }\n    }\n    onModelChanged() {\n        this.localToDispose.clear();\n        const model = this.editor.getModel();\n        if (!this._isEnabled || !model || model.isTooLargeForTokenization()) {\n            // huge files get no view model, so they cannot support hidden areas\n            return;\n        }\n        this._currentModelHasFoldedImports = false;\n        this.foldingModel = new FoldingModel(model, this.foldingDecorationProvider);\n        this.localToDispose.add(this.foldingModel);\n        this.hiddenRangeModel = new HiddenRangeModel(this.foldingModel);\n        this.localToDispose.add(this.hiddenRangeModel);\n        this.localToDispose.add(this.hiddenRangeModel.onDidChange(hr => this.onHiddenRangesChanges(hr)));\n        this.updateScheduler = new Delayer(this.updateDebounceInfo.get(model));\n        this.cursorChangedScheduler = new RunOnceScheduler(() => this.revealCursor(), 200);\n        this.localToDispose.add(this.cursorChangedScheduler);\n        this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange(() => this.onFoldingStrategyChanged()));\n        this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(() => this.onFoldingStrategyChanged())); // covers model language changes as well\n        this.localToDispose.add(this.editor.onDidChangeModelContent(e => this.onDidChangeModelContent(e)));\n        this.localToDispose.add(this.editor.onDidChangeCursorPosition(() => this.onCursorPositionChanged()));\n        this.localToDispose.add(this.editor.onMouseDown(e => this.onEditorMouseDown(e)));\n        this.localToDispose.add(this.editor.onMouseUp(e => this.onEditorMouseUp(e)));\n        this.localToDispose.add({\n            dispose: () => {\n                if (this.foldingRegionPromise) {\n                    this.foldingRegionPromise.cancel();\n                    this.foldingRegionPromise = null;\n                }\n                this.updateScheduler?.cancel();\n                this.updateScheduler = null;\n                this.foldingModel = null;\n                this.foldingModelPromise = null;\n                this.hiddenRangeModel = null;\n                this.cursorChangedScheduler = null;\n                this.rangeProvider?.dispose();\n                this.rangeProvider = null;\n            }\n        });\n        this.triggerFoldingModelChanged();\n    }\n    onFoldingStrategyChanged() {\n        this.rangeProvider?.dispose();\n        this.rangeProvider = null;\n        this.triggerFoldingModelChanged();\n    }\n    getRangeProvider(editorModel) {\n        if (this.rangeProvider) {\n            return this.rangeProvider;\n        }\n        const indentRangeProvider = new IndentRangeProvider(editorModel, this.languageConfigurationService, this._foldingLimitReporter);\n        this.rangeProvider = indentRangeProvider; // fallback\n        if (this._useFoldingProviders && this.foldingModel) {\n            const selectedProviders = FoldingController_1.getFoldingRangeProviders(this.languageFeaturesService, editorModel);\n            if (selectedProviders.length > 0) {\n                this.rangeProvider = new SyntaxRangeProvider(editorModel, selectedProviders, () => this.triggerFoldingModelChanged(), this._foldingLimitReporter, indentRangeProvider);\n            }\n        }\n        return this.rangeProvider;\n    }\n    getFoldingModel() {\n        return this.foldingModelPromise;\n    }\n    onDidChangeModelContent(e) {\n        this.hiddenRangeModel?.notifyChangeModelContent(e);\n        this.triggerFoldingModelChanged();\n    }\n    triggerFoldingModelChanged() {\n        if (this.updateScheduler) {\n            if (this.foldingRegionPromise) {\n                this.foldingRegionPromise.cancel();\n                this.foldingRegionPromise = null;\n            }\n            this.foldingModelPromise = this.updateScheduler.trigger(() => {\n                const foldingModel = this.foldingModel;\n                if (!foldingModel) { // null if editor has been disposed, or folding turned off\n                    return null;\n                }\n                const sw = new StopWatch();\n                const provider = this.getRangeProvider(foldingModel.textModel);\n                const foldingRegionPromise = this.foldingRegionPromise = createCancelablePromise(token => provider.compute(token));\n                return foldingRegionPromise.then(foldingRanges => {\n                    if (foldingRanges && foldingRegionPromise === this.foldingRegionPromise) { // new request or cancelled in the meantime?\n                        let scrollState;\n                        if (this._foldingImportsByDefault && !this._currentModelHasFoldedImports) {\n                            const hasChanges = foldingRanges.setCollapsedAllOfType(FoldingRangeKind.Imports.value, true);\n                            if (hasChanges) {\n                                scrollState = StableEditorScrollState.capture(this.editor);\n                                this._currentModelHasFoldedImports = hasChanges;\n                            }\n                        }\n                        // some cursors might have moved into hidden regions, make sure they are in expanded regions\n                        const selections = this.editor.getSelections();\n                        foldingModel.update(foldingRanges, toSelectedLines(selections));\n                        scrollState?.restore(this.editor);\n                        // update debounce info\n                        const newValue = this.updateDebounceInfo.update(foldingModel.textModel, sw.elapsed());\n                        if (this.updateScheduler) {\n                            this.updateScheduler.defaultDelay = newValue;\n                        }\n                    }\n                    return foldingModel;\n                });\n            }).then(undefined, (err) => {\n                onUnexpectedError(err);\n                return null;\n            });\n        }\n    }\n    onHiddenRangesChanges(hiddenRanges) {\n        if (this.hiddenRangeModel && hiddenRanges.length && !this._restoringViewState) {\n            const selections = this.editor.getSelections();\n            if (selections) {\n                if (this.hiddenRangeModel.adjustSelections(selections)) {\n                    this.editor.setSelections(selections);\n                }\n            }\n        }\n        this.editor.setHiddenAreas(hiddenRanges, this);\n    }\n    onCursorPositionChanged() {\n        if (this.hiddenRangeModel && this.hiddenRangeModel.hasRanges()) {\n            this.cursorChangedScheduler.schedule();\n        }\n    }\n    revealCursor() {\n        const foldingModel = this.getFoldingModel();\n        if (!foldingModel) {\n            return;\n        }\n        foldingModel.then(foldingModel => {\n            if (foldingModel) {\n                const selections = this.editor.getSelections();\n                if (selections && selections.length > 0) {\n                    const toToggle = [];\n                    for (const selection of selections) {\n                        const lineNumber = selection.selectionStartLineNumber;\n                        if (this.hiddenRangeModel && this.hiddenRangeModel.isHidden(lineNumber)) {\n                            toToggle.push(...foldingModel.getAllRegionsAtLine(lineNumber, r => r.isCollapsed && lineNumber > r.startLineNumber));\n                        }\n                    }\n                    if (toToggle.length) {\n                        foldingModel.toggleCollapseState(toToggle);\n                        this.reveal(selections[0].getPosition());\n                    }\n                }\n            }\n        }).then(undefined, onUnexpectedError);\n    }\n    onEditorMouseDown(e) {\n        this.mouseDownInfo = null;\n        if (!this.hiddenRangeModel || !e.target || !e.target.range) {\n            return;\n        }\n        if (!e.event.leftButton && !e.event.middleButton) {\n            return;\n        }\n        const range = e.target.range;\n        let iconClicked = false;\n        switch (e.target.type) {\n            case 4 /* MouseTargetType.GUTTER_LINE_DECORATIONS */: {\n                const data = e.target.detail;\n                const offsetLeftInGutter = e.target.element.offsetLeft;\n                const gutterOffsetX = data.offsetX - offsetLeftInGutter;\n                // const gutterOffsetX = data.offsetX - data.glyphMarginWidth - data.lineNumbersWidth - data.glyphMarginLeft;\n                // TODO@joao TODO@alex TODO@martin this is such that we don't collide with dirty diff\n                if (gutterOffsetX < 4) { // the whitespace between the border and the real folding icon border is 4px\n                    return;\n                }\n                iconClicked = true;\n                break;\n            }\n            case 7 /* MouseTargetType.CONTENT_EMPTY */: {\n                if (this._unfoldOnClickAfterEndOfLine && this.hiddenRangeModel.hasRanges()) {\n                    const data = e.target.detail;\n                    if (!data.isAfterLines) {\n                        break;\n                    }\n                }\n                return;\n            }\n            case 6 /* MouseTargetType.CONTENT_TEXT */: {\n                if (this.hiddenRangeModel.hasRanges()) {\n                    const model = this.editor.getModel();\n                    if (model && range.startColumn === model.getLineMaxColumn(range.startLineNumber)) {\n                        break;\n                    }\n                }\n                return;\n            }\n            default:\n                return;\n        }\n        this.mouseDownInfo = { lineNumber: range.startLineNumber, iconClicked };\n    }\n    onEditorMouseUp(e) {\n        const foldingModel = this.foldingModel;\n        if (!foldingModel || !this.mouseDownInfo || !e.target) {\n            return;\n        }\n        const lineNumber = this.mouseDownInfo.lineNumber;\n        const iconClicked = this.mouseDownInfo.iconClicked;\n        const range = e.target.range;\n        if (!range || range.startLineNumber !== lineNumber) {\n            return;\n        }\n        if (iconClicked) {\n            if (e.target.type !== 4 /* MouseTargetType.GUTTER_LINE_DECORATIONS */) {\n                return;\n            }\n        }\n        else {\n            const model = this.editor.getModel();\n            if (!model || range.startColumn !== model.getLineMaxColumn(lineNumber)) {\n                return;\n            }\n        }\n        const region = foldingModel.getRegionAtLine(lineNumber);\n        if (region && region.startLineNumber === lineNumber) {\n            const isCollapsed = region.isCollapsed;\n            if (iconClicked || isCollapsed) {\n                const surrounding = e.event.altKey;\n                let toToggle = [];\n                if (surrounding) {\n                    const filter = (otherRegion) => !otherRegion.containedBy(region) && !region.containedBy(otherRegion);\n                    const toMaybeToggle = foldingModel.getRegionsInside(null, filter);\n                    for (const r of toMaybeToggle) {\n                        if (r.isCollapsed) {\n                            toToggle.push(r);\n                        }\n                    }\n                    // if any surrounding regions are folded, unfold those. Otherwise, fold all surrounding\n                    if (toToggle.length === 0) {\n                        toToggle = toMaybeToggle;\n                    }\n                }\n                else {\n                    const recursive = e.event.middleButton || e.event.shiftKey;\n                    if (recursive) {\n                        for (const r of foldingModel.getRegionsInside(region)) {\n                            if (r.isCollapsed === isCollapsed) {\n                                toToggle.push(r);\n                            }\n                        }\n                    }\n                    // when recursive, first only collapse all children. If all are already folded or there are no children, also fold parent.\n                    if (isCollapsed || !recursive || toToggle.length === 0) {\n                        toToggle.push(region);\n                    }\n                }\n                foldingModel.toggleCollapseState(toToggle);\n                this.reveal({ lineNumber, column: 1 });\n            }\n        }\n    }\n    reveal(position) {\n        this.editor.revealPositionInCenterIfOutsideViewport(position, 0 /* ScrollType.Smooth */);\n    }\n};\nFoldingController = FoldingController_1 = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, ILanguageConfigurationService),\n    __param(3, INotificationService),\n    __param(4, ILanguageFeatureDebounceService),\n    __param(5, ILanguageFeaturesService)\n], FoldingController);\nexport { FoldingController };\nexport class RangesLimitReporter {\n    constructor(editor) {\n        this.editor = editor;\n        this._onDidChange = new Emitter();\n        this._computed = 0;\n        this._limited = false;\n    }\n    get limit() {\n        return this.editor.getOptions().get(47 /* EditorOption.foldingMaximumRegions */);\n    }\n    update(computed, limited) {\n        if (computed !== this._computed || limited !== this._limited) {\n            this._computed = computed;\n            this._limited = limited;\n            this._onDidChange.fire();\n        }\n    }\n}\nclass FoldingAction extends EditorAction {\n    runEditorCommand(accessor, editor, args) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const foldingController = FoldingController.get(editor);\n        if (!foldingController) {\n            return;\n        }\n        const foldingModelPromise = foldingController.getFoldingModel();\n        if (foldingModelPromise) {\n            this.reportTelemetry(accessor, editor);\n            return foldingModelPromise.then(foldingModel => {\n                if (foldingModel) {\n                    this.invoke(foldingController, foldingModel, editor, args, languageConfigurationService);\n                    const selection = editor.getSelection();\n                    if (selection) {\n                        foldingController.reveal(selection.getStartPosition());\n                    }\n                }\n            });\n        }\n    }\n    getSelectedLines(editor) {\n        const selections = editor.getSelections();\n        return selections ? selections.map(s => s.startLineNumber) : [];\n    }\n    getLineNumbers(args, editor) {\n        if (args && args.selectionLines) {\n            return args.selectionLines.map(l => l + 1); // to 0-bases line numbers\n        }\n        return this.getSelectedLines(editor);\n    }\n    run(_accessor, _editor) {\n    }\n}\nexport function toSelectedLines(selections) {\n    if (!selections || selections.length === 0) {\n        return {\n            startsInside: () => false\n        };\n    }\n    return {\n        startsInside(startLine, endLine) {\n            for (const s of selections) {\n                const line = s.startLineNumber;\n                if (line >= startLine && line <= endLine) {\n                    return true;\n                }\n            }\n            return false;\n        }\n    };\n}\nfunction foldingArgumentsConstraint(args) {\n    if (!types.isUndefined(args)) {\n        if (!types.isObject(args)) {\n            return false;\n        }\n        const foldingArgs = args;\n        if (!types.isUndefined(foldingArgs.levels) && !types.isNumber(foldingArgs.levels)) {\n            return false;\n        }\n        if (!types.isUndefined(foldingArgs.direction) && !types.isString(foldingArgs.direction)) {\n            return false;\n        }\n        if (!types.isUndefined(foldingArgs.selectionLines) && (!Array.isArray(foldingArgs.selectionLines) || !foldingArgs.selectionLines.every(types.isNumber))) {\n            return false;\n        }\n    }\n    return true;\n}\nclass UnfoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfold',\n            label: nls.localize('unfoldAction.label', \"Unfold\"),\n            alias: 'Unfold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 94 /* KeyCode.BracketRight */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 94 /* KeyCode.BracketRight */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: 'Unfold the content in the editor',\n                args: [\n                    {\n                        name: 'Unfold editor argument',\n                        description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t* 'levels': Number of levels to unfold. If not set, defaults to 1.\n\t\t\t\t\t\t* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.\n\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t`,\n                        constraint: foldingArgumentsConstraint,\n                        schema: {\n                            'type': 'object',\n                            'properties': {\n                                'levels': {\n                                    'type': 'number',\n                                    'default': 1\n                                },\n                                'direction': {\n                                    'type': 'string',\n                                    'enum': ['up', 'down'],\n                                    'default': 'down'\n                                },\n                                'selectionLines': {\n                                    'type': 'array',\n                                    'items': {\n                                        'type': 'number'\n                                    }\n                                }\n                            }\n                        }\n                    }\n                ]\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args) {\n        const levels = args && args.levels || 1;\n        const lineNumbers = this.getLineNumbers(args, editor);\n        if (args && args.direction === 'up') {\n            setCollapseStateLevelsUp(foldingModel, false, levels, lineNumbers);\n        }\n        else {\n            setCollapseStateLevelsDown(foldingModel, false, levels, lineNumbers);\n        }\n    }\n}\nclass UnFoldRecursivelyAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldRecursively',\n            label: nls.localize('unFoldRecursivelyAction.label', \"Unfold Recursively\"),\n            alias: 'Unfold Recursively',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 94 /* KeyCode.BracketRight */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, _args) {\n        setCollapseStateLevelsDown(foldingModel, false, Number.MAX_VALUE, this.getSelectedLines(editor));\n    }\n}\nclass FoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.fold',\n            label: nls.localize('foldAction.label', \"Fold\"),\n            alias: 'Fold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 92 /* KeyCode.BracketLeft */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 92 /* KeyCode.BracketLeft */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: 'Fold the content in the editor',\n                args: [\n                    {\n                        name: 'Fold editor argument',\n                        description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t\t* 'levels': Number of levels to fold.\n\t\t\t\t\t\t\t* 'direction': If 'up', folds given number of levels up otherwise folds down.\n\t\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t\tIf no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.\n\t\t\t\t\t\t`,\n                        constraint: foldingArgumentsConstraint,\n                        schema: {\n                            'type': 'object',\n                            'properties': {\n                                'levels': {\n                                    'type': 'number',\n                                },\n                                'direction': {\n                                    'type': 'string',\n                                    'enum': ['up', 'down'],\n                                },\n                                'selectionLines': {\n                                    'type': 'array',\n                                    'items': {\n                                        'type': 'number'\n                                    }\n                                }\n                            }\n                        }\n                    }\n                ]\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args) {\n        const lineNumbers = this.getLineNumbers(args, editor);\n        const levels = args && args.levels;\n        const direction = args && args.direction;\n        if (typeof levels !== 'number' && typeof direction !== 'string') {\n            // fold the region at the location or if already collapsed, the first uncollapsed parent instead.\n            setCollapseStateUp(foldingModel, true, lineNumbers);\n        }\n        else {\n            if (direction === 'up') {\n                setCollapseStateLevelsUp(foldingModel, true, levels || 1, lineNumbers);\n            }\n            else {\n                setCollapseStateLevelsDown(foldingModel, true, levels || 1, lineNumbers);\n            }\n        }\n    }\n}\nclass ToggleFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.toggleFold',\n            label: nls.localize('toggleFoldAction.label', \"Toggle Fold\"),\n            alias: 'Toggle Fold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 42 /* KeyCode.KeyL */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        toggleCollapseState(foldingModel, 1, selectedLines);\n    }\n}\nclass FoldRecursivelyAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldRecursively',\n            label: nls.localize('foldRecursivelyAction.label', \"Fold Recursively\"),\n            alias: 'Fold Recursively',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 92 /* KeyCode.BracketLeft */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        setCollapseStateLevelsDown(foldingModel, true, Number.MAX_VALUE, selectedLines);\n    }\n}\nclass ToggleFoldRecursivelyAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.toggleFoldRecursively',\n            label: nls.localize('toggleFoldRecursivelyAction.label', \"Toggle Fold Recursively\"),\n            alias: 'Toggle Fold Recursively',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 42 /* KeyCode.KeyL */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        toggleCollapseState(foldingModel, Number.MAX_VALUE, selectedLines);\n    }\n}\nclass FoldAllBlockCommentsAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAllBlockComments',\n            label: nls.localize('foldAllBlockComments.label', \"Fold All Block Comments\"),\n            alias: 'Fold All Block Comments',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 90 /* KeyCode.Slash */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args, languageConfigurationService) {\n        if (foldingModel.regions.hasTypes()) {\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Comment.value, true);\n        }\n        else {\n            const editorModel = editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const comments = languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).comments;\n            if (comments && comments.blockCommentStartToken) {\n                const regExp = new RegExp('^\\\\s*' + escapeRegExpCharacters(comments.blockCommentStartToken));\n                setCollapseStateForMatchingLines(foldingModel, regExp, true);\n            }\n        }\n    }\n}\nclass FoldAllRegionsAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAllMarkerRegions',\n            label: nls.localize('foldAllMarkerRegions.label', \"Fold All Regions\"),\n            alias: 'Fold All Regions',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 29 /* KeyCode.Digit8 */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args, languageConfigurationService) {\n        if (foldingModel.regions.hasTypes()) {\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Region.value, true);\n        }\n        else {\n            const editorModel = editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const foldingRules = languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).foldingRules;\n            if (foldingRules && foldingRules.markers && foldingRules.markers.start) {\n                const regExp = new RegExp(foldingRules.markers.start);\n                setCollapseStateForMatchingLines(foldingModel, regExp, true);\n            }\n        }\n    }\n}\nclass UnfoldAllRegionsAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldAllMarkerRegions',\n            label: nls.localize('unfoldAllMarkerRegions.label', \"Unfold All Regions\"),\n            alias: 'Unfold All Regions',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 30 /* KeyCode.Digit9 */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args, languageConfigurationService) {\n        if (foldingModel.regions.hasTypes()) {\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Region.value, false);\n        }\n        else {\n            const editorModel = editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const foldingRules = languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).foldingRules;\n            if (foldingRules && foldingRules.markers && foldingRules.markers.start) {\n                const regExp = new RegExp(foldingRules.markers.start);\n                setCollapseStateForMatchingLines(foldingModel, regExp, false);\n            }\n        }\n    }\n}\nclass FoldAllExceptAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAllExcept',\n            label: nls.localize('foldAllExcept.label', \"Fold All Except Selected\"),\n            alias: 'Fold All Except Selected',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 88 /* KeyCode.Minus */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        setCollapseStateForRest(foldingModel, true, selectedLines);\n    }\n}\nclass UnfoldAllExceptAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldAllExcept',\n            label: nls.localize('unfoldAllExcept.label', \"Unfold All Except Selected\"),\n            alias: 'Unfold All Except Selected',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 86 /* KeyCode.Equal */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        setCollapseStateForRest(foldingModel, false, selectedLines);\n    }\n}\nclass FoldAllAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAll',\n            label: nls.localize('foldAllAction.label', \"Fold All\"),\n            alias: 'Fold All',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 21 /* KeyCode.Digit0 */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, _editor) {\n        setCollapseStateLevelsDown(foldingModel, true);\n    }\n}\nclass UnfoldAllAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldAll',\n            label: nls.localize('unfoldAllAction.label', \"Unfold All\"),\n            alias: 'Unfold All',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 40 /* KeyCode.KeyJ */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, _editor) {\n        setCollapseStateLevelsDown(foldingModel, false);\n    }\n}\nclass FoldLevelAction extends FoldingAction {\n    static { this.ID_PREFIX = 'editor.foldLevel'; }\n    static { this.ID = (level) => FoldLevelAction.ID_PREFIX + level; }\n    getFoldingLevel() {\n        return parseInt(this.id.substr(FoldLevelAction.ID_PREFIX.length));\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        setCollapseStateAtLevel(foldingModel, this.getFoldingLevel(), true, this.getSelectedLines(editor));\n    }\n}\n/** Action to go to the parent fold of current line */\nclass GotoParentFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.gotoParentFold',\n            label: nls.localize('gotoParentFold.label', \"Go to Parent Fold\"),\n            alias: 'Go to Parent Fold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        if (selectedLines.length > 0) {\n            const startLineNumber = getParentFoldLine(selectedLines[0], foldingModel);\n            if (startLineNumber !== null) {\n                editor.setSelection({\n                    startLineNumber: startLineNumber,\n                    startColumn: 1,\n                    endLineNumber: startLineNumber,\n                    endColumn: 1\n                });\n            }\n        }\n    }\n}\n/** Action to go to the previous fold of current line */\nclass GotoPreviousFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.gotoPreviousFold',\n            label: nls.localize('gotoPreviousFold.label', \"Go to Previous Folding Range\"),\n            alias: 'Go to Previous Folding Range',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        if (selectedLines.length > 0) {\n            const startLineNumber = getPreviousFoldLine(selectedLines[0], foldingModel);\n            if (startLineNumber !== null) {\n                editor.setSelection({\n                    startLineNumber: startLineNumber,\n                    startColumn: 1,\n                    endLineNumber: startLineNumber,\n                    endColumn: 1\n                });\n            }\n        }\n    }\n}\n/** Action to go to the next fold of current line */\nclass GotoNextFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.gotoNextFold',\n            label: nls.localize('gotoNextFold.label', \"Go to Next Folding Range\"),\n            alias: 'Go to Next Folding Range',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        if (selectedLines.length > 0) {\n            const startLineNumber = getNextFoldLine(selectedLines[0], foldingModel);\n            if (startLineNumber !== null) {\n                editor.setSelection({\n                    startLineNumber: startLineNumber,\n                    startColumn: 1,\n                    endLineNumber: startLineNumber,\n                    endColumn: 1\n                });\n            }\n        }\n    }\n}\nclass FoldRangeFromSelectionAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.createFoldingRangeFromSelection',\n            label: nls.localize('createManualFoldRange.label', \"Create Folding Range from Selection\"),\n            alias: 'Create Folding Range from Selection',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 87 /* KeyCode.Comma */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const collapseRanges = [];\n        const selections = editor.getSelections();\n        if (selections) {\n            for (const selection of selections) {\n                let endLineNumber = selection.endLineNumber;\n                if (selection.endColumn === 1) {\n                    --endLineNumber;\n                }\n                if (endLineNumber > selection.startLineNumber) {\n                    collapseRanges.push({\n                        startLineNumber: selection.startLineNumber,\n                        endLineNumber: endLineNumber,\n                        type: undefined,\n                        isCollapsed: true,\n                        source: 1 /* FoldSource.userDefined */\n                    });\n                    editor.setSelection({\n                        startLineNumber: selection.startLineNumber,\n                        startColumn: 1,\n                        endLineNumber: selection.startLineNumber,\n                        endColumn: 1\n                    });\n                }\n            }\n            if (collapseRanges.length > 0) {\n                collapseRanges.sort((a, b) => {\n                    return a.startLineNumber - b.startLineNumber;\n                });\n                const newRanges = FoldingRegions.sanitizeAndMerge(foldingModel.regions, collapseRanges, editor.getModel()?.getLineCount());\n                foldingModel.updatePost(FoldingRegions.fromFoldRanges(newRanges));\n            }\n        }\n    }\n}\nclass RemoveFoldRangeFromSelectionAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.removeManualFoldingRanges',\n            label: nls.localize('removeManualFoldingRanges.label', \"Remove Manual Folding Ranges\"),\n            alias: 'Remove Manual Folding Ranges',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 89 /* KeyCode.Period */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(foldingController, foldingModel, editor) {\n        const selections = editor.getSelections();\n        if (selections) {\n            const ranges = [];\n            for (const selection of selections) {\n                const { startLineNumber, endLineNumber } = selection;\n                ranges.push(endLineNumber >= startLineNumber ? { startLineNumber, endLineNumber } : { endLineNumber, startLineNumber });\n            }\n            foldingModel.removeManualRanges(ranges);\n            foldingController.triggerFoldingModelChanged();\n        }\n    }\n}\nregisterEditorContribution(FoldingController.ID, FoldingController, 0 /* EditorContributionInstantiation.Eager */); // eager because it uses `saveViewState`/`restoreViewState`\nregisterEditorAction(UnfoldAction);\nregisterEditorAction(UnFoldRecursivelyAction);\nregisterEditorAction(FoldAction);\nregisterEditorAction(FoldRecursivelyAction);\nregisterEditorAction(ToggleFoldRecursivelyAction);\nregisterEditorAction(FoldAllAction);\nregisterEditorAction(UnfoldAllAction);\nregisterEditorAction(FoldAllBlockCommentsAction);\nregisterEditorAction(FoldAllRegionsAction);\nregisterEditorAction(UnfoldAllRegionsAction);\nregisterEditorAction(FoldAllExceptAction);\nregisterEditorAction(UnfoldAllExceptAction);\nregisterEditorAction(ToggleFoldAction);\nregisterEditorAction(GotoParentFoldAction);\nregisterEditorAction(GotoPreviousFoldAction);\nregisterEditorAction(GotoNextFoldAction);\nregisterEditorAction(FoldRangeFromSelectionAction);\nregisterEditorAction(RemoveFoldRangeFromSelectionAction);\nfor (let i = 1; i <= 7; i++) {\n    registerInstantiatedEditorAction(new FoldLevelAction({\n        id: FoldLevelAction.ID(i),\n        label: nls.localize('foldLevelAction.label', \"Fold Level {0}\", i),\n        alias: `Fold Level ${i}`,\n        precondition: CONTEXT_FOLDING_ENABLED,\n        kbOpts: {\n            kbExpr: EditorContextKeys.editorTextFocus,\n            primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | (21 /* KeyCode.Digit0 */ + i)),\n            weight: 100 /* KeybindingWeight.EditorContrib */\n        }\n    }));\n}\nCommandsRegistry.registerCommand('_executeFoldingRangeProvider', async function (accessor, ...args) {\n    const [resource] = args;\n    if (!(resource instanceof URI)) {\n        throw illegalArgument();\n    }\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const model = accessor.get(IModelService).getModel(resource);\n    if (!model) {\n        throw illegalArgument();\n    }\n    const configurationService = accessor.get(IConfigurationService);\n    if (!configurationService.getValue('editor.folding', { resource })) {\n        return [];\n    }\n    const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n    const strategy = configurationService.getValue('editor.foldingStrategy', { resource });\n    const foldingLimitReporter = {\n        get limit() {\n            return configurationService.getValue('editor.foldingMaximumRegions', { resource });\n        },\n        update: (computed, limited) => { }\n    };\n    const indentRangeProvider = new IndentRangeProvider(model, languageConfigurationService, foldingLimitReporter);\n    let rangeProvider = indentRangeProvider;\n    if (strategy !== 'indentation') {\n        const providers = FoldingController.getFoldingRangeProviders(languageFeaturesService, model);\n        if (providers.length) {\n            rangeProvider = new SyntaxRangeProvider(model, providers, () => { }, foldingLimitReporter, indentRangeProvider);\n        }\n    }\n    const ranges = await rangeProvider.compute(CancellationToken.None);\n    const result = [];\n    try {\n        if (ranges) {\n            for (let i = 0; i < ranges.length; i++) {\n                const type = ranges.getType(i);\n                result.push({ start: ranges.getStartLineNumber(i), end: ranges.getEndLineNumber(i), kind: type ? FoldingRangeKind.fromValue(type) : undefined });\n            }\n        }\n        return result;\n    }\n    finally {\n        rangeProvider.dispose();\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorZoom } from '../../../common/config/editorZoom.js';\nimport * as nls from '../../../../nls.js';\nclass EditorFontZoomIn extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomIn',\n            label: nls.localize('EditorFontZoomIn.label', \"Increase Editor Font Size\"),\n            alias: 'Increase Editor Font Size',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() + 1);\n    }\n}\nclass EditorFontZoomOut extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomOut',\n            label: nls.localize('EditorFontZoomOut.label', \"Decrease Editor Font Size\"),\n            alias: 'Decrease Editor Font Size',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() - 1);\n    }\n}\nclass EditorFontZoomReset extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomReset',\n            label: nls.localize('EditorFontZoomReset.label', \"Reset Editor Font Size\"),\n            alias: 'Reset Editor Font Size',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(0);\n    }\n}\nregisterEditorAction(EditorFontZoomIn);\nregisterEditorAction(EditorFontZoomOut);\nregisterEditorAction(EditorFontZoomReset);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { CharacterSet } from '../../../common/core/characterClassifier.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { formatDocumentRangesWithSelectedProvider, formatDocumentWithSelectedProvider, getOnTypeFormattingEdits } from './format.js';\nimport { FormattingEdit } from './formattingEdit.js';\nimport * as nls from '../../../../nls.js';\nimport { AccessibilitySignal, IAccessibilitySignalService } from '../../../../platform/accessibilitySignal/browser/accessibilitySignalService.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IEditorProgressService, Progress } from '../../../../platform/progress/common/progress.js';\nlet FormatOnType = class FormatOnType {\n    static { this.ID = 'editor.contrib.autoFormat'; }\n    constructor(_editor, _languageFeaturesService, _workerService, _accessibilitySignalService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._workerService = _workerService;\n        this._accessibilitySignalService = _accessibilitySignalService;\n        this._disposables = new DisposableStore();\n        this._sessionDisposables = new DisposableStore();\n        this._disposables.add(_languageFeaturesService.onTypeFormattingEditProvider.onDidChange(this._update, this));\n        this._disposables.add(_editor.onDidChangeModel(() => this._update()));\n        this._disposables.add(_editor.onDidChangeModelLanguage(() => this._update()));\n        this._disposables.add(_editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(56 /* EditorOption.formatOnType */)) {\n                this._update();\n            }\n        }));\n        this._update();\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._sessionDisposables.dispose();\n    }\n    _update() {\n        // clean up\n        this._sessionDisposables.clear();\n        // we are disabled\n        if (!this._editor.getOption(56 /* EditorOption.formatOnType */)) {\n            return;\n        }\n        // no model\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        // no support\n        const [support] = this._languageFeaturesService.onTypeFormattingEditProvider.ordered(model);\n        if (!support || !support.autoFormatTriggerCharacters) {\n            return;\n        }\n        // register typing listeners that will trigger the format\n        const triggerChars = new CharacterSet();\n        for (const ch of support.autoFormatTriggerCharacters) {\n            triggerChars.add(ch.charCodeAt(0));\n        }\n        this._sessionDisposables.add(this._editor.onDidType((text) => {\n            const lastCharCode = text.charCodeAt(text.length - 1);\n            if (triggerChars.has(lastCharCode)) {\n                this._trigger(String.fromCharCode(lastCharCode));\n            }\n        }));\n    }\n    _trigger(ch) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (this._editor.getSelections().length > 1 || !this._editor.getSelection().isEmpty()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const position = this._editor.getPosition();\n        const cts = new CancellationTokenSource();\n        // install a listener that checks if edits happens before the\n        // position on which we format right now. If so, we won't\n        // apply the format edits\n        const unbind = this._editor.onDidChangeModelContent((e) => {\n            if (e.isFlush) {\n                // a model.setValue() was called\n                // cancel only once\n                cts.cancel();\n                unbind.dispose();\n                return;\n            }\n            for (let i = 0, len = e.changes.length; i < len; i++) {\n                const change = e.changes[i];\n                if (change.range.endLineNumber <= position.lineNumber) {\n                    // cancel only once\n                    cts.cancel();\n                    unbind.dispose();\n                    return;\n                }\n            }\n        });\n        getOnTypeFormattingEdits(this._workerService, this._languageFeaturesService, model, position, ch, model.getFormattingOptions(), cts.token).then(edits => {\n            if (cts.token.isCancellationRequested) {\n                return;\n            }\n            if (isNonEmptyArray(edits)) {\n                this._accessibilitySignalService.playSignal(AccessibilitySignal.format, { userGesture: false });\n                FormattingEdit.execute(this._editor, edits, true);\n            }\n        }).finally(() => {\n            unbind.dispose();\n        });\n    }\n};\nFormatOnType = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IEditorWorkerService),\n    __param(3, IAccessibilitySignalService)\n], FormatOnType);\nexport { FormatOnType };\nlet FormatOnPaste = class FormatOnPaste {\n    static { this.ID = 'editor.contrib.formatOnPaste'; }\n    constructor(editor, _languageFeaturesService, _instantiationService) {\n        this.editor = editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._instantiationService = _instantiationService;\n        this._callOnDispose = new DisposableStore();\n        this._callOnModel = new DisposableStore();\n        this._callOnDispose.add(editor.onDidChangeConfiguration(() => this._update()));\n        this._callOnDispose.add(editor.onDidChangeModel(() => this._update()));\n        this._callOnDispose.add(editor.onDidChangeModelLanguage(() => this._update()));\n        this._callOnDispose.add(_languageFeaturesService.documentRangeFormattingEditProvider.onDidChange(this._update, this));\n    }\n    dispose() {\n        this._callOnDispose.dispose();\n        this._callOnModel.dispose();\n    }\n    _update() {\n        // clean up\n        this._callOnModel.clear();\n        // we are disabled\n        if (!this.editor.getOption(55 /* EditorOption.formatOnPaste */)) {\n            return;\n        }\n        // no model\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        // no formatter\n        if (!this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())) {\n            return;\n        }\n        this._callOnModel.add(this.editor.onDidPaste(({ range }) => this._trigger(range)));\n    }\n    _trigger(range) {\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        if (this.editor.getSelections().length > 1) {\n            return;\n        }\n        this._instantiationService.invokeFunction(formatDocumentRangesWithSelectedProvider, this.editor, range, 2 /* FormattingMode.Silent */, Progress.None, CancellationToken.None, false).catch(onUnexpectedError);\n    }\n};\nFormatOnPaste = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IInstantiationService)\n], FormatOnPaste);\nclass FormatDocumentAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.formatDocument',\n            label: nls.localize('formatDocument.label', \"Format Document\"),\n            alias: 'Format Document',\n            precondition: ContextKeyExpr.and(EditorContextKeys.notInCompositeEditor, EditorContextKeys.writable, EditorContextKeys.hasDocumentFormattingProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 36 /* KeyCode.KeyF */,\n                linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 39 /* KeyCode.KeyI */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 1.3\n            }\n        });\n    }\n    async run(accessor, editor) {\n        if (editor.hasModel()) {\n            const instaService = accessor.get(IInstantiationService);\n            const progressService = accessor.get(IEditorProgressService);\n            await progressService.showWhile(instaService.invokeFunction(formatDocumentWithSelectedProvider, editor, 1 /* FormattingMode.Explicit */, Progress.None, CancellationToken.None, true), 250);\n        }\n    }\n}\nclass FormatSelectionAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.formatSelection',\n            label: nls.localize('formatSelection.label', \"Format Selection\"),\n            alias: 'Format Selection',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasDocumentSelectionFormattingProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 36 /* KeyCode.KeyF */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                when: EditorContextKeys.hasNonEmptySelection,\n                group: '1_modification',\n                order: 1.31\n            }\n        });\n    }\n    async run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const instaService = accessor.get(IInstantiationService);\n        const model = editor.getModel();\n        const ranges = editor.getSelections().map(range => {\n            return range.isEmpty()\n                ? new Range(range.startLineNumber, 1, range.startLineNumber, model.getLineMaxColumn(range.startLineNumber))\n                : range;\n        });\n        const progressService = accessor.get(IEditorProgressService);\n        await progressService.showWhile(instaService.invokeFunction(formatDocumentRangesWithSelectedProvider, editor, ranges, 1 /* FormattingMode.Explicit */, Progress.None, CancellationToken.None, true), 250);\n    }\n}\nregisterEditorContribution(FormatOnType.ID, FormatOnType, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorContribution(FormatOnPaste.ID, FormatOnPaste, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(FormatDocumentAction);\nregisterEditorAction(FormatSelectionAction);\n// this is the old format action that does both (format document OR format selection)\n// and we keep it here such that existing keybinding configurations etc will still work\nCommandsRegistry.registerCommand('editor.action.format', async (accessor) => {\n    const editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n    if (!editor || !editor.hasModel()) {\n        return;\n    }\n    const commandService = accessor.get(ICommandService);\n    if (editor.getSelection().isEmpty()) {\n        await commandService.executeCommand('editor.action.formatDocument');\n    }\n    else {\n        await commandService.executeCommand('editor.action.formatSelection');\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { equals } from '../../../../base/common/arrays.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { LRUCache } from '../../../../base/common/map.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport class TreeElement {\n    remove() {\n        this.parent?.children.delete(this.id);\n    }\n    static findId(candidate, container) {\n        // complex id-computation which contains the origin/extension,\n        // the parent path, and some dedupe logic when names collide\n        let candidateId;\n        if (typeof candidate === 'string') {\n            candidateId = `${container.id}/${candidate}`;\n        }\n        else {\n            candidateId = `${container.id}/${candidate.name}`;\n            if (container.children.get(candidateId) !== undefined) {\n                candidateId = `${container.id}/${candidate.name}_${candidate.range.startLineNumber}_${candidate.range.startColumn}`;\n            }\n        }\n        let id = candidateId;\n        for (let i = 0; container.children.get(id) !== undefined; i++) {\n            id = `${candidateId}_${i}`;\n        }\n        return id;\n    }\n    static empty(element) {\n        return element.children.size === 0;\n    }\n}\nexport class OutlineElement extends TreeElement {\n    constructor(id, parent, symbol) {\n        super();\n        this.id = id;\n        this.parent = parent;\n        this.symbol = symbol;\n        this.children = new Map();\n    }\n}\nexport class OutlineGroup extends TreeElement {\n    constructor(id, parent, label, order) {\n        super();\n        this.id = id;\n        this.parent = parent;\n        this.label = label;\n        this.order = order;\n        this.children = new Map();\n    }\n}\nexport class OutlineModel extends TreeElement {\n    static create(registry, textModel, token) {\n        const cts = new CancellationTokenSource(token);\n        const result = new OutlineModel(textModel.uri);\n        const provider = registry.ordered(textModel);\n        const promises = provider.map((provider, index) => {\n            const id = TreeElement.findId(`provider_${index}`, result);\n            const group = new OutlineGroup(id, result, provider.displayName ?? 'Unknown Outline Provider', index);\n            return Promise.resolve(provider.provideDocumentSymbols(textModel, cts.token)).then(result => {\n                for (const info of result || []) {\n                    OutlineModel._makeOutlineElement(info, group);\n                }\n                return group;\n            }, err => {\n                onUnexpectedExternalError(err);\n                return group;\n            }).then(group => {\n                if (!TreeElement.empty(group)) {\n                    result._groups.set(id, group);\n                }\n                else {\n                    group.remove();\n                }\n            });\n        });\n        const listener = registry.onDidChange(() => {\n            const newProvider = registry.ordered(textModel);\n            if (!equals(newProvider, provider)) {\n                cts.cancel();\n            }\n        });\n        return Promise.all(promises).then(() => {\n            if (cts.token.isCancellationRequested && !token.isCancellationRequested) {\n                return OutlineModel.create(registry, textModel, token);\n            }\n            else {\n                return result._compact();\n            }\n        }).finally(() => {\n            cts.dispose();\n            listener.dispose();\n            cts.dispose();\n        });\n    }\n    static _makeOutlineElement(info, container) {\n        const id = TreeElement.findId(info, container);\n        const res = new OutlineElement(id, container, info);\n        if (info.children) {\n            for (const childInfo of info.children) {\n                OutlineModel._makeOutlineElement(childInfo, res);\n            }\n        }\n        container.children.set(res.id, res);\n    }\n    constructor(uri) {\n        super();\n        this.uri = uri;\n        this.id = 'root';\n        this.parent = undefined;\n        this._groups = new Map();\n        this.children = new Map();\n        this.id = 'root';\n        this.parent = undefined;\n    }\n    _compact() {\n        let count = 0;\n        for (const [key, group] of this._groups) {\n            if (group.children.size === 0) { // empty\n                this._groups.delete(key);\n            }\n            else {\n                count += 1;\n            }\n        }\n        if (count !== 1) {\n            //\n            this.children = this._groups;\n        }\n        else {\n            // adopt all elements of the first group\n            const group = Iterable.first(this._groups.values());\n            for (const [, child] of group.children) {\n                child.parent = this;\n                this.children.set(child.id, child);\n            }\n        }\n        return this;\n    }\n    getTopLevelSymbols() {\n        const roots = [];\n        for (const child of this.children.values()) {\n            if (child instanceof OutlineElement) {\n                roots.push(child.symbol);\n            }\n            else {\n                roots.push(...Iterable.map(child.children.values(), child => child.symbol));\n            }\n        }\n        return roots.sort((a, b) => Range.compareRangesUsingStarts(a.range, b.range));\n    }\n    asListOfDocumentSymbols() {\n        const roots = this.getTopLevelSymbols();\n        const bucket = [];\n        OutlineModel._flattenDocumentSymbols(bucket, roots, '');\n        return bucket.sort((a, b) => Position.compare(Range.getStartPosition(a.range), Range.getStartPosition(b.range)) || Position.compare(Range.getEndPosition(b.range), Range.getEndPosition(a.range)));\n    }\n    static _flattenDocumentSymbols(bucket, entries, overrideContainerLabel) {\n        for (const entry of entries) {\n            bucket.push({\n                kind: entry.kind,\n                tags: entry.tags,\n                name: entry.name,\n                detail: entry.detail,\n                containerName: entry.containerName || overrideContainerLabel,\n                range: entry.range,\n                selectionRange: entry.selectionRange,\n                children: undefined, // we flatten it...\n            });\n            // Recurse over children\n            if (entry.children) {\n                OutlineModel._flattenDocumentSymbols(bucket, entry.children, entry.name);\n            }\n        }\n    }\n}\nexport const IOutlineModelService = createDecorator('IOutlineModelService');\nlet OutlineModelService = class OutlineModelService {\n    constructor(_languageFeaturesService, debounces, modelService) {\n        this._languageFeaturesService = _languageFeaturesService;\n        this._disposables = new DisposableStore();\n        this._cache = new LRUCache(10, 0.7);\n        this._debounceInformation = debounces.for(_languageFeaturesService.documentSymbolProvider, 'DocumentSymbols', { min: 350 });\n        // don't cache outline models longer than their text model\n        this._disposables.add(modelService.onModelRemoved(textModel => {\n            this._cache.delete(textModel.id);\n        }));\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n    async getOrCreate(textModel, token) {\n        const registry = this._languageFeaturesService.documentSymbolProvider;\n        const provider = registry.ordered(textModel);\n        let data = this._cache.get(textModel.id);\n        if (!data || data.versionId !== textModel.getVersionId() || !equals(data.provider, provider)) {\n            const source = new CancellationTokenSource();\n            data = {\n                versionId: textModel.getVersionId(),\n                provider,\n                promiseCnt: 0,\n                source,\n                promise: OutlineModel.create(registry, textModel, source.token),\n                model: undefined,\n            };\n            this._cache.set(textModel.id, data);\n            const now = Date.now();\n            data.promise.then(outlineModel => {\n                data.model = outlineModel;\n                this._debounceInformation.update(textModel, Date.now() - now);\n            }).catch(_err => {\n                this._cache.delete(textModel.id);\n            });\n        }\n        if (data.model) {\n            // resolved -> return data\n            return data.model;\n        }\n        // increase usage counter\n        data.promiseCnt += 1;\n        const listener = token.onCancellationRequested(() => {\n            // last -> cancel provider request, remove cached promise\n            if (--data.promiseCnt === 0) {\n                data.source.cancel();\n                this._cache.delete(textModel.id);\n            }\n        });\n        try {\n            return await data.promise;\n        }\n        finally {\n            listener.dispose();\n        }\n    }\n};\nOutlineModelService = __decorate([\n    __param(0, ILanguageFeaturesService),\n    __param(1, ILanguageFeatureDebounceService),\n    __param(2, IModelService)\n], OutlineModelService);\nexport { OutlineModelService };\nregisterSingleton(IOutlineModelService, OutlineModelService, 1 /* InstantiationType.Delayed */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { IOutlineModelService } from './outlineModel.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nCommandsRegistry.registerCommand('_executeDocumentSymbolProvider', async function (accessor, ...args) {\n    const [resource] = args;\n    assertType(URI.isUri(resource));\n    const outlineService = accessor.get(IOutlineModelService);\n    const modelService = accessor.get(ITextModelService);\n    const reference = await modelService.createModelReference(resource);\n    try {\n        return (await outlineService.getOrCreate(reference.object.textEditorModel, CancellationToken.None)).getTopLevelSymbols();\n    }\n    finally {\n        reference.dispose();\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { autorun } from '../../../../../base/common/observable.js';\nimport { firstNonWhitespaceIndex } from '../../../../../base/common/strings.js';\nimport { CursorColumns } from '../../../../common/core/cursorColumns.js';\nimport { RawContextKey } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { localize } from '../../../../../nls.js';\nexport class InlineCompletionContextKeys extends Disposable {\n    static { this.inlineSuggestionVisible = new RawContextKey('inlineSuggestionVisible', false, localize('inlineSuggestionVisible', \"Whether an inline suggestion is visible\")); }\n    static { this.inlineSuggestionHasIndentation = new RawContextKey('inlineSuggestionHasIndentation', false, localize('inlineSuggestionHasIndentation', \"Whether the inline suggestion starts with whitespace\")); }\n    static { this.inlineSuggestionHasIndentationLessThanTabSize = new RawContextKey('inlineSuggestionHasIndentationLessThanTabSize', true, localize('inlineSuggestionHasIndentationLessThanTabSize', \"Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab\")); }\n    static { this.suppressSuggestions = new RawContextKey('inlineSuggestionSuppressSuggestions', undefined, localize('suppressSuggestions', \"Whether suggestions should be suppressed for the current suggestion\")); }\n    constructor(contextKeyService, model) {\n        super();\n        this.contextKeyService = contextKeyService;\n        this.model = model;\n        this.inlineCompletionVisible = InlineCompletionContextKeys.inlineSuggestionVisible.bindTo(this.contextKeyService);\n        this.inlineCompletionSuggestsIndentation = InlineCompletionContextKeys.inlineSuggestionHasIndentation.bindTo(this.contextKeyService);\n        this.inlineCompletionSuggestsIndentationLessThanTabSize = InlineCompletionContextKeys.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService);\n        this.suppressSuggestions = InlineCompletionContextKeys.suppressSuggestions.bindTo(this.contextKeyService);\n        this._register(autorun(reader => {\n            /** @description update context key: inlineCompletionVisible, suppressSuggestions */\n            const model = this.model.read(reader);\n            const state = model?.state.read(reader);\n            const isInlineCompletionVisible = !!state?.inlineCompletion && state?.primaryGhostText !== undefined && !state?.primaryGhostText.isEmpty();\n            this.inlineCompletionVisible.set(isInlineCompletionVisible);\n            if (state?.primaryGhostText && state?.inlineCompletion) {\n                this.suppressSuggestions.set(state.inlineCompletion.inlineCompletion.source.inlineCompletions.suppressSuggestions);\n            }\n        }));\n        this._register(autorun(reader => {\n            /** @description update context key: inlineCompletionSuggestsIndentation, inlineCompletionSuggestsIndentationLessThanTabSize */\n            const model = this.model.read(reader);\n            let startsWithIndentation = false;\n            let startsWithIndentationLessThanTabSize = true;\n            const ghostText = model?.primaryGhostText.read(reader);\n            if (!!model?.selectedSuggestItem && ghostText && ghostText.parts.length > 0) {\n                const { column, lines } = ghostText.parts[0];\n                const firstLine = lines[0];\n                const indentationEndColumn = model.textModel.getLineIndentColumn(ghostText.lineNumber);\n                const inIndentation = column <= indentationEndColumn;\n                if (inIndentation) {\n                    let firstNonWsIdx = firstNonWhitespaceIndex(firstLine);\n                    if (firstNonWsIdx === -1) {\n                        firstNonWsIdx = firstLine.length - 1;\n                    }\n                    startsWithIndentation = firstNonWsIdx > 0;\n                    const tabSize = model.textModel.getOptions().tabSize;\n                    const visibleColumnIndentation = CursorColumns.visibleColumnFromColumn(firstLine, firstNonWsIdx + 1, tabSize);\n                    startsWithIndentationLessThanTabSize = visibleColumnIndentation < tabSize;\n                }\n            }\n            this.inlineCompletionSuggestsIndentation.set(startsWithIndentation);\n            this.inlineCompletionSuggestsIndentationLessThanTabSize.set(startsWithIndentationLessThanTabSize);\n        }));\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { equals } from '../../../../../base/common/arrays.js';\nimport { splitLines } from '../../../../../base/common/strings.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { SingleTextEdit, TextEdit } from '../../../../common/core/textEdit.js';\nexport class GhostText {\n    constructor(lineNumber, parts) {\n        this.lineNumber = lineNumber;\n        this.parts = parts;\n    }\n    equals(other) {\n        return this.lineNumber === other.lineNumber &&\n            this.parts.length === other.parts.length &&\n            this.parts.every((part, index) => part.equals(other.parts[index]));\n    }\n    renderForScreenReader(lineText) {\n        if (this.parts.length === 0) {\n            return '';\n        }\n        const lastPart = this.parts[this.parts.length - 1];\n        const cappedLineText = lineText.substr(0, lastPart.column - 1);\n        const text = new TextEdit([\n            ...this.parts.map(p => new SingleTextEdit(Range.fromPositions(new Position(1, p.column)), p.lines.join('\\n'))),\n        ]).applyToString(cappedLineText);\n        return text.substring(this.parts[0].column - 1);\n    }\n    isEmpty() {\n        return this.parts.every(p => p.lines.length === 0);\n    }\n    get lineCount() {\n        return 1 + this.parts.reduce((r, p) => r + p.lines.length - 1, 0);\n    }\n}\nexport class GhostTextPart {\n    constructor(column, text, \n    /**\n     * Indicates if this part is a preview of an inline suggestion when a suggestion is previewed.\n    */\n    preview) {\n        this.column = column;\n        this.text = text;\n        this.preview = preview;\n        this.lines = splitLines(this.text);\n    }\n    equals(other) {\n        return this.column === other.column &&\n            this.lines.length === other.lines.length &&\n            this.lines.every((line, index) => line === other.lines[index]);\n    }\n}\nexport class GhostTextReplacement {\n    constructor(lineNumber, columnRange, text, additionalReservedLineCount = 0) {\n        this.lineNumber = lineNumber;\n        this.columnRange = columnRange;\n        this.text = text;\n        this.additionalReservedLineCount = additionalReservedLineCount;\n        this.parts = [\n            new GhostTextPart(this.columnRange.endColumnExclusive, this.text, false),\n        ];\n        this.newLines = splitLines(this.text);\n    }\n    renderForScreenReader(_lineText) {\n        return this.newLines.join('\\n');\n    }\n    get lineCount() {\n        return this.newLines.length;\n    }\n    isEmpty() {\n        return this.parts.every(p => p.lines.length === 0);\n    }\n    equals(other) {\n        return this.lineNumber === other.lineNumber &&\n            this.columnRange.equals(other.columnRange) &&\n            this.newLines.length === other.newLines.length &&\n            this.newLines.every((line, index) => line === other.newLines[index]) &&\n            this.additionalReservedLineCount === other.additionalReservedLineCount;\n    }\n}\nexport function ghostTextsOrReplacementsEqual(a, b) {\n    return equals(a, b, ghostTextOrReplacementEquals);\n}\nexport function ghostTextOrReplacementEquals(a, b) {\n    if (a === b) {\n        return true;\n    }\n    if (!a || !b) {\n        return false;\n    }\n    if (a instanceof GhostText && b instanceof GhostText) {\n        return a.equals(b);\n    }\n    if (a instanceof GhostTextReplacement && b instanceof GhostTextReplacement) {\n        return a.equals(b);\n    }\n    return false;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { BugIndicatingError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { autorunOpts } from '../../../../base/common/observable.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nconst array = [];\nexport function getReadonlyEmptyArray() {\n    return array;\n}\nexport class ColumnRange {\n    constructor(startColumn, endColumnExclusive) {\n        this.startColumn = startColumn;\n        this.endColumnExclusive = endColumnExclusive;\n        if (startColumn > endColumnExclusive) {\n            throw new BugIndicatingError(`startColumn ${startColumn} cannot be after endColumnExclusive ${endColumnExclusive}`);\n        }\n    }\n    toRange(lineNumber) {\n        return new Range(lineNumber, this.startColumn, lineNumber, this.endColumnExclusive);\n    }\n    equals(other) {\n        return this.startColumn === other.startColumn\n            && this.endColumnExclusive === other.endColumnExclusive;\n    }\n}\nexport function applyObservableDecorations(editor, decorations) {\n    const d = new DisposableStore();\n    const decorationsCollection = editor.createDecorationsCollection();\n    d.add(autorunOpts({ debugName: () => `Apply decorations from ${decorations.debugName}` }, reader => {\n        const d = decorations.read(reader);\n        decorationsCollection.set(d);\n    }));\n    d.add({\n        dispose: () => {\n            decorationsCollection.clear();\n        }\n    });\n    return d;\n}\nexport function addPositions(pos1, pos2) {\n    return new Position(pos1.lineNumber + pos2.lineNumber - 1, pos2.lineNumber === 1 ? pos1.column + pos2.column - 1 : pos2.column);\n}\nexport function subtractPositions(pos1, pos2) {\n    return new Position(pos1.lineNumber - pos2.lineNumber + 1, pos1.lineNumber - pos2.lineNumber === 0 ? pos1.column - pos2.column + 1 : pos1.column);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { createTrustedTypesPolicy } from '../../../../../base/browser/trustedTypes.js';\nimport { Event } from '../../../../../base/common/event.js';\nimport { Disposable, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { autorun, derived, observableFromEvent, observableSignalFromEvent, observableValue } from '../../../../../base/common/observable.js';\nimport * as strings from '../../../../../base/common/strings.js';\nimport './ghostTextView.css';\nimport { applyFontInfo } from '../../../../browser/config/domFontInfo.js';\nimport { EditorFontLigatures } from '../../../../common/config/editorOptions.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { StringBuilder } from '../../../../common/core/stringBuilder.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { InjectedTextCursorStops } from '../../../../common/model.js';\nimport { LineTokens } from '../../../../common/tokens/lineTokens.js';\nimport { LineDecoration } from '../../../../common/viewLayout/lineDecorations.js';\nimport { RenderLineInput, renderViewLine } from '../../../../common/viewLayout/viewLineRenderer.js';\nimport { GhostTextReplacement } from '../model/ghostText.js';\nimport { ColumnRange, applyObservableDecorations } from '../utils.js';\nexport const GHOST_TEXT_DESCRIPTION = 'ghost-text';\nlet GhostTextView = class GhostTextView extends Disposable {\n    constructor(editor, model, languageService) {\n        super();\n        this.editor = editor;\n        this.model = model;\n        this.languageService = languageService;\n        this.isDisposed = observableValue(this, false);\n        this.currentTextModel = observableFromEvent(this, this.editor.onDidChangeModel, () => /** @description editor.model */ this.editor.getModel());\n        this.uiState = derived(this, reader => {\n            if (this.isDisposed.read(reader)) {\n                return undefined;\n            }\n            const textModel = this.currentTextModel.read(reader);\n            if (textModel !== this.model.targetTextModel.read(reader)) {\n                return undefined;\n            }\n            const ghostText = this.model.ghostText.read(reader);\n            if (!ghostText) {\n                return undefined;\n            }\n            const replacedRange = ghostText instanceof GhostTextReplacement ? ghostText.columnRange : undefined;\n            const inlineTexts = [];\n            const additionalLines = [];\n            function addToAdditionalLines(lines, className) {\n                if (additionalLines.length > 0) {\n                    const lastLine = additionalLines[additionalLines.length - 1];\n                    if (className) {\n                        lastLine.decorations.push(new LineDecoration(lastLine.content.length + 1, lastLine.content.length + 1 + lines[0].length, className, 0 /* InlineDecorationType.Regular */));\n                    }\n                    lastLine.content += lines[0];\n                    lines = lines.slice(1);\n                }\n                for (const line of lines) {\n                    additionalLines.push({\n                        content: line,\n                        decorations: className ? [new LineDecoration(1, line.length + 1, className, 0 /* InlineDecorationType.Regular */)] : []\n                    });\n                }\n            }\n            const textBufferLine = textModel.getLineContent(ghostText.lineNumber);\n            let hiddenTextStartColumn = undefined;\n            let lastIdx = 0;\n            for (const part of ghostText.parts) {\n                let lines = part.lines;\n                if (hiddenTextStartColumn === undefined) {\n                    inlineTexts.push({\n                        column: part.column,\n                        text: lines[0],\n                        preview: part.preview,\n                    });\n                    lines = lines.slice(1);\n                }\n                else {\n                    addToAdditionalLines([textBufferLine.substring(lastIdx, part.column - 1)], undefined);\n                }\n                if (lines.length > 0) {\n                    addToAdditionalLines(lines, GHOST_TEXT_DESCRIPTION);\n                    if (hiddenTextStartColumn === undefined && part.column <= textBufferLine.length) {\n                        hiddenTextStartColumn = part.column;\n                    }\n                }\n                lastIdx = part.column - 1;\n            }\n            if (hiddenTextStartColumn !== undefined) {\n                addToAdditionalLines([textBufferLine.substring(lastIdx)], undefined);\n            }\n            const hiddenRange = hiddenTextStartColumn !== undefined ? new ColumnRange(hiddenTextStartColumn, textBufferLine.length + 1) : undefined;\n            return {\n                replacedRange,\n                inlineTexts,\n                additionalLines,\n                hiddenRange,\n                lineNumber: ghostText.lineNumber,\n                additionalReservedLineCount: this.model.minReservedLineCount.read(reader),\n                targetTextModel: textModel,\n            };\n        });\n        this.decorations = derived(this, reader => {\n            const uiState = this.uiState.read(reader);\n            if (!uiState) {\n                return [];\n            }\n            const decorations = [];\n            if (uiState.replacedRange) {\n                decorations.push({\n                    range: uiState.replacedRange.toRange(uiState.lineNumber),\n                    options: { inlineClassName: 'inline-completion-text-to-replace', description: 'GhostTextReplacement' }\n                });\n            }\n            if (uiState.hiddenRange) {\n                decorations.push({\n                    range: uiState.hiddenRange.toRange(uiState.lineNumber),\n                    options: { inlineClassName: 'ghost-text-hidden', description: 'ghost-text-hidden', }\n                });\n            }\n            for (const p of uiState.inlineTexts) {\n                decorations.push({\n                    range: Range.fromPositions(new Position(uiState.lineNumber, p.column)),\n                    options: {\n                        description: GHOST_TEXT_DESCRIPTION,\n                        after: { content: p.text, inlineClassName: p.preview ? 'ghost-text-decoration-preview' : 'ghost-text-decoration', cursorStops: InjectedTextCursorStops.Left },\n                        showIfCollapsed: true,\n                    }\n                });\n            }\n            return decorations;\n        });\n        this.additionalLinesWidget = this._register(new AdditionalLinesWidget(this.editor, this.languageService.languageIdCodec, derived(reader => {\n            /** @description lines */\n            const uiState = this.uiState.read(reader);\n            return uiState ? {\n                lineNumber: uiState.lineNumber,\n                additionalLines: uiState.additionalLines,\n                minReservedLineCount: uiState.additionalReservedLineCount,\n                targetTextModel: uiState.targetTextModel,\n            } : undefined;\n        })));\n        this._register(toDisposable(() => { this.isDisposed.set(true, undefined); }));\n        this._register(applyObservableDecorations(this.editor, this.decorations));\n    }\n    ownsViewZone(viewZoneId) {\n        return this.additionalLinesWidget.viewZoneId === viewZoneId;\n    }\n};\nGhostTextView = __decorate([\n    __param(2, ILanguageService)\n], GhostTextView);\nexport { GhostTextView };\nexport class AdditionalLinesWidget extends Disposable {\n    get viewZoneId() { return this._viewZoneId; }\n    constructor(editor, languageIdCodec, lines) {\n        super();\n        this.editor = editor;\n        this.languageIdCodec = languageIdCodec;\n        this.lines = lines;\n        this._viewZoneId = undefined;\n        this.editorOptionsChanged = observableSignalFromEvent('editorOptionChanged', Event.filter(this.editor.onDidChangeConfiguration, e => e.hasChanged(33 /* EditorOption.disableMonospaceOptimizations */)\n            || e.hasChanged(118 /* EditorOption.stopRenderingLineAfter */)\n            || e.hasChanged(100 /* EditorOption.renderWhitespace */)\n            || e.hasChanged(95 /* EditorOption.renderControlCharacters */)\n            || e.hasChanged(51 /* EditorOption.fontLigatures */)\n            || e.hasChanged(50 /* EditorOption.fontInfo */)\n            || e.hasChanged(67 /* EditorOption.lineHeight */)));\n        this._register(autorun(reader => {\n            /** @description update view zone */\n            const lines = this.lines.read(reader);\n            this.editorOptionsChanged.read(reader);\n            if (lines) {\n                this.updateLines(lines.lineNumber, lines.additionalLines, lines.minReservedLineCount);\n            }\n            else {\n                this.clear();\n            }\n        }));\n    }\n    dispose() {\n        super.dispose();\n        this.clear();\n    }\n    clear() {\n        this.editor.changeViewZones((changeAccessor) => {\n            if (this._viewZoneId) {\n                changeAccessor.removeZone(this._viewZoneId);\n                this._viewZoneId = undefined;\n            }\n        });\n    }\n    updateLines(lineNumber, additionalLines, minReservedLineCount) {\n        const textModel = this.editor.getModel();\n        if (!textModel) {\n            return;\n        }\n        const { tabSize } = textModel.getOptions();\n        this.editor.changeViewZones((changeAccessor) => {\n            if (this._viewZoneId) {\n                changeAccessor.removeZone(this._viewZoneId);\n                this._viewZoneId = undefined;\n            }\n            const heightInLines = Math.max(additionalLines.length, minReservedLineCount);\n            if (heightInLines > 0) {\n                const domNode = document.createElement('div');\n                renderLines(domNode, tabSize, additionalLines, this.editor.getOptions(), this.languageIdCodec);\n                this._viewZoneId = changeAccessor.addZone({\n                    afterLineNumber: lineNumber,\n                    heightInLines: heightInLines,\n                    domNode,\n                    afterColumnAffinity: 1 /* PositionAffinity.Right */\n                });\n            }\n        });\n    }\n}\nfunction renderLines(domNode, tabSize, lines, opts, languageIdCodec) {\n    const disableMonospaceOptimizations = opts.get(33 /* EditorOption.disableMonospaceOptimizations */);\n    const stopRenderingLineAfter = opts.get(118 /* EditorOption.stopRenderingLineAfter */);\n    // To avoid visual confusion, we don't want to render visible whitespace\n    const renderWhitespace = 'none';\n    const renderControlCharacters = opts.get(95 /* EditorOption.renderControlCharacters */);\n    const fontLigatures = opts.get(51 /* EditorOption.fontLigatures */);\n    const fontInfo = opts.get(50 /* EditorOption.fontInfo */);\n    const lineHeight = opts.get(67 /* EditorOption.lineHeight */);\n    const sb = new StringBuilder(10000);\n    sb.appendString('<div class=\"suggest-preview-text\">');\n    for (let i = 0, len = lines.length; i < len; i++) {\n        const lineData = lines[i];\n        const line = lineData.content;\n        sb.appendString('<div class=\"view-line');\n        sb.appendString('\" style=\"top:');\n        sb.appendString(String(i * lineHeight));\n        sb.appendString('px;width:1000000px;\">');\n        const isBasicASCII = strings.isBasicASCII(line);\n        const containsRTL = strings.containsRTL(line);\n        const lineTokens = LineTokens.createEmpty(line, languageIdCodec);\n        renderViewLine(new RenderLineInput((fontInfo.isMonospace && !disableMonospaceOptimizations), fontInfo.canUseHalfwidthRightwardsArrow, line, false, isBasicASCII, containsRTL, 0, lineTokens, lineData.decorations, tabSize, 0, fontInfo.spaceWidth, fontInfo.middotWidth, fontInfo.wsmiddotWidth, stopRenderingLineAfter, renderWhitespace, renderControlCharacters, fontLigatures !== EditorFontLigatures.OFF, null), sb);\n        sb.appendString('</div>');\n    }\n    sb.appendString('</div>');\n    applyFontInfo(domNode, fontInfo);\n    const html = sb.build();\n    const trustedhtml = ttPolicy ? ttPolicy.createHTML(html) : html;\n    domNode.innerHTML = trustedhtml;\n}\nexport const ttPolicy = createTrustedTypesPolicy('editorGhostText', { createHTML: value => value });\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { assertNever } from '../../../../../base/common/assert.js';\nimport { DeferredPromise } from '../../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../../base/common/cancellation.js';\nimport { SetMap } from '../../../../../base/common/map.js';\nimport { onUnexpectedExternalError } from '../../../../../base/common/errors.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { fixBracketsInLine } from '../../../../common/model/bracketPairsTextModelPart/fixBrackets.js';\nimport { SingleTextEdit } from '../../../../common/core/textEdit.js';\nimport { getReadonlyEmptyArray } from '../utils.js';\nimport { SnippetParser, Text } from '../../../snippet/browser/snippetParser.js';\nexport async function provideInlineCompletions(registry, positionOrRange, model, context, token = CancellationToken.None, languageConfigurationService) {\n    // Important: Don't use position after the await calls, as the model could have been changed in the meantime!\n    const defaultReplaceRange = positionOrRange instanceof Position ? getDefaultRange(positionOrRange, model) : positionOrRange;\n    const providers = registry.all(model);\n    const multiMap = new SetMap();\n    for (const provider of providers) {\n        if (provider.groupId) {\n            multiMap.add(provider.groupId, provider);\n        }\n    }\n    function getPreferredProviders(provider) {\n        if (!provider.yieldsToGroupIds) {\n            return [];\n        }\n        const result = [];\n        for (const groupId of provider.yieldsToGroupIds || []) {\n            const providers = multiMap.get(groupId);\n            for (const p of providers) {\n                result.push(p);\n            }\n        }\n        return result;\n    }\n    const states = new Map();\n    const seen = new Set();\n    function findPreferredProviderCircle(provider, stack) {\n        stack = [...stack, provider];\n        if (seen.has(provider)) {\n            return stack;\n        }\n        seen.add(provider);\n        try {\n            const preferred = getPreferredProviders(provider);\n            for (const p of preferred) {\n                const c = findPreferredProviderCircle(p, stack);\n                if (c) {\n                    return c;\n                }\n            }\n        }\n        finally {\n            seen.delete(provider);\n        }\n        return undefined;\n    }\n    function processProvider(provider) {\n        const state = states.get(provider);\n        if (state) {\n            return state;\n        }\n        const circle = findPreferredProviderCircle(provider, []);\n        if (circle) {\n            onUnexpectedExternalError(new Error(`Inline completions: cyclic yield-to dependency detected. Path: ${circle.map(s => s.toString ? s.toString() : ('' + s)).join(' -> ')}`));\n        }\n        const deferredPromise = new DeferredPromise();\n        states.set(provider, deferredPromise.p);\n        (async () => {\n            if (!circle) {\n                const preferred = getPreferredProviders(provider);\n                for (const p of preferred) {\n                    const result = await processProvider(p);\n                    if (result && result.items.length > 0) {\n                        // Skip provider\n                        return undefined;\n                    }\n                }\n            }\n            try {\n                if (positionOrRange instanceof Position) {\n                    const completions = await provider.provideInlineCompletions(model, positionOrRange, context, token);\n                    return completions;\n                }\n                else {\n                    const completions = await provider.provideInlineEdits?.(model, positionOrRange, context, token);\n                    return completions;\n                }\n            }\n            catch (e) {\n                onUnexpectedExternalError(e);\n                return undefined;\n            }\n        })().then(c => deferredPromise.complete(c), e => deferredPromise.error(e));\n        return deferredPromise.p;\n    }\n    const providerResults = await Promise.all(providers.map(async (provider) => ({ provider, completions: await processProvider(provider) })));\n    const itemsByHash = new Map();\n    const lists = [];\n    for (const result of providerResults) {\n        const completions = result.completions;\n        if (!completions) {\n            continue;\n        }\n        const list = new InlineCompletionList(completions, result.provider);\n        lists.push(list);\n        for (const item of completions.items) {\n            const inlineCompletionItem = InlineCompletionItem.from(item, list, defaultReplaceRange, model, languageConfigurationService);\n            itemsByHash.set(inlineCompletionItem.hash(), inlineCompletionItem);\n        }\n    }\n    return new InlineCompletionProviderResult(Array.from(itemsByHash.values()), new Set(itemsByHash.keys()), lists);\n}\nexport class InlineCompletionProviderResult {\n    constructor(\n    /**\n     * Free of duplicates.\n     */\n    completions, hashs, providerResults) {\n        this.completions = completions;\n        this.hashs = hashs;\n        this.providerResults = providerResults;\n    }\n    has(item) {\n        return this.hashs.has(item.hash());\n    }\n    dispose() {\n        for (const result of this.providerResults) {\n            result.removeRef();\n        }\n    }\n}\n/**\n * A ref counted pointer to the computed `InlineCompletions` and the `InlineCompletionsProvider` that\n * computed them.\n */\nexport class InlineCompletionList {\n    constructor(inlineCompletions, provider) {\n        this.inlineCompletions = inlineCompletions;\n        this.provider = provider;\n        this.refCount = 1;\n    }\n    addRef() {\n        this.refCount++;\n    }\n    removeRef() {\n        this.refCount--;\n        if (this.refCount === 0) {\n            this.provider.freeInlineCompletions(this.inlineCompletions);\n        }\n    }\n}\nexport class InlineCompletionItem {\n    static from(inlineCompletion, source, defaultReplaceRange, textModel, languageConfigurationService) {\n        let insertText;\n        let snippetInfo;\n        let range = inlineCompletion.range ? Range.lift(inlineCompletion.range) : defaultReplaceRange;\n        if (typeof inlineCompletion.insertText === 'string') {\n            insertText = inlineCompletion.insertText;\n            if (languageConfigurationService && inlineCompletion.completeBracketPairs) {\n                insertText = closeBrackets(insertText, range.getStartPosition(), textModel, languageConfigurationService);\n                // Modify range depending on if brackets are added or removed\n                const diff = insertText.length - inlineCompletion.insertText.length;\n                if (diff !== 0) {\n                    range = new Range(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn + diff);\n                }\n            }\n            snippetInfo = undefined;\n        }\n        else if ('snippet' in inlineCompletion.insertText) {\n            const preBracketCompletionLength = inlineCompletion.insertText.snippet.length;\n            if (languageConfigurationService && inlineCompletion.completeBracketPairs) {\n                inlineCompletion.insertText.snippet = closeBrackets(inlineCompletion.insertText.snippet, range.getStartPosition(), textModel, languageConfigurationService);\n                // Modify range depending on if brackets are added or removed\n                const diff = inlineCompletion.insertText.snippet.length - preBracketCompletionLength;\n                if (diff !== 0) {\n                    range = new Range(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn + diff);\n                }\n            }\n            const snippet = new SnippetParser().parse(inlineCompletion.insertText.snippet);\n            if (snippet.children.length === 1 && snippet.children[0] instanceof Text) {\n                insertText = snippet.children[0].value;\n                snippetInfo = undefined;\n            }\n            else {\n                insertText = snippet.toString();\n                snippetInfo = {\n                    snippet: inlineCompletion.insertText.snippet,\n                    range: range\n                };\n            }\n        }\n        else {\n            assertNever(inlineCompletion.insertText);\n        }\n        return new InlineCompletionItem(insertText, inlineCompletion.command, range, insertText, snippetInfo, inlineCompletion.additionalTextEdits || getReadonlyEmptyArray(), inlineCompletion, source);\n    }\n    constructor(filterText, command, range, insertText, snippetInfo, additionalTextEdits, \n    /**\n     * A reference to the original inline completion this inline completion has been constructed from.\n     * Used for event data to ensure referential equality.\n    */\n    sourceInlineCompletion, \n    /**\n     * A reference to the original inline completion list this inline completion has been constructed from.\n     * Used for event data to ensure referential equality.\n    */\n    source) {\n        this.filterText = filterText;\n        this.command = command;\n        this.range = range;\n        this.insertText = insertText;\n        this.snippetInfo = snippetInfo;\n        this.additionalTextEdits = additionalTextEdits;\n        this.sourceInlineCompletion = sourceInlineCompletion;\n        this.source = source;\n        filterText = filterText.replace(/\\r\\n|\\r/g, '\\n');\n        insertText = filterText.replace(/\\r\\n|\\r/g, '\\n');\n    }\n    withRange(updatedRange) {\n        return new InlineCompletionItem(this.filterText, this.command, updatedRange, this.insertText, this.snippetInfo, this.additionalTextEdits, this.sourceInlineCompletion, this.source);\n    }\n    hash() {\n        return JSON.stringify({ insertText: this.insertText, range: this.range.toString() });\n    }\n    toSingleTextEdit() {\n        return new SingleTextEdit(this.range, this.insertText);\n    }\n}\nfunction getDefaultRange(position, model) {\n    const word = model.getWordAtPosition(position);\n    const maxColumn = model.getLineMaxColumn(position.lineNumber);\n    // By default, always replace up until the end of the current line.\n    // This default might be subject to change!\n    return word\n        ? new Range(position.lineNumber, word.startColumn, position.lineNumber, maxColumn)\n        : Range.fromPositions(position, position.with(undefined, maxColumn));\n}\nfunction closeBrackets(text, position, model, languageConfigurationService) {\n    const lineStart = model.getLineContent(position.lineNumber).substring(0, position.column - 1);\n    const newLine = lineStart + text;\n    const newTokens = model.tokenization.tokenizeLineWithEdit(position, newLine.length - (position.column - 1), text);\n    const slicedTokens = newTokens?.sliceAndInflate(position.column - 1, newLine.length, 0);\n    if (!slicedTokens) {\n        return text;\n    }\n    const newText = fixBracketsInLine(slicedTokens, languageConfigurationService);\n    return newText;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { LcsDiff } from '../../../../../base/common/diff/diff.js';\nimport { commonPrefixLength, getLeadingWhitespace } from '../../../../../base/common/strings.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { TextLength } from '../../../../common/core/textLength.js';\nimport { SingleTextEdit } from '../../../../common/core/textEdit.js';\nimport { GhostText, GhostTextPart } from './ghostText.js';\nexport function singleTextRemoveCommonPrefix(edit, model, validModelRange) {\n    const modelRange = validModelRange ? edit.range.intersectRanges(validModelRange) : edit.range;\n    if (!modelRange) {\n        return edit;\n    }\n    const valueToReplace = model.getValueInRange(modelRange, 1 /* EndOfLinePreference.LF */);\n    const commonPrefixLen = commonPrefixLength(valueToReplace, edit.text);\n    const start = TextLength.ofText(valueToReplace.substring(0, commonPrefixLen)).addToPosition(edit.range.getStartPosition());\n    const text = edit.text.substring(commonPrefixLen);\n    const range = Range.fromPositions(start, edit.range.getEndPosition());\n    return new SingleTextEdit(range, text);\n}\nexport function singleTextEditAugments(edit, base) {\n    // The augmented completion must replace the base range, but can replace even more\n    return edit.text.startsWith(base.text) && rangeExtends(edit.range, base.range);\n}\n/**\n * @param previewSuffixLength Sets where to split `inlineCompletion.text`.\n * \tIf the text is `hello` and the suffix length is 2, the non-preview part is `hel` and the preview-part is `lo`.\n*/\nexport function computeGhostText(edit, model, mode, cursorPosition, previewSuffixLength = 0) {\n    let e = singleTextRemoveCommonPrefix(edit, model);\n    if (e.range.endLineNumber !== e.range.startLineNumber) {\n        // This edit might span multiple lines, but the first lines must be a common prefix.\n        return undefined;\n    }\n    const sourceLine = model.getLineContent(e.range.startLineNumber);\n    const sourceIndentationLength = getLeadingWhitespace(sourceLine).length;\n    const suggestionTouchesIndentation = e.range.startColumn - 1 <= sourceIndentationLength;\n    if (suggestionTouchesIndentation) {\n        // source:      ··········[······abc]\n        //                         ^^^^^^^^^ inlineCompletion.range\n        //              ^^^^^^^^^^ ^^^^^^ sourceIndentationLength\n        //                         ^^^^^^ replacedIndentation.length\n        //                               ^^^ rangeThatDoesNotReplaceIndentation\n        // inlineCompletion.text: '··foo'\n        //                         ^^ suggestionAddedIndentationLength\n        const suggestionAddedIndentationLength = getLeadingWhitespace(e.text).length;\n        const replacedIndentation = sourceLine.substring(e.range.startColumn - 1, sourceIndentationLength);\n        const [startPosition, endPosition] = [e.range.getStartPosition(), e.range.getEndPosition()];\n        const newStartPosition = startPosition.column + replacedIndentation.length <= endPosition.column\n            ? startPosition.delta(0, replacedIndentation.length)\n            : endPosition;\n        const rangeThatDoesNotReplaceIndentation = Range.fromPositions(newStartPosition, endPosition);\n        const suggestionWithoutIndentationChange = e.text.startsWith(replacedIndentation)\n            // Adds more indentation without changing existing indentation: We can add ghost text for this\n            ? e.text.substring(replacedIndentation.length)\n            // Changes or removes existing indentation. Only add ghost text for the non-indentation part.\n            : e.text.substring(suggestionAddedIndentationLength);\n        e = new SingleTextEdit(rangeThatDoesNotReplaceIndentation, suggestionWithoutIndentationChange);\n    }\n    // This is a single line string\n    const valueToBeReplaced = model.getValueInRange(e.range);\n    const changes = cachingDiff(valueToBeReplaced, e.text);\n    if (!changes) {\n        // No ghost text in case the diff would be too slow to compute\n        return undefined;\n    }\n    const lineNumber = e.range.startLineNumber;\n    const parts = new Array();\n    if (mode === 'prefix') {\n        const filteredChanges = changes.filter(c => c.originalLength === 0);\n        if (filteredChanges.length > 1 || filteredChanges.length === 1 && filteredChanges[0].originalStart !== valueToBeReplaced.length) {\n            // Prefixes only have a single change.\n            return undefined;\n        }\n    }\n    const previewStartInCompletionText = e.text.length - previewSuffixLength;\n    for (const c of changes) {\n        const insertColumn = e.range.startColumn + c.originalStart + c.originalLength;\n        if (mode === 'subwordSmart' && cursorPosition && cursorPosition.lineNumber === e.range.startLineNumber && insertColumn < cursorPosition.column) {\n            // No ghost text before cursor\n            return undefined;\n        }\n        if (c.originalLength > 0) {\n            return undefined;\n        }\n        if (c.modifiedLength === 0) {\n            continue;\n        }\n        const modifiedEnd = c.modifiedStart + c.modifiedLength;\n        const nonPreviewTextEnd = Math.max(c.modifiedStart, Math.min(modifiedEnd, previewStartInCompletionText));\n        const nonPreviewText = e.text.substring(c.modifiedStart, nonPreviewTextEnd);\n        const italicText = e.text.substring(nonPreviewTextEnd, Math.max(c.modifiedStart, modifiedEnd));\n        if (nonPreviewText.length > 0) {\n            parts.push(new GhostTextPart(insertColumn, nonPreviewText, false));\n        }\n        if (italicText.length > 0) {\n            parts.push(new GhostTextPart(insertColumn, italicText, true));\n        }\n    }\n    return new GhostText(lineNumber, parts);\n}\nfunction rangeExtends(extendingRange, rangeToExtend) {\n    return rangeToExtend.getStartPosition().equals(extendingRange.getStartPosition())\n        && rangeToExtend.getEndPosition().isBeforeOrEqual(extendingRange.getEndPosition());\n}\nlet lastRequest = undefined;\nfunction cachingDiff(originalValue, newValue) {\n    if (lastRequest?.originalValue === originalValue && lastRequest?.newValue === newValue) {\n        return lastRequest?.changes;\n    }\n    else {\n        let changes = smartDiff(originalValue, newValue, true);\n        if (changes) {\n            const deletedChars = deletedCharacters(changes);\n            if (deletedChars > 0) {\n                // For performance reasons, don't compute diff if there is nothing to improve\n                const newChanges = smartDiff(originalValue, newValue, false);\n                if (newChanges && deletedCharacters(newChanges) < deletedChars) {\n                    // Disabling smartness seems to be better here\n                    changes = newChanges;\n                }\n            }\n        }\n        lastRequest = {\n            originalValue,\n            newValue,\n            changes\n        };\n        return changes;\n    }\n}\nfunction deletedCharacters(changes) {\n    let sum = 0;\n    for (const c of changes) {\n        sum += c.originalLength;\n    }\n    return sum;\n}\n/**\n * When matching `if ()` with `if (f() = 1) { g(); }`,\n * align it like this:        `if (       )`\n * Not like this:\t\t\t  `if (  )`\n * Also not like this:\t\t  `if (             )`.\n *\n * The parenthesis are preprocessed to ensure that they match correctly.\n */\nfunction smartDiff(originalValue, newValue, smartBracketMatching) {\n    if (originalValue.length > 5000 || newValue.length > 5000) {\n        // We don't want to work on strings that are too big\n        return undefined;\n    }\n    function getMaxCharCode(val) {\n        let maxCharCode = 0;\n        for (let i = 0, len = val.length; i < len; i++) {\n            const charCode = val.charCodeAt(i);\n            if (charCode > maxCharCode) {\n                maxCharCode = charCode;\n            }\n        }\n        return maxCharCode;\n    }\n    const maxCharCode = Math.max(getMaxCharCode(originalValue), getMaxCharCode(newValue));\n    function getUniqueCharCode(id) {\n        if (id < 0) {\n            throw new Error('unexpected');\n        }\n        return maxCharCode + id + 1;\n    }\n    function getElements(source) {\n        let level = 0;\n        let group = 0;\n        const characters = new Int32Array(source.length);\n        for (let i = 0, len = source.length; i < len; i++) {\n            // TODO support more brackets\n            if (smartBracketMatching && source[i] === '(') {\n                const id = group * 100 + level;\n                characters[i] = getUniqueCharCode(2 * id);\n                level++;\n            }\n            else if (smartBracketMatching && source[i] === ')') {\n                level = Math.max(level - 1, 0);\n                const id = group * 100 + level;\n                characters[i] = getUniqueCharCode(2 * id + 1);\n                if (level === 0) {\n                    group++;\n                }\n            }\n            else {\n                characters[i] = source.charCodeAt(i);\n            }\n        }\n        return characters;\n    }\n    const elements1 = getElements(originalValue);\n    const elements2 = getElements(newValue);\n    return new LcsDiff({ getElements: () => elements1 }, { getElements: () => elements2 }).ComputeDiff(false).changes;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { CancellationTokenSource } from '../../../../../base/common/cancellation.js';\nimport { equalsIfDefined, itemEquals } from '../../../../../base/common/equals.js';\nimport { matchesSubString } from '../../../../../base/common/filters.js';\nimport { Disposable, MutableDisposable } from '../../../../../base/common/lifecycle.js';\nimport { derivedOpts, disposableObservableValue, transaction } from '../../../../../base/common/observable.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { SingleTextEdit } from '../../../../common/core/textEdit.js';\nimport { TextLength } from '../../../../common/core/textLength.js';\nimport { InlineCompletionTriggerKind } from '../../../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeaturesService } from '../../../../common/services/languageFeatures.js';\nimport { provideInlineCompletions } from './provideInlineCompletions.js';\nimport { singleTextRemoveCommonPrefix } from './singleTextEdit.js';\nlet InlineCompletionsSource = class InlineCompletionsSource extends Disposable {\n    constructor(textModel, versionId, _debounceValue, languageFeaturesService, languageConfigurationService) {\n        super();\n        this.textModel = textModel;\n        this.versionId = versionId;\n        this._debounceValue = _debounceValue;\n        this.languageFeaturesService = languageFeaturesService;\n        this.languageConfigurationService = languageConfigurationService;\n        this._updateOperation = this._register(new MutableDisposable());\n        this.inlineCompletions = disposableObservableValue('inlineCompletions', undefined);\n        this.suggestWidgetInlineCompletions = disposableObservableValue('suggestWidgetInlineCompletions', undefined);\n        this._register(this.textModel.onDidChangeContent(() => {\n            this._updateOperation.clear();\n        }));\n    }\n    fetch(position, context, activeInlineCompletion) {\n        const request = new UpdateRequest(position, context, this.textModel.getVersionId());\n        const target = context.selectedSuggestionInfo ? this.suggestWidgetInlineCompletions : this.inlineCompletions;\n        if (this._updateOperation.value?.request.satisfies(request)) {\n            return this._updateOperation.value.promise;\n        }\n        else if (target.get()?.request.satisfies(request)) {\n            return Promise.resolve(true);\n        }\n        const updateOngoing = !!this._updateOperation.value;\n        this._updateOperation.clear();\n        const source = new CancellationTokenSource();\n        const promise = (async () => {\n            const shouldDebounce = updateOngoing || context.triggerKind === InlineCompletionTriggerKind.Automatic;\n            if (shouldDebounce) {\n                // This debounces the operation\n                await wait(this._debounceValue.get(this.textModel), source.token);\n            }\n            if (source.token.isCancellationRequested || this._store.isDisposed || this.textModel.getVersionId() !== request.versionId) {\n                return false;\n            }\n            const startTime = new Date();\n            const updatedCompletions = await provideInlineCompletions(this.languageFeaturesService.inlineCompletionsProvider, position, this.textModel, context, source.token, this.languageConfigurationService);\n            if (source.token.isCancellationRequested || this._store.isDisposed || this.textModel.getVersionId() !== request.versionId) {\n                return false;\n            }\n            const endTime = new Date();\n            this._debounceValue.update(this.textModel, endTime.getTime() - startTime.getTime());\n            const completions = new UpToDateInlineCompletions(updatedCompletions, request, this.textModel, this.versionId);\n            if (activeInlineCompletion) {\n                const asInlineCompletion = activeInlineCompletion.toInlineCompletion(undefined);\n                if (activeInlineCompletion.canBeReused(this.textModel, position) && !updatedCompletions.has(asInlineCompletion)) {\n                    completions.prepend(activeInlineCompletion.inlineCompletion, asInlineCompletion.range, true);\n                }\n            }\n            this._updateOperation.clear();\n            transaction(tx => {\n                /** @description Update completions with provider result */\n                target.set(completions, tx);\n            });\n            return true;\n        })();\n        const updateOperation = new UpdateOperation(request, source, promise);\n        this._updateOperation.value = updateOperation;\n        return promise;\n    }\n    clear(tx) {\n        this._updateOperation.clear();\n        this.inlineCompletions.set(undefined, tx);\n        this.suggestWidgetInlineCompletions.set(undefined, tx);\n    }\n    clearSuggestWidgetInlineCompletions(tx) {\n        if (this._updateOperation.value?.request.context.selectedSuggestionInfo) {\n            this._updateOperation.clear();\n        }\n        this.suggestWidgetInlineCompletions.set(undefined, tx);\n    }\n    cancelUpdate() {\n        this._updateOperation.clear();\n    }\n};\nInlineCompletionsSource = __decorate([\n    __param(3, ILanguageFeaturesService),\n    __param(4, ILanguageConfigurationService)\n], InlineCompletionsSource);\nexport { InlineCompletionsSource };\nfunction wait(ms, cancellationToken) {\n    return new Promise(resolve => {\n        let d = undefined;\n        const handle = setTimeout(() => {\n            if (d) {\n                d.dispose();\n            }\n            resolve();\n        }, ms);\n        if (cancellationToken) {\n            d = cancellationToken.onCancellationRequested(() => {\n                clearTimeout(handle);\n                if (d) {\n                    d.dispose();\n                }\n                resolve();\n            });\n        }\n    });\n}\nclass UpdateRequest {\n    constructor(position, context, versionId) {\n        this.position = position;\n        this.context = context;\n        this.versionId = versionId;\n    }\n    satisfies(other) {\n        return this.position.equals(other.position)\n            && equalsIfDefined(this.context.selectedSuggestionInfo, other.context.selectedSuggestionInfo, itemEquals())\n            && (other.context.triggerKind === InlineCompletionTriggerKind.Automatic\n                || this.context.triggerKind === InlineCompletionTriggerKind.Explicit)\n            && this.versionId === other.versionId;\n    }\n}\nclass UpdateOperation {\n    constructor(request, cancellationTokenSource, promise) {\n        this.request = request;\n        this.cancellationTokenSource = cancellationTokenSource;\n        this.promise = promise;\n    }\n    dispose() {\n        this.cancellationTokenSource.cancel();\n    }\n}\nexport class UpToDateInlineCompletions {\n    get inlineCompletions() { return this._inlineCompletions; }\n    constructor(inlineCompletionProviderResult, request, _textModel, _versionId) {\n        this.inlineCompletionProviderResult = inlineCompletionProviderResult;\n        this.request = request;\n        this._textModel = _textModel;\n        this._versionId = _versionId;\n        this._refCount = 1;\n        this._prependedInlineCompletionItems = [];\n        const ids = _textModel.deltaDecorations([], inlineCompletionProviderResult.completions.map(i => ({\n            range: i.range,\n            options: {\n                description: 'inline-completion-tracking-range'\n            },\n        })));\n        this._inlineCompletions = inlineCompletionProviderResult.completions.map((i, index) => new InlineCompletionWithUpdatedRange(i, ids[index], this._textModel, this._versionId));\n    }\n    clone() {\n        this._refCount++;\n        return this;\n    }\n    dispose() {\n        this._refCount--;\n        if (this._refCount === 0) {\n            setTimeout(() => {\n                // To fix https://github.com/microsoft/vscode/issues/188348\n                if (!this._textModel.isDisposed()) {\n                    // This is just cleanup. It's ok if it happens with a delay.\n                    this._textModel.deltaDecorations(this._inlineCompletions.map(i => i.decorationId), []);\n                }\n            }, 0);\n            this.inlineCompletionProviderResult.dispose();\n            for (const i of this._prependedInlineCompletionItems) {\n                i.source.removeRef();\n            }\n        }\n    }\n    prepend(inlineCompletion, range, addRefToSource) {\n        if (addRefToSource) {\n            inlineCompletion.source.addRef();\n        }\n        const id = this._textModel.deltaDecorations([], [{\n                range,\n                options: {\n                    description: 'inline-completion-tracking-range'\n                },\n            }])[0];\n        this._inlineCompletions.unshift(new InlineCompletionWithUpdatedRange(inlineCompletion, id, this._textModel, this._versionId));\n        this._prependedInlineCompletionItems.push(inlineCompletion);\n    }\n}\nexport class InlineCompletionWithUpdatedRange {\n    get forwardStable() {\n        return this.inlineCompletion.source.inlineCompletions.enableForwardStability ?? false;\n    }\n    constructor(inlineCompletion, decorationId, _textModel, _modelVersion) {\n        this.inlineCompletion = inlineCompletion;\n        this.decorationId = decorationId;\n        this._textModel = _textModel;\n        this._modelVersion = _modelVersion;\n        this.semanticId = JSON.stringify([\n            this.inlineCompletion.filterText,\n            this.inlineCompletion.insertText,\n            this.inlineCompletion.range.getStartPosition().toString()\n        ]);\n        this._updatedRange = derivedOpts({ owner: this, equalsFn: Range.equalsRange }, reader => {\n            this._modelVersion.read(reader);\n            return this._textModel.getDecorationRange(this.decorationId);\n        });\n    }\n    toInlineCompletion(reader) {\n        return this.inlineCompletion.withRange(this._updatedRange.read(reader) ?? emptyRange);\n    }\n    toSingleTextEdit(reader) {\n        return new SingleTextEdit(this._updatedRange.read(reader) ?? emptyRange, this.inlineCompletion.insertText);\n    }\n    isVisible(model, cursorPosition, reader) {\n        const minimizedReplacement = singleTextRemoveCommonPrefix(this._toFilterTextReplacement(reader), model);\n        const updatedRange = this._updatedRange.read(reader);\n        if (!updatedRange\n            || !this.inlineCompletion.range.getStartPosition().equals(updatedRange.getStartPosition())\n            || cursorPosition.lineNumber !== minimizedReplacement.range.startLineNumber) {\n            return false;\n        }\n        // We might consider comparing by .toLowerText, but this requires GhostTextReplacement\n        const originalValue = model.getValueInRange(minimizedReplacement.range, 1 /* EndOfLinePreference.LF */);\n        const filterText = minimizedReplacement.text;\n        const cursorPosIndex = Math.max(0, cursorPosition.column - minimizedReplacement.range.startColumn);\n        let filterTextBefore = filterText.substring(0, cursorPosIndex);\n        let filterTextAfter = filterText.substring(cursorPosIndex);\n        let originalValueBefore = originalValue.substring(0, cursorPosIndex);\n        let originalValueAfter = originalValue.substring(cursorPosIndex);\n        const originalValueIndent = model.getLineIndentColumn(minimizedReplacement.range.startLineNumber);\n        if (minimizedReplacement.range.startColumn <= originalValueIndent) {\n            // Remove indentation\n            originalValueBefore = originalValueBefore.trimStart();\n            if (originalValueBefore.length === 0) {\n                originalValueAfter = originalValueAfter.trimStart();\n            }\n            filterTextBefore = filterTextBefore.trimStart();\n            if (filterTextBefore.length === 0) {\n                filterTextAfter = filterTextAfter.trimStart();\n            }\n        }\n        return filterTextBefore.startsWith(originalValueBefore)\n            && !!matchesSubString(originalValueAfter, filterTextAfter);\n    }\n    canBeReused(model, position) {\n        const updatedRange = this._updatedRange.read(undefined);\n        const result = !!updatedRange\n            && updatedRange.containsPosition(position)\n            && this.isVisible(model, position, undefined)\n            && TextLength.ofRange(updatedRange).isGreaterThanOrEqualTo(TextLength.ofRange(this.inlineCompletion.range));\n        return result;\n    }\n    _toFilterTextReplacement(reader) {\n        return new SingleTextEdit(this._updatedRange.read(reader) ?? emptyRange, this.inlineCompletion.filterText);\n    }\n}\nconst emptyRange = new Range(1, 1, 1, 1);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { CancellationError, isCancellationError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { FuzzyScore } from '../../../../base/common/filters.js';\nimport { DisposableStore, isDisposable } from '../../../../base/common/lifecycle.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\nimport { localize } from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { historyNavigationVisible } from '../../../../platform/history/browser/contextScopedHistoryWidget.js';\nexport const Context = {\n    Visible: historyNavigationVisible,\n    HasFocusedSuggestion: new RawContextKey('suggestWidgetHasFocusedSuggestion', false, localize('suggestWidgetHasSelection', \"Whether any suggestion is focused\")),\n    DetailsVisible: new RawContextKey('suggestWidgetDetailsVisible', false, localize('suggestWidgetDetailsVisible', \"Whether suggestion details are visible\")),\n    MultipleSuggestions: new RawContextKey('suggestWidgetMultipleSuggestions', false, localize('suggestWidgetMultipleSuggestions', \"Whether there are multiple suggestions to pick from\")),\n    MakesTextEdit: new RawContextKey('suggestionMakesTextEdit', true, localize('suggestionMakesTextEdit', \"Whether inserting the current suggestion yields in a change or has everything already been typed\")),\n    AcceptSuggestionsOnEnter: new RawContextKey('acceptSuggestionOnEnter', true, localize('acceptSuggestionOnEnter', \"Whether suggestions are inserted when pressing Enter\")),\n    HasInsertAndReplaceRange: new RawContextKey('suggestionHasInsertAndReplaceRange', false, localize('suggestionHasInsertAndReplaceRange', \"Whether the current suggestion has insert and replace behaviour\")),\n    InsertMode: new RawContextKey('suggestionInsertMode', undefined, { type: 'string', description: localize('suggestionInsertMode', \"Whether the default behaviour is to insert or replace\") }),\n    CanResolve: new RawContextKey('suggestionCanResolve', false, localize('suggestionCanResolve', \"Whether the current suggestion supports to resolve further details\")),\n};\nexport const suggestWidgetStatusbarMenu = new MenuId('suggestWidgetStatusBar');\nexport class CompletionItem {\n    constructor(position, completion, container, provider) {\n        this.position = position;\n        this.completion = completion;\n        this.container = container;\n        this.provider = provider;\n        // validation\n        this.isInvalid = false;\n        // sorting, filtering\n        this.score = FuzzyScore.Default;\n        this.distance = 0;\n        this.textLabel = typeof completion.label === 'string'\n            ? completion.label\n            : completion.label?.label;\n        // ensure lower-variants (perf)\n        this.labelLow = this.textLabel.toLowerCase();\n        // validate label\n        this.isInvalid = !this.textLabel;\n        this.sortTextLow = completion.sortText && completion.sortText.toLowerCase();\n        this.filterTextLow = completion.filterText && completion.filterText.toLowerCase();\n        this.extensionId = completion.extensionId;\n        // normalize ranges\n        if (Range.isIRange(completion.range)) {\n            this.editStart = new Position(completion.range.startLineNumber, completion.range.startColumn);\n            this.editInsertEnd = new Position(completion.range.endLineNumber, completion.range.endColumn);\n            this.editReplaceEnd = new Position(completion.range.endLineNumber, completion.range.endColumn);\n            // validate range\n            this.isInvalid = this.isInvalid\n                || Range.spansMultipleLines(completion.range) || completion.range.startLineNumber !== position.lineNumber;\n        }\n        else {\n            this.editStart = new Position(completion.range.insert.startLineNumber, completion.range.insert.startColumn);\n            this.editInsertEnd = new Position(completion.range.insert.endLineNumber, completion.range.insert.endColumn);\n            this.editReplaceEnd = new Position(completion.range.replace.endLineNumber, completion.range.replace.endColumn);\n            // validate ranges\n            this.isInvalid = this.isInvalid\n                || Range.spansMultipleLines(completion.range.insert) || Range.spansMultipleLines(completion.range.replace)\n                || completion.range.insert.startLineNumber !== position.lineNumber || completion.range.replace.startLineNumber !== position.lineNumber\n                || completion.range.insert.startColumn !== completion.range.replace.startColumn;\n        }\n        // create the suggestion resolver\n        if (typeof provider.resolveCompletionItem !== 'function') {\n            this._resolveCache = Promise.resolve();\n            this._resolveDuration = 0;\n        }\n    }\n    // ---- resolving\n    get isResolved() {\n        return this._resolveDuration !== undefined;\n    }\n    get resolveDuration() {\n        return this._resolveDuration !== undefined ? this._resolveDuration : -1;\n    }\n    async resolve(token) {\n        if (!this._resolveCache) {\n            const sub = token.onCancellationRequested(() => {\n                this._resolveCache = undefined;\n                this._resolveDuration = undefined;\n            });\n            const sw = new StopWatch(true);\n            this._resolveCache = Promise.resolve(this.provider.resolveCompletionItem(this.completion, token)).then(value => {\n                Object.assign(this.completion, value);\n                this._resolveDuration = sw.elapsed();\n            }, err => {\n                if (isCancellationError(err)) {\n                    // the IPC queue will reject the request with the\n                    // cancellation error -> reset cached\n                    this._resolveCache = undefined;\n                    this._resolveDuration = undefined;\n                }\n            }).finally(() => {\n                sub.dispose();\n            });\n        }\n        return this._resolveCache;\n    }\n}\nexport class CompletionOptions {\n    static { this.default = new CompletionOptions(); }\n    constructor(snippetSortOrder = 2 /* SnippetSortOrder.Bottom */, kindFilter = new Set(), providerFilter = new Set(), providerItemsToReuse = new Map(), showDeprecated = true) {\n        this.snippetSortOrder = snippetSortOrder;\n        this.kindFilter = kindFilter;\n        this.providerFilter = providerFilter;\n        this.providerItemsToReuse = providerItemsToReuse;\n        this.showDeprecated = showDeprecated;\n    }\n}\nlet _snippetSuggestSupport;\nexport function getSnippetSuggestSupport() {\n    return _snippetSuggestSupport;\n}\nexport class CompletionItemModel {\n    constructor(items, needsClipboard, durations, disposable) {\n        this.items = items;\n        this.needsClipboard = needsClipboard;\n        this.durations = durations;\n        this.disposable = disposable;\n    }\n}\nexport async function provideSuggestionItems(registry, model, position, options = CompletionOptions.default, context = { triggerKind: 0 /* languages.CompletionTriggerKind.Invoke */ }, token = CancellationToken.None) {\n    const sw = new StopWatch();\n    position = position.clone();\n    const word = model.getWordAtPosition(position);\n    const defaultReplaceRange = word ? new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn) : Range.fromPositions(position);\n    const defaultRange = { replace: defaultReplaceRange, insert: defaultReplaceRange.setEndPosition(position.lineNumber, position.column) };\n    const result = [];\n    const disposables = new DisposableStore();\n    const durations = [];\n    let needsClipboard = false;\n    const onCompletionList = (provider, container, sw) => {\n        let didAddResult = false;\n        if (!container) {\n            return didAddResult;\n        }\n        for (const suggestion of container.suggestions) {\n            if (!options.kindFilter.has(suggestion.kind)) {\n                // skip if not showing deprecated suggestions\n                if (!options.showDeprecated && suggestion?.tags?.includes(1 /* languages.CompletionItemTag.Deprecated */)) {\n                    continue;\n                }\n                // fill in default range when missing\n                if (!suggestion.range) {\n                    suggestion.range = defaultRange;\n                }\n                // fill in default sortText when missing\n                if (!suggestion.sortText) {\n                    suggestion.sortText = typeof suggestion.label === 'string' ? suggestion.label : suggestion.label.label;\n                }\n                if (!needsClipboard && suggestion.insertTextRules && suggestion.insertTextRules & 4 /* languages.CompletionItemInsertTextRule.InsertAsSnippet */) {\n                    needsClipboard = SnippetParser.guessNeedsClipboard(suggestion.insertText);\n                }\n                result.push(new CompletionItem(position, suggestion, container, provider));\n                didAddResult = true;\n            }\n        }\n        if (isDisposable(container)) {\n            disposables.add(container);\n        }\n        durations.push({\n            providerName: provider._debugDisplayName ?? 'unknown_provider', elapsedProvider: container.duration ?? -1, elapsedOverall: sw.elapsed()\n        });\n        return didAddResult;\n    };\n    // ask for snippets in parallel to asking \"real\" providers. Only do something if configured to\n    // do so - no snippet filter, no special-providers-only request\n    const snippetCompletions = (async () => {\n        if (!_snippetSuggestSupport || options.kindFilter.has(27 /* languages.CompletionItemKind.Snippet */)) {\n            return;\n        }\n        // we have items from a previous session that we can reuse\n        const reuseItems = options.providerItemsToReuse.get(_snippetSuggestSupport);\n        if (reuseItems) {\n            reuseItems.forEach(item => result.push(item));\n            return;\n        }\n        if (options.providerFilter.size > 0 && !options.providerFilter.has(_snippetSuggestSupport)) {\n            return;\n        }\n        const sw = new StopWatch();\n        const list = await _snippetSuggestSupport.provideCompletionItems(model, position, context, token);\n        onCompletionList(_snippetSuggestSupport, list, sw);\n    })();\n    // add suggestions from contributed providers - providers are ordered in groups of\n    // equal score and once a group produces a result the process stops\n    // get provider groups, always add snippet suggestion provider\n    for (const providerGroup of registry.orderedGroups(model)) {\n        // for each support in the group ask for suggestions\n        let didAddResult = false;\n        await Promise.all(providerGroup.map(async (provider) => {\n            // we have items from a previous session that we can reuse\n            if (options.providerItemsToReuse.has(provider)) {\n                const items = options.providerItemsToReuse.get(provider);\n                items.forEach(item => result.push(item));\n                didAddResult = didAddResult || items.length > 0;\n                return;\n            }\n            // check if this provider is filtered out\n            if (options.providerFilter.size > 0 && !options.providerFilter.has(provider)) {\n                return;\n            }\n            try {\n                const sw = new StopWatch();\n                const list = await provider.provideCompletionItems(model, position, context, token);\n                didAddResult = onCompletionList(provider, list, sw) || didAddResult;\n            }\n            catch (err) {\n                onUnexpectedExternalError(err);\n            }\n        }));\n        if (didAddResult || token.isCancellationRequested) {\n            break;\n        }\n    }\n    await snippetCompletions;\n    if (token.isCancellationRequested) {\n        disposables.dispose();\n        return Promise.reject(new CancellationError());\n    }\n    return new CompletionItemModel(result.sort(getSuggestionComparator(options.snippetSortOrder)), needsClipboard, { entries: durations, elapsed: sw.elapsed() }, disposables);\n}\nfunction defaultComparator(a, b) {\n    // check with 'sortText'\n    if (a.sortTextLow && b.sortTextLow) {\n        if (a.sortTextLow < b.sortTextLow) {\n            return -1;\n        }\n        else if (a.sortTextLow > b.sortTextLow) {\n            return 1;\n        }\n    }\n    // check with 'label'\n    if (a.textLabel < b.textLabel) {\n        return -1;\n    }\n    else if (a.textLabel > b.textLabel) {\n        return 1;\n    }\n    // check with 'type'\n    return a.completion.kind - b.completion.kind;\n}\nfunction snippetUpComparator(a, b) {\n    if (a.completion.kind !== b.completion.kind) {\n        if (a.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return -1;\n        }\n        else if (b.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return 1;\n        }\n    }\n    return defaultComparator(a, b);\n}\nfunction snippetDownComparator(a, b) {\n    if (a.completion.kind !== b.completion.kind) {\n        if (a.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return 1;\n        }\n        else if (b.completion.kind === 27 /* languages.CompletionItemKind.Snippet */) {\n            return -1;\n        }\n    }\n    return defaultComparator(a, b);\n}\nconst _snippetComparators = new Map();\n_snippetComparators.set(0 /* SnippetSortOrder.Top */, snippetUpComparator);\n_snippetComparators.set(2 /* SnippetSortOrder.Bottom */, snippetDownComparator);\n_snippetComparators.set(1 /* SnippetSortOrder.Inline */, defaultComparator);\nexport function getSuggestionComparator(snippetConfig) {\n    return _snippetComparators.get(snippetConfig);\n}\nCommandsRegistry.registerCommand('_executeCompletionItemProvider', async (accessor, ...args) => {\n    const [uri, position, triggerCharacter, maxItemsToResolve] = args;\n    assertType(URI.isUri(uri));\n    assertType(Position.isIPosition(position));\n    assertType(typeof triggerCharacter === 'string' || !triggerCharacter);\n    assertType(typeof maxItemsToResolve === 'number' || !maxItemsToResolve);\n    const { completionProvider } = accessor.get(ILanguageFeaturesService);\n    const ref = await accessor.get(ITextModelService).createModelReference(uri);\n    try {\n        const result = {\n            incomplete: false,\n            suggestions: []\n        };\n        const resolving = [];\n        const actualPosition = ref.object.textEditorModel.validatePosition(position);\n        const completions = await provideSuggestionItems(completionProvider, ref.object.textEditorModel, actualPosition, undefined, { triggerCharacter: triggerCharacter ?? undefined, triggerKind: triggerCharacter ? 1 /* languages.CompletionTriggerKind.TriggerCharacter */ : 0 /* languages.CompletionTriggerKind.Invoke */ });\n        for (const item of completions.items) {\n            if (resolving.length < (maxItemsToResolve ?? 0)) {\n                resolving.push(item.resolve(CancellationToken.None));\n            }\n            result.incomplete = result.incomplete || item.container.incomplete;\n            result.suggestions.push(item.completion);\n        }\n        try {\n            await Promise.all(resolving);\n            return result;\n        }\n        finally {\n            setTimeout(() => completions.disposable.dispose(), 100);\n        }\n    }\n    finally {\n        ref.dispose();\n    }\n});\nexport function showSimpleSuggestions(editor, provider) {\n    editor.getContribution('editor.contrib.suggestController')?.triggerSuggest(new Set().add(provider), undefined, true);\n}\nexport class QuickSuggestionsOptions {\n    static isAllOff(config) {\n        return config.other === 'off' && config.comments === 'off' && config.strings === 'off';\n    }\n    static isAllOn(config) {\n        return config.other === 'on' && config.comments === 'on' && config.strings === 'on';\n    }\n    static valueFor(config, tokenType) {\n        switch (tokenType) {\n            case 1 /* StandardTokenType.Comment */: return config.comments;\n            case 2 /* StandardTokenType.String */: return config.strings;\n            default: return config.other;\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { normalizeDriveLetter } from '../../../../base/common/labels.js';\nimport * as path from '../../../../base/common/path.js';\nimport { dirname } from '../../../../base/common/resources.js';\nimport { commonPrefixLength, getLeadingWhitespace, isFalsyOrWhitespace, splitLines } from '../../../../base/common/strings.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { Text } from './snippetParser.js';\nimport * as nls from '../../../../nls.js';\nimport { WORKSPACE_EXTENSION, isSingleFolderWorkspaceIdentifier, toWorkspaceIdentifier, isEmptyWorkspaceIdentifier } from '../../../../platform/workspace/common/workspace.js';\nexport const KnownSnippetVariableNames = Object.freeze({\n    'CURRENT_YEAR': true,\n    'CURRENT_YEAR_SHORT': true,\n    'CURRENT_MONTH': true,\n    'CURRENT_DATE': true,\n    'CURRENT_HOUR': true,\n    'CURRENT_MINUTE': true,\n    'CURRENT_SECOND': true,\n    'CURRENT_DAY_NAME': true,\n    'CURRENT_DAY_NAME_SHORT': true,\n    'CURRENT_MONTH_NAME': true,\n    'CURRENT_MONTH_NAME_SHORT': true,\n    'CURRENT_SECONDS_UNIX': true,\n    'CURRENT_TIMEZONE_OFFSET': true,\n    'SELECTION': true,\n    'CLIPBOARD': true,\n    'TM_SELECTED_TEXT': true,\n    'TM_CURRENT_LINE': true,\n    'TM_CURRENT_WORD': true,\n    'TM_LINE_INDEX': true,\n    'TM_LINE_NUMBER': true,\n    'TM_FILENAME': true,\n    'TM_FILENAME_BASE': true,\n    'TM_DIRECTORY': true,\n    'TM_FILEPATH': true,\n    'CURSOR_INDEX': true, // 0-offset\n    'CURSOR_NUMBER': true, // 1-offset\n    'RELATIVE_FILEPATH': true,\n    'BLOCK_COMMENT_START': true,\n    'BLOCK_COMMENT_END': true,\n    'LINE_COMMENT': true,\n    'WORKSPACE_NAME': true,\n    'WORKSPACE_FOLDER': true,\n    'RANDOM': true,\n    'RANDOM_HEX': true,\n    'UUID': true\n});\nexport class CompositeSnippetVariableResolver {\n    constructor(_delegates) {\n        this._delegates = _delegates;\n        //\n    }\n    resolve(variable) {\n        for (const delegate of this._delegates) {\n            const value = delegate.resolve(variable);\n            if (value !== undefined) {\n                return value;\n            }\n        }\n        return undefined;\n    }\n}\nexport class SelectionBasedVariableResolver {\n    constructor(_model, _selection, _selectionIdx, _overtypingCapturer) {\n        this._model = _model;\n        this._selection = _selection;\n        this._selectionIdx = _selectionIdx;\n        this._overtypingCapturer = _overtypingCapturer;\n        //\n    }\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'SELECTION' || name === 'TM_SELECTED_TEXT') {\n            let value = this._model.getValueInRange(this._selection) || undefined;\n            let isMultiline = this._selection.startLineNumber !== this._selection.endLineNumber;\n            // If there was no selected text, try to get last overtyped text\n            if (!value && this._overtypingCapturer) {\n                const info = this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);\n                if (info) {\n                    value = info.value;\n                    isMultiline = info.multiline;\n                }\n            }\n            if (value && isMultiline && variable.snippet) {\n                // Selection is a multiline string which we indentation we now\n                // need to adjust. We compare the indentation of this variable\n                // with the indentation at the editor position and add potential\n                // extra indentation to the value\n                const line = this._model.getLineContent(this._selection.startLineNumber);\n                const lineLeadingWhitespace = getLeadingWhitespace(line, 0, this._selection.startColumn - 1);\n                let varLeadingWhitespace = lineLeadingWhitespace;\n                variable.snippet.walk(marker => {\n                    if (marker === variable) {\n                        return false;\n                    }\n                    if (marker instanceof Text) {\n                        varLeadingWhitespace = getLeadingWhitespace(splitLines(marker.value).pop());\n                    }\n                    return true;\n                });\n                const whitespaceCommonLength = commonPrefixLength(varLeadingWhitespace, lineLeadingWhitespace);\n                value = value.replace(/(\\r\\n|\\r|\\n)(.*)/g, (m, newline, rest) => `${newline}${varLeadingWhitespace.substr(whitespaceCommonLength)}${rest}`);\n            }\n            return value;\n        }\n        else if (name === 'TM_CURRENT_LINE') {\n            return this._model.getLineContent(this._selection.positionLineNumber);\n        }\n        else if (name === 'TM_CURRENT_WORD') {\n            const info = this._model.getWordAtPosition({\n                lineNumber: this._selection.positionLineNumber,\n                column: this._selection.positionColumn\n            });\n            return info && info.word || undefined;\n        }\n        else if (name === 'TM_LINE_INDEX') {\n            return String(this._selection.positionLineNumber - 1);\n        }\n        else if (name === 'TM_LINE_NUMBER') {\n            return String(this._selection.positionLineNumber);\n        }\n        else if (name === 'CURSOR_INDEX') {\n            return String(this._selectionIdx);\n        }\n        else if (name === 'CURSOR_NUMBER') {\n            return String(this._selectionIdx + 1);\n        }\n        return undefined;\n    }\n}\nexport class ModelBasedVariableResolver {\n    constructor(_labelService, _model) {\n        this._labelService = _labelService;\n        this._model = _model;\n        //\n    }\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'TM_FILENAME') {\n            return path.basename(this._model.uri.fsPath);\n        }\n        else if (name === 'TM_FILENAME_BASE') {\n            const name = path.basename(this._model.uri.fsPath);\n            const idx = name.lastIndexOf('.');\n            if (idx <= 0) {\n                return name;\n            }\n            else {\n                return name.slice(0, idx);\n            }\n        }\n        else if (name === 'TM_DIRECTORY') {\n            if (path.dirname(this._model.uri.fsPath) === '.') {\n                return '';\n            }\n            return this._labelService.getUriLabel(dirname(this._model.uri));\n        }\n        else if (name === 'TM_FILEPATH') {\n            return this._labelService.getUriLabel(this._model.uri);\n        }\n        else if (name === 'RELATIVE_FILEPATH') {\n            return this._labelService.getUriLabel(this._model.uri, { relative: true, noPrefix: true });\n        }\n        return undefined;\n    }\n}\nexport class ClipboardBasedVariableResolver {\n    constructor(_readClipboardText, _selectionIdx, _selectionCount, _spread) {\n        this._readClipboardText = _readClipboardText;\n        this._selectionIdx = _selectionIdx;\n        this._selectionCount = _selectionCount;\n        this._spread = _spread;\n        //\n    }\n    resolve(variable) {\n        if (variable.name !== 'CLIPBOARD') {\n            return undefined;\n        }\n        const clipboardText = this._readClipboardText();\n        if (!clipboardText) {\n            return undefined;\n        }\n        // `spread` is assigning each cursor a line of the clipboard\n        // text whenever there the line count equals the cursor count\n        // and when enabled\n        if (this._spread) {\n            const lines = clipboardText.split(/\\r\\n|\\n|\\r/).filter(s => !isFalsyOrWhitespace(s));\n            if (lines.length === this._selectionCount) {\n                return lines[this._selectionIdx];\n            }\n        }\n        return clipboardText;\n    }\n}\nlet CommentBasedVariableResolver = class CommentBasedVariableResolver {\n    constructor(_model, _selection, _languageConfigurationService) {\n        this._model = _model;\n        this._selection = _selection;\n        this._languageConfigurationService = _languageConfigurationService;\n        //\n    }\n    resolve(variable) {\n        const { name } = variable;\n        const langId = this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber, this._selection.selectionStartColumn);\n        const config = this._languageConfigurationService.getLanguageConfiguration(langId).comments;\n        if (!config) {\n            return undefined;\n        }\n        if (name === 'LINE_COMMENT') {\n            return config.lineCommentToken || undefined;\n        }\n        else if (name === 'BLOCK_COMMENT_START') {\n            return config.blockCommentStartToken || undefined;\n        }\n        else if (name === 'BLOCK_COMMENT_END') {\n            return config.blockCommentEndToken || undefined;\n        }\n        return undefined;\n    }\n};\nCommentBasedVariableResolver = __decorate([\n    __param(2, ILanguageConfigurationService)\n], CommentBasedVariableResolver);\nexport { CommentBasedVariableResolver };\nexport class TimeBasedVariableResolver {\n    constructor() {\n        this._date = new Date();\n    }\n    static { this.dayNames = [nls.localize('Sunday', \"Sunday\"), nls.localize('Monday', \"Monday\"), nls.localize('Tuesday', \"Tuesday\"), nls.localize('Wednesday', \"Wednesday\"), nls.localize('Thursday', \"Thursday\"), nls.localize('Friday', \"Friday\"), nls.localize('Saturday', \"Saturday\")]; }\n    static { this.dayNamesShort = [nls.localize('SundayShort', \"Sun\"), nls.localize('MondayShort', \"Mon\"), nls.localize('TuesdayShort', \"Tue\"), nls.localize('WednesdayShort', \"Wed\"), nls.localize('ThursdayShort', \"Thu\"), nls.localize('FridayShort', \"Fri\"), nls.localize('SaturdayShort', \"Sat\")]; }\n    static { this.monthNames = [nls.localize('January', \"January\"), nls.localize('February', \"February\"), nls.localize('March', \"March\"), nls.localize('April', \"April\"), nls.localize('May', \"May\"), nls.localize('June', \"June\"), nls.localize('July', \"July\"), nls.localize('August', \"August\"), nls.localize('September', \"September\"), nls.localize('October', \"October\"), nls.localize('November', \"November\"), nls.localize('December', \"December\")]; }\n    static { this.monthNamesShort = [nls.localize('JanuaryShort', \"Jan\"), nls.localize('FebruaryShort', \"Feb\"), nls.localize('MarchShort', \"Mar\"), nls.localize('AprilShort', \"Apr\"), nls.localize('MayShort', \"May\"), nls.localize('JuneShort', \"Jun\"), nls.localize('JulyShort', \"Jul\"), nls.localize('AugustShort', \"Aug\"), nls.localize('SeptemberShort', \"Sep\"), nls.localize('OctoberShort', \"Oct\"), nls.localize('NovemberShort', \"Nov\"), nls.localize('DecemberShort', \"Dec\")]; }\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'CURRENT_YEAR') {\n            return String(this._date.getFullYear());\n        }\n        else if (name === 'CURRENT_YEAR_SHORT') {\n            return String(this._date.getFullYear()).slice(-2);\n        }\n        else if (name === 'CURRENT_MONTH') {\n            return String(this._date.getMonth().valueOf() + 1).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_DATE') {\n            return String(this._date.getDate().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_HOUR') {\n            return String(this._date.getHours().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_MINUTE') {\n            return String(this._date.getMinutes().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_SECOND') {\n            return String(this._date.getSeconds().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_DAY_NAME') {\n            return TimeBasedVariableResolver.dayNames[this._date.getDay()];\n        }\n        else if (name === 'CURRENT_DAY_NAME_SHORT') {\n            return TimeBasedVariableResolver.dayNamesShort[this._date.getDay()];\n        }\n        else if (name === 'CURRENT_MONTH_NAME') {\n            return TimeBasedVariableResolver.monthNames[this._date.getMonth()];\n        }\n        else if (name === 'CURRENT_MONTH_NAME_SHORT') {\n            return TimeBasedVariableResolver.monthNamesShort[this._date.getMonth()];\n        }\n        else if (name === 'CURRENT_SECONDS_UNIX') {\n            return String(Math.floor(this._date.getTime() / 1000));\n        }\n        else if (name === 'CURRENT_TIMEZONE_OFFSET') {\n            const rawTimeOffset = this._date.getTimezoneOffset();\n            const sign = rawTimeOffset > 0 ? '-' : '+';\n            const hours = Math.trunc(Math.abs(rawTimeOffset / 60));\n            const hoursString = (hours < 10 ? '0' + hours : hours);\n            const minutes = Math.abs(rawTimeOffset) - hours * 60;\n            const minutesString = (minutes < 10 ? '0' + minutes : minutes);\n            return sign + hoursString + ':' + minutesString;\n        }\n        return undefined;\n    }\n}\nexport class WorkspaceBasedVariableResolver {\n    constructor(_workspaceService) {\n        this._workspaceService = _workspaceService;\n        //\n    }\n    resolve(variable) {\n        if (!this._workspaceService) {\n            return undefined;\n        }\n        const workspaceIdentifier = toWorkspaceIdentifier(this._workspaceService.getWorkspace());\n        if (isEmptyWorkspaceIdentifier(workspaceIdentifier)) {\n            return undefined;\n        }\n        if (variable.name === 'WORKSPACE_NAME') {\n            return this._resolveWorkspaceName(workspaceIdentifier);\n        }\n        else if (variable.name === 'WORKSPACE_FOLDER') {\n            return this._resoveWorkspacePath(workspaceIdentifier);\n        }\n        return undefined;\n    }\n    _resolveWorkspaceName(workspaceIdentifier) {\n        if (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\n            return path.basename(workspaceIdentifier.uri.path);\n        }\n        let filename = path.basename(workspaceIdentifier.configPath.path);\n        if (filename.endsWith(WORKSPACE_EXTENSION)) {\n            filename = filename.substr(0, filename.length - WORKSPACE_EXTENSION.length - 1);\n        }\n        return filename;\n    }\n    _resoveWorkspacePath(workspaceIdentifier) {\n        if (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\n            return normalizeDriveLetter(workspaceIdentifier.uri.fsPath);\n        }\n        const filename = path.basename(workspaceIdentifier.configPath.path);\n        let folderpath = workspaceIdentifier.configPath.fsPath;\n        if (folderpath.endsWith(filename)) {\n            folderpath = folderpath.substr(0, folderpath.length - filename.length - 1);\n        }\n        return (folderpath ? normalizeDriveLetter(folderpath) : '/');\n    }\n}\nexport class RandomBasedVariableResolver {\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'RANDOM') {\n            return Math.random().toString().slice(-6);\n        }\n        else if (name === 'RANDOM_HEX') {\n            return Math.random().toString(16).slice(-6);\n        }\n        else if (name === 'UUID') {\n            return generateUuid();\n        }\n        return undefined;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SnippetSession_1;\nimport { groupBy } from '../../../../base/common/arrays.js';\nimport { dispose } from '../../../../base/common/lifecycle.js';\nimport { getLeadingWhitespace } from '../../../../base/common/strings.js';\nimport './snippetSession.css';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { Choice, Placeholder, SnippetParser, Text, TextmateSnippet } from './snippetParser.js';\nimport { ClipboardBasedVariableResolver, CommentBasedVariableResolver, CompositeSnippetVariableResolver, ModelBasedVariableResolver, RandomBasedVariableResolver, SelectionBasedVariableResolver, TimeBasedVariableResolver, WorkspaceBasedVariableResolver } from './snippetVariables.js';\nexport class OneSnippet {\n    static { this._decor = {\n        active: ModelDecorationOptions.register({ description: 'snippet-placeholder-1', stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */, className: 'snippet-placeholder' }),\n        inactive: ModelDecorationOptions.register({ description: 'snippet-placeholder-2', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */, className: 'snippet-placeholder' }),\n        activeFinal: ModelDecorationOptions.register({ description: 'snippet-placeholder-3', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */, className: 'finish-snippet-placeholder' }),\n        inactiveFinal: ModelDecorationOptions.register({ description: 'snippet-placeholder-4', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */, className: 'finish-snippet-placeholder' }),\n    }; }\n    constructor(_editor, _snippet, _snippetLineLeadingWhitespace) {\n        this._editor = _editor;\n        this._snippet = _snippet;\n        this._snippetLineLeadingWhitespace = _snippetLineLeadingWhitespace;\n        this._offset = -1;\n        this._nestingLevel = 1;\n        this._placeholderGroups = groupBy(_snippet.placeholders, Placeholder.compareByIndex);\n        this._placeholderGroupsIdx = -1;\n    }\n    initialize(textChange) {\n        this._offset = textChange.newPosition;\n    }\n    dispose() {\n        if (this._placeholderDecorations) {\n            this._editor.removeDecorations([...this._placeholderDecorations.values()]);\n        }\n        this._placeholderGroups.length = 0;\n    }\n    _initDecorations() {\n        if (this._offset === -1) {\n            throw new Error(`Snippet not initialized!`);\n        }\n        if (this._placeholderDecorations) {\n            // already initialized\n            return;\n        }\n        this._placeholderDecorations = new Map();\n        const model = this._editor.getModel();\n        this._editor.changeDecorations(accessor => {\n            // create a decoration for each placeholder\n            for (const placeholder of this._snippet.placeholders) {\n                const placeholderOffset = this._snippet.offset(placeholder);\n                const placeholderLen = this._snippet.fullLen(placeholder);\n                const range = Range.fromPositions(model.getPositionAt(this._offset + placeholderOffset), model.getPositionAt(this._offset + placeholderOffset + placeholderLen));\n                const options = placeholder.isFinalTabstop ? OneSnippet._decor.inactiveFinal : OneSnippet._decor.inactive;\n                const handle = accessor.addDecoration(range, options);\n                this._placeholderDecorations.set(placeholder, handle);\n            }\n        });\n    }\n    move(fwd) {\n        if (!this._editor.hasModel()) {\n            return [];\n        }\n        this._initDecorations();\n        // Transform placeholder text if necessary\n        if (this._placeholderGroupsIdx >= 0) {\n            const operations = [];\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\n                // Check if the placeholder has a transformation\n                if (placeholder.transform) {\n                    const id = this._placeholderDecorations.get(placeholder);\n                    const range = this._editor.getModel().getDecorationRange(id);\n                    const currentValue = this._editor.getModel().getValueInRange(range);\n                    const transformedValueLines = placeholder.transform.resolve(currentValue).split(/\\r\\n|\\r|\\n/);\n                    // fix indentation for transformed lines\n                    for (let i = 1; i < transformedValueLines.length; i++) {\n                        transformedValueLines[i] = this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace + transformedValueLines[i]);\n                    }\n                    operations.push(EditOperation.replace(range, transformedValueLines.join(this._editor.getModel().getEOL())));\n                }\n            }\n            if (operations.length > 0) {\n                this._editor.executeEdits('snippet.placeholderTransform', operations);\n            }\n        }\n        let couldSkipThisPlaceholder = false;\n        if (fwd === true && this._placeholderGroupsIdx < this._placeholderGroups.length - 1) {\n            this._placeholderGroupsIdx += 1;\n            couldSkipThisPlaceholder = true;\n        }\n        else if (fwd === false && this._placeholderGroupsIdx > 0) {\n            this._placeholderGroupsIdx -= 1;\n            couldSkipThisPlaceholder = true;\n        }\n        else {\n            // the selection of the current placeholder might\n            // not acurate any more -> simply restore it\n        }\n        const newSelections = this._editor.getModel().changeDecorations(accessor => {\n            const activePlaceholders = new Set();\n            // change stickiness to always grow when typing at its edges\n            // because these decorations represent the currently active\n            // tabstop.\n            // Special case #1: reaching the final tabstop\n            // Special case #2: placeholders enclosing active placeholders\n            const selections = [];\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\n                const id = this._placeholderDecorations.get(placeholder);\n                const range = this._editor.getModel().getDecorationRange(id);\n                selections.push(new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn));\n                // consider to skip this placeholder index when the decoration\n                // range is empty but when the placeholder wasn't. that's a strong\n                // hint that the placeholder has been deleted. (all placeholder must match this)\n                couldSkipThisPlaceholder = couldSkipThisPlaceholder && this._hasPlaceholderBeenCollapsed(placeholder);\n                accessor.changeDecorationOptions(id, placeholder.isFinalTabstop ? OneSnippet._decor.activeFinal : OneSnippet._decor.active);\n                activePlaceholders.add(placeholder);\n                for (const enclosingPlaceholder of this._snippet.enclosingPlaceholders(placeholder)) {\n                    const id = this._placeholderDecorations.get(enclosingPlaceholder);\n                    accessor.changeDecorationOptions(id, enclosingPlaceholder.isFinalTabstop ? OneSnippet._decor.activeFinal : OneSnippet._decor.active);\n                    activePlaceholders.add(enclosingPlaceholder);\n                }\n            }\n            // change stickness to never grow when typing at its edges\n            // so that in-active tabstops never grow\n            for (const [placeholder, id] of this._placeholderDecorations) {\n                if (!activePlaceholders.has(placeholder)) {\n                    accessor.changeDecorationOptions(id, placeholder.isFinalTabstop ? OneSnippet._decor.inactiveFinal : OneSnippet._decor.inactive);\n                }\n            }\n            return selections;\n        });\n        return !couldSkipThisPlaceholder ? newSelections ?? [] : this.move(fwd);\n    }\n    _hasPlaceholderBeenCollapsed(placeholder) {\n        // A placeholder is empty when it wasn't empty when authored but\n        // when its tracking decoration is empty. This also applies to all\n        // potential parent placeholders\n        let marker = placeholder;\n        while (marker) {\n            if (marker instanceof Placeholder) {\n                const id = this._placeholderDecorations.get(marker);\n                const range = this._editor.getModel().getDecorationRange(id);\n                if (range.isEmpty() && marker.toString().length > 0) {\n                    return true;\n                }\n            }\n            marker = marker.parent;\n        }\n        return false;\n    }\n    get isAtFirstPlaceholder() {\n        return this._placeholderGroupsIdx <= 0 || this._placeholderGroups.length === 0;\n    }\n    get isAtLastPlaceholder() {\n        return this._placeholderGroupsIdx === this._placeholderGroups.length - 1;\n    }\n    get hasPlaceholder() {\n        return this._snippet.placeholders.length > 0;\n    }\n    /**\n     * A snippet is trivial when it has no placeholder or only a final placeholder at\n     * its very end\n     */\n    get isTrivialSnippet() {\n        if (this._snippet.placeholders.length === 0) {\n            return true;\n        }\n        if (this._snippet.placeholders.length === 1) {\n            const [placeholder] = this._snippet.placeholders;\n            if (placeholder.isFinalTabstop) {\n                if (this._snippet.rightMostDescendant === placeholder) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    computePossibleSelections() {\n        const result = new Map();\n        for (const placeholdersWithEqualIndex of this._placeholderGroups) {\n            let ranges;\n            for (const placeholder of placeholdersWithEqualIndex) {\n                if (placeholder.isFinalTabstop) {\n                    // ignore those\n                    break;\n                }\n                if (!ranges) {\n                    ranges = [];\n                    result.set(placeholder.index, ranges);\n                }\n                const id = this._placeholderDecorations.get(placeholder);\n                const range = this._editor.getModel().getDecorationRange(id);\n                if (!range) {\n                    // one of the placeholder lost its decoration and\n                    // therefore we bail out and pretend the placeholder\n                    // (with its mirrors) doesn't exist anymore.\n                    result.delete(placeholder.index);\n                    break;\n                }\n                ranges.push(range);\n            }\n        }\n        return result;\n    }\n    get activeChoice() {\n        if (!this._placeholderDecorations) {\n            return undefined;\n        }\n        const placeholder = this._placeholderGroups[this._placeholderGroupsIdx][0];\n        if (!placeholder?.choice) {\n            return undefined;\n        }\n        const id = this._placeholderDecorations.get(placeholder);\n        if (!id) {\n            return undefined;\n        }\n        const range = this._editor.getModel().getDecorationRange(id);\n        if (!range) {\n            return undefined;\n        }\n        return { range, choice: placeholder.choice };\n    }\n    get hasChoice() {\n        let result = false;\n        this._snippet.walk(marker => {\n            result = marker instanceof Choice;\n            return !result;\n        });\n        return result;\n    }\n    merge(others) {\n        const model = this._editor.getModel();\n        this._nestingLevel *= 10;\n        this._editor.changeDecorations(accessor => {\n            // For each active placeholder take one snippet and merge it\n            // in that the placeholder (can be many for `$1foo$1foo`). Because\n            // everything is sorted by editor selection we can simply remove\n            // elements from the beginning of the array\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\n                const nested = others.shift();\n                console.assert(nested._offset !== -1);\n                console.assert(!nested._placeholderDecorations);\n                // Massage placeholder-indicies of the nested snippet to be\n                // sorted right after the insertion point. This ensures we move\n                // through the placeholders in the correct order\n                const indexLastPlaceholder = nested._snippet.placeholderInfo.last.index;\n                for (const nestedPlaceholder of nested._snippet.placeholderInfo.all) {\n                    if (nestedPlaceholder.isFinalTabstop) {\n                        nestedPlaceholder.index = placeholder.index + ((indexLastPlaceholder + 1) / this._nestingLevel);\n                    }\n                    else {\n                        nestedPlaceholder.index = placeholder.index + (nestedPlaceholder.index / this._nestingLevel);\n                    }\n                }\n                this._snippet.replace(placeholder, nested._snippet.children);\n                // Remove the placeholder at which position are inserting\n                // the snippet and also remove its decoration.\n                const id = this._placeholderDecorations.get(placeholder);\n                accessor.removeDecoration(id);\n                this._placeholderDecorations.delete(placeholder);\n                // For each *new* placeholder we create decoration to monitor\n                // how and if it grows/shrinks.\n                for (const placeholder of nested._snippet.placeholders) {\n                    const placeholderOffset = nested._snippet.offset(placeholder);\n                    const placeholderLen = nested._snippet.fullLen(placeholder);\n                    const range = Range.fromPositions(model.getPositionAt(nested._offset + placeholderOffset), model.getPositionAt(nested._offset + placeholderOffset + placeholderLen));\n                    const handle = accessor.addDecoration(range, OneSnippet._decor.inactive);\n                    this._placeholderDecorations.set(placeholder, handle);\n                }\n            }\n            // Last, re-create the placeholder groups by sorting placeholders by their index.\n            this._placeholderGroups = groupBy(this._snippet.placeholders, Placeholder.compareByIndex);\n        });\n    }\n}\nconst _defaultOptions = {\n    overwriteBefore: 0,\n    overwriteAfter: 0,\n    adjustWhitespace: true,\n    clipboardText: undefined,\n    overtypingCapturer: undefined\n};\nlet SnippetSession = SnippetSession_1 = class SnippetSession {\n    static adjustWhitespace(model, position, adjustIndentation, snippet, filter) {\n        const line = model.getLineContent(position.lineNumber);\n        const lineLeadingWhitespace = getLeadingWhitespace(line, 0, position.column - 1);\n        // the snippet as inserted\n        let snippetTextString;\n        snippet.walk(marker => {\n            // all text elements that are not inside choice\n            if (!(marker instanceof Text) || marker.parent instanceof Choice) {\n                return true;\n            }\n            // check with filter (iff provided)\n            if (filter && !filter.has(marker)) {\n                return true;\n            }\n            const lines = marker.value.split(/\\r\\n|\\r|\\n/);\n            if (adjustIndentation) {\n                // adjust indentation of snippet test\n                // -the snippet-start doesn't get extra-indented (lineLeadingWhitespace), only normalized\n                // -all N+1 lines get extra-indented and normalized\n                // -the text start get extra-indented and normalized when following a linebreak\n                const offset = snippet.offset(marker);\n                if (offset === 0) {\n                    // snippet start\n                    lines[0] = model.normalizeIndentation(lines[0]);\n                }\n                else {\n                    // check if text start is after a linebreak\n                    snippetTextString = snippetTextString ?? snippet.toString();\n                    const prevChar = snippetTextString.charCodeAt(offset - 1);\n                    if (prevChar === 10 /* CharCode.LineFeed */ || prevChar === 13 /* CharCode.CarriageReturn */) {\n                        lines[0] = model.normalizeIndentation(lineLeadingWhitespace + lines[0]);\n                    }\n                }\n                for (let i = 1; i < lines.length; i++) {\n                    lines[i] = model.normalizeIndentation(lineLeadingWhitespace + lines[i]);\n                }\n            }\n            const newValue = lines.join(model.getEOL());\n            if (newValue !== marker.value) {\n                marker.parent.replace(marker, [new Text(newValue)]);\n                snippetTextString = undefined;\n            }\n            return true;\n        });\n        return lineLeadingWhitespace;\n    }\n    static adjustSelection(model, selection, overwriteBefore, overwriteAfter) {\n        if (overwriteBefore !== 0 || overwriteAfter !== 0) {\n            // overwrite[Before|After] is compute using the position, not the whole\n            // selection. therefore we adjust the selection around that position\n            const { positionLineNumber, positionColumn } = selection;\n            const positionColumnBefore = positionColumn - overwriteBefore;\n            const positionColumnAfter = positionColumn + overwriteAfter;\n            const range = model.validateRange({\n                startLineNumber: positionLineNumber,\n                startColumn: positionColumnBefore,\n                endLineNumber: positionLineNumber,\n                endColumn: positionColumnAfter\n            });\n            selection = Selection.createWithDirection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn, selection.getDirection());\n        }\n        return selection;\n    }\n    static createEditsAndSnippetsFromSelections(editor, template, overwriteBefore, overwriteAfter, enforceFinalTabstop, adjustWhitespace, clipboardText, overtypingCapturer, languageConfigurationService) {\n        const edits = [];\n        const snippets = [];\n        if (!editor.hasModel()) {\n            return { edits, snippets };\n        }\n        const model = editor.getModel();\n        const workspaceService = editor.invokeWithinContext(accessor => accessor.get(IWorkspaceContextService));\n        const modelBasedVariableResolver = editor.invokeWithinContext(accessor => new ModelBasedVariableResolver(accessor.get(ILabelService), model));\n        const readClipboardText = () => clipboardText;\n        // know what text the overwrite[Before|After] extensions\n        // of the primary curser have selected because only when\n        // secondary selections extend to the same text we can grow them\n        const firstBeforeText = model.getValueInRange(SnippetSession_1.adjustSelection(model, editor.getSelection(), overwriteBefore, 0));\n        const firstAfterText = model.getValueInRange(SnippetSession_1.adjustSelection(model, editor.getSelection(), 0, overwriteAfter));\n        // remember the first non-whitespace column to decide if\n        // `keepWhitespace` should be overruled for secondary selections\n        const firstLineFirstNonWhitespace = model.getLineFirstNonWhitespaceColumn(editor.getSelection().positionLineNumber);\n        // sort selections by their start position but remeber\n        // the original index. that allows you to create correct\n        // offset-based selection logic without changing the\n        // primary selection\n        const indexedSelections = editor.getSelections()\n            .map((selection, idx) => ({ selection, idx }))\n            .sort((a, b) => Range.compareRangesUsingStarts(a.selection, b.selection));\n        for (const { selection, idx } of indexedSelections) {\n            // extend selection with the `overwriteBefore` and `overwriteAfter` and then\n            // compare if this matches the extensions of the primary selection\n            let extensionBefore = SnippetSession_1.adjustSelection(model, selection, overwriteBefore, 0);\n            let extensionAfter = SnippetSession_1.adjustSelection(model, selection, 0, overwriteAfter);\n            if (firstBeforeText !== model.getValueInRange(extensionBefore)) {\n                extensionBefore = selection;\n            }\n            if (firstAfterText !== model.getValueInRange(extensionAfter)) {\n                extensionAfter = selection;\n            }\n            // merge the before and after selection into one\n            const snippetSelection = selection\n                .setStartPosition(extensionBefore.startLineNumber, extensionBefore.startColumn)\n                .setEndPosition(extensionAfter.endLineNumber, extensionAfter.endColumn);\n            const snippet = new SnippetParser().parse(template, true, enforceFinalTabstop);\n            // adjust the template string to match the indentation and\n            // whitespace rules of this insert location (can be different for each cursor)\n            // happens when being asked for (default) or when this is a secondary\n            // cursor and the leading whitespace is different\n            const start = snippetSelection.getStartPosition();\n            const snippetLineLeadingWhitespace = SnippetSession_1.adjustWhitespace(model, start, adjustWhitespace || (idx > 0 && firstLineFirstNonWhitespace !== model.getLineFirstNonWhitespaceColumn(selection.positionLineNumber)), snippet);\n            snippet.resolveVariables(new CompositeSnippetVariableResolver([\n                modelBasedVariableResolver,\n                new ClipboardBasedVariableResolver(readClipboardText, idx, indexedSelections.length, editor.getOption(79 /* EditorOption.multiCursorPaste */) === 'spread'),\n                new SelectionBasedVariableResolver(model, selection, idx, overtypingCapturer),\n                new CommentBasedVariableResolver(model, selection, languageConfigurationService),\n                new TimeBasedVariableResolver,\n                new WorkspaceBasedVariableResolver(workspaceService),\n                new RandomBasedVariableResolver,\n            ]));\n            // store snippets with the index of their originating selection.\n            // that ensures the primiary cursor stays primary despite not being\n            // the one with lowest start position\n            edits[idx] = EditOperation.replace(snippetSelection, snippet.toString());\n            edits[idx].identifier = { major: idx, minor: 0 }; // mark the edit so only our undo edits will be used to generate end cursors\n            edits[idx]._isTracked = true;\n            snippets[idx] = new OneSnippet(editor, snippet, snippetLineLeadingWhitespace);\n        }\n        return { edits, snippets };\n    }\n    static createEditsAndSnippetsFromEdits(editor, snippetEdits, enforceFinalTabstop, adjustWhitespace, clipboardText, overtypingCapturer, languageConfigurationService) {\n        if (!editor.hasModel() || snippetEdits.length === 0) {\n            return { edits: [], snippets: [] };\n        }\n        const edits = [];\n        const model = editor.getModel();\n        const parser = new SnippetParser();\n        const snippet = new TextmateSnippet();\n        // snippet variables resolver\n        const resolver = new CompositeSnippetVariableResolver([\n            editor.invokeWithinContext(accessor => new ModelBasedVariableResolver(accessor.get(ILabelService), model)),\n            new ClipboardBasedVariableResolver(() => clipboardText, 0, editor.getSelections().length, editor.getOption(79 /* EditorOption.multiCursorPaste */) === 'spread'),\n            new SelectionBasedVariableResolver(model, editor.getSelection(), 0, overtypingCapturer),\n            new CommentBasedVariableResolver(model, editor.getSelection(), languageConfigurationService),\n            new TimeBasedVariableResolver,\n            new WorkspaceBasedVariableResolver(editor.invokeWithinContext(accessor => accessor.get(IWorkspaceContextService))),\n            new RandomBasedVariableResolver,\n        ]);\n        //\n        snippetEdits = snippetEdits.sort((a, b) => Range.compareRangesUsingStarts(a.range, b.range));\n        let offset = 0;\n        for (let i = 0; i < snippetEdits.length; i++) {\n            const { range, template } = snippetEdits[i];\n            // gaps between snippet edits are appended as text nodes. this\n            // ensures placeholder-offsets are later correct\n            if (i > 0) {\n                const lastRange = snippetEdits[i - 1].range;\n                const textRange = Range.fromPositions(lastRange.getEndPosition(), range.getStartPosition());\n                const textNode = new Text(model.getValueInRange(textRange));\n                snippet.appendChild(textNode);\n                offset += textNode.value.length;\n            }\n            const newNodes = parser.parseFragment(template, snippet);\n            SnippetSession_1.adjustWhitespace(model, range.getStartPosition(), true, snippet, new Set(newNodes));\n            snippet.resolveVariables(resolver);\n            const snippetText = snippet.toString();\n            const snippetFragmentText = snippetText.slice(offset);\n            offset = snippetText.length;\n            // make edit\n            const edit = EditOperation.replace(range, snippetFragmentText);\n            edit.identifier = { major: i, minor: 0 }; // mark the edit so only our undo edits will be used to generate end cursors\n            edit._isTracked = true;\n            edits.push(edit);\n        }\n        //\n        parser.ensureFinalTabstop(snippet, enforceFinalTabstop, true);\n        return {\n            edits,\n            snippets: [new OneSnippet(editor, snippet, '')]\n        };\n    }\n    constructor(_editor, _template, _options = _defaultOptions, _languageConfigurationService) {\n        this._editor = _editor;\n        this._template = _template;\n        this._options = _options;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._templateMerges = [];\n        this._snippets = [];\n    }\n    dispose() {\n        dispose(this._snippets);\n    }\n    _logInfo() {\n        return `template=\"${this._template}\", merged_templates=\"${this._templateMerges.join(' -> ')}\"`;\n    }\n    insert() {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        // make insert edit and start with first selections\n        const { edits, snippets } = typeof this._template === 'string'\n            ? SnippetSession_1.createEditsAndSnippetsFromSelections(this._editor, this._template, this._options.overwriteBefore, this._options.overwriteAfter, false, this._options.adjustWhitespace, this._options.clipboardText, this._options.overtypingCapturer, this._languageConfigurationService)\n            : SnippetSession_1.createEditsAndSnippetsFromEdits(this._editor, this._template, false, this._options.adjustWhitespace, this._options.clipboardText, this._options.overtypingCapturer, this._languageConfigurationService);\n        this._snippets = snippets;\n        this._editor.executeEdits('snippet', edits, _undoEdits => {\n            // Sometimes, the text buffer will remove automatic whitespace when doing any edits,\n            // so we need to look only at the undo edits relevant for us.\n            // Our edits have an identifier set so that's how we can distinguish them\n            const undoEdits = _undoEdits.filter(edit => !!edit.identifier);\n            for (let idx = 0; idx < snippets.length; idx++) {\n                snippets[idx].initialize(undoEdits[idx].textChange);\n            }\n            if (this._snippets[0].hasPlaceholder) {\n                return this._move(true);\n            }\n            else {\n                return undoEdits\n                    .map(edit => Selection.fromPositions(edit.range.getEndPosition()));\n            }\n        });\n        this._editor.revealRange(this._editor.getSelections()[0]);\n    }\n    merge(template, options = _defaultOptions) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        this._templateMerges.push([this._snippets[0]._nestingLevel, this._snippets[0]._placeholderGroupsIdx, template]);\n        const { edits, snippets } = SnippetSession_1.createEditsAndSnippetsFromSelections(this._editor, template, options.overwriteBefore, options.overwriteAfter, true, options.adjustWhitespace, options.clipboardText, options.overtypingCapturer, this._languageConfigurationService);\n        this._editor.executeEdits('snippet', edits, _undoEdits => {\n            // Sometimes, the text buffer will remove automatic whitespace when doing any edits,\n            // so we need to look only at the undo edits relevant for us.\n            // Our edits have an identifier set so that's how we can distinguish them\n            const undoEdits = _undoEdits.filter(edit => !!edit.identifier);\n            for (let idx = 0; idx < snippets.length; idx++) {\n                snippets[idx].initialize(undoEdits[idx].textChange);\n            }\n            // Trivial snippets have no placeholder or are just the final placeholder. That means they\n            // are just text insertions and we don't need to merge the nested snippet into the existing\n            // snippet\n            const isTrivialSnippet = snippets[0].isTrivialSnippet;\n            if (!isTrivialSnippet) {\n                for (const snippet of this._snippets) {\n                    snippet.merge(snippets);\n                }\n                console.assert(snippets.length === 0);\n            }\n            if (this._snippets[0].hasPlaceholder && !isTrivialSnippet) {\n                return this._move(undefined);\n            }\n            else {\n                return undoEdits.map(edit => Selection.fromPositions(edit.range.getEndPosition()));\n            }\n        });\n    }\n    next() {\n        const newSelections = this._move(true);\n        this._editor.setSelections(newSelections);\n        this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition());\n    }\n    prev() {\n        const newSelections = this._move(false);\n        this._editor.setSelections(newSelections);\n        this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition());\n    }\n    _move(fwd) {\n        const selections = [];\n        for (const snippet of this._snippets) {\n            const oneSelection = snippet.move(fwd);\n            selections.push(...oneSelection);\n        }\n        return selections;\n    }\n    get isAtFirstPlaceholder() {\n        return this._snippets[0].isAtFirstPlaceholder;\n    }\n    get isAtLastPlaceholder() {\n        return this._snippets[0].isAtLastPlaceholder;\n    }\n    get hasPlaceholder() {\n        return this._snippets[0].hasPlaceholder;\n    }\n    get hasChoice() {\n        return this._snippets[0].hasChoice;\n    }\n    get activeChoice() {\n        return this._snippets[0].activeChoice;\n    }\n    isSelectionWithinPlaceholders() {\n        if (!this.hasPlaceholder) {\n            return false;\n        }\n        const selections = this._editor.getSelections();\n        if (selections.length < this._snippets.length) {\n            // this means we started snippet mode with N\n            // selections and have M (N > M) selections.\n            // So one snippet is without selection -> cancel\n            return false;\n        }\n        const allPossibleSelections = new Map();\n        for (const snippet of this._snippets) {\n            const possibleSelections = snippet.computePossibleSelections();\n            // for the first snippet find the placeholder (and its ranges)\n            // that contain at least one selection. for all remaining snippets\n            // the same placeholder (and their ranges) must be used.\n            if (allPossibleSelections.size === 0) {\n                for (const [index, ranges] of possibleSelections) {\n                    ranges.sort(Range.compareRangesUsingStarts);\n                    for (const selection of selections) {\n                        if (ranges[0].containsRange(selection)) {\n                            allPossibleSelections.set(index, []);\n                            break;\n                        }\n                    }\n                }\n            }\n            if (allPossibleSelections.size === 0) {\n                // return false if we couldn't associate a selection to\n                // this (the first) snippet\n                return false;\n            }\n            // add selections from 'this' snippet so that we know all\n            // selections for this placeholder\n            allPossibleSelections.forEach((array, index) => {\n                array.push(...possibleSelections.get(index));\n            });\n        }\n        // sort selections (and later placeholder-ranges). then walk both\n        // arrays and make sure the placeholder-ranges contain the corresponding\n        // selection\n        selections.sort(Range.compareRangesUsingStarts);\n        for (const [index, ranges] of allPossibleSelections) {\n            if (ranges.length !== selections.length) {\n                allPossibleSelections.delete(index);\n                continue;\n            }\n            ranges.sort(Range.compareRangesUsingStarts);\n            for (let i = 0; i < ranges.length; i++) {\n                if (!ranges[i].containsRange(selections[i])) {\n                    allPossibleSelections.delete(index);\n                    continue;\n                }\n            }\n        }\n        // from all possible selections we have deleted those\n        // that don't match with the current selection. if we don't\n        // have any left, we don't have a selection anymore\n        return allPossibleSelections.size > 0;\n    }\n};\nSnippetSession = SnippetSession_1 = __decorate([\n    __param(3, ILanguageConfigurationService)\n], SnippetSession);\nexport { SnippetSession };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SnippetController2_1;\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { EditorCommand, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { showSimpleSuggestions } from '../../suggest/browser/suggest.js';\nimport { localize } from '../../../../nls.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { SnippetSession } from './snippetSession.js';\nconst _defaultOptions = {\n    overwriteBefore: 0,\n    overwriteAfter: 0,\n    undoStopBefore: true,\n    undoStopAfter: true,\n    adjustWhitespace: true,\n    clipboardText: undefined,\n    overtypingCapturer: undefined\n};\nlet SnippetController2 = class SnippetController2 {\n    static { SnippetController2_1 = this; }\n    static { this.ID = 'snippetController2'; }\n    static get(editor) {\n        return editor.getContribution(SnippetController2_1.ID);\n    }\n    static { this.InSnippetMode = new RawContextKey('inSnippetMode', false, localize('inSnippetMode', \"Whether the editor in current in snippet mode\")); }\n    static { this.HasNextTabstop = new RawContextKey('hasNextTabstop', false, localize('hasNextTabstop', \"Whether there is a next tab stop when in snippet mode\")); }\n    static { this.HasPrevTabstop = new RawContextKey('hasPrevTabstop', false, localize('hasPrevTabstop', \"Whether there is a previous tab stop when in snippet mode\")); }\n    constructor(_editor, _logService, _languageFeaturesService, contextKeyService, _languageConfigurationService) {\n        this._editor = _editor;\n        this._logService = _logService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._snippetListener = new DisposableStore();\n        this._modelVersionId = -1;\n        this._inSnippet = SnippetController2_1.InSnippetMode.bindTo(contextKeyService);\n        this._hasNextTabstop = SnippetController2_1.HasNextTabstop.bindTo(contextKeyService);\n        this._hasPrevTabstop = SnippetController2_1.HasPrevTabstop.bindTo(contextKeyService);\n    }\n    dispose() {\n        this._inSnippet.reset();\n        this._hasPrevTabstop.reset();\n        this._hasNextTabstop.reset();\n        this._session?.dispose();\n        this._snippetListener.dispose();\n    }\n    insert(template, opts) {\n        // this is here to find out more about the yet-not-understood\n        // error that sometimes happens when we fail to inserted a nested\n        // snippet\n        try {\n            this._doInsert(template, typeof opts === 'undefined' ? _defaultOptions : { ..._defaultOptions, ...opts });\n        }\n        catch (e) {\n            this.cancel();\n            this._logService.error(e);\n            this._logService.error('snippet_error');\n            this._logService.error('insert_template=', template);\n            this._logService.error('existing_template=', this._session ? this._session._logInfo() : '<no_session>');\n        }\n    }\n    _doInsert(template, opts) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        // don't listen while inserting the snippet\n        // as that is the inflight state causing cancelation\n        this._snippetListener.clear();\n        if (opts.undoStopBefore) {\n            this._editor.getModel().pushStackElement();\n        }\n        // don't merge\n        if (this._session && typeof template !== 'string') {\n            this.cancel();\n        }\n        if (!this._session) {\n            this._modelVersionId = this._editor.getModel().getAlternativeVersionId();\n            this._session = new SnippetSession(this._editor, template, opts, this._languageConfigurationService);\n            this._session.insert();\n        }\n        else {\n            assertType(typeof template === 'string');\n            this._session.merge(template, opts);\n        }\n        if (opts.undoStopAfter) {\n            this._editor.getModel().pushStackElement();\n        }\n        // regster completion item provider when there is any choice element\n        if (this._session?.hasChoice) {\n            const provider = {\n                _debugDisplayName: 'snippetChoiceCompletions',\n                provideCompletionItems: (model, position) => {\n                    if (!this._session || model !== this._editor.getModel() || !Position.equals(this._editor.getPosition(), position)) {\n                        return undefined;\n                    }\n                    const { activeChoice } = this._session;\n                    if (!activeChoice || activeChoice.choice.options.length === 0) {\n                        return undefined;\n                    }\n                    const word = model.getValueInRange(activeChoice.range);\n                    const isAnyOfOptions = Boolean(activeChoice.choice.options.find(o => o.value === word));\n                    const suggestions = [];\n                    for (let i = 0; i < activeChoice.choice.options.length; i++) {\n                        const option = activeChoice.choice.options[i];\n                        suggestions.push({\n                            kind: 13 /* CompletionItemKind.Value */,\n                            label: option.value,\n                            insertText: option.value,\n                            sortText: 'a'.repeat(i + 1),\n                            range: activeChoice.range,\n                            filterText: isAnyOfOptions ? `${word}_${option.value}` : undefined,\n                            command: { id: 'jumpToNextSnippetPlaceholder', title: localize('next', 'Go to next placeholder...') }\n                        });\n                    }\n                    return { suggestions };\n                }\n            };\n            const model = this._editor.getModel();\n            let registration;\n            let isRegistered = false;\n            const disable = () => {\n                registration?.dispose();\n                isRegistered = false;\n            };\n            const enable = () => {\n                if (!isRegistered) {\n                    registration = this._languageFeaturesService.completionProvider.register({\n                        language: model.getLanguageId(),\n                        pattern: model.uri.fsPath,\n                        scheme: model.uri.scheme,\n                        exclusive: true\n                    }, provider);\n                    this._snippetListener.add(registration);\n                    isRegistered = true;\n                }\n            };\n            this._choiceCompletions = { provider, enable, disable };\n        }\n        this._updateState();\n        this._snippetListener.add(this._editor.onDidChangeModelContent(e => e.isFlush && this.cancel()));\n        this._snippetListener.add(this._editor.onDidChangeModel(() => this.cancel()));\n        this._snippetListener.add(this._editor.onDidChangeCursorSelection(() => this._updateState()));\n    }\n    _updateState() {\n        if (!this._session || !this._editor.hasModel()) {\n            // canceled in the meanwhile\n            return;\n        }\n        if (this._modelVersionId === this._editor.getModel().getAlternativeVersionId()) {\n            // undo until the 'before' state happened\n            // and makes use cancel snippet mode\n            return this.cancel();\n        }\n        if (!this._session.hasPlaceholder) {\n            // don't listen for selection changes and don't\n            // update context keys when the snippet is plain text\n            return this.cancel();\n        }\n        if (this._session.isAtLastPlaceholder || !this._session.isSelectionWithinPlaceholders()) {\n            this._editor.getModel().pushStackElement();\n            return this.cancel();\n        }\n        this._inSnippet.set(true);\n        this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder);\n        this._hasNextTabstop.set(!this._session.isAtLastPlaceholder);\n        this._handleChoice();\n    }\n    _handleChoice() {\n        if (!this._session || !this._editor.hasModel()) {\n            this._currentChoice = undefined;\n            return;\n        }\n        const { activeChoice } = this._session;\n        if (!activeChoice || !this._choiceCompletions) {\n            this._choiceCompletions?.disable();\n            this._currentChoice = undefined;\n            return;\n        }\n        if (this._currentChoice !== activeChoice.choice) {\n            this._currentChoice = activeChoice.choice;\n            this._choiceCompletions.enable();\n            // trigger suggest with the special choice completion provider\n            queueMicrotask(() => {\n                showSimpleSuggestions(this._editor, this._choiceCompletions.provider);\n            });\n        }\n    }\n    finish() {\n        while (this._inSnippet.get()) {\n            this.next();\n        }\n    }\n    cancel(resetSelection = false) {\n        this._inSnippet.reset();\n        this._hasPrevTabstop.reset();\n        this._hasNextTabstop.reset();\n        this._snippetListener.clear();\n        this._currentChoice = undefined;\n        this._session?.dispose();\n        this._session = undefined;\n        this._modelVersionId = -1;\n        if (resetSelection) {\n            // reset selection to the primary cursor when being asked\n            // for. this happens when explicitly cancelling snippet mode,\n            // e.g. when pressing ESC\n            this._editor.setSelections([this._editor.getSelection()]);\n        }\n    }\n    prev() {\n        this._session?.prev();\n        this._updateState();\n    }\n    next() {\n        this._session?.next();\n        this._updateState();\n    }\n    isInSnippet() {\n        return Boolean(this._inSnippet.get());\n    }\n};\nSnippetController2 = SnippetController2_1 = __decorate([\n    __param(1, ILogService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, IContextKeyService),\n    __param(4, ILanguageConfigurationService)\n], SnippetController2);\nexport { SnippetController2 };\nregisterEditorContribution(SnippetController2.ID, SnippetController2, 4 /* EditorContributionInstantiation.Lazy */);\nconst CommandCtor = EditorCommand.bindToContribution(SnippetController2.get);\nregisterEditorCommand(new CommandCtor({\n    id: 'jumpToNextSnippetPlaceholder',\n    precondition: ContextKeyExpr.and(SnippetController2.InSnippetMode, SnippetController2.HasNextTabstop),\n    handler: ctrl => ctrl.next(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new CommandCtor({\n    id: 'jumpToPrevSnippetPlaceholder',\n    precondition: ContextKeyExpr.and(SnippetController2.InSnippetMode, SnippetController2.HasPrevTabstop),\n    handler: ctrl => ctrl.prev(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new CommandCtor({\n    id: 'leaveSnippet',\n    precondition: SnippetController2.InSnippetMode,\n    handler: ctrl => ctrl.cancel(true),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new CommandCtor({\n    id: 'acceptSnippet',\n    precondition: SnippetController2.InSnippetMode,\n    handler: ctrl => ctrl.finish(),\n    // kbOpts: {\n    // \tweight: KeybindingWeight.EditorContrib + 30,\n    // \tkbExpr: EditorContextKeys.textFocus,\n    // \tprimary: KeyCode.Enter,\n    // }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { compareBy, Permutation } from '../../../../../base/common/arrays.js';\nimport { mapFindFirst } from '../../../../../base/common/arraysFind.js';\nimport { itemsEquals } from '../../../../../base/common/equals.js';\nimport { BugIndicatingError, onUnexpectedError, onUnexpectedExternalError } from '../../../../../base/common/errors.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { autorun, derived, derivedHandleChanges, derivedOpts, observableSignal, observableValue, recomputeInitiallyAndOnChange, subtransaction, transaction } from '../../../../../base/common/observable.js';\nimport { commonPrefixLength, splitLinesIncludeSeparators } from '../../../../../base/common/strings.js';\nimport { isDefined } from '../../../../../base/common/types.js';\nimport { EditOperation } from '../../../../common/core/editOperation.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { Selection } from '../../../../common/core/selection.js';\nimport { SingleTextEdit, TextEdit } from '../../../../common/core/textEdit.js';\nimport { TextLength } from '../../../../common/core/textLength.js';\nimport { InlineCompletionTriggerKind } from '../../../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { GhostText, ghostTextOrReplacementEquals, ghostTextsOrReplacementsEqual } from './ghostText.js';\nimport { InlineCompletionsSource } from './inlineCompletionsSource.js';\nimport { computeGhostText, singleTextEditAugments, singleTextRemoveCommonPrefix } from './singleTextEdit.js';\nimport { addPositions, subtractPositions } from '../utils.js';\nimport { SnippetController2 } from '../../../snippet/browser/snippetController2.js';\nimport { ICommandService } from '../../../../../platform/commands/common/commands.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nlet InlineCompletionsModel = class InlineCompletionsModel extends Disposable {\n    get isAcceptingPartially() { return this._isAcceptingPartially; }\n    constructor(textModel, selectedSuggestItem, _textModelVersionId, _positions, _debounceValue, _suggestPreviewEnabled, _suggestPreviewMode, _inlineSuggestMode, _enabled, _instantiationService, _commandService, _languageConfigurationService) {\n        super();\n        this.textModel = textModel;\n        this.selectedSuggestItem = selectedSuggestItem;\n        this._textModelVersionId = _textModelVersionId;\n        this._positions = _positions;\n        this._debounceValue = _debounceValue;\n        this._suggestPreviewEnabled = _suggestPreviewEnabled;\n        this._suggestPreviewMode = _suggestPreviewMode;\n        this._inlineSuggestMode = _inlineSuggestMode;\n        this._enabled = _enabled;\n        this._instantiationService = _instantiationService;\n        this._commandService = _commandService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._source = this._register(this._instantiationService.createInstance(InlineCompletionsSource, this.textModel, this._textModelVersionId, this._debounceValue));\n        this._isActive = observableValue(this, false);\n        this._forceUpdateExplicitlySignal = observableSignal(this);\n        // We use a semantic id to keep the same inline completion selected even if the provider reorders the completions.\n        this._selectedInlineCompletionId = observableValue(this, undefined);\n        this._primaryPosition = derived(this, reader => this._positions.read(reader)[0] ?? new Position(1, 1));\n        this._isAcceptingPartially = false;\n        this._preserveCurrentCompletionReasons = new Set([\n            VersionIdChangeReason.Redo,\n            VersionIdChangeReason.Undo,\n            VersionIdChangeReason.AcceptWord,\n        ]);\n        this._fetchInlineCompletionsPromise = derivedHandleChanges({\n            owner: this,\n            createEmptyChangeSummary: () => ({\n                preserveCurrentCompletion: false,\n                inlineCompletionTriggerKind: InlineCompletionTriggerKind.Automatic\n            }),\n            handleChange: (ctx, changeSummary) => {\n                /** @description fetch inline completions */\n                if (ctx.didChange(this._textModelVersionId) && this._preserveCurrentCompletionReasons.has(this._getReason(ctx.change))) {\n                    changeSummary.preserveCurrentCompletion = true;\n                }\n                else if (ctx.didChange(this._forceUpdateExplicitlySignal)) {\n                    changeSummary.inlineCompletionTriggerKind = InlineCompletionTriggerKind.Explicit;\n                }\n                return true;\n            },\n        }, (reader, changeSummary) => {\n            this._forceUpdateExplicitlySignal.read(reader);\n            const shouldUpdate = (this._enabled.read(reader) && this.selectedSuggestItem.read(reader)) || this._isActive.read(reader);\n            if (!shouldUpdate) {\n                this._source.cancelUpdate();\n                return undefined;\n            }\n            this._textModelVersionId.read(reader); // Refetch on text change\n            const suggestWidgetInlineCompletions = this._source.suggestWidgetInlineCompletions.get();\n            const suggestItem = this.selectedSuggestItem.read(reader);\n            if (suggestWidgetInlineCompletions && !suggestItem) {\n                const inlineCompletions = this._source.inlineCompletions.get();\n                transaction(tx => {\n                    /** @description Seed inline completions with (newer) suggest widget inline completions */\n                    if (!inlineCompletions || suggestWidgetInlineCompletions.request.versionId > inlineCompletions.request.versionId) {\n                        this._source.inlineCompletions.set(suggestWidgetInlineCompletions.clone(), tx);\n                    }\n                    this._source.clearSuggestWidgetInlineCompletions(tx);\n                });\n            }\n            const cursorPosition = this._primaryPosition.read(reader);\n            const context = {\n                triggerKind: changeSummary.inlineCompletionTriggerKind,\n                selectedSuggestionInfo: suggestItem?.toSelectedSuggestionInfo(),\n            };\n            const itemToPreserveCandidate = this.selectedInlineCompletion.get();\n            const itemToPreserve = changeSummary.preserveCurrentCompletion || itemToPreserveCandidate?.forwardStable\n                ? itemToPreserveCandidate : undefined;\n            return this._source.fetch(cursorPosition, context, itemToPreserve);\n        });\n        this._filteredInlineCompletionItems = derivedOpts({ owner: this, equalsFn: itemsEquals() }, reader => {\n            const c = this._source.inlineCompletions.read(reader);\n            if (!c) {\n                return [];\n            }\n            const cursorPosition = this._primaryPosition.read(reader);\n            const filteredCompletions = c.inlineCompletions.filter(c => c.isVisible(this.textModel, cursorPosition, reader));\n            return filteredCompletions;\n        });\n        this.selectedInlineCompletionIndex = derived(this, (reader) => {\n            const selectedInlineCompletionId = this._selectedInlineCompletionId.read(reader);\n            const filteredCompletions = this._filteredInlineCompletionItems.read(reader);\n            const idx = this._selectedInlineCompletionId === undefined ? -1\n                : filteredCompletions.findIndex(v => v.semanticId === selectedInlineCompletionId);\n            if (idx === -1) {\n                // Reset the selection so that the selection does not jump back when it appears again\n                this._selectedInlineCompletionId.set(undefined, undefined);\n                return 0;\n            }\n            return idx;\n        });\n        this.selectedInlineCompletion = derived(this, (reader) => {\n            const filteredCompletions = this._filteredInlineCompletionItems.read(reader);\n            const idx = this.selectedInlineCompletionIndex.read(reader);\n            return filteredCompletions[idx];\n        });\n        this.activeCommands = derivedOpts({ owner: this, equalsFn: itemsEquals() }, r => this.selectedInlineCompletion.read(r)?.inlineCompletion.source.inlineCompletions.commands ?? []);\n        this.lastTriggerKind = this._source.inlineCompletions.map(this, v => v?.request.context.triggerKind);\n        this.inlineCompletionsCount = derived(this, reader => {\n            if (this.lastTriggerKind.read(reader) === InlineCompletionTriggerKind.Explicit) {\n                return this._filteredInlineCompletionItems.read(reader).length;\n            }\n            else {\n                return undefined;\n            }\n        });\n        this.state = derivedOpts({\n            owner: this,\n            equalsFn: (a, b) => {\n                if (!a || !b) {\n                    return a === b;\n                }\n                return ghostTextsOrReplacementsEqual(a.ghostTexts, b.ghostTexts)\n                    && a.inlineCompletion === b.inlineCompletion\n                    && a.suggestItem === b.suggestItem;\n            }\n        }, (reader) => {\n            const model = this.textModel;\n            const suggestItem = this.selectedSuggestItem.read(reader);\n            if (suggestItem) {\n                const suggestCompletionEdit = singleTextRemoveCommonPrefix(suggestItem.toSingleTextEdit(), model);\n                const augmentation = this._computeAugmentation(suggestCompletionEdit, reader);\n                const isSuggestionPreviewEnabled = this._suggestPreviewEnabled.read(reader);\n                if (!isSuggestionPreviewEnabled && !augmentation) {\n                    return undefined;\n                }\n                const fullEdit = augmentation?.edit ?? suggestCompletionEdit;\n                const fullEditPreviewLength = augmentation ? augmentation.edit.text.length - suggestCompletionEdit.text.length : 0;\n                const mode = this._suggestPreviewMode.read(reader);\n                const positions = this._positions.read(reader);\n                const edits = [fullEdit, ...getSecondaryEdits(this.textModel, positions, fullEdit)];\n                const ghostTexts = edits\n                    .map((edit, idx) => computeGhostText(edit, model, mode, positions[idx], fullEditPreviewLength))\n                    .filter(isDefined);\n                const primaryGhostText = ghostTexts[0] ?? new GhostText(fullEdit.range.endLineNumber, []);\n                return { edits, primaryGhostText, ghostTexts, inlineCompletion: augmentation?.completion, suggestItem };\n            }\n            else {\n                if (!this._isActive.read(reader)) {\n                    return undefined;\n                }\n                const inlineCompletion = this.selectedInlineCompletion.read(reader);\n                if (!inlineCompletion) {\n                    return undefined;\n                }\n                const replacement = inlineCompletion.toSingleTextEdit(reader);\n                const mode = this._inlineSuggestMode.read(reader);\n                const positions = this._positions.read(reader);\n                const edits = [replacement, ...getSecondaryEdits(this.textModel, positions, replacement)];\n                const ghostTexts = edits\n                    .map((edit, idx) => computeGhostText(edit, model, mode, positions[idx], 0))\n                    .filter(isDefined);\n                if (!ghostTexts[0]) {\n                    return undefined;\n                }\n                return { edits, primaryGhostText: ghostTexts[0], ghostTexts, inlineCompletion, suggestItem: undefined };\n            }\n        });\n        this.ghostTexts = derivedOpts({ owner: this, equalsFn: ghostTextsOrReplacementsEqual }, reader => {\n            const v = this.state.read(reader);\n            if (!v) {\n                return undefined;\n            }\n            return v.ghostTexts;\n        });\n        this.primaryGhostText = derivedOpts({ owner: this, equalsFn: ghostTextOrReplacementEquals }, reader => {\n            const v = this.state.read(reader);\n            if (!v) {\n                return undefined;\n            }\n            return v?.primaryGhostText;\n        });\n        this._register(recomputeInitiallyAndOnChange(this._fetchInlineCompletionsPromise));\n        let lastItem = undefined;\n        this._register(autorun(reader => {\n            /** @description call handleItemDidShow */\n            const item = this.state.read(reader);\n            const completion = item?.inlineCompletion;\n            if (completion?.semanticId !== lastItem?.semanticId) {\n                lastItem = completion;\n                if (completion) {\n                    const i = completion.inlineCompletion;\n                    const src = i.source;\n                    src.provider.handleItemDidShow?.(src.inlineCompletions, i.sourceInlineCompletion, i.insertText);\n                }\n            }\n        }));\n    }\n    _getReason(e) {\n        if (e?.isUndoing) {\n            return VersionIdChangeReason.Undo;\n        }\n        if (e?.isRedoing) {\n            return VersionIdChangeReason.Redo;\n        }\n        if (this.isAcceptingPartially) {\n            return VersionIdChangeReason.AcceptWord;\n        }\n        return VersionIdChangeReason.Other;\n    }\n    async trigger(tx) {\n        this._isActive.set(true, tx);\n        await this._fetchInlineCompletionsPromise.get();\n    }\n    async triggerExplicitly(tx) {\n        subtransaction(tx, tx => {\n            this._isActive.set(true, tx);\n            this._forceUpdateExplicitlySignal.trigger(tx);\n        });\n        await this._fetchInlineCompletionsPromise.get();\n    }\n    stop(tx) {\n        subtransaction(tx, tx => {\n            this._isActive.set(false, tx);\n            this._source.clear(tx);\n        });\n    }\n    _computeAugmentation(suggestCompletion, reader) {\n        const model = this.textModel;\n        const suggestWidgetInlineCompletions = this._source.suggestWidgetInlineCompletions.read(reader);\n        const candidateInlineCompletions = suggestWidgetInlineCompletions\n            ? suggestWidgetInlineCompletions.inlineCompletions\n            : [this.selectedInlineCompletion.read(reader)].filter(isDefined);\n        const augmentedCompletion = mapFindFirst(candidateInlineCompletions, completion => {\n            let r = completion.toSingleTextEdit(reader);\n            r = singleTextRemoveCommonPrefix(r, model, Range.fromPositions(r.range.getStartPosition(), suggestCompletion.range.getEndPosition()));\n            return singleTextEditAugments(r, suggestCompletion) ? { completion, edit: r } : undefined;\n        });\n        return augmentedCompletion;\n    }\n    async _deltaSelectedInlineCompletionIndex(delta) {\n        await this.triggerExplicitly();\n        const completions = this._filteredInlineCompletionItems.get() || [];\n        if (completions.length > 0) {\n            const newIdx = (this.selectedInlineCompletionIndex.get() + delta + completions.length) % completions.length;\n            this._selectedInlineCompletionId.set(completions[newIdx].semanticId, undefined);\n        }\n        else {\n            this._selectedInlineCompletionId.set(undefined, undefined);\n        }\n    }\n    async next() {\n        await this._deltaSelectedInlineCompletionIndex(1);\n    }\n    async previous() {\n        await this._deltaSelectedInlineCompletionIndex(-1);\n    }\n    async accept(editor) {\n        if (editor.getModel() !== this.textModel) {\n            throw new BugIndicatingError();\n        }\n        const state = this.state.get();\n        if (!state || state.primaryGhostText.isEmpty() || !state.inlineCompletion) {\n            return;\n        }\n        const completion = state.inlineCompletion.toInlineCompletion(undefined);\n        if (completion.command) {\n            // Make sure the completion list will not be disposed.\n            completion.source.addRef();\n        }\n        editor.pushUndoStop();\n        if (completion.snippetInfo) {\n            editor.executeEdits('inlineSuggestion.accept', [\n                EditOperation.replace(completion.range, ''),\n                ...completion.additionalTextEdits\n            ]);\n            editor.setPosition(completion.snippetInfo.range.getStartPosition(), 'inlineCompletionAccept');\n            SnippetController2.get(editor)?.insert(completion.snippetInfo.snippet, { undoStopBefore: false });\n        }\n        else {\n            const edits = state.edits;\n            const selections = getEndPositionsAfterApplying(edits).map(p => Selection.fromPositions(p));\n            editor.executeEdits('inlineSuggestion.accept', [\n                ...edits.map(edit => EditOperation.replace(edit.range, edit.text)),\n                ...completion.additionalTextEdits\n            ]);\n            editor.setSelections(selections, 'inlineCompletionAccept');\n        }\n        // Reset before invoking the command, as the command might cause a follow up trigger (which we don't want to reset).\n        this.stop();\n        if (completion.command) {\n            await this._commandService\n                .executeCommand(completion.command.id, ...(completion.command.arguments || []))\n                .then(undefined, onUnexpectedExternalError);\n            completion.source.removeRef();\n        }\n    }\n    async acceptNextWord(editor) {\n        await this._acceptNext(editor, (pos, text) => {\n            const langId = this.textModel.getLanguageIdAtPosition(pos.lineNumber, pos.column);\n            const config = this._languageConfigurationService.getLanguageConfiguration(langId);\n            const wordRegExp = new RegExp(config.wordDefinition.source, config.wordDefinition.flags.replace('g', ''));\n            const m1 = text.match(wordRegExp);\n            let acceptUntilIndexExclusive = 0;\n            if (m1 && m1.index !== undefined) {\n                if (m1.index === 0) {\n                    acceptUntilIndexExclusive = m1[0].length;\n                }\n                else {\n                    acceptUntilIndexExclusive = m1.index;\n                }\n            }\n            else {\n                acceptUntilIndexExclusive = text.length;\n            }\n            const wsRegExp = /\\s+/g;\n            const m2 = wsRegExp.exec(text);\n            if (m2 && m2.index !== undefined) {\n                if (m2.index + m2[0].length < acceptUntilIndexExclusive) {\n                    acceptUntilIndexExclusive = m2.index + m2[0].length;\n                }\n            }\n            return acceptUntilIndexExclusive;\n        }, 0 /* PartialAcceptTriggerKind.Word */);\n    }\n    async acceptNextLine(editor) {\n        await this._acceptNext(editor, (pos, text) => {\n            const m = text.match(/\\n/);\n            if (m && m.index !== undefined) {\n                return m.index + 1;\n            }\n            return text.length;\n        }, 1 /* PartialAcceptTriggerKind.Line */);\n    }\n    async _acceptNext(editor, getAcceptUntilIndex, kind) {\n        if (editor.getModel() !== this.textModel) {\n            throw new BugIndicatingError();\n        }\n        const state = this.state.get();\n        if (!state || state.primaryGhostText.isEmpty() || !state.inlineCompletion) {\n            return;\n        }\n        const ghostText = state.primaryGhostText;\n        const completion = state.inlineCompletion.toInlineCompletion(undefined);\n        if (completion.snippetInfo || completion.filterText !== completion.insertText) {\n            // not in WYSIWYG mode, partial commit might change completion, thus it is not supported\n            await this.accept(editor);\n            return;\n        }\n        const firstPart = ghostText.parts[0];\n        const ghostTextPos = new Position(ghostText.lineNumber, firstPart.column);\n        const ghostTextVal = firstPart.text;\n        const acceptUntilIndexExclusive = getAcceptUntilIndex(ghostTextPos, ghostTextVal);\n        if (acceptUntilIndexExclusive === ghostTextVal.length && ghostText.parts.length === 1) {\n            this.accept(editor);\n            return;\n        }\n        const partialGhostTextVal = ghostTextVal.substring(0, acceptUntilIndexExclusive);\n        const positions = this._positions.get();\n        const cursorPosition = positions[0];\n        // Executing the edit might free the completion, so we have to hold a reference on it.\n        completion.source.addRef();\n        try {\n            this._isAcceptingPartially = true;\n            try {\n                editor.pushUndoStop();\n                const replaceRange = Range.fromPositions(cursorPosition, ghostTextPos);\n                const newText = editor.getModel().getValueInRange(replaceRange) + partialGhostTextVal;\n                const primaryEdit = new SingleTextEdit(replaceRange, newText);\n                const edits = [primaryEdit, ...getSecondaryEdits(this.textModel, positions, primaryEdit)];\n                const selections = getEndPositionsAfterApplying(edits).map(p => Selection.fromPositions(p));\n                editor.executeEdits('inlineSuggestion.accept', edits.map(edit => EditOperation.replace(edit.range, edit.text)));\n                editor.setSelections(selections, 'inlineCompletionPartialAccept');\n                editor.revealPositionInCenterIfOutsideViewport(editor.getPosition(), 1 /* ScrollType.Immediate */);\n            }\n            finally {\n                this._isAcceptingPartially = false;\n            }\n            if (completion.source.provider.handlePartialAccept) {\n                const acceptedRange = Range.fromPositions(completion.range.getStartPosition(), TextLength.ofText(partialGhostTextVal).addToPosition(ghostTextPos));\n                // This assumes that the inline completion and the model use the same EOL style.\n                const text = editor.getModel().getValueInRange(acceptedRange, 1 /* EndOfLinePreference.LF */);\n                completion.source.provider.handlePartialAccept(completion.source.inlineCompletions, completion.sourceInlineCompletion, text.length, { kind, });\n            }\n        }\n        finally {\n            completion.source.removeRef();\n        }\n    }\n    handleSuggestAccepted(item) {\n        const itemEdit = singleTextRemoveCommonPrefix(item.toSingleTextEdit(), this.textModel);\n        const augmentedCompletion = this._computeAugmentation(itemEdit, undefined);\n        if (!augmentedCompletion) {\n            return;\n        }\n        const inlineCompletion = augmentedCompletion.completion.inlineCompletion;\n        inlineCompletion.source.provider.handlePartialAccept?.(inlineCompletion.source.inlineCompletions, inlineCompletion.sourceInlineCompletion, itemEdit.text.length, {\n            kind: 2 /* PartialAcceptTriggerKind.Suggest */,\n        });\n    }\n};\nInlineCompletionsModel = __decorate([\n    __param(9, IInstantiationService),\n    __param(10, ICommandService),\n    __param(11, ILanguageConfigurationService)\n], InlineCompletionsModel);\nexport { InlineCompletionsModel };\nexport var VersionIdChangeReason;\n(function (VersionIdChangeReason) {\n    VersionIdChangeReason[VersionIdChangeReason[\"Undo\"] = 0] = \"Undo\";\n    VersionIdChangeReason[VersionIdChangeReason[\"Redo\"] = 1] = \"Redo\";\n    VersionIdChangeReason[VersionIdChangeReason[\"AcceptWord\"] = 2] = \"AcceptWord\";\n    VersionIdChangeReason[VersionIdChangeReason[\"Other\"] = 3] = \"Other\";\n})(VersionIdChangeReason || (VersionIdChangeReason = {}));\nexport function getSecondaryEdits(textModel, positions, primaryEdit) {\n    if (positions.length === 1) {\n        // No secondary cursor positions\n        return [];\n    }\n    const primaryPosition = positions[0];\n    const secondaryPositions = positions.slice(1);\n    const primaryEditStartPosition = primaryEdit.range.getStartPosition();\n    const primaryEditEndPosition = primaryEdit.range.getEndPosition();\n    const replacedTextAfterPrimaryCursor = textModel.getValueInRange(Range.fromPositions(primaryPosition, primaryEditEndPosition));\n    const positionWithinTextEdit = subtractPositions(primaryPosition, primaryEditStartPosition);\n    if (positionWithinTextEdit.lineNumber < 1) {\n        onUnexpectedError(new BugIndicatingError(`positionWithinTextEdit line number should be bigger than 0.\n\t\t\tInvalid subtraction between ${primaryPosition.toString()} and ${primaryEditStartPosition.toString()}`));\n        return [];\n    }\n    const secondaryEditText = substringPos(primaryEdit.text, positionWithinTextEdit);\n    return secondaryPositions.map(pos => {\n        const posEnd = addPositions(subtractPositions(pos, primaryEditStartPosition), primaryEditEndPosition);\n        const textAfterSecondaryCursor = textModel.getValueInRange(Range.fromPositions(pos, posEnd));\n        const l = commonPrefixLength(replacedTextAfterPrimaryCursor, textAfterSecondaryCursor);\n        const range = Range.fromPositions(pos, pos.delta(0, l));\n        return new SingleTextEdit(range, secondaryEditText);\n    });\n}\nfunction substringPos(text, pos) {\n    let subtext = '';\n    const lines = splitLinesIncludeSeparators(text);\n    for (let i = pos.lineNumber - 1; i < lines.length; i++) {\n        subtext += lines[i].substring(i === pos.lineNumber - 1 ? pos.column - 1 : 0);\n    }\n    return subtext;\n}\nfunction getEndPositionsAfterApplying(edits) {\n    const sortPerm = Permutation.createSortPermutation(edits, compareBy(e => e.range, Range.compareRangesUsingStarts));\n    const edit = new TextEdit(sortPerm.apply(edits));\n    const sortedNewRanges = edit.getNewRanges();\n    const newRanges = sortPerm.inverse().apply(sortedNewRanges);\n    return newRanges.map(range => range.getEndPosition());\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SuggestMemoryService_1;\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { LRUCache } from '../../../../base/common/map.js';\nimport { TernarySearchTree } from '../../../../base/common/ternarySearchTree.js';\nimport { CompletionItemKinds } from '../../../common/languages.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService, WillSaveStateReason } from '../../../../platform/storage/common/storage.js';\nexport class Memory {\n    constructor(name) {\n        this.name = name;\n    }\n    select(model, pos, items) {\n        if (items.length === 0) {\n            return 0;\n        }\n        const topScore = items[0].score[0];\n        for (let i = 0; i < items.length; i++) {\n            const { score, completion: suggestion } = items[i];\n            if (score[0] !== topScore) {\n                // stop when leaving the group of top matches\n                break;\n            }\n            if (suggestion.preselect) {\n                // stop when seeing an auto-select-item\n                return i;\n            }\n        }\n        return 0;\n    }\n}\nexport class NoMemory extends Memory {\n    constructor() {\n        super('first');\n    }\n    memorize(model, pos, item) {\n        // no-op\n    }\n    toJSON() {\n        return undefined;\n    }\n    fromJSON() {\n        //\n    }\n}\nexport class LRUMemory extends Memory {\n    constructor() {\n        super('recentlyUsed');\n        this._cache = new LRUCache(300, 0.66);\n        this._seq = 0;\n    }\n    memorize(model, pos, item) {\n        const key = `${model.getLanguageId()}/${item.textLabel}`;\n        this._cache.set(key, {\n            touch: this._seq++,\n            type: item.completion.kind,\n            insertText: item.completion.insertText\n        });\n    }\n    select(model, pos, items) {\n        if (items.length === 0) {\n            return 0;\n        }\n        const lineSuffix = model.getLineContent(pos.lineNumber).substr(pos.column - 10, pos.column - 1);\n        if (/\\s$/.test(lineSuffix)) {\n            return super.select(model, pos, items);\n        }\n        const topScore = items[0].score[0];\n        let indexPreselect = -1;\n        let indexRecency = -1;\n        let seq = -1;\n        for (let i = 0; i < items.length; i++) {\n            if (items[i].score[0] !== topScore) {\n                // consider only top items\n                break;\n            }\n            const key = `${model.getLanguageId()}/${items[i].textLabel}`;\n            const item = this._cache.peek(key);\n            if (item && item.touch > seq && item.type === items[i].completion.kind && item.insertText === items[i].completion.insertText) {\n                seq = item.touch;\n                indexRecency = i;\n            }\n            if (items[i].completion.preselect && indexPreselect === -1) {\n                // stop when seeing an auto-select-item\n                return indexPreselect = i;\n            }\n        }\n        if (indexRecency !== -1) {\n            return indexRecency;\n        }\n        else if (indexPreselect !== -1) {\n            return indexPreselect;\n        }\n        else {\n            return 0;\n        }\n    }\n    toJSON() {\n        return this._cache.toJSON();\n    }\n    fromJSON(data) {\n        this._cache.clear();\n        const seq = 0;\n        for (const [key, value] of data) {\n            value.touch = seq;\n            value.type = typeof value.type === 'number' ? value.type : CompletionItemKinds.fromString(value.type);\n            this._cache.set(key, value);\n        }\n        this._seq = this._cache.size;\n    }\n}\nexport class PrefixMemory extends Memory {\n    constructor() {\n        super('recentlyUsedByPrefix');\n        this._trie = TernarySearchTree.forStrings();\n        this._seq = 0;\n    }\n    memorize(model, pos, item) {\n        const { word } = model.getWordUntilPosition(pos);\n        const key = `${model.getLanguageId()}/${word}`;\n        this._trie.set(key, {\n            type: item.completion.kind,\n            insertText: item.completion.insertText,\n            touch: this._seq++\n        });\n    }\n    select(model, pos, items) {\n        const { word } = model.getWordUntilPosition(pos);\n        if (!word) {\n            return super.select(model, pos, items);\n        }\n        const key = `${model.getLanguageId()}/${word}`;\n        let item = this._trie.get(key);\n        if (!item) {\n            item = this._trie.findSubstr(key);\n        }\n        if (item) {\n            for (let i = 0; i < items.length; i++) {\n                const { kind, insertText } = items[i].completion;\n                if (kind === item.type && insertText === item.insertText) {\n                    return i;\n                }\n            }\n        }\n        return super.select(model, pos, items);\n    }\n    toJSON() {\n        const entries = [];\n        this._trie.forEach((value, key) => entries.push([key, value]));\n        // sort by last recently used (touch), then\n        // take the top 200 item and normalize their\n        // touch\n        entries\n            .sort((a, b) => -(a[1].touch - b[1].touch))\n            .forEach((value, i) => value[1].touch = i);\n        return entries.slice(0, 200);\n    }\n    fromJSON(data) {\n        this._trie.clear();\n        if (data.length > 0) {\n            this._seq = data[0][1].touch + 1;\n            for (const [key, value] of data) {\n                value.type = typeof value.type === 'number' ? value.type : CompletionItemKinds.fromString(value.type);\n                this._trie.set(key, value);\n            }\n        }\n    }\n}\nlet SuggestMemoryService = class SuggestMemoryService {\n    static { SuggestMemoryService_1 = this; }\n    static { this._strategyCtors = new Map([\n        ['recentlyUsedByPrefix', PrefixMemory],\n        ['recentlyUsed', LRUMemory],\n        ['first', NoMemory]\n    ]); }\n    static { this._storagePrefix = 'suggest/memories'; }\n    constructor(_storageService, _configService) {\n        this._storageService = _storageService;\n        this._configService = _configService;\n        this._disposables = new DisposableStore();\n        this._persistSoon = new RunOnceScheduler(() => this._saveState(), 500);\n        this._disposables.add(_storageService.onWillSaveState(e => {\n            if (e.reason === WillSaveStateReason.SHUTDOWN) {\n                this._saveState();\n            }\n        }));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._persistSoon.dispose();\n    }\n    memorize(model, pos, item) {\n        this._withStrategy(model, pos).memorize(model, pos, item);\n        this._persistSoon.schedule();\n    }\n    select(model, pos, items) {\n        return this._withStrategy(model, pos).select(model, pos, items);\n    }\n    _withStrategy(model, pos) {\n        const mode = this._configService.getValue('editor.suggestSelection', {\n            overrideIdentifier: model.getLanguageIdAtPosition(pos.lineNumber, pos.column),\n            resource: model.uri\n        });\n        if (this._strategy?.name !== mode) {\n            this._saveState();\n            const ctor = SuggestMemoryService_1._strategyCtors.get(mode) || NoMemory;\n            this._strategy = new ctor();\n            try {\n                const share = this._configService.getValue('editor.suggest.shareSuggestSelections');\n                const scope = share ? 0 /* StorageScope.PROFILE */ : 1 /* StorageScope.WORKSPACE */;\n                const raw = this._storageService.get(`${SuggestMemoryService_1._storagePrefix}/${mode}`, scope);\n                if (raw) {\n                    this._strategy.fromJSON(JSON.parse(raw));\n                }\n            }\n            catch (e) {\n                // things can go wrong with JSON...\n            }\n        }\n        return this._strategy;\n    }\n    _saveState() {\n        if (this._strategy) {\n            const share = this._configService.getValue('editor.suggest.shareSuggestSelections');\n            const scope = share ? 0 /* StorageScope.PROFILE */ : 1 /* StorageScope.WORKSPACE */;\n            const raw = JSON.stringify(this._strategy);\n            this._storageService.store(`${SuggestMemoryService_1._storagePrefix}/${this._strategy.name}`, raw, scope, 1 /* StorageTarget.MACHINE */);\n        }\n    }\n};\nSuggestMemoryService = SuggestMemoryService_1 = __decorate([\n    __param(0, IStorageService),\n    __param(1, IConfigurationService)\n], SuggestMemoryService);\nexport { SuggestMemoryService };\nexport const ISuggestMemoryService = createDecorator('ISuggestMemories');\nregisterSingleton(ISuggestMemoryService, SuggestMemoryService, 1 /* InstantiationType.Delayed */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar WordContextKey_1;\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nlet WordContextKey = class WordContextKey {\n    static { WordContextKey_1 = this; }\n    static { this.AtEnd = new RawContextKey('atEndOfWord', false); }\n    constructor(_editor, contextKeyService) {\n        this._editor = _editor;\n        this._enabled = false;\n        this._ckAtEnd = WordContextKey_1.AtEnd.bindTo(contextKeyService);\n        this._configListener = this._editor.onDidChangeConfiguration(e => e.hasChanged(124 /* EditorOption.tabCompletion */) && this._update());\n        this._update();\n    }\n    dispose() {\n        this._configListener.dispose();\n        this._selectionListener?.dispose();\n        this._ckAtEnd.reset();\n    }\n    _update() {\n        // only update this when tab completions are enabled\n        const enabled = this._editor.getOption(124 /* EditorOption.tabCompletion */) === 'on';\n        if (this._enabled === enabled) {\n            return;\n        }\n        this._enabled = enabled;\n        if (this._enabled) {\n            const checkForWordEnd = () => {\n                if (!this._editor.hasModel()) {\n                    this._ckAtEnd.set(false);\n                    return;\n                }\n                const model = this._editor.getModel();\n                const selection = this._editor.getSelection();\n                const word = model.getWordAtPosition(selection.getStartPosition());\n                if (!word) {\n                    this._ckAtEnd.set(false);\n                    return;\n                }\n                this._ckAtEnd.set(word.endColumn === selection.getStartPosition().column);\n            };\n            this._selectionListener = this._editor.onDidChangeCursorSelection(checkForWordEnd);\n            checkForWordEnd();\n        }\n        else if (this._selectionListener) {\n            this._ckAtEnd.reset();\n            this._selectionListener.dispose();\n            this._selectionListener = undefined;\n        }\n    }\n};\nWordContextKey = WordContextKey_1 = __decorate([\n    __param(1, IContextKeyService)\n], WordContextKey);\nexport { WordContextKey };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SuggestAlternatives_1;\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nlet SuggestAlternatives = class SuggestAlternatives {\n    static { SuggestAlternatives_1 = this; }\n    static { this.OtherSuggestions = new RawContextKey('hasOtherSuggestions', false); }\n    constructor(_editor, contextKeyService) {\n        this._editor = _editor;\n        this._index = 0;\n        this._ckOtherSuggestions = SuggestAlternatives_1.OtherSuggestions.bindTo(contextKeyService);\n    }\n    dispose() {\n        this.reset();\n    }\n    reset() {\n        this._ckOtherSuggestions.reset();\n        this._listener?.dispose();\n        this._model = undefined;\n        this._acceptNext = undefined;\n        this._ignore = false;\n    }\n    set({ model, index }, acceptNext) {\n        // no suggestions -> nothing to do\n        if (model.items.length === 0) {\n            this.reset();\n            return;\n        }\n        // no alternative suggestions -> nothing to do\n        const nextIndex = SuggestAlternatives_1._moveIndex(true, model, index);\n        if (nextIndex === index) {\n            this.reset();\n            return;\n        }\n        this._acceptNext = acceptNext;\n        this._model = model;\n        this._index = index;\n        this._listener = this._editor.onDidChangeCursorPosition(() => {\n            if (!this._ignore) {\n                this.reset();\n            }\n        });\n        this._ckOtherSuggestions.set(true);\n    }\n    static _moveIndex(fwd, model, index) {\n        let newIndex = index;\n        for (let rounds = model.items.length; rounds > 0; rounds--) {\n            newIndex = (newIndex + model.items.length + (fwd ? +1 : -1)) % model.items.length;\n            if (newIndex === index) {\n                break;\n            }\n            if (!model.items[newIndex].completion.additionalTextEdits) {\n                break;\n            }\n        }\n        return newIndex;\n    }\n    next() {\n        this._move(true);\n    }\n    prev() {\n        this._move(false);\n    }\n    _move(fwd) {\n        if (!this._model) {\n            // nothing to reason about\n            return;\n        }\n        try {\n            this._ignore = true;\n            this._index = SuggestAlternatives_1._moveIndex(fwd, this._model, this._index);\n            this._acceptNext({ index: this._index, item: this._model.items[this._index], model: this._model });\n        }\n        finally {\n            this._ignore = false;\n        }\n    }\n};\nSuggestAlternatives = SuggestAlternatives_1 = __decorate([\n    __param(1, IContextKeyService)\n], SuggestAlternatives);\nexport { SuggestAlternatives };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { CharacterSet } from '../../../common/core/characterClassifier.js';\nexport class CommitCharacterController {\n    constructor(editor, widget, model, accept) {\n        this._disposables = new DisposableStore();\n        this._disposables.add(model.onDidSuggest(e => {\n            if (e.completionModel.items.length === 0) {\n                this.reset();\n            }\n        }));\n        this._disposables.add(model.onDidCancel(e => {\n            this.reset();\n        }));\n        this._disposables.add(widget.onDidShow(() => this._onItem(widget.getFocusedItem())));\n        this._disposables.add(widget.onDidFocus(this._onItem, this));\n        this._disposables.add(widget.onDidHide(this.reset, this));\n        this._disposables.add(editor.onWillType(text => {\n            if (this._active && !widget.isFrozen() && model.state !== 0 /* State.Idle */) {\n                const ch = text.charCodeAt(text.length - 1);\n                if (this._active.acceptCharacters.has(ch) && editor.getOption(0 /* EditorOption.acceptSuggestionOnCommitCharacter */)) {\n                    accept(this._active.item);\n                }\n            }\n        }));\n    }\n    _onItem(selected) {\n        if (!selected || !isNonEmptyArray(selected.item.completion.commitCharacters)) {\n            // no item or no commit characters\n            this.reset();\n            return;\n        }\n        if (this._active && this._active.item.item === selected.item) {\n            // still the same item\n            return;\n        }\n        // keep item and its commit characters\n        const acceptCharacters = new CharacterSet();\n        for (const ch of selected.item.completion.commitCharacters) {\n            if (ch.length > 0) {\n                acceptCharacters.add(ch.charCodeAt(0));\n            }\n        }\n        this._active = { acceptCharacters, item: selected };\n    }\n    reset() {\n        this._active = undefined;\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nexport class BracketSelectionRangeProvider {\n    async provideSelectionRanges(model, positions) {\n        const result = [];\n        for (const position of positions) {\n            const bucket = [];\n            result.push(bucket);\n            const ranges = new Map();\n            await new Promise(resolve => BracketSelectionRangeProvider._bracketsRightYield(resolve, 0, model, position, ranges));\n            await new Promise(resolve => BracketSelectionRangeProvider._bracketsLeftYield(resolve, 0, model, position, ranges, bucket));\n        }\n        return result;\n    }\n    static { this._maxDuration = 30; }\n    static { this._maxRounds = 2; }\n    static _bracketsRightYield(resolve, round, model, pos, ranges) {\n        const counts = new Map();\n        const t1 = Date.now();\n        while (true) {\n            if (round >= BracketSelectionRangeProvider._maxRounds) {\n                resolve();\n                break;\n            }\n            if (!pos) {\n                resolve();\n                break;\n            }\n            const bracket = model.bracketPairs.findNextBracket(pos);\n            if (!bracket) {\n                resolve();\n                break;\n            }\n            const d = Date.now() - t1;\n            if (d > BracketSelectionRangeProvider._maxDuration) {\n                setTimeout(() => BracketSelectionRangeProvider._bracketsRightYield(resolve, round + 1, model, pos, ranges));\n                break;\n            }\n            if (bracket.bracketInfo.isOpeningBracket) {\n                const key = bracket.bracketInfo.bracketText;\n                // wait for closing\n                const val = counts.has(key) ? counts.get(key) : 0;\n                counts.set(key, val + 1);\n            }\n            else {\n                const key = bracket.bracketInfo.getOpeningBrackets()[0].bracketText;\n                // process closing\n                let val = counts.has(key) ? counts.get(key) : 0;\n                val -= 1;\n                counts.set(key, Math.max(0, val));\n                if (val < 0) {\n                    let list = ranges.get(key);\n                    if (!list) {\n                        list = new LinkedList();\n                        ranges.set(key, list);\n                    }\n                    list.push(bracket.range);\n                }\n            }\n            pos = bracket.range.getEndPosition();\n        }\n    }\n    static _bracketsLeftYield(resolve, round, model, pos, ranges, bucket) {\n        const counts = new Map();\n        const t1 = Date.now();\n        while (true) {\n            if (round >= BracketSelectionRangeProvider._maxRounds && ranges.size === 0) {\n                resolve();\n                break;\n            }\n            if (!pos) {\n                resolve();\n                break;\n            }\n            const bracket = model.bracketPairs.findPrevBracket(pos);\n            if (!bracket) {\n                resolve();\n                break;\n            }\n            const d = Date.now() - t1;\n            if (d > BracketSelectionRangeProvider._maxDuration) {\n                setTimeout(() => BracketSelectionRangeProvider._bracketsLeftYield(resolve, round + 1, model, pos, ranges, bucket));\n                break;\n            }\n            if (!bracket.bracketInfo.isOpeningBracket) {\n                const key = bracket.bracketInfo.getOpeningBrackets()[0].bracketText;\n                // wait for opening\n                const val = counts.has(key) ? counts.get(key) : 0;\n                counts.set(key, val + 1);\n            }\n            else {\n                const key = bracket.bracketInfo.bracketText;\n                // opening\n                let val = counts.has(key) ? counts.get(key) : 0;\n                val -= 1;\n                counts.set(key, Math.max(0, val));\n                if (val < 0) {\n                    const list = ranges.get(key);\n                    if (list) {\n                        const closing = list.shift();\n                        if (list.size === 0) {\n                            ranges.delete(key);\n                        }\n                        const innerBracket = Range.fromPositions(bracket.range.getEndPosition(), closing.getStartPosition());\n                        const outerBracket = Range.fromPositions(bracket.range.getStartPosition(), closing.getEndPosition());\n                        bucket.push({ range: innerBracket });\n                        bucket.push({ range: outerBracket });\n                        BracketSelectionRangeProvider._addBracketLeading(model, outerBracket, bucket);\n                    }\n                }\n            }\n            pos = bracket.range.getStartPosition();\n        }\n    }\n    static _addBracketLeading(model, bracket, bucket) {\n        if (bracket.startLineNumber === bracket.endLineNumber) {\n            return;\n        }\n        // xxxxxxxx {\n        //\n        // }\n        const startLine = bracket.startLineNumber;\n        const column = model.getLineFirstNonWhitespaceColumn(startLine);\n        if (column !== 0 && column !== bracket.startColumn) {\n            bucket.push({ range: Range.fromPositions(new Position(startLine, column), bracket.getEndPosition()) });\n            bucket.push({ range: Range.fromPositions(new Position(startLine, 1), bracket.getEndPosition()) });\n        }\n        // xxxxxxxx\n        // {\n        //\n        // }\n        const aboveLine = startLine - 1;\n        if (aboveLine > 0) {\n            const column = model.getLineFirstNonWhitespaceColumn(aboveLine);\n            if (column === bracket.startColumn && column !== model.getLineLastNonWhitespaceColumn(aboveLine)) {\n                bucket.push({ range: Range.fromPositions(new Position(aboveLine, column), bracket.getEndPosition()) });\n                bucket.push({ range: Range.fromPositions(new Position(aboveLine, 1), bracket.getEndPosition()) });\n            }\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { binarySearch, isFalsyOrEmpty } from '../../../../base/common/arrays.js';\nimport { Range } from '../../../common/core/range.js';\nimport { BracketSelectionRangeProvider } from '../../smartSelect/browser/bracketSelections.js';\nexport class WordDistance {\n    static { this.None = new class extends WordDistance {\n        distance() { return 0; }\n    }; }\n    static async create(service, editor) {\n        if (!editor.getOption(119 /* EditorOption.suggest */).localityBonus) {\n            return WordDistance.None;\n        }\n        if (!editor.hasModel()) {\n            return WordDistance.None;\n        }\n        const model = editor.getModel();\n        const position = editor.getPosition();\n        if (!service.canComputeWordRanges(model.uri)) {\n            return WordDistance.None;\n        }\n        const [ranges] = await new BracketSelectionRangeProvider().provideSelectionRanges(model, [position]);\n        if (ranges.length === 0) {\n            return WordDistance.None;\n        }\n        const wordRanges = await service.computeWordRanges(model.uri, ranges[0].range);\n        if (!wordRanges) {\n            return WordDistance.None;\n        }\n        // remove current word\n        const wordUntilPos = model.getWordUntilPosition(position);\n        delete wordRanges[wordUntilPos.word];\n        return new class extends WordDistance {\n            distance(anchor, item) {\n                if (!position.equals(editor.getPosition())) {\n                    return 0;\n                }\n                if (item.kind === 17 /* CompletionItemKind.Keyword */) {\n                    return 2 << 20;\n                }\n                const word = typeof item.label === 'string' ? item.label : item.label.label;\n                const wordLines = wordRanges[word];\n                if (isFalsyOrEmpty(wordLines)) {\n                    return 2 << 20;\n                }\n                const idx = binarySearch(wordLines, Range.fromPositions(anchor), Range.compareRangesUsingStarts);\n                const bestWordRange = idx >= 0 ? wordLines[idx] : wordLines[Math.max(0, ~idx - 1)];\n                let blockDistance = ranges.length;\n                for (const range of ranges) {\n                    if (!Range.containsRange(range.range, bestWordRange)) {\n                        break;\n                    }\n                    blockDistance -= 1;\n                }\n                return blockDistance;\n            }\n        };\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { quickSelect } from '../../../../base/common/arrays.js';\nimport { anyScore, fuzzyScore, FuzzyScore, fuzzyScoreGracefulAggressive, FuzzyScoreOptions } from '../../../../base/common/filters.js';\nimport { compareIgnoreCase } from '../../../../base/common/strings.js';\nexport class LineContext {\n    constructor(leadingLineContent, characterCountDelta) {\n        this.leadingLineContent = leadingLineContent;\n        this.characterCountDelta = characterCountDelta;\n    }\n}\n/**\n * Sorted, filtered completion view model\n * */\nexport class CompletionModel {\n    constructor(items, column, lineContext, wordDistance, options, snippetSuggestions, fuzzyScoreOptions = FuzzyScoreOptions.default, clipboardText = undefined) {\n        this.clipboardText = clipboardText;\n        this._snippetCompareFn = CompletionModel._compareCompletionItems;\n        this._items = items;\n        this._column = column;\n        this._wordDistance = wordDistance;\n        this._options = options;\n        this._refilterKind = 1 /* Refilter.All */;\n        this._lineContext = lineContext;\n        this._fuzzyScoreOptions = fuzzyScoreOptions;\n        if (snippetSuggestions === 'top') {\n            this._snippetCompareFn = CompletionModel._compareCompletionItemsSnippetsUp;\n        }\n        else if (snippetSuggestions === 'bottom') {\n            this._snippetCompareFn = CompletionModel._compareCompletionItemsSnippetsDown;\n        }\n    }\n    get lineContext() {\n        return this._lineContext;\n    }\n    set lineContext(value) {\n        if (this._lineContext.leadingLineContent !== value.leadingLineContent\n            || this._lineContext.characterCountDelta !== value.characterCountDelta) {\n            this._refilterKind = this._lineContext.characterCountDelta < value.characterCountDelta && this._filteredItems ? 2 /* Refilter.Incr */ : 1 /* Refilter.All */;\n            this._lineContext = value;\n        }\n    }\n    get items() {\n        this._ensureCachedState();\n        return this._filteredItems;\n    }\n    getItemsByProvider() {\n        this._ensureCachedState();\n        return this._itemsByProvider;\n    }\n    getIncompleteProvider() {\n        this._ensureCachedState();\n        const result = new Set();\n        for (const [provider, items] of this.getItemsByProvider()) {\n            if (items.length > 0 && items[0].container.incomplete) {\n                result.add(provider);\n            }\n        }\n        return result;\n    }\n    get stats() {\n        this._ensureCachedState();\n        return this._stats;\n    }\n    _ensureCachedState() {\n        if (this._refilterKind !== 0 /* Refilter.Nothing */) {\n            this._createCachedState();\n        }\n    }\n    _createCachedState() {\n        this._itemsByProvider = new Map();\n        const labelLengths = [];\n        const { leadingLineContent, characterCountDelta } = this._lineContext;\n        let word = '';\n        let wordLow = '';\n        // incrementally filter less\n        const source = this._refilterKind === 1 /* Refilter.All */ ? this._items : this._filteredItems;\n        const target = [];\n        // picks a score function based on the number of\n        // items that we have to score/filter and based on the\n        // user-configuration\n        const scoreFn = (!this._options.filterGraceful || source.length > 2000) ? fuzzyScore : fuzzyScoreGracefulAggressive;\n        for (let i = 0; i < source.length; i++) {\n            const item = source[i];\n            if (item.isInvalid) {\n                continue; // SKIP invalid items\n            }\n            // keep all items by their provider\n            const arr = this._itemsByProvider.get(item.provider);\n            if (arr) {\n                arr.push(item);\n            }\n            else {\n                this._itemsByProvider.set(item.provider, [item]);\n            }\n            // 'word' is that remainder of the current line that we\n            // filter and score against. In theory each suggestion uses a\n            // different word, but in practice not - that's why we cache\n            const overwriteBefore = item.position.column - item.editStart.column;\n            const wordLen = overwriteBefore + characterCountDelta - (item.position.column - this._column);\n            if (word.length !== wordLen) {\n                word = wordLen === 0 ? '' : leadingLineContent.slice(-wordLen);\n                wordLow = word.toLowerCase();\n            }\n            // remember the word against which this item was\n            // scored\n            item.word = word;\n            if (wordLen === 0) {\n                // when there is nothing to score against, don't\n                // event try to do. Use a const rank and rely on\n                // the fallback-sort using the initial sort order.\n                // use a score of `-100` because that is out of the\n                // bound of values `fuzzyScore` will return\n                item.score = FuzzyScore.Default;\n            }\n            else {\n                // skip word characters that are whitespace until\n                // we have hit the replace range (overwriteBefore)\n                let wordPos = 0;\n                while (wordPos < overwriteBefore) {\n                    const ch = word.charCodeAt(wordPos);\n                    if (ch === 32 /* CharCode.Space */ || ch === 9 /* CharCode.Tab */) {\n                        wordPos += 1;\n                    }\n                    else {\n                        break;\n                    }\n                }\n                if (wordPos >= wordLen) {\n                    // the wordPos at which scoring starts is the whole word\n                    // and therefore the same rules as not having a word apply\n                    item.score = FuzzyScore.Default;\n                }\n                else if (typeof item.completion.filterText === 'string') {\n                    // when there is a `filterText` it must match the `word`.\n                    // if it matches we check with the label to compute highlights\n                    // and if that doesn't yield a result we have no highlights,\n                    // despite having the match\n                    const match = scoreFn(word, wordLow, wordPos, item.completion.filterText, item.filterTextLow, 0, this._fuzzyScoreOptions);\n                    if (!match) {\n                        continue; // NO match\n                    }\n                    if (compareIgnoreCase(item.completion.filterText, item.textLabel) === 0) {\n                        // filterText and label are actually the same -> use good highlights\n                        item.score = match;\n                    }\n                    else {\n                        // re-run the scorer on the label in the hope of a result BUT use the rank\n                        // of the filterText-match\n                        item.score = anyScore(word, wordLow, wordPos, item.textLabel, item.labelLow, 0);\n                        item.score[0] = match[0]; // use score from filterText\n                    }\n                }\n                else {\n                    // by default match `word` against the `label`\n                    const match = scoreFn(word, wordLow, wordPos, item.textLabel, item.labelLow, 0, this._fuzzyScoreOptions);\n                    if (!match) {\n                        continue; // NO match\n                    }\n                    item.score = match;\n                }\n            }\n            item.idx = i;\n            item.distance = this._wordDistance.distance(item.position, item.completion);\n            target.push(item);\n            // update stats\n            labelLengths.push(item.textLabel.length);\n        }\n        this._filteredItems = target.sort(this._snippetCompareFn);\n        this._refilterKind = 0 /* Refilter.Nothing */;\n        this._stats = {\n            pLabelLen: labelLengths.length ?\n                quickSelect(labelLengths.length - .85, labelLengths, (a, b) => a - b)\n                : 0\n        };\n    }\n    static _compareCompletionItems(a, b) {\n        if (a.score[0] > b.score[0]) {\n            return -1;\n        }\n        else if (a.score[0] < b.score[0]) {\n            return 1;\n        }\n        else if (a.distance < b.distance) {\n            return -1;\n        }\n        else if (a.distance > b.distance) {\n            return 1;\n        }\n        else if (a.idx < b.idx) {\n            return -1;\n        }\n        else if (a.idx > b.idx) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    static _compareCompletionItemsSnippetsDown(a, b) {\n        if (a.completion.kind !== b.completion.kind) {\n            if (a.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return 1;\n            }\n            else if (b.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return -1;\n            }\n        }\n        return CompletionModel._compareCompletionItems(a, b);\n    }\n    static _compareCompletionItemsSnippetsUp(a, b) {\n        if (a.completion.kind !== b.completion.kind) {\n            if (a.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return -1;\n            }\n            else if (b.completion.kind === 27 /* CompletionItemKind.Snippet */) {\n                return 1;\n            }\n        }\n        return CompletionModel._compareCompletionItems(a, b);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SuggestModel_1;\nimport { TimeoutTimer } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { getLeadingWhitespace, isHighSurrogate, isLowSurrogate } from '../../../../base/common/strings.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { WordDistance } from './wordDistance.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { CompletionModel } from './completionModel.js';\nimport { CompletionOptions, getSnippetSuggestSupport, provideSuggestionItems, QuickSuggestionsOptions } from './suggest.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { FuzzyScoreOptions } from '../../../../base/common/filters.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { InlineCompletionContextKeys } from '../../inlineCompletions/browser/controller/inlineCompletionContextKeys.js';\nimport { SnippetController2 } from '../../snippet/browser/snippetController2.js';\nimport { IEnvironmentService } from '../../../../platform/environment/common/environment.js';\nexport class LineContext {\n    static shouldAutoTrigger(editor) {\n        if (!editor.hasModel()) {\n            return false;\n        }\n        const model = editor.getModel();\n        const pos = editor.getPosition();\n        model.tokenization.tokenizeIfCheap(pos.lineNumber);\n        const word = model.getWordAtPosition(pos);\n        if (!word) {\n            return false;\n        }\n        if (word.endColumn !== pos.column &&\n            word.startColumn + 1 !== pos.column /* after typing a single character before a word */) {\n            return false;\n        }\n        if (!isNaN(Number(word.word))) {\n            return false;\n        }\n        return true;\n    }\n    constructor(model, position, triggerOptions) {\n        this.leadingLineContent = model.getLineContent(position.lineNumber).substr(0, position.column - 1);\n        this.leadingWord = model.getWordUntilPosition(position);\n        this.lineNumber = position.lineNumber;\n        this.column = position.column;\n        this.triggerOptions = triggerOptions;\n    }\n}\nfunction canShowQuickSuggest(editor, contextKeyService, configurationService) {\n    if (!Boolean(contextKeyService.getContextKeyValue(InlineCompletionContextKeys.inlineSuggestionVisible.key))) {\n        // Allow if there is no inline suggestion.\n        return true;\n    }\n    const suppressSuggestions = contextKeyService.getContextKeyValue(InlineCompletionContextKeys.suppressSuggestions.key);\n    if (suppressSuggestions !== undefined) {\n        return !suppressSuggestions;\n    }\n    return !editor.getOption(62 /* EditorOption.inlineSuggest */).suppressSuggestions;\n}\nfunction canShowSuggestOnTriggerCharacters(editor, contextKeyService, configurationService) {\n    if (!Boolean(contextKeyService.getContextKeyValue('inlineSuggestionVisible'))) {\n        // Allow if there is no inline suggestion.\n        return true;\n    }\n    const suppressSuggestions = contextKeyService.getContextKeyValue(InlineCompletionContextKeys.suppressSuggestions.key);\n    if (suppressSuggestions !== undefined) {\n        return !suppressSuggestions;\n    }\n    return !editor.getOption(62 /* EditorOption.inlineSuggest */).suppressSuggestions;\n}\nlet SuggestModel = SuggestModel_1 = class SuggestModel {\n    constructor(_editor, _editorWorkerService, _clipboardService, _telemetryService, _logService, _contextKeyService, _configurationService, _languageFeaturesService, _envService) {\n        this._editor = _editor;\n        this._editorWorkerService = _editorWorkerService;\n        this._clipboardService = _clipboardService;\n        this._telemetryService = _telemetryService;\n        this._logService = _logService;\n        this._contextKeyService = _contextKeyService;\n        this._configurationService = _configurationService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._envService = _envService;\n        this._toDispose = new DisposableStore();\n        this._triggerCharacterListener = new DisposableStore();\n        this._triggerQuickSuggest = new TimeoutTimer();\n        this._triggerState = undefined;\n        this._completionDisposables = new DisposableStore();\n        this._onDidCancel = new Emitter();\n        this._onDidTrigger = new Emitter();\n        this._onDidSuggest = new Emitter();\n        this.onDidCancel = this._onDidCancel.event;\n        this.onDidTrigger = this._onDidTrigger.event;\n        this.onDidSuggest = this._onDidSuggest.event;\n        this._telemetryGate = 0;\n        this._currentSelection = this._editor.getSelection() || new Selection(1, 1, 1, 1);\n        // wire up various listeners\n        this._toDispose.add(this._editor.onDidChangeModel(() => {\n            this._updateTriggerCharacters();\n            this.cancel();\n        }));\n        this._toDispose.add(this._editor.onDidChangeModelLanguage(() => {\n            this._updateTriggerCharacters();\n            this.cancel();\n        }));\n        this._toDispose.add(this._editor.onDidChangeConfiguration(() => {\n            this._updateTriggerCharacters();\n        }));\n        this._toDispose.add(this._languageFeaturesService.completionProvider.onDidChange(() => {\n            this._updateTriggerCharacters();\n            this._updateActiveSuggestSession();\n        }));\n        let editorIsComposing = false;\n        this._toDispose.add(this._editor.onDidCompositionStart(() => {\n            editorIsComposing = true;\n        }));\n        this._toDispose.add(this._editor.onDidCompositionEnd(() => {\n            editorIsComposing = false;\n            this._onCompositionEnd();\n        }));\n        this._toDispose.add(this._editor.onDidChangeCursorSelection(e => {\n            // only trigger suggest when the editor isn't composing a character\n            if (!editorIsComposing) {\n                this._onCursorChange(e);\n            }\n        }));\n        this._toDispose.add(this._editor.onDidChangeModelContent(() => {\n            // only filter completions when the editor isn't composing a character\n            // allow-any-unicode-next-line\n            // e.g. ¨ + u makes ü but just ¨ cannot be used for filtering\n            if (!editorIsComposing && this._triggerState !== undefined) {\n                this._refilterCompletionItems();\n            }\n        }));\n        this._updateTriggerCharacters();\n    }\n    dispose() {\n        dispose(this._triggerCharacterListener);\n        dispose([this._onDidCancel, this._onDidSuggest, this._onDidTrigger, this._triggerQuickSuggest]);\n        this._toDispose.dispose();\n        this._completionDisposables.dispose();\n        this.cancel();\n    }\n    _updateTriggerCharacters() {\n        this._triggerCharacterListener.clear();\n        if (this._editor.getOption(92 /* EditorOption.readOnly */)\n            || !this._editor.hasModel()\n            || !this._editor.getOption(122 /* EditorOption.suggestOnTriggerCharacters */)) {\n            return;\n        }\n        const supportsByTriggerCharacter = new Map();\n        for (const support of this._languageFeaturesService.completionProvider.all(this._editor.getModel())) {\n            for (const ch of support.triggerCharacters || []) {\n                let set = supportsByTriggerCharacter.get(ch);\n                if (!set) {\n                    set = new Set();\n                    const suggestSupport = getSnippetSuggestSupport();\n                    if (suggestSupport) {\n                        set.add(suggestSupport);\n                    }\n                    supportsByTriggerCharacter.set(ch, set);\n                }\n                set.add(support);\n            }\n        }\n        const checkTriggerCharacter = (text) => {\n            if (!canShowSuggestOnTriggerCharacters(this._editor, this._contextKeyService, this._configurationService)) {\n                return;\n            }\n            if (LineContext.shouldAutoTrigger(this._editor)) {\n                // don't trigger by trigger characters when this is a case for quick suggest\n                return;\n            }\n            if (!text) {\n                // came here from the compositionEnd-event\n                const position = this._editor.getPosition();\n                const model = this._editor.getModel();\n                text = model.getLineContent(position.lineNumber).substr(0, position.column - 1);\n            }\n            let lastChar = '';\n            if (isLowSurrogate(text.charCodeAt(text.length - 1))) {\n                if (isHighSurrogate(text.charCodeAt(text.length - 2))) {\n                    lastChar = text.substr(text.length - 2);\n                }\n            }\n            else {\n                lastChar = text.charAt(text.length - 1);\n            }\n            const supports = supportsByTriggerCharacter.get(lastChar);\n            if (supports) {\n                // keep existing items that where not computed by the\n                // supports/providers that want to trigger now\n                const providerItemsToReuse = new Map();\n                if (this._completionModel) {\n                    for (const [provider, items] of this._completionModel.getItemsByProvider()) {\n                        if (!supports.has(provider)) {\n                            providerItemsToReuse.set(provider, items);\n                        }\n                    }\n                }\n                this.trigger({\n                    auto: true,\n                    triggerKind: 1 /* CompletionTriggerKind.TriggerCharacter */,\n                    triggerCharacter: lastChar,\n                    retrigger: Boolean(this._completionModel),\n                    clipboardText: this._completionModel?.clipboardText,\n                    completionOptions: { providerFilter: supports, providerItemsToReuse }\n                });\n            }\n        };\n        this._triggerCharacterListener.add(this._editor.onDidType(checkTriggerCharacter));\n        this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(() => checkTriggerCharacter()));\n    }\n    // --- trigger/retrigger/cancel suggest\n    get state() {\n        if (!this._triggerState) {\n            return 0 /* State.Idle */;\n        }\n        else if (!this._triggerState.auto) {\n            return 1 /* State.Manual */;\n        }\n        else {\n            return 2 /* State.Auto */;\n        }\n    }\n    cancel(retrigger = false) {\n        if (this._triggerState !== undefined) {\n            this._triggerQuickSuggest.cancel();\n            this._requestToken?.cancel();\n            this._requestToken = undefined;\n            this._triggerState = undefined;\n            this._completionModel = undefined;\n            this._context = undefined;\n            this._onDidCancel.fire({ retrigger });\n        }\n    }\n    clear() {\n        this._completionDisposables.clear();\n    }\n    _updateActiveSuggestSession() {\n        if (this._triggerState !== undefined) {\n            if (!this._editor.hasModel() || !this._languageFeaturesService.completionProvider.has(this._editor.getModel())) {\n                this.cancel();\n            }\n            else {\n                this.trigger({ auto: this._triggerState.auto, retrigger: true });\n            }\n        }\n    }\n    _onCursorChange(e) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const prevSelection = this._currentSelection;\n        this._currentSelection = this._editor.getSelection();\n        if (!e.selection.isEmpty()\n            || (e.reason !== 0 /* CursorChangeReason.NotSet */ && e.reason !== 3 /* CursorChangeReason.Explicit */)\n            || (e.source !== 'keyboard' && e.source !== 'deleteLeft')) {\n            // Early exit if nothing needs to be done!\n            // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\n            this.cancel();\n            return;\n        }\n        if (this._triggerState === undefined && e.reason === 0 /* CursorChangeReason.NotSet */) {\n            if (prevSelection.containsRange(this._currentSelection) || prevSelection.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition())) {\n                // cursor did move RIGHT due to typing -> trigger quick suggest\n                this._doTriggerQuickSuggest();\n            }\n        }\n        else if (this._triggerState !== undefined && e.reason === 3 /* CursorChangeReason.Explicit */) {\n            // suggest is active and something like cursor keys are used to move\n            // the cursor. this means we can refilter at the new position\n            this._refilterCompletionItems();\n        }\n    }\n    _onCompositionEnd() {\n        // trigger or refilter when composition ends\n        if (this._triggerState === undefined) {\n            this._doTriggerQuickSuggest();\n        }\n        else {\n            this._refilterCompletionItems();\n        }\n    }\n    _doTriggerQuickSuggest() {\n        if (QuickSuggestionsOptions.isAllOff(this._editor.getOption(90 /* EditorOption.quickSuggestions */))) {\n            // not enabled\n            return;\n        }\n        if (this._editor.getOption(119 /* EditorOption.suggest */).snippetsPreventQuickSuggestions && SnippetController2.get(this._editor)?.isInSnippet()) {\n            // no quick suggestion when in snippet mode\n            return;\n        }\n        this.cancel();\n        this._triggerQuickSuggest.cancelAndSet(() => {\n            if (this._triggerState !== undefined) {\n                return;\n            }\n            if (!LineContext.shouldAutoTrigger(this._editor)) {\n                return;\n            }\n            if (!this._editor.hasModel() || !this._editor.hasWidgetFocus()) {\n                return;\n            }\n            const model = this._editor.getModel();\n            const pos = this._editor.getPosition();\n            // validate enabled now\n            const config = this._editor.getOption(90 /* EditorOption.quickSuggestions */);\n            if (QuickSuggestionsOptions.isAllOff(config)) {\n                return;\n            }\n            if (!QuickSuggestionsOptions.isAllOn(config)) {\n                // Check the type of the token that triggered this\n                model.tokenization.tokenizeIfCheap(pos.lineNumber);\n                const lineTokens = model.tokenization.getLineTokens(pos.lineNumber);\n                const tokenType = lineTokens.getStandardTokenType(lineTokens.findTokenIndexAtOffset(Math.max(pos.column - 1 - 1, 0)));\n                if (QuickSuggestionsOptions.valueFor(config, tokenType) !== 'on') {\n                    return;\n                }\n            }\n            if (!canShowQuickSuggest(this._editor, this._contextKeyService, this._configurationService)) {\n                // do not trigger quick suggestions if inline suggestions are shown\n                return;\n            }\n            if (!this._languageFeaturesService.completionProvider.has(model)) {\n                return;\n            }\n            // we made it till here -> trigger now\n            this.trigger({ auto: true });\n        }, this._editor.getOption(91 /* EditorOption.quickSuggestionsDelay */));\n    }\n    _refilterCompletionItems() {\n        assertType(this._editor.hasModel());\n        assertType(this._triggerState !== undefined);\n        const model = this._editor.getModel();\n        const position = this._editor.getPosition();\n        const ctx = new LineContext(model, position, { ...this._triggerState, refilter: true });\n        this._onNewContext(ctx);\n    }\n    trigger(options) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const ctx = new LineContext(model, this._editor.getPosition(), options);\n        // Cancel previous requests, change state & update UI\n        this.cancel(options.retrigger);\n        this._triggerState = options;\n        this._onDidTrigger.fire({ auto: options.auto, shy: options.shy ?? false, position: this._editor.getPosition() });\n        // Capture context when request was sent\n        this._context = ctx;\n        // Build context for request\n        let suggestCtx = { triggerKind: options.triggerKind ?? 0 /* CompletionTriggerKind.Invoke */ };\n        if (options.triggerCharacter) {\n            suggestCtx = {\n                triggerKind: 1 /* CompletionTriggerKind.TriggerCharacter */,\n                triggerCharacter: options.triggerCharacter\n            };\n        }\n        this._requestToken = new CancellationTokenSource();\n        // kind filter and snippet sort rules\n        const snippetSuggestions = this._editor.getOption(113 /* EditorOption.snippetSuggestions */);\n        let snippetSortOrder = 1 /* SnippetSortOrder.Inline */;\n        switch (snippetSuggestions) {\n            case 'top':\n                snippetSortOrder = 0 /* SnippetSortOrder.Top */;\n                break;\n            // \t↓ that's the default anyways...\n            // case 'inline':\n            // \tsnippetSortOrder = SnippetSortOrder.Inline;\n            // \tbreak;\n            case 'bottom':\n                snippetSortOrder = 2 /* SnippetSortOrder.Bottom */;\n                break;\n        }\n        const { itemKind: itemKindFilter, showDeprecated } = SuggestModel_1.createSuggestFilter(this._editor);\n        const completionOptions = new CompletionOptions(snippetSortOrder, options.completionOptions?.kindFilter ?? itemKindFilter, options.completionOptions?.providerFilter, options.completionOptions?.providerItemsToReuse, showDeprecated);\n        const wordDistance = WordDistance.create(this._editorWorkerService, this._editor);\n        const completions = provideSuggestionItems(this._languageFeaturesService.completionProvider, model, this._editor.getPosition(), completionOptions, suggestCtx, this._requestToken.token);\n        Promise.all([completions, wordDistance]).then(async ([completions, wordDistance]) => {\n            this._requestToken?.dispose();\n            if (!this._editor.hasModel()) {\n                return;\n            }\n            let clipboardText = options?.clipboardText;\n            if (!clipboardText && completions.needsClipboard) {\n                clipboardText = await this._clipboardService.readText();\n            }\n            if (this._triggerState === undefined) {\n                return;\n            }\n            const model = this._editor.getModel();\n            // const items = completions.items;\n            // if (existing) {\n            // \tconst cmpFn = getSuggestionComparator(snippetSortOrder);\n            // \titems = items.concat(existing.items).sort(cmpFn);\n            // }\n            const ctx = new LineContext(model, this._editor.getPosition(), options);\n            const fuzzySearchOptions = {\n                ...FuzzyScoreOptions.default,\n                firstMatchCanBeWeak: !this._editor.getOption(119 /* EditorOption.suggest */).matchOnWordStartOnly\n            };\n            this._completionModel = new CompletionModel(completions.items, this._context.column, {\n                leadingLineContent: ctx.leadingLineContent,\n                characterCountDelta: ctx.column - this._context.column\n            }, wordDistance, this._editor.getOption(119 /* EditorOption.suggest */), this._editor.getOption(113 /* EditorOption.snippetSuggestions */), fuzzySearchOptions, clipboardText);\n            // store containers so that they can be disposed later\n            this._completionDisposables.add(completions.disposable);\n            this._onNewContext(ctx);\n            // finally report telemetry about durations\n            this._reportDurationsTelemetry(completions.durations);\n            // report invalid completions by source\n            if (!this._envService.isBuilt || this._envService.isExtensionDevelopment) {\n                for (const item of completions.items) {\n                    if (item.isInvalid) {\n                        this._logService.warn(`[suggest] did IGNORE invalid completion item from ${item.provider._debugDisplayName}`, item.completion);\n                    }\n                }\n            }\n        }).catch(onUnexpectedError);\n    }\n    _reportDurationsTelemetry(durations) {\n        if (this._telemetryGate++ % 230 !== 0) {\n            return;\n        }\n        setTimeout(() => {\n            this._telemetryService.publicLog2('suggest.durations.json', { data: JSON.stringify(durations) });\n            this._logService.debug('suggest.durations.json', durations);\n        });\n    }\n    static createSuggestFilter(editor) {\n        // kind filter and snippet sort rules\n        const result = new Set();\n        // snippet setting\n        const snippetSuggestions = editor.getOption(113 /* EditorOption.snippetSuggestions */);\n        if (snippetSuggestions === 'none') {\n            result.add(27 /* CompletionItemKind.Snippet */);\n        }\n        // type setting\n        const suggestOptions = editor.getOption(119 /* EditorOption.suggest */);\n        if (!suggestOptions.showMethods) {\n            result.add(0 /* CompletionItemKind.Method */);\n        }\n        if (!suggestOptions.showFunctions) {\n            result.add(1 /* CompletionItemKind.Function */);\n        }\n        if (!suggestOptions.showConstructors) {\n            result.add(2 /* CompletionItemKind.Constructor */);\n        }\n        if (!suggestOptions.showFields) {\n            result.add(3 /* CompletionItemKind.Field */);\n        }\n        if (!suggestOptions.showVariables) {\n            result.add(4 /* CompletionItemKind.Variable */);\n        }\n        if (!suggestOptions.showClasses) {\n            result.add(5 /* CompletionItemKind.Class */);\n        }\n        if (!suggestOptions.showStructs) {\n            result.add(6 /* CompletionItemKind.Struct */);\n        }\n        if (!suggestOptions.showInterfaces) {\n            result.add(7 /* CompletionItemKind.Interface */);\n        }\n        if (!suggestOptions.showModules) {\n            result.add(8 /* CompletionItemKind.Module */);\n        }\n        if (!suggestOptions.showProperties) {\n            result.add(9 /* CompletionItemKind.Property */);\n        }\n        if (!suggestOptions.showEvents) {\n            result.add(10 /* CompletionItemKind.Event */);\n        }\n        if (!suggestOptions.showOperators) {\n            result.add(11 /* CompletionItemKind.Operator */);\n        }\n        if (!suggestOptions.showUnits) {\n            result.add(12 /* CompletionItemKind.Unit */);\n        }\n        if (!suggestOptions.showValues) {\n            result.add(13 /* CompletionItemKind.Value */);\n        }\n        if (!suggestOptions.showConstants) {\n            result.add(14 /* CompletionItemKind.Constant */);\n        }\n        if (!suggestOptions.showEnums) {\n            result.add(15 /* CompletionItemKind.Enum */);\n        }\n        if (!suggestOptions.showEnumMembers) {\n            result.add(16 /* CompletionItemKind.EnumMember */);\n        }\n        if (!suggestOptions.showKeywords) {\n            result.add(17 /* CompletionItemKind.Keyword */);\n        }\n        if (!suggestOptions.showWords) {\n            result.add(18 /* CompletionItemKind.Text */);\n        }\n        if (!suggestOptions.showColors) {\n            result.add(19 /* CompletionItemKind.Color */);\n        }\n        if (!suggestOptions.showFiles) {\n            result.add(20 /* CompletionItemKind.File */);\n        }\n        if (!suggestOptions.showReferences) {\n            result.add(21 /* CompletionItemKind.Reference */);\n        }\n        if (!suggestOptions.showColors) {\n            result.add(22 /* CompletionItemKind.Customcolor */);\n        }\n        if (!suggestOptions.showFolders) {\n            result.add(23 /* CompletionItemKind.Folder */);\n        }\n        if (!suggestOptions.showTypeParameters) {\n            result.add(24 /* CompletionItemKind.TypeParameter */);\n        }\n        if (!suggestOptions.showSnippets) {\n            result.add(27 /* CompletionItemKind.Snippet */);\n        }\n        if (!suggestOptions.showUsers) {\n            result.add(25 /* CompletionItemKind.User */);\n        }\n        if (!suggestOptions.showIssues) {\n            result.add(26 /* CompletionItemKind.Issue */);\n        }\n        return { itemKind: result, showDeprecated: suggestOptions.showDeprecated };\n    }\n    _onNewContext(ctx) {\n        if (!this._context) {\n            // happens when 24x7 IntelliSense is enabled and still in its delay\n            return;\n        }\n        if (ctx.lineNumber !== this._context.lineNumber) {\n            // e.g. happens when pressing Enter while IntelliSense is computed\n            this.cancel();\n            return;\n        }\n        if (getLeadingWhitespace(ctx.leadingLineContent) !== getLeadingWhitespace(this._context.leadingLineContent)) {\n            // cancel IntelliSense when line start changes\n            // happens when the current word gets outdented\n            this.cancel();\n            return;\n        }\n        if (ctx.column < this._context.column) {\n            // typed -> moved cursor LEFT -> retrigger if still on a word\n            if (ctx.leadingWord.word) {\n                this.trigger({ auto: this._context.triggerOptions.auto, retrigger: true });\n            }\n            else {\n                this.cancel();\n            }\n            return;\n        }\n        if (!this._completionModel) {\n            // happens when IntelliSense is not yet computed\n            return;\n        }\n        if (ctx.leadingWord.word.length !== 0 && ctx.leadingWord.startColumn > this._context.leadingWord.startColumn) {\n            // started a new word while IntelliSense shows -> retrigger but reuse all items that we currently have\n            const shouldAutoTrigger = LineContext.shouldAutoTrigger(this._editor);\n            if (shouldAutoTrigger && this._context) {\n                // shouldAutoTrigger forces tokenization, which can cause pending cursor change events to be emitted, which can cause\n                // suggestions to be cancelled, which causes `this._context` to be undefined\n                const map = this._completionModel.getItemsByProvider();\n                this.trigger({\n                    auto: this._context.triggerOptions.auto,\n                    retrigger: true,\n                    clipboardText: this._completionModel.clipboardText,\n                    completionOptions: { providerItemsToReuse: map }\n                });\n            }\n            return;\n        }\n        if (ctx.column > this._context.column && this._completionModel.getIncompleteProvider().size > 0 && ctx.leadingWord.word.length !== 0) {\n            // typed -> moved cursor RIGHT & incomple model & still on a word -> retrigger\n            const providerItemsToReuse = new Map();\n            const providerFilter = new Set();\n            for (const [provider, items] of this._completionModel.getItemsByProvider()) {\n                if (items.length > 0 && items[0].container.incomplete) {\n                    providerFilter.add(provider);\n                }\n                else {\n                    providerItemsToReuse.set(provider, items);\n                }\n            }\n            this.trigger({\n                auto: this._context.triggerOptions.auto,\n                triggerKind: 2 /* CompletionTriggerKind.TriggerForIncompleteCompletions */,\n                retrigger: true,\n                clipboardText: this._completionModel.clipboardText,\n                completionOptions: { providerFilter, providerItemsToReuse }\n            });\n        }\n        else {\n            // typed -> moved cursor RIGHT -> update UI\n            const oldLineContext = this._completionModel.lineContext;\n            let isFrozen = false;\n            this._completionModel.lineContext = {\n                leadingLineContent: ctx.leadingLineContent,\n                characterCountDelta: ctx.column - this._context.column\n            };\n            if (this._completionModel.items.length === 0) {\n                const shouldAutoTrigger = LineContext.shouldAutoTrigger(this._editor);\n                if (!this._context) {\n                    // shouldAutoTrigger forces tokenization, which can cause pending cursor change events to be emitted, which can cause\n                    // suggestions to be cancelled, which causes `this._context` to be undefined\n                    this.cancel();\n                    return;\n                }\n                if (shouldAutoTrigger && this._context.leadingWord.endColumn < ctx.leadingWord.startColumn) {\n                    // retrigger when heading into a new word\n                    this.trigger({ auto: this._context.triggerOptions.auto, retrigger: true });\n                    return;\n                }\n                if (!this._context.triggerOptions.auto) {\n                    // freeze when IntelliSense was manually requested\n                    this._completionModel.lineContext = oldLineContext;\n                    isFrozen = this._completionModel.items.length > 0;\n                    if (isFrozen && ctx.leadingWord.word.length === 0) {\n                        // there were results before but now there aren't\n                        // and also we are not on a word anymore -> cancel\n                        this.cancel();\n                        return;\n                    }\n                }\n                else {\n                    // nothing left\n                    this.cancel();\n                    return;\n                }\n            }\n            this._onDidSuggest.fire({\n                completionModel: this._completionModel,\n                triggerOptions: ctx.triggerOptions,\n                isFrozen,\n            });\n        }\n    }\n};\nSuggestModel = SuggestModel_1 = __decorate([\n    __param(1, IEditorWorkerService),\n    __param(2, IClipboardService),\n    __param(3, ITelemetryService),\n    __param(4, ILogService),\n    __param(5, IContextKeyService),\n    __param(6, IConfigurationService),\n    __param(7, ILanguageFeaturesService),\n    __param(8, IEnvironmentService)\n], SuggestModel);\nexport { SuggestModel };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nexport class OvertypingCapturer {\n    static { this._maxSelectionLength = 51200; }\n    constructor(editor, suggestModel) {\n        this._disposables = new DisposableStore();\n        this._lastOvertyped = [];\n        this._locked = false;\n        this._disposables.add(editor.onWillType(() => {\n            if (this._locked || !editor.hasModel()) {\n                return;\n            }\n            const selections = editor.getSelections();\n            const selectionsLength = selections.length;\n            // Check if it will overtype any selections\n            let willOvertype = false;\n            for (let i = 0; i < selectionsLength; i++) {\n                if (!selections[i].isEmpty()) {\n                    willOvertype = true;\n                    break;\n                }\n            }\n            if (!willOvertype) {\n                if (this._lastOvertyped.length !== 0) {\n                    this._lastOvertyped.length = 0;\n                }\n                return;\n            }\n            this._lastOvertyped = [];\n            const model = editor.getModel();\n            for (let i = 0; i < selectionsLength; i++) {\n                const selection = selections[i];\n                // Check for overtyping capturer restrictions\n                if (model.getValueLengthInRange(selection) > OvertypingCapturer._maxSelectionLength) {\n                    return;\n                }\n                this._lastOvertyped[i] = { value: model.getValueInRange(selection), multiline: selection.startLineNumber !== selection.endLineNumber };\n            }\n        }));\n        this._disposables.add(suggestModel.onDidTrigger(e => {\n            this._locked = true;\n        }));\n        this._disposables.add(suggestModel.onDidCancel(e => {\n            this._locked = false;\n        }));\n    }\n    getLastOvertypedInfo(idx) {\n        if (idx >= 0 && idx < this._lastOvertyped.length) {\n            return this._lastOvertyped[idx];\n        }\n        return undefined;\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ActionBar } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { TextOnlyMenuEntryActionViewItem } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IMenuService, MenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nlet SuggestWidgetStatus = class SuggestWidgetStatus {\n    constructor(container, _menuId, instantiationService, _menuService, _contextKeyService) {\n        this._menuId = _menuId;\n        this._menuService = _menuService;\n        this._contextKeyService = _contextKeyService;\n        this._menuDisposables = new DisposableStore();\n        this.element = dom.append(container, dom.$('.suggest-status-bar'));\n        const actionViewItemProvider = (action => {\n            return action instanceof MenuItemAction ? instantiationService.createInstance(TextOnlyMenuEntryActionViewItem, action, { useComma: true }) : undefined;\n        });\n        this._leftActions = new ActionBar(this.element, { actionViewItemProvider });\n        this._rightActions = new ActionBar(this.element, { actionViewItemProvider });\n        this._leftActions.domNode.classList.add('left');\n        this._rightActions.domNode.classList.add('right');\n    }\n    dispose() {\n        this._menuDisposables.dispose();\n        this._leftActions.dispose();\n        this._rightActions.dispose();\n        this.element.remove();\n    }\n    show() {\n        const menu = this._menuService.createMenu(this._menuId, this._contextKeyService);\n        const renderMenu = () => {\n            const left = [];\n            const right = [];\n            for (const [group, actions] of menu.getActions()) {\n                if (group === 'left') {\n                    left.push(...actions);\n                }\n                else {\n                    right.push(...actions);\n                }\n            }\n            this._leftActions.clear();\n            this._leftActions.push(left);\n            this._rightActions.clear();\n            this._rightActions.push(right);\n        };\n        this._menuDisposables.add(menu.onDidChange(() => renderMenu()));\n        this._menuDisposables.add(menu);\n    }\n    hide() {\n        this._menuDisposables.clear();\n    }\n};\nSuggestWidgetStatus = __decorate([\n    __param(2, IInstantiationService),\n    __param(3, IMenuService),\n    __param(4, IContextKeyService)\n], SuggestWidgetStatus);\nexport { SuggestWidgetStatus };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { DomScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../../browser/widget/markdownRenderer/browser/markdownRenderer.js';\nimport { ResizableHTMLElement } from '../../../../base/browser/ui/resizable/resizable.js';\nimport * as nls from '../../../../nls.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nexport function canExpandCompletionItem(item) {\n    return !!item && Boolean(item.completion.documentation || item.completion.detail && item.completion.detail !== item.completion.label);\n}\nlet SuggestDetailsWidget = class SuggestDetailsWidget {\n    constructor(_editor, instaService) {\n        this._editor = _editor;\n        this._onDidClose = new Emitter();\n        this.onDidClose = this._onDidClose.event;\n        this._onDidChangeContents = new Emitter();\n        this.onDidChangeContents = this._onDidChangeContents.event;\n        this._disposables = new DisposableStore();\n        this._renderDisposeable = new DisposableStore();\n        this._borderWidth = 1;\n        this._size = new dom.Dimension(330, 0);\n        this.domNode = dom.$('.suggest-details');\n        this.domNode.classList.add('no-docs');\n        this._markdownRenderer = instaService.createInstance(MarkdownRenderer, { editor: _editor });\n        this._body = dom.$('.body');\n        this._scrollbar = new DomScrollableElement(this._body, {\n            alwaysConsumeMouseWheel: true,\n        });\n        dom.append(this.domNode, this._scrollbar.getDomNode());\n        this._disposables.add(this._scrollbar);\n        this._header = dom.append(this._body, dom.$('.header'));\n        this._close = dom.append(this._header, dom.$('span' + ThemeIcon.asCSSSelector(Codicon.close)));\n        this._close.title = nls.localize('details.close', \"Close\");\n        this._type = dom.append(this._header, dom.$('p.type'));\n        this._docs = dom.append(this._body, dom.$('p.docs'));\n        this._configureFont();\n        this._disposables.add(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(50 /* EditorOption.fontInfo */)) {\n                this._configureFont();\n            }\n        }));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._renderDisposeable.dispose();\n    }\n    _configureFont() {\n        const options = this._editor.getOptions();\n        const fontInfo = options.get(50 /* EditorOption.fontInfo */);\n        const fontFamily = fontInfo.getMassagedFontFamily();\n        const fontSize = options.get(120 /* EditorOption.suggestFontSize */) || fontInfo.fontSize;\n        const lineHeight = options.get(121 /* EditorOption.suggestLineHeight */) || fontInfo.lineHeight;\n        const fontWeight = fontInfo.fontWeight;\n        const fontSizePx = `${fontSize}px`;\n        const lineHeightPx = `${lineHeight}px`;\n        this.domNode.style.fontSize = fontSizePx;\n        this.domNode.style.lineHeight = `${lineHeight / fontSize}`;\n        this.domNode.style.fontWeight = fontWeight;\n        this.domNode.style.fontFeatureSettings = fontInfo.fontFeatureSettings;\n        this._type.style.fontFamily = fontFamily;\n        this._close.style.height = lineHeightPx;\n        this._close.style.width = lineHeightPx;\n    }\n    getLayoutInfo() {\n        const lineHeight = this._editor.getOption(121 /* EditorOption.suggestLineHeight */) || this._editor.getOption(50 /* EditorOption.fontInfo */).lineHeight;\n        const borderWidth = this._borderWidth;\n        const borderHeight = borderWidth * 2;\n        return {\n            lineHeight,\n            borderWidth,\n            borderHeight,\n            verticalPadding: 22,\n            horizontalPadding: 14\n        };\n    }\n    renderLoading() {\n        this._type.textContent = nls.localize('loading', \"Loading...\");\n        this._docs.textContent = '';\n        this.domNode.classList.remove('no-docs', 'no-type');\n        this.layout(this.size.width, this.getLayoutInfo().lineHeight * 2);\n        this._onDidChangeContents.fire(this);\n    }\n    renderItem(item, explainMode) {\n        this._renderDisposeable.clear();\n        let { detail, documentation } = item.completion;\n        if (explainMode) {\n            let md = '';\n            md += `score: ${item.score[0]}\\n`;\n            md += `prefix: ${item.word ?? '(no prefix)'}\\n`;\n            md += `word: ${item.completion.filterText ? item.completion.filterText + ' (filterText)' : item.textLabel}\\n`;\n            md += `distance: ${item.distance} (localityBonus-setting)\\n`;\n            md += `index: ${item.idx}, based on ${item.completion.sortText && `sortText: \"${item.completion.sortText}\"` || 'label'}\\n`;\n            md += `commit_chars: ${item.completion.commitCharacters?.join('')}\\n`;\n            documentation = new MarkdownString().appendCodeblock('empty', md);\n            detail = `Provider: ${item.provider._debugDisplayName}`;\n        }\n        if (!explainMode && !canExpandCompletionItem(item)) {\n            this.clearContents();\n            return;\n        }\n        this.domNode.classList.remove('no-docs', 'no-type');\n        // --- details\n        if (detail) {\n            const cappedDetail = detail.length > 100000 ? `${detail.substr(0, 100000)}…` : detail;\n            this._type.textContent = cappedDetail;\n            this._type.title = cappedDetail;\n            dom.show(this._type);\n            this._type.classList.toggle('auto-wrap', !/\\r?\\n^\\s+/gmi.test(cappedDetail));\n        }\n        else {\n            dom.clearNode(this._type);\n            this._type.title = '';\n            dom.hide(this._type);\n            this.domNode.classList.add('no-type');\n        }\n        // --- documentation\n        dom.clearNode(this._docs);\n        if (typeof documentation === 'string') {\n            this._docs.classList.remove('markdown-docs');\n            this._docs.textContent = documentation;\n        }\n        else if (documentation) {\n            this._docs.classList.add('markdown-docs');\n            dom.clearNode(this._docs);\n            const renderedContents = this._markdownRenderer.render(documentation);\n            this._docs.appendChild(renderedContents.element);\n            this._renderDisposeable.add(renderedContents);\n            this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync(() => {\n                this.layout(this._size.width, this._type.clientHeight + this._docs.clientHeight);\n                this._onDidChangeContents.fire(this);\n            }));\n        }\n        this.domNode.style.userSelect = 'text';\n        this.domNode.tabIndex = -1;\n        this._close.onmousedown = e => {\n            e.preventDefault();\n            e.stopPropagation();\n        };\n        this._close.onclick = e => {\n            e.preventDefault();\n            e.stopPropagation();\n            this._onDidClose.fire();\n        };\n        this._body.scrollTop = 0;\n        this.layout(this._size.width, this._type.clientHeight + this._docs.clientHeight);\n        this._onDidChangeContents.fire(this);\n    }\n    clearContents() {\n        this.domNode.classList.add('no-docs');\n        this._type.textContent = '';\n        this._docs.textContent = '';\n    }\n    get isEmpty() {\n        return this.domNode.classList.contains('no-docs');\n    }\n    get size() {\n        return this._size;\n    }\n    layout(width, height) {\n        const newSize = new dom.Dimension(width, height);\n        if (!dom.Dimension.equals(newSize, this._size)) {\n            this._size = newSize;\n            dom.size(this.domNode, width, height);\n        }\n        this._scrollbar.scanDomNode();\n    }\n    scrollDown(much = 8) {\n        this._body.scrollTop += much;\n    }\n    scrollUp(much = 8) {\n        this._body.scrollTop -= much;\n    }\n    scrollTop() {\n        this._body.scrollTop = 0;\n    }\n    scrollBottom() {\n        this._body.scrollTop = this._body.scrollHeight;\n    }\n    pageDown() {\n        this.scrollDown(80);\n    }\n    pageUp() {\n        this.scrollUp(80);\n    }\n    set borderWidth(width) {\n        this._borderWidth = width;\n    }\n    get borderWidth() {\n        return this._borderWidth;\n    }\n};\nSuggestDetailsWidget = __decorate([\n    __param(1, IInstantiationService)\n], SuggestDetailsWidget);\nexport { SuggestDetailsWidget };\nexport class SuggestDetailsOverlay {\n    constructor(widget, _editor) {\n        this.widget = widget;\n        this._editor = _editor;\n        this.allowEditorOverflow = true;\n        this._disposables = new DisposableStore();\n        this._added = false;\n        this._preferAlignAtTop = true;\n        this._resizable = new ResizableHTMLElement();\n        this._resizable.domNode.classList.add('suggest-details-container');\n        this._resizable.domNode.appendChild(widget.domNode);\n        this._resizable.enableSashes(false, true, true, false);\n        let topLeftNow;\n        let sizeNow;\n        let deltaTop = 0;\n        let deltaLeft = 0;\n        this._disposables.add(this._resizable.onDidWillResize(() => {\n            topLeftNow = this._topLeft;\n            sizeNow = this._resizable.size;\n        }));\n        this._disposables.add(this._resizable.onDidResize(e => {\n            if (topLeftNow && sizeNow) {\n                this.widget.layout(e.dimension.width, e.dimension.height);\n                let updateTopLeft = false;\n                if (e.west) {\n                    deltaLeft = sizeNow.width - e.dimension.width;\n                    updateTopLeft = true;\n                }\n                if (e.north) {\n                    deltaTop = sizeNow.height - e.dimension.height;\n                    updateTopLeft = true;\n                }\n                if (updateTopLeft) {\n                    this._applyTopLeft({\n                        top: topLeftNow.top + deltaTop,\n                        left: topLeftNow.left + deltaLeft,\n                    });\n                }\n            }\n            if (e.done) {\n                topLeftNow = undefined;\n                sizeNow = undefined;\n                deltaTop = 0;\n                deltaLeft = 0;\n                this._userSize = e.dimension;\n            }\n        }));\n        this._disposables.add(this.widget.onDidChangeContents(() => {\n            if (this._anchorBox) {\n                this._placeAtAnchor(this._anchorBox, this._userSize ?? this.widget.size, this._preferAlignAtTop);\n            }\n        }));\n    }\n    dispose() {\n        this._resizable.dispose();\n        this._disposables.dispose();\n        this.hide();\n    }\n    getId() {\n        return 'suggest.details';\n    }\n    getDomNode() {\n        return this._resizable.domNode;\n    }\n    getPosition() {\n        return this._topLeft ? { preference: this._topLeft } : null;\n    }\n    show() {\n        if (!this._added) {\n            this._editor.addOverlayWidget(this);\n            this._added = true;\n        }\n    }\n    hide(sessionEnded = false) {\n        this._resizable.clearSashHoverState();\n        if (this._added) {\n            this._editor.removeOverlayWidget(this);\n            this._added = false;\n            this._anchorBox = undefined;\n            this._topLeft = undefined;\n        }\n        if (sessionEnded) {\n            this._userSize = undefined;\n            this.widget.clearContents();\n        }\n    }\n    placeAtAnchor(anchor, preferAlignAtTop) {\n        const anchorBox = anchor.getBoundingClientRect();\n        this._anchorBox = anchorBox;\n        this._preferAlignAtTop = preferAlignAtTop;\n        this._placeAtAnchor(this._anchorBox, this._userSize ?? this.widget.size, preferAlignAtTop);\n    }\n    _placeAtAnchor(anchorBox, size, preferAlignAtTop) {\n        const bodyBox = dom.getClientArea(this.getDomNode().ownerDocument.body);\n        const info = this.widget.getLayoutInfo();\n        const defaultMinSize = new dom.Dimension(220, 2 * info.lineHeight);\n        const defaultTop = anchorBox.top;\n        // EAST\n        const eastPlacement = (function () {\n            const width = bodyBox.width - (anchorBox.left + anchorBox.width + info.borderWidth + info.horizontalPadding);\n            const left = -info.borderWidth + anchorBox.left + anchorBox.width;\n            const maxSizeTop = new dom.Dimension(width, bodyBox.height - anchorBox.top - info.borderHeight - info.verticalPadding);\n            const maxSizeBottom = maxSizeTop.with(undefined, anchorBox.top + anchorBox.height - info.borderHeight - info.verticalPadding);\n            return { top: defaultTop, left, fit: width - size.width, maxSizeTop, maxSizeBottom, minSize: defaultMinSize.with(Math.min(width, defaultMinSize.width)) };\n        })();\n        // WEST\n        const westPlacement = (function () {\n            const width = anchorBox.left - info.borderWidth - info.horizontalPadding;\n            const left = Math.max(info.horizontalPadding, anchorBox.left - size.width - info.borderWidth);\n            const maxSizeTop = new dom.Dimension(width, bodyBox.height - anchorBox.top - info.borderHeight - info.verticalPadding);\n            const maxSizeBottom = maxSizeTop.with(undefined, anchorBox.top + anchorBox.height - info.borderHeight - info.verticalPadding);\n            return { top: defaultTop, left, fit: width - size.width, maxSizeTop, maxSizeBottom, minSize: defaultMinSize.with(Math.min(width, defaultMinSize.width)) };\n        })();\n        // SOUTH\n        const southPacement = (function () {\n            const left = anchorBox.left;\n            const top = -info.borderWidth + anchorBox.top + anchorBox.height;\n            const maxSizeBottom = new dom.Dimension(anchorBox.width - info.borderHeight, bodyBox.height - anchorBox.top - anchorBox.height - info.verticalPadding);\n            return { top, left, fit: maxSizeBottom.height - size.height, maxSizeBottom, maxSizeTop: maxSizeBottom, minSize: defaultMinSize.with(maxSizeBottom.width) };\n        })();\n        // take first placement that fits or the first with \"least bad\" fit\n        const placements = [eastPlacement, westPlacement, southPacement];\n        const placement = placements.find(p => p.fit >= 0) ?? placements.sort((a, b) => b.fit - a.fit)[0];\n        // top/bottom placement\n        const bottom = anchorBox.top + anchorBox.height - info.borderHeight;\n        let alignAtTop;\n        let height = size.height;\n        const maxHeight = Math.max(placement.maxSizeTop.height, placement.maxSizeBottom.height);\n        if (height > maxHeight) {\n            height = maxHeight;\n        }\n        let maxSize;\n        if (preferAlignAtTop) {\n            if (height <= placement.maxSizeTop.height) {\n                alignAtTop = true;\n                maxSize = placement.maxSizeTop;\n            }\n            else {\n                alignAtTop = false;\n                maxSize = placement.maxSizeBottom;\n            }\n        }\n        else {\n            if (height <= placement.maxSizeBottom.height) {\n                alignAtTop = false;\n                maxSize = placement.maxSizeBottom;\n            }\n            else {\n                alignAtTop = true;\n                maxSize = placement.maxSizeTop;\n            }\n        }\n        let { top, left } = placement;\n        if (!alignAtTop && height > anchorBox.height) {\n            top = bottom - height;\n        }\n        const editorDomNode = this._editor.getDomNode();\n        if (editorDomNode) {\n            // get bounding rectangle of the suggest widget relative to the editor\n            const editorBoundingBox = editorDomNode.getBoundingClientRect();\n            top -= editorBoundingBox.top;\n            left -= editorBoundingBox.left;\n        }\n        this._applyTopLeft({ left, top });\n        this._resizable.enableSashes(!alignAtTop, placement === eastPlacement, alignAtTop, placement !== eastPlacement);\n        this._resizable.minSize = placement.minSize;\n        this._resizable.maxSize = maxSize;\n        this._resizable.layout(height, Math.min(maxSize.width, size.width));\n        this.widget.layout(this._resizable.size.width, this._resizable.size.height);\n    }\n    _applyTopLeft(topLeft) {\n        this._topLeft = topLeft;\n        this._editor.layoutOverlayWidget(this);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { $, append, hide, show } from '../../../../base/browser/dom.js';\nimport { IconLabel } from '../../../../base/browser/ui/iconLabel/iconLabel.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { createMatches } from '../../../../base/common/filters.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { CompletionItemKinds } from '../../../common/languages.js';\nimport { getIconClasses } from '../../../common/services/getIconClasses.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport * as nls from '../../../../nls.js';\nimport { FileKind } from '../../../../platform/files/common/files.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { canExpandCompletionItem } from './suggestWidgetDetails.js';\nexport function getAriaId(index) {\n    return `suggest-aria-id:${index}`;\n}\nconst suggestMoreInfoIcon = registerIcon('suggest-more-info', Codicon.chevronRight, nls.localize('suggestMoreInfoIcon', 'Icon for more information in the suggest widget.'));\nconst _completionItemColor = new class ColorExtractor {\n    static { this._regexRelaxed = /(#([\\da-fA-F]{3}){1,2}|(rgb|hsl)a\\(\\s*(\\d{1,3}%?\\s*,\\s*){3}(1|0?\\.\\d+)\\)|(rgb|hsl)\\(\\s*\\d{1,3}%?(\\s*,\\s*\\d{1,3}%?){2}\\s*\\))/; }\n    static { this._regexStrict = new RegExp(`^${ColorExtractor._regexRelaxed.source}$`, 'i'); }\n    extract(item, out) {\n        if (item.textLabel.match(ColorExtractor._regexStrict)) {\n            out[0] = item.textLabel;\n            return true;\n        }\n        if (item.completion.detail && item.completion.detail.match(ColorExtractor._regexStrict)) {\n            out[0] = item.completion.detail;\n            return true;\n        }\n        if (item.completion.documentation) {\n            const value = typeof item.completion.documentation === 'string'\n                ? item.completion.documentation\n                : item.completion.documentation.value;\n            const match = ColorExtractor._regexRelaxed.exec(value);\n            if (match && (match.index === 0 || match.index + match[0].length === value.length)) {\n                out[0] = match[0];\n                return true;\n            }\n        }\n        return false;\n    }\n};\nlet ItemRenderer = class ItemRenderer {\n    constructor(_editor, _modelService, _languageService, _themeService) {\n        this._editor = _editor;\n        this._modelService = _modelService;\n        this._languageService = _languageService;\n        this._themeService = _themeService;\n        this._onDidToggleDetails = new Emitter();\n        this.onDidToggleDetails = this._onDidToggleDetails.event;\n        this.templateId = 'suggestion';\n    }\n    dispose() {\n        this._onDidToggleDetails.dispose();\n    }\n    renderTemplate(container) {\n        const disposables = new DisposableStore();\n        const root = container;\n        root.classList.add('show-file-icons');\n        const icon = append(container, $('.icon'));\n        const colorspan = append(icon, $('span.colorspan'));\n        const text = append(container, $('.contents'));\n        const main = append(text, $('.main'));\n        const iconContainer = append(main, $('.icon-label.codicon'));\n        const left = append(main, $('span.left'));\n        const right = append(main, $('span.right'));\n        const iconLabel = new IconLabel(left, { supportHighlights: true, supportIcons: true });\n        disposables.add(iconLabel);\n        const parametersLabel = append(left, $('span.signature-label'));\n        const qualifierLabel = append(left, $('span.qualifier-label'));\n        const detailsLabel = append(right, $('span.details-label'));\n        const readMore = append(right, $('span.readMore' + ThemeIcon.asCSSSelector(suggestMoreInfoIcon)));\n        readMore.title = nls.localize('readMore', \"Read More\");\n        const configureFont = () => {\n            const options = this._editor.getOptions();\n            const fontInfo = options.get(50 /* EditorOption.fontInfo */);\n            const fontFamily = fontInfo.getMassagedFontFamily();\n            const fontFeatureSettings = fontInfo.fontFeatureSettings;\n            const fontSize = options.get(120 /* EditorOption.suggestFontSize */) || fontInfo.fontSize;\n            const lineHeight = options.get(121 /* EditorOption.suggestLineHeight */) || fontInfo.lineHeight;\n            const fontWeight = fontInfo.fontWeight;\n            const letterSpacing = fontInfo.letterSpacing;\n            const fontSizePx = `${fontSize}px`;\n            const lineHeightPx = `${lineHeight}px`;\n            const letterSpacingPx = `${letterSpacing}px`;\n            root.style.fontSize = fontSizePx;\n            root.style.fontWeight = fontWeight;\n            root.style.letterSpacing = letterSpacingPx;\n            main.style.fontFamily = fontFamily;\n            main.style.fontFeatureSettings = fontFeatureSettings;\n            main.style.lineHeight = lineHeightPx;\n            icon.style.height = lineHeightPx;\n            icon.style.width = lineHeightPx;\n            readMore.style.height = lineHeightPx;\n            readMore.style.width = lineHeightPx;\n        };\n        return { root, left, right, icon, colorspan, iconLabel, iconContainer, parametersLabel, qualifierLabel, detailsLabel, readMore, disposables, configureFont };\n    }\n    renderElement(element, index, data) {\n        data.configureFont();\n        const { completion } = element;\n        data.root.id = getAriaId(index);\n        data.colorspan.style.backgroundColor = '';\n        const labelOptions = {\n            labelEscapeNewLines: true,\n            matches: createMatches(element.score)\n        };\n        const color = [];\n        if (completion.kind === 19 /* CompletionItemKind.Color */ && _completionItemColor.extract(element, color)) {\n            // special logic for 'color' completion items\n            data.icon.className = 'icon customcolor';\n            data.iconContainer.className = 'icon hide';\n            data.colorspan.style.backgroundColor = color[0];\n        }\n        else if (completion.kind === 20 /* CompletionItemKind.File */ && this._themeService.getFileIconTheme().hasFileIcons) {\n            // special logic for 'file' completion items\n            data.icon.className = 'icon hide';\n            data.iconContainer.className = 'icon hide';\n            const labelClasses = getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: element.textLabel }), FileKind.FILE);\n            const detailClasses = getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: completion.detail }), FileKind.FILE);\n            labelOptions.extraClasses = labelClasses.length > detailClasses.length ? labelClasses : detailClasses;\n        }\n        else if (completion.kind === 23 /* CompletionItemKind.Folder */ && this._themeService.getFileIconTheme().hasFolderIcons) {\n            // special logic for 'folder' completion items\n            data.icon.className = 'icon hide';\n            data.iconContainer.className = 'icon hide';\n            labelOptions.extraClasses = [\n                getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: element.textLabel }), FileKind.FOLDER),\n                getIconClasses(this._modelService, this._languageService, URI.from({ scheme: 'fake', path: completion.detail }), FileKind.FOLDER)\n            ].flat();\n        }\n        else {\n            // normal icon\n            data.icon.className = 'icon hide';\n            data.iconContainer.className = '';\n            data.iconContainer.classList.add('suggest-icon', ...ThemeIcon.asClassNameArray(CompletionItemKinds.toIcon(completion.kind)));\n        }\n        if (completion.tags && completion.tags.indexOf(1 /* CompletionItemTag.Deprecated */) >= 0) {\n            labelOptions.extraClasses = (labelOptions.extraClasses || []).concat(['deprecated']);\n            labelOptions.matches = [];\n        }\n        data.iconLabel.setLabel(element.textLabel, undefined, labelOptions);\n        if (typeof completion.label === 'string') {\n            data.parametersLabel.textContent = '';\n            data.detailsLabel.textContent = stripNewLines(completion.detail || '');\n            data.root.classList.add('string-label');\n        }\n        else {\n            data.parametersLabel.textContent = stripNewLines(completion.label.detail || '');\n            data.detailsLabel.textContent = stripNewLines(completion.label.description || '');\n            data.root.classList.remove('string-label');\n        }\n        if (this._editor.getOption(119 /* EditorOption.suggest */).showInlineDetails) {\n            show(data.detailsLabel);\n        }\n        else {\n            hide(data.detailsLabel);\n        }\n        if (canExpandCompletionItem(element)) {\n            data.right.classList.add('can-expand-details');\n            show(data.readMore);\n            data.readMore.onmousedown = e => {\n                e.stopPropagation();\n                e.preventDefault();\n            };\n            data.readMore.onclick = e => {\n                e.stopPropagation();\n                e.preventDefault();\n                this._onDidToggleDetails.fire();\n            };\n        }\n        else {\n            data.right.classList.remove('can-expand-details');\n            hide(data.readMore);\n            data.readMore.onmousedown = null;\n            data.readMore.onclick = null;\n        }\n    }\n    disposeTemplate(templateData) {\n        templateData.disposables.dispose();\n    }\n};\nItemRenderer = __decorate([\n    __param(1, IModelService),\n    __param(2, ILanguageService),\n    __param(3, IThemeService)\n], ItemRenderer);\nexport { ItemRenderer };\nfunction stripNewLines(str) {\n    return str.replace(/\\r\\n|\\r|\\n/g, '');\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SuggestWidget_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport '../../../../base/browser/ui/codicons/codiconStyles.js'; // The codicon symbol styles are defined here and must be loaded\nimport { List } from '../../../../base/browser/ui/list/listWidget.js';\nimport { createCancelablePromise, disposableTimeout, TimeoutTimer } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter, PauseableEmitter } from '../../../../base/common/event.js';\nimport { DisposableStore, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { clamp } from '../../../../base/common/numbers.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport './media/suggest.css';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/codeEditor/embeddedCodeEditorWidget.js';\nimport { SuggestWidgetStatus } from './suggestWidgetStatus.js';\nimport '../../symbolIcons/browser/symbolIcons.js'; // The codicon symbol colors are defined here and must be loaded to get colors\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nimport { activeContrastBorder, editorForeground, editorWidgetBackground, editorWidgetBorder, listFocusHighlightForeground, listHighlightForeground, quickInputListFocusBackground, quickInputListFocusForeground, quickInputListFocusIconForeground, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { ResizableHTMLElement } from '../../../../base/browser/ui/resizable/resizable.js';\nimport { Context as SuggestContext, suggestWidgetStatusbarMenu } from './suggest.js';\nimport { canExpandCompletionItem, SuggestDetailsOverlay, SuggestDetailsWidget } from './suggestWidgetDetails.js';\nimport { getAriaId, ItemRenderer } from './suggestWidgetRenderer.js';\nimport { getListStyles } from '../../../../platform/theme/browser/defaultStyles.js';\nimport { status } from '../../../../base/browser/ui/aria/aria.js';\n/**\n * Suggest widget colors\n */\nregisterColor('editorSuggestWidget.background', editorWidgetBackground, nls.localize('editorSuggestWidgetBackground', 'Background color of the suggest widget.'));\nregisterColor('editorSuggestWidget.border', editorWidgetBorder, nls.localize('editorSuggestWidgetBorder', 'Border color of the suggest widget.'));\nconst editorSuggestWidgetForeground = registerColor('editorSuggestWidget.foreground', editorForeground, nls.localize('editorSuggestWidgetForeground', 'Foreground color of the suggest widget.'));\nregisterColor('editorSuggestWidget.selectedForeground', quickInputListFocusForeground, nls.localize('editorSuggestWidgetSelectedForeground', 'Foreground color of the selected entry in the suggest widget.'));\nregisterColor('editorSuggestWidget.selectedIconForeground', quickInputListFocusIconForeground, nls.localize('editorSuggestWidgetSelectedIconForeground', 'Icon foreground color of the selected entry in the suggest widget.'));\nexport const editorSuggestWidgetSelectedBackground = registerColor('editorSuggestWidget.selectedBackground', quickInputListFocusBackground, nls.localize('editorSuggestWidgetSelectedBackground', 'Background color of the selected entry in the suggest widget.'));\nregisterColor('editorSuggestWidget.highlightForeground', listHighlightForeground, nls.localize('editorSuggestWidgetHighlightForeground', 'Color of the match highlights in the suggest widget.'));\nregisterColor('editorSuggestWidget.focusHighlightForeground', listFocusHighlightForeground, nls.localize('editorSuggestWidgetFocusHighlightForeground', 'Color of the match highlights in the suggest widget when an item is focused.'));\nregisterColor('editorSuggestWidgetStatus.foreground', transparent(editorSuggestWidgetForeground, .5), nls.localize('editorSuggestWidgetStatusForeground', 'Foreground color of the suggest widget status.'));\nclass PersistedWidgetSize {\n    constructor(_service, editor) {\n        this._service = _service;\n        this._key = `suggestWidget.size/${editor.getEditorType()}/${editor instanceof EmbeddedCodeEditorWidget}`;\n    }\n    restore() {\n        const raw = this._service.get(this._key, 0 /* StorageScope.PROFILE */) ?? '';\n        try {\n            const obj = JSON.parse(raw);\n            if (dom.Dimension.is(obj)) {\n                return dom.Dimension.lift(obj);\n            }\n        }\n        catch {\n            // ignore\n        }\n        return undefined;\n    }\n    store(size) {\n        this._service.store(this._key, JSON.stringify(size), 0 /* StorageScope.PROFILE */, 1 /* StorageTarget.MACHINE */);\n    }\n    reset() {\n        this._service.remove(this._key, 0 /* StorageScope.PROFILE */);\n    }\n}\nlet SuggestWidget = class SuggestWidget {\n    static { SuggestWidget_1 = this; }\n    static { this.LOADING_MESSAGE = nls.localize('suggestWidget.loading', \"Loading...\"); }\n    static { this.NO_SUGGESTIONS_MESSAGE = nls.localize('suggestWidget.noSuggestions', \"No suggestions.\"); }\n    constructor(editor, _storageService, _contextKeyService, _themeService, instantiationService) {\n        this.editor = editor;\n        this._storageService = _storageService;\n        this._state = 0 /* State.Hidden */;\n        this._isAuto = false;\n        this._pendingLayout = new MutableDisposable();\n        this._pendingShowDetails = new MutableDisposable();\n        this._ignoreFocusEvents = false;\n        this._forceRenderingAbove = false;\n        this._explainMode = false;\n        this._showTimeout = new TimeoutTimer();\n        this._disposables = new DisposableStore();\n        this._onDidSelect = new PauseableEmitter();\n        this._onDidFocus = new PauseableEmitter();\n        this._onDidHide = new Emitter();\n        this._onDidShow = new Emitter();\n        this.onDidSelect = this._onDidSelect.event;\n        this.onDidFocus = this._onDidFocus.event;\n        this.onDidHide = this._onDidHide.event;\n        this.onDidShow = this._onDidShow.event;\n        this._onDetailsKeydown = new Emitter();\n        this.onDetailsKeyDown = this._onDetailsKeydown.event;\n        this.element = new ResizableHTMLElement();\n        this.element.domNode.classList.add('editor-widget', 'suggest-widget');\n        this._contentWidget = new SuggestContentWidget(this, editor);\n        this._persistedSize = new PersistedWidgetSize(_storageService, editor);\n        class ResizeState {\n            constructor(persistedSize, currentSize, persistHeight = false, persistWidth = false) {\n                this.persistedSize = persistedSize;\n                this.currentSize = currentSize;\n                this.persistHeight = persistHeight;\n                this.persistWidth = persistWidth;\n            }\n        }\n        let state;\n        this._disposables.add(this.element.onDidWillResize(() => {\n            this._contentWidget.lockPreference();\n            state = new ResizeState(this._persistedSize.restore(), this.element.size);\n        }));\n        this._disposables.add(this.element.onDidResize(e => {\n            this._resize(e.dimension.width, e.dimension.height);\n            if (state) {\n                state.persistHeight = state.persistHeight || !!e.north || !!e.south;\n                state.persistWidth = state.persistWidth || !!e.east || !!e.west;\n            }\n            if (!e.done) {\n                return;\n            }\n            if (state) {\n                // only store width or height value that have changed and also\n                // only store changes that are above a certain threshold\n                const { itemHeight, defaultSize } = this.getLayoutInfo();\n                const threshold = Math.round(itemHeight / 2);\n                let { width, height } = this.element.size;\n                if (!state.persistHeight || Math.abs(state.currentSize.height - height) <= threshold) {\n                    height = state.persistedSize?.height ?? defaultSize.height;\n                }\n                if (!state.persistWidth || Math.abs(state.currentSize.width - width) <= threshold) {\n                    width = state.persistedSize?.width ?? defaultSize.width;\n                }\n                this._persistedSize.store(new dom.Dimension(width, height));\n            }\n            // reset working state\n            this._contentWidget.unlockPreference();\n            state = undefined;\n        }));\n        this._messageElement = dom.append(this.element.domNode, dom.$('.message'));\n        this._listElement = dom.append(this.element.domNode, dom.$('.tree'));\n        const details = this._disposables.add(instantiationService.createInstance(SuggestDetailsWidget, this.editor));\n        details.onDidClose(this.toggleDetails, this, this._disposables);\n        this._details = new SuggestDetailsOverlay(details, this.editor);\n        const applyIconStyle = () => this.element.domNode.classList.toggle('no-icons', !this.editor.getOption(119 /* EditorOption.suggest */).showIcons);\n        applyIconStyle();\n        const renderer = instantiationService.createInstance(ItemRenderer, this.editor);\n        this._disposables.add(renderer);\n        this._disposables.add(renderer.onDidToggleDetails(() => this.toggleDetails()));\n        this._list = new List('SuggestWidget', this._listElement, {\n            getHeight: (_element) => this.getLayoutInfo().itemHeight,\n            getTemplateId: (_element) => 'suggestion'\n        }, [renderer], {\n            alwaysConsumeMouseWheel: true,\n            useShadows: false,\n            mouseSupport: false,\n            multipleSelectionSupport: false,\n            accessibilityProvider: {\n                getRole: () => 'option',\n                getWidgetAriaLabel: () => nls.localize('suggest', \"Suggest\"),\n                getWidgetRole: () => 'listbox',\n                getAriaLabel: (item) => {\n                    let label = item.textLabel;\n                    if (typeof item.completion.label !== 'string') {\n                        const { detail, description } = item.completion.label;\n                        if (detail && description) {\n                            label = nls.localize('label.full', '{0} {1}, {2}', label, detail, description);\n                        }\n                        else if (detail) {\n                            label = nls.localize('label.detail', '{0} {1}', label, detail);\n                        }\n                        else if (description) {\n                            label = nls.localize('label.desc', '{0}, {1}', label, description);\n                        }\n                    }\n                    if (!item.isResolved || !this._isDetailsVisible()) {\n                        return label;\n                    }\n                    const { documentation, detail } = item.completion;\n                    const docs = strings.format('{0}{1}', detail || '', documentation ? (typeof documentation === 'string' ? documentation : documentation.value) : '');\n                    return nls.localize('ariaCurrenttSuggestionReadDetails', \"{0}, docs: {1}\", label, docs);\n                },\n            }\n        });\n        this._list.style(getListStyles({\n            listInactiveFocusBackground: editorSuggestWidgetSelectedBackground,\n            listInactiveFocusOutline: activeContrastBorder\n        }));\n        this._status = instantiationService.createInstance(SuggestWidgetStatus, this.element.domNode, suggestWidgetStatusbarMenu);\n        const applyStatusBarStyle = () => this.element.domNode.classList.toggle('with-status-bar', this.editor.getOption(119 /* EditorOption.suggest */).showStatusBar);\n        applyStatusBarStyle();\n        this._disposables.add(_themeService.onDidColorThemeChange(t => this._onThemeChange(t)));\n        this._onThemeChange(_themeService.getColorTheme());\n        this._disposables.add(this._list.onMouseDown(e => this._onListMouseDownOrTap(e)));\n        this._disposables.add(this._list.onTap(e => this._onListMouseDownOrTap(e)));\n        this._disposables.add(this._list.onDidChangeSelection(e => this._onListSelection(e)));\n        this._disposables.add(this._list.onDidChangeFocus(e => this._onListFocus(e)));\n        this._disposables.add(this.editor.onDidChangeCursorSelection(() => this._onCursorSelectionChanged()));\n        this._disposables.add(this.editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(119 /* EditorOption.suggest */)) {\n                applyStatusBarStyle();\n                applyIconStyle();\n            }\n            if (this._completionModel && (e.hasChanged(50 /* EditorOption.fontInfo */) || e.hasChanged(120 /* EditorOption.suggestFontSize */) || e.hasChanged(121 /* EditorOption.suggestLineHeight */))) {\n                this._list.splice(0, this._list.length, this._completionModel.items);\n            }\n        }));\n        this._ctxSuggestWidgetVisible = SuggestContext.Visible.bindTo(_contextKeyService);\n        this._ctxSuggestWidgetDetailsVisible = SuggestContext.DetailsVisible.bindTo(_contextKeyService);\n        this._ctxSuggestWidgetMultipleSuggestions = SuggestContext.MultipleSuggestions.bindTo(_contextKeyService);\n        this._ctxSuggestWidgetHasFocusedSuggestion = SuggestContext.HasFocusedSuggestion.bindTo(_contextKeyService);\n        this._disposables.add(dom.addStandardDisposableListener(this._details.widget.domNode, 'keydown', e => {\n            this._onDetailsKeydown.fire(e);\n        }));\n        this._disposables.add(this.editor.onMouseDown((e) => this._onEditorMouseDown(e)));\n    }\n    dispose() {\n        this._details.widget.dispose();\n        this._details.dispose();\n        this._list.dispose();\n        this._status.dispose();\n        this._disposables.dispose();\n        this._loadingTimeout?.dispose();\n        this._pendingLayout.dispose();\n        this._pendingShowDetails.dispose();\n        this._showTimeout.dispose();\n        this._contentWidget.dispose();\n        this.element.dispose();\n    }\n    _onEditorMouseDown(mouseEvent) {\n        if (this._details.widget.domNode.contains(mouseEvent.target.element)) {\n            // Clicking inside details\n            this._details.widget.domNode.focus();\n        }\n        else {\n            // Clicking outside details and inside suggest\n            if (this.element.domNode.contains(mouseEvent.target.element)) {\n                this.editor.focus();\n            }\n        }\n    }\n    _onCursorSelectionChanged() {\n        if (this._state !== 0 /* State.Hidden */) {\n            this._contentWidget.layout();\n        }\n    }\n    _onListMouseDownOrTap(e) {\n        if (typeof e.element === 'undefined' || typeof e.index === 'undefined') {\n            return;\n        }\n        // prevent stealing browser focus from the editor\n        e.browserEvent.preventDefault();\n        e.browserEvent.stopPropagation();\n        this._select(e.element, e.index);\n    }\n    _onListSelection(e) {\n        if (e.elements.length) {\n            this._select(e.elements[0], e.indexes[0]);\n        }\n    }\n    _select(item, index) {\n        const completionModel = this._completionModel;\n        if (completionModel) {\n            this._onDidSelect.fire({ item, index, model: completionModel });\n            this.editor.focus();\n        }\n    }\n    _onThemeChange(theme) {\n        this._details.widget.borderWidth = isHighContrast(theme.type) ? 2 : 1;\n    }\n    _onListFocus(e) {\n        if (this._ignoreFocusEvents) {\n            return;\n        }\n        if (!e.elements.length) {\n            if (this._currentSuggestionDetails) {\n                this._currentSuggestionDetails.cancel();\n                this._currentSuggestionDetails = undefined;\n                this._focusedItem = undefined;\n            }\n            this.editor.setAriaOptions({ activeDescendant: undefined });\n            this._ctxSuggestWidgetHasFocusedSuggestion.set(false);\n            return;\n        }\n        if (!this._completionModel) {\n            return;\n        }\n        this._ctxSuggestWidgetHasFocusedSuggestion.set(true);\n        const item = e.elements[0];\n        const index = e.indexes[0];\n        if (item !== this._focusedItem) {\n            this._currentSuggestionDetails?.cancel();\n            this._currentSuggestionDetails = undefined;\n            this._focusedItem = item;\n            this._list.reveal(index);\n            this._currentSuggestionDetails = createCancelablePromise(async (token) => {\n                const loading = disposableTimeout(() => {\n                    if (this._isDetailsVisible()) {\n                        this.showDetails(true);\n                    }\n                }, 250);\n                const sub = token.onCancellationRequested(() => loading.dispose());\n                try {\n                    return await item.resolve(token);\n                }\n                finally {\n                    loading.dispose();\n                    sub.dispose();\n                }\n            });\n            this._currentSuggestionDetails.then(() => {\n                if (index >= this._list.length || item !== this._list.element(index)) {\n                    return;\n                }\n                // item can have extra information, so re-render\n                this._ignoreFocusEvents = true;\n                this._list.splice(index, 1, [item]);\n                this._list.setFocus([index]);\n                this._ignoreFocusEvents = false;\n                if (this._isDetailsVisible()) {\n                    this.showDetails(false);\n                }\n                else {\n                    this.element.domNode.classList.remove('docs-side');\n                }\n                this.editor.setAriaOptions({ activeDescendant: getAriaId(index) });\n            }).catch(onUnexpectedError);\n        }\n        // emit an event\n        this._onDidFocus.fire({ item, index, model: this._completionModel });\n    }\n    _setState(state) {\n        if (this._state === state) {\n            return;\n        }\n        this._state = state;\n        this.element.domNode.classList.toggle('frozen', state === 4 /* State.Frozen */);\n        this.element.domNode.classList.remove('message');\n        switch (state) {\n            case 0 /* State.Hidden */:\n                dom.hide(this._messageElement, this._listElement, this._status.element);\n                this._details.hide(true);\n                this._status.hide();\n                this._contentWidget.hide();\n                this._ctxSuggestWidgetVisible.reset();\n                this._ctxSuggestWidgetMultipleSuggestions.reset();\n                this._ctxSuggestWidgetHasFocusedSuggestion.reset();\n                this._showTimeout.cancel();\n                this.element.domNode.classList.remove('visible');\n                this._list.splice(0, this._list.length);\n                this._focusedItem = undefined;\n                this._cappedHeight = undefined;\n                this._explainMode = false;\n                break;\n            case 1 /* State.Loading */:\n                this.element.domNode.classList.add('message');\n                this._messageElement.textContent = SuggestWidget_1.LOADING_MESSAGE;\n                dom.hide(this._listElement, this._status.element);\n                dom.show(this._messageElement);\n                this._details.hide();\n                this._show();\n                this._focusedItem = undefined;\n                status(SuggestWidget_1.LOADING_MESSAGE);\n                break;\n            case 2 /* State.Empty */:\n                this.element.domNode.classList.add('message');\n                this._messageElement.textContent = SuggestWidget_1.NO_SUGGESTIONS_MESSAGE;\n                dom.hide(this._listElement, this._status.element);\n                dom.show(this._messageElement);\n                this._details.hide();\n                this._show();\n                this._focusedItem = undefined;\n                status(SuggestWidget_1.NO_SUGGESTIONS_MESSAGE);\n                break;\n            case 3 /* State.Open */:\n                dom.hide(this._messageElement);\n                dom.show(this._listElement, this._status.element);\n                this._show();\n                break;\n            case 4 /* State.Frozen */:\n                dom.hide(this._messageElement);\n                dom.show(this._listElement, this._status.element);\n                this._show();\n                break;\n            case 5 /* State.Details */:\n                dom.hide(this._messageElement);\n                dom.show(this._listElement, this._status.element);\n                this._details.show();\n                this._show();\n                break;\n        }\n    }\n    _show() {\n        this._status.show();\n        this._contentWidget.show();\n        this._layout(this._persistedSize.restore());\n        this._ctxSuggestWidgetVisible.set(true);\n        this._showTimeout.cancelAndSet(() => {\n            this.element.domNode.classList.add('visible');\n            this._onDidShow.fire(this);\n        }, 100);\n    }\n    showTriggered(auto, delay) {\n        if (this._state !== 0 /* State.Hidden */) {\n            return;\n        }\n        this._contentWidget.setPosition(this.editor.getPosition());\n        this._isAuto = !!auto;\n        if (!this._isAuto) {\n            this._loadingTimeout = disposableTimeout(() => this._setState(1 /* State.Loading */), delay);\n        }\n    }\n    showSuggestions(completionModel, selectionIndex, isFrozen, isAuto, noFocus) {\n        this._contentWidget.setPosition(this.editor.getPosition());\n        this._loadingTimeout?.dispose();\n        this._currentSuggestionDetails?.cancel();\n        this._currentSuggestionDetails = undefined;\n        if (this._completionModel !== completionModel) {\n            this._completionModel = completionModel;\n        }\n        if (isFrozen && this._state !== 2 /* State.Empty */ && this._state !== 0 /* State.Hidden */) {\n            this._setState(4 /* State.Frozen */);\n            return;\n        }\n        const visibleCount = this._completionModel.items.length;\n        const isEmpty = visibleCount === 0;\n        this._ctxSuggestWidgetMultipleSuggestions.set(visibleCount > 1);\n        if (isEmpty) {\n            this._setState(isAuto ? 0 /* State.Hidden */ : 2 /* State.Empty */);\n            this._completionModel = undefined;\n            return;\n        }\n        this._focusedItem = undefined;\n        // calling list.splice triggers focus event which this widget forwards. That can lead to\n        // suggestions being cancelled and the widget being cleared (and hidden). All this happens\n        // before revealing and focusing is done which means revealing and focusing will fail when\n        // they get run.\n        this._onDidFocus.pause();\n        this._onDidSelect.pause();\n        try {\n            this._list.splice(0, this._list.length, this._completionModel.items);\n            this._setState(isFrozen ? 4 /* State.Frozen */ : 3 /* State.Open */);\n            this._list.reveal(selectionIndex, 0);\n            this._list.setFocus(noFocus ? [] : [selectionIndex]);\n        }\n        finally {\n            this._onDidFocus.resume();\n            this._onDidSelect.resume();\n        }\n        this._pendingLayout.value = dom.runAtThisOrScheduleAtNextAnimationFrame(dom.getWindow(this.element.domNode), () => {\n            this._pendingLayout.clear();\n            this._layout(this.element.size);\n            // Reset focus border\n            this._details.widget.domNode.classList.remove('focused');\n        });\n    }\n    focusSelected() {\n        if (this._list.length > 0) {\n            this._list.setFocus([0]);\n        }\n    }\n    selectNextPage() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.pageDown();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusNextPage();\n                return true;\n        }\n    }\n    selectNext() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusNext(1, true);\n                return true;\n        }\n    }\n    selectLast() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.scrollBottom();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusLast();\n                return true;\n        }\n    }\n    selectPreviousPage() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.pageUp();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusPreviousPage();\n                return true;\n        }\n    }\n    selectPrevious() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusPrevious(1, true);\n                return false;\n        }\n    }\n    selectFirst() {\n        switch (this._state) {\n            case 0 /* State.Hidden */:\n                return false;\n            case 5 /* State.Details */:\n                this._details.widget.scrollTop();\n                return true;\n            case 1 /* State.Loading */:\n                return !this._isAuto;\n            default:\n                this._list.focusFirst();\n                return true;\n        }\n    }\n    getFocusedItem() {\n        if (this._state !== 0 /* State.Hidden */\n            && this._state !== 2 /* State.Empty */\n            && this._state !== 1 /* State.Loading */\n            && this._completionModel\n            && this._list.getFocus().length > 0) {\n            return {\n                item: this._list.getFocusedElements()[0],\n                index: this._list.getFocus()[0],\n                model: this._completionModel\n            };\n        }\n        return undefined;\n    }\n    toggleDetailsFocus() {\n        if (this._state === 5 /* State.Details */) {\n            this._setState(3 /* State.Open */);\n            this._details.widget.domNode.classList.remove('focused');\n        }\n        else if (this._state === 3 /* State.Open */ && this._isDetailsVisible()) {\n            this._setState(5 /* State.Details */);\n            this._details.widget.domNode.classList.add('focused');\n        }\n    }\n    toggleDetails() {\n        if (this._isDetailsVisible()) {\n            // hide details widget\n            this._pendingShowDetails.clear();\n            this._ctxSuggestWidgetDetailsVisible.set(false);\n            this._setDetailsVisible(false);\n            this._details.hide();\n            this.element.domNode.classList.remove('shows-details');\n        }\n        else if ((canExpandCompletionItem(this._list.getFocusedElements()[0]) || this._explainMode) && (this._state === 3 /* State.Open */ || this._state === 5 /* State.Details */ || this._state === 4 /* State.Frozen */)) {\n            // show details widget (iff possible)\n            this._ctxSuggestWidgetDetailsVisible.set(true);\n            this._setDetailsVisible(true);\n            this.showDetails(false);\n        }\n    }\n    showDetails(loading) {\n        this._pendingShowDetails.value = dom.runAtThisOrScheduleAtNextAnimationFrame(dom.getWindow(this.element.domNode), () => {\n            this._pendingShowDetails.clear();\n            this._details.show();\n            if (loading) {\n                this._details.widget.renderLoading();\n            }\n            else {\n                this._details.widget.renderItem(this._list.getFocusedElements()[0], this._explainMode);\n            }\n            if (!this._details.widget.isEmpty) {\n                this._positionDetails();\n                this.element.domNode.classList.add('shows-details');\n            }\n            else {\n                this._details.hide();\n            }\n            this.editor.focus();\n        });\n    }\n    toggleExplainMode() {\n        if (this._list.getFocusedElements()[0]) {\n            this._explainMode = !this._explainMode;\n            if (!this._isDetailsVisible()) {\n                this.toggleDetails();\n            }\n            else {\n                this.showDetails(false);\n            }\n        }\n    }\n    resetPersistedSize() {\n        this._persistedSize.reset();\n    }\n    hideWidget() {\n        this._pendingLayout.clear();\n        this._pendingShowDetails.clear();\n        this._loadingTimeout?.dispose();\n        this._setState(0 /* State.Hidden */);\n        this._onDidHide.fire(this);\n        this.element.clearSashHoverState();\n        // ensure that a reasonable widget height is persisted so that\n        // accidential \"resize-to-single-items\" cases aren't happening\n        const dim = this._persistedSize.restore();\n        const minPersistedHeight = Math.ceil(this.getLayoutInfo().itemHeight * 4.3);\n        if (dim && dim.height < minPersistedHeight) {\n            this._persistedSize.store(dim.with(undefined, minPersistedHeight));\n        }\n    }\n    isFrozen() {\n        return this._state === 4 /* State.Frozen */;\n    }\n    _afterRender(position) {\n        if (position === null) {\n            if (this._isDetailsVisible()) {\n                this._details.hide(); //todo@jrieken soft-hide\n            }\n            return;\n        }\n        if (this._state === 2 /* State.Empty */ || this._state === 1 /* State.Loading */) {\n            // no special positioning when widget isn't showing list\n            return;\n        }\n        if (this._isDetailsVisible() && !this._details.widget.isEmpty) {\n            this._details.show();\n        }\n        this._positionDetails();\n    }\n    _layout(size) {\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        if (!this.editor.getDomNode()) {\n            // happens when running tests\n            return;\n        }\n        const bodyBox = dom.getClientArea(this.element.domNode.ownerDocument.body);\n        const info = this.getLayoutInfo();\n        if (!size) {\n            size = info.defaultSize;\n        }\n        let height = size.height;\n        let width = size.width;\n        // status bar\n        this._status.element.style.height = `${info.itemHeight}px`;\n        if (this._state === 2 /* State.Empty */ || this._state === 1 /* State.Loading */) {\n            // showing a message only\n            height = info.itemHeight + info.borderHeight;\n            width = info.defaultSize.width / 2;\n            this.element.enableSashes(false, false, false, false);\n            this.element.minSize = this.element.maxSize = new dom.Dimension(width, height);\n            this._contentWidget.setPreference(2 /* ContentWidgetPositionPreference.BELOW */);\n        }\n        else {\n            // showing items\n            // width math\n            const maxWidth = bodyBox.width - info.borderHeight - 2 * info.horizontalPadding;\n            if (width > maxWidth) {\n                width = maxWidth;\n            }\n            const preferredWidth = this._completionModel ? this._completionModel.stats.pLabelLen * info.typicalHalfwidthCharacterWidth : width;\n            // height math\n            const fullHeight = info.statusBarHeight + this._list.contentHeight + info.borderHeight;\n            const minHeight = info.itemHeight + info.statusBarHeight;\n            const editorBox = dom.getDomNodePagePosition(this.editor.getDomNode());\n            const cursorBox = this.editor.getScrolledVisiblePosition(this.editor.getPosition());\n            const cursorBottom = editorBox.top + cursorBox.top + cursorBox.height;\n            const maxHeightBelow = Math.min(bodyBox.height - cursorBottom - info.verticalPadding, fullHeight);\n            const availableSpaceAbove = editorBox.top + cursorBox.top - info.verticalPadding;\n            const maxHeightAbove = Math.min(availableSpaceAbove, fullHeight);\n            let maxHeight = Math.min(Math.max(maxHeightAbove, maxHeightBelow) + info.borderHeight, fullHeight);\n            if (height === this._cappedHeight?.capped) {\n                // Restore the old (wanted) height when the current\n                // height is capped to fit\n                height = this._cappedHeight.wanted;\n            }\n            if (height < minHeight) {\n                height = minHeight;\n            }\n            if (height > maxHeight) {\n                height = maxHeight;\n            }\n            const forceRenderingAboveRequiredSpace = 150;\n            if (height > maxHeightBelow || (this._forceRenderingAbove && availableSpaceAbove > forceRenderingAboveRequiredSpace)) {\n                this._contentWidget.setPreference(1 /* ContentWidgetPositionPreference.ABOVE */);\n                this.element.enableSashes(true, true, false, false);\n                maxHeight = maxHeightAbove;\n            }\n            else {\n                this._contentWidget.setPreference(2 /* ContentWidgetPositionPreference.BELOW */);\n                this.element.enableSashes(false, true, true, false);\n                maxHeight = maxHeightBelow;\n            }\n            this.element.preferredSize = new dom.Dimension(preferredWidth, info.defaultSize.height);\n            this.element.maxSize = new dom.Dimension(maxWidth, maxHeight);\n            this.element.minSize = new dom.Dimension(220, minHeight);\n            // Know when the height was capped to fit and remember\n            // the wanted height for later. This is required when going\n            // left to widen suggestions.\n            this._cappedHeight = height === fullHeight\n                ? { wanted: this._cappedHeight?.wanted ?? size.height, capped: height }\n                : undefined;\n        }\n        this._resize(width, height);\n    }\n    _resize(width, height) {\n        const { width: maxWidth, height: maxHeight } = this.element.maxSize;\n        width = Math.min(maxWidth, width);\n        height = Math.min(maxHeight, height);\n        const { statusBarHeight } = this.getLayoutInfo();\n        this._list.layout(height - statusBarHeight, width);\n        this._listElement.style.height = `${height - statusBarHeight}px`;\n        this.element.layout(height, width);\n        this._contentWidget.layout();\n        this._positionDetails();\n    }\n    _positionDetails() {\n        if (this._isDetailsVisible()) {\n            this._details.placeAtAnchor(this.element.domNode, this._contentWidget.getPosition()?.preference[0] === 2 /* ContentWidgetPositionPreference.BELOW */);\n        }\n    }\n    getLayoutInfo() {\n        const fontInfo = this.editor.getOption(50 /* EditorOption.fontInfo */);\n        const itemHeight = clamp(this.editor.getOption(121 /* EditorOption.suggestLineHeight */) || fontInfo.lineHeight, 8, 1000);\n        const statusBarHeight = !this.editor.getOption(119 /* EditorOption.suggest */).showStatusBar || this._state === 2 /* State.Empty */ || this._state === 1 /* State.Loading */ ? 0 : itemHeight;\n        const borderWidth = this._details.widget.borderWidth;\n        const borderHeight = 2 * borderWidth;\n        return {\n            itemHeight,\n            statusBarHeight,\n            borderWidth,\n            borderHeight,\n            typicalHalfwidthCharacterWidth: fontInfo.typicalHalfwidthCharacterWidth,\n            verticalPadding: 22,\n            horizontalPadding: 14,\n            defaultSize: new dom.Dimension(430, statusBarHeight + 12 * itemHeight + borderHeight)\n        };\n    }\n    _isDetailsVisible() {\n        return this._storageService.getBoolean('expandSuggestionDocs', 0 /* StorageScope.PROFILE */, false);\n    }\n    _setDetailsVisible(value) {\n        this._storageService.store('expandSuggestionDocs', value, 0 /* StorageScope.PROFILE */, 0 /* StorageTarget.USER */);\n    }\n    forceRenderingAbove() {\n        if (!this._forceRenderingAbove) {\n            this._forceRenderingAbove = true;\n            this._layout(this._persistedSize.restore());\n        }\n    }\n    stopForceRenderingAbove() {\n        this._forceRenderingAbove = false;\n    }\n};\nSuggestWidget = SuggestWidget_1 = __decorate([\n    __param(1, IStorageService),\n    __param(2, IContextKeyService),\n    __param(3, IThemeService),\n    __param(4, IInstantiationService)\n], SuggestWidget);\nexport { SuggestWidget };\nexport class SuggestContentWidget {\n    constructor(_widget, _editor) {\n        this._widget = _widget;\n        this._editor = _editor;\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = false;\n        this._preferenceLocked = false;\n        this._added = false;\n        this._hidden = false;\n    }\n    dispose() {\n        if (this._added) {\n            this._added = false;\n            this._editor.removeContentWidget(this);\n        }\n    }\n    getId() {\n        return 'editor.widget.suggestWidget';\n    }\n    getDomNode() {\n        return this._widget.element.domNode;\n    }\n    show() {\n        this._hidden = false;\n        if (!this._added) {\n            this._added = true;\n            this._editor.addContentWidget(this);\n        }\n    }\n    hide() {\n        if (!this._hidden) {\n            this._hidden = true;\n            this.layout();\n        }\n    }\n    layout() {\n        this._editor.layoutContentWidget(this);\n    }\n    getPosition() {\n        if (this._hidden || !this._position || !this._preference) {\n            return null;\n        }\n        return {\n            position: this._position,\n            preference: [this._preference]\n        };\n    }\n    beforeRender() {\n        const { height, width } = this._widget.element.size;\n        const { borderWidth, horizontalPadding } = this._widget.getLayoutInfo();\n        return new dom.Dimension(width + 2 * borderWidth + horizontalPadding, height + 2 * borderWidth);\n    }\n    afterRender(position) {\n        this._widget._afterRender(position);\n    }\n    setPreference(preference) {\n        if (!this._preferenceLocked) {\n            this._preference = preference;\n        }\n    }\n    lockPreference() {\n        this._preferenceLocked = true;\n    }\n    unlockPreference() {\n        this._preferenceLocked = false;\n    }\n    setPosition(position) {\n        this._position = position;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SuggestController_1;\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { KeyCodeChord } from '../../../../base/common/keybindings.js';\nimport { DisposableStore, dispose, MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { assertType, isObject } from '../../../../base/common/types.js';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { SnippetController2 } from '../../snippet/browser/snippetController2.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\nimport { ISuggestMemoryService } from './suggestMemory.js';\nimport { WordContextKey } from './wordContextKey.js';\nimport * as nls from '../../../../nls.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { Context as SuggestContext, suggestWidgetStatusbarMenu } from './suggest.js';\nimport { SuggestAlternatives } from './suggestAlternatives.js';\nimport { CommitCharacterController } from './suggestCommitCharacters.js';\nimport { SuggestModel } from './suggestModel.js';\nimport { OvertypingCapturer } from './suggestOvertypingCapturer.js';\nimport { SuggestWidget } from './suggestWidget.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { basename, extname } from '../../../../base/common/resources.js';\nimport { hash } from '../../../../base/common/hash.js';\nimport { WindowIdleValue, getWindow } from '../../../../base/browser/dom.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\n// sticky suggest widget which doesn't disappear on focus out and such\nconst _sticky = false;\nclass LineSuffix {\n    constructor(_model, _position) {\n        this._model = _model;\n        this._position = _position;\n        this._decorationOptions = ModelDecorationOptions.register({\n            description: 'suggest-line-suffix',\n            stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */\n        });\n        // spy on what's happening right of the cursor. two cases:\n        // 1. end of line -> check that it's still end of line\n        // 2. mid of line -> add a marker and compute the delta\n        const maxColumn = _model.getLineMaxColumn(_position.lineNumber);\n        if (maxColumn !== _position.column) {\n            const offset = _model.getOffsetAt(_position);\n            const end = _model.getPositionAt(offset + 1);\n            _model.changeDecorations(accessor => {\n                if (this._marker) {\n                    accessor.removeDecoration(this._marker);\n                }\n                this._marker = accessor.addDecoration(Range.fromPositions(_position, end), this._decorationOptions);\n            });\n        }\n    }\n    dispose() {\n        if (this._marker && !this._model.isDisposed()) {\n            this._model.changeDecorations(accessor => {\n                accessor.removeDecoration(this._marker);\n                this._marker = undefined;\n            });\n        }\n    }\n    delta(position) {\n        if (this._model.isDisposed() || this._position.lineNumber !== position.lineNumber) {\n            // bail out early if things seems fishy\n            return 0;\n        }\n        // read the marker (in case suggest was triggered at line end) or compare\n        // the cursor to the line end.\n        if (this._marker) {\n            const range = this._model.getDecorationRange(this._marker);\n            const end = this._model.getOffsetAt(range.getStartPosition());\n            return end - this._model.getOffsetAt(position);\n        }\n        else {\n            return this._model.getLineMaxColumn(position.lineNumber) - position.column;\n        }\n    }\n}\nlet SuggestController = class SuggestController {\n    static { SuggestController_1 = this; }\n    static { this.ID = 'editor.contrib.suggestController'; }\n    static get(editor) {\n        return editor.getContribution(SuggestController_1.ID);\n    }\n    constructor(editor, _memoryService, _commandService, _contextKeyService, _instantiationService, _logService, _telemetryService) {\n        this._memoryService = _memoryService;\n        this._commandService = _commandService;\n        this._contextKeyService = _contextKeyService;\n        this._instantiationService = _instantiationService;\n        this._logService = _logService;\n        this._telemetryService = _telemetryService;\n        this._lineSuffix = new MutableDisposable();\n        this._toDispose = new DisposableStore();\n        this._selectors = new PriorityRegistry(s => s.priority);\n        this._onWillInsertSuggestItem = new Emitter();\n        this.onWillInsertSuggestItem = this._onWillInsertSuggestItem.event;\n        this.editor = editor;\n        this.model = _instantiationService.createInstance(SuggestModel, this.editor);\n        // default selector\n        this._selectors.register({\n            priority: 0,\n            select: (model, pos, items) => this._memoryService.select(model, pos, items)\n        });\n        // context key: update insert/replace mode\n        const ctxInsertMode = SuggestContext.InsertMode.bindTo(_contextKeyService);\n        ctxInsertMode.set(editor.getOption(119 /* EditorOption.suggest */).insertMode);\n        this._toDispose.add(this.model.onDidTrigger(() => ctxInsertMode.set(editor.getOption(119 /* EditorOption.suggest */).insertMode)));\n        this.widget = this._toDispose.add(new WindowIdleValue(getWindow(editor.getDomNode()), () => {\n            const widget = this._instantiationService.createInstance(SuggestWidget, this.editor);\n            this._toDispose.add(widget);\n            this._toDispose.add(widget.onDidSelect(item => this._insertSuggestion(item, 0 /* InsertFlags.None */), this));\n            // Wire up logic to accept a suggestion on certain characters\n            const commitCharacterController = new CommitCharacterController(this.editor, widget, this.model, item => this._insertSuggestion(item, 2 /* InsertFlags.NoAfterUndoStop */));\n            this._toDispose.add(commitCharacterController);\n            // Wire up makes text edit context key\n            const ctxMakesTextEdit = SuggestContext.MakesTextEdit.bindTo(this._contextKeyService);\n            const ctxHasInsertAndReplace = SuggestContext.HasInsertAndReplaceRange.bindTo(this._contextKeyService);\n            const ctxCanResolve = SuggestContext.CanResolve.bindTo(this._contextKeyService);\n            this._toDispose.add(toDisposable(() => {\n                ctxMakesTextEdit.reset();\n                ctxHasInsertAndReplace.reset();\n                ctxCanResolve.reset();\n            }));\n            this._toDispose.add(widget.onDidFocus(({ item }) => {\n                // (ctx: makesTextEdit)\n                const position = this.editor.getPosition();\n                const startColumn = item.editStart.column;\n                const endColumn = position.column;\n                let value = true;\n                if (this.editor.getOption(1 /* EditorOption.acceptSuggestionOnEnter */) === 'smart'\n                    && this.model.state === 2 /* State.Auto */\n                    && !item.completion.additionalTextEdits\n                    && !(item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */)\n                    && endColumn - startColumn === item.completion.insertText.length) {\n                    const oldText = this.editor.getModel().getValueInRange({\n                        startLineNumber: position.lineNumber,\n                        startColumn,\n                        endLineNumber: position.lineNumber,\n                        endColumn\n                    });\n                    value = oldText !== item.completion.insertText;\n                }\n                ctxMakesTextEdit.set(value);\n                // (ctx: hasInsertAndReplaceRange)\n                ctxHasInsertAndReplace.set(!Position.equals(item.editInsertEnd, item.editReplaceEnd));\n                // (ctx: canResolve)\n                ctxCanResolve.set(Boolean(item.provider.resolveCompletionItem) || Boolean(item.completion.documentation) || item.completion.detail !== item.completion.label);\n            }));\n            this._toDispose.add(widget.onDetailsKeyDown(e => {\n                // cmd + c on macOS, ctrl + c on Win / Linux\n                if (e.toKeyCodeChord().equals(new KeyCodeChord(true, false, false, false, 33 /* KeyCode.KeyC */)) ||\n                    (platform.isMacintosh && e.toKeyCodeChord().equals(new KeyCodeChord(false, false, false, true, 33 /* KeyCode.KeyC */)))) {\n                    e.stopPropagation();\n                    return;\n                }\n                if (!e.toKeyCodeChord().isModifierKey()) {\n                    this.editor.focus();\n                }\n            }));\n            return widget;\n        }));\n        // Wire up text overtyping capture\n        this._overtypingCapturer = this._toDispose.add(new WindowIdleValue(getWindow(editor.getDomNode()), () => {\n            return this._toDispose.add(new OvertypingCapturer(this.editor, this.model));\n        }));\n        this._alternatives = this._toDispose.add(new WindowIdleValue(getWindow(editor.getDomNode()), () => {\n            return this._toDispose.add(new SuggestAlternatives(this.editor, this._contextKeyService));\n        }));\n        this._toDispose.add(_instantiationService.createInstance(WordContextKey, editor));\n        this._toDispose.add(this.model.onDidTrigger(e => {\n            this.widget.value.showTriggered(e.auto, e.shy ? 250 : 50);\n            this._lineSuffix.value = new LineSuffix(this.editor.getModel(), e.position);\n        }));\n        this._toDispose.add(this.model.onDidSuggest(e => {\n            if (e.triggerOptions.shy) {\n                return;\n            }\n            let index = -1;\n            for (const selector of this._selectors.itemsOrderedByPriorityDesc) {\n                index = selector.select(this.editor.getModel(), this.editor.getPosition(), e.completionModel.items);\n                if (index !== -1) {\n                    break;\n                }\n            }\n            if (index === -1) {\n                index = 0;\n            }\n            if (this.model.state === 0 /* State.Idle */) {\n                // selecting an item can \"pump\" out selection/cursor change events\n                // which can cancel suggest halfway through this function. therefore\n                // we need to check again and bail if the session has been canceled\n                return;\n            }\n            let noFocus = false;\n            if (e.triggerOptions.auto) {\n                // don't \"focus\" item when configured to do\n                const options = this.editor.getOption(119 /* EditorOption.suggest */);\n                if (options.selectionMode === 'never' || options.selectionMode === 'always') {\n                    // simple: always or never\n                    noFocus = options.selectionMode === 'never';\n                }\n                else if (options.selectionMode === 'whenTriggerCharacter') {\n                    // on with trigger character\n                    noFocus = e.triggerOptions.triggerKind !== 1 /* CompletionTriggerKind.TriggerCharacter */;\n                }\n                else if (options.selectionMode === 'whenQuickSuggestion') {\n                    // without trigger character or when refiltering\n                    noFocus = e.triggerOptions.triggerKind === 1 /* CompletionTriggerKind.TriggerCharacter */ && !e.triggerOptions.refilter;\n                }\n            }\n            this.widget.value.showSuggestions(e.completionModel, index, e.isFrozen, e.triggerOptions.auto, noFocus);\n        }));\n        this._toDispose.add(this.model.onDidCancel(e => {\n            if (!e.retrigger) {\n                this.widget.value.hideWidget();\n            }\n        }));\n        this._toDispose.add(this.editor.onDidBlurEditorWidget(() => {\n            if (!_sticky) {\n                this.model.cancel();\n                this.model.clear();\n            }\n        }));\n        // Manage the acceptSuggestionsOnEnter context key\n        const acceptSuggestionsOnEnter = SuggestContext.AcceptSuggestionsOnEnter.bindTo(_contextKeyService);\n        const updateFromConfig = () => {\n            const acceptSuggestionOnEnter = this.editor.getOption(1 /* EditorOption.acceptSuggestionOnEnter */);\n            acceptSuggestionsOnEnter.set(acceptSuggestionOnEnter === 'on' || acceptSuggestionOnEnter === 'smart');\n        };\n        this._toDispose.add(this.editor.onDidChangeConfiguration(() => updateFromConfig()));\n        updateFromConfig();\n    }\n    dispose() {\n        this._alternatives.dispose();\n        this._toDispose.dispose();\n        this.widget.dispose();\n        this.model.dispose();\n        this._lineSuffix.dispose();\n        this._onWillInsertSuggestItem.dispose();\n    }\n    _insertSuggestion(event, flags) {\n        if (!event || !event.item) {\n            this._alternatives.value.reset();\n            this.model.cancel();\n            this.model.clear();\n            return;\n        }\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        const snippetController = SnippetController2.get(this.editor);\n        if (!snippetController) {\n            return;\n        }\n        this._onWillInsertSuggestItem.fire({ item: event.item });\n        const model = this.editor.getModel();\n        const modelVersionNow = model.getAlternativeVersionId();\n        const { item } = event;\n        //\n        const tasks = [];\n        const cts = new CancellationTokenSource();\n        // pushing undo stops *before* additional text edits and\n        // *after* the main edit\n        if (!(flags & 1 /* InsertFlags.NoBeforeUndoStop */)) {\n            this.editor.pushUndoStop();\n        }\n        // compute overwrite[Before|After] deltas BEFORE applying extra edits\n        const info = this.getOverwriteInfo(item, Boolean(flags & 8 /* InsertFlags.AlternativeOverwriteConfig */));\n        // keep item in memory\n        this._memoryService.memorize(model, this.editor.getPosition(), item);\n        const isResolved = item.isResolved;\n        // telemetry data points: duration of command execution, info about async additional edits (-1=n/a, -2=none, 1=success, 0=failed)\n        let _commandExectionDuration = -1;\n        let _additionalEditsAppliedAsync = -1;\n        if (Array.isArray(item.completion.additionalTextEdits)) {\n            // cancel -> stops all listening and closes widget\n            this.model.cancel();\n            // sync additional edits\n            const scrollState = StableEditorScrollState.capture(this.editor);\n            this.editor.executeEdits('suggestController.additionalTextEdits.sync', item.completion.additionalTextEdits.map(edit => {\n                let range = Range.lift(edit.range);\n                if (range.startLineNumber === item.position.lineNumber && range.startColumn > item.position.column) {\n                    // shift additional edit when it is \"after\" the completion insertion position\n                    const columnDelta = this.editor.getPosition().column - item.position.column;\n                    const startColumnDelta = columnDelta;\n                    const endColumnDelta = Range.spansMultipleLines(range) ? 0 : columnDelta;\n                    range = new Range(range.startLineNumber, range.startColumn + startColumnDelta, range.endLineNumber, range.endColumn + endColumnDelta);\n                }\n                return EditOperation.replaceMove(range, edit.text);\n            }));\n            scrollState.restoreRelativeVerticalPositionOfCursor(this.editor);\n        }\n        else if (!isResolved) {\n            // async additional edits\n            const sw = new StopWatch();\n            let position;\n            const docListener = model.onDidChangeContent(e => {\n                if (e.isFlush) {\n                    cts.cancel();\n                    docListener.dispose();\n                    return;\n                }\n                for (const change of e.changes) {\n                    const thisPosition = Range.getEndPosition(change.range);\n                    if (!position || Position.isBefore(thisPosition, position)) {\n                        position = thisPosition;\n                    }\n                }\n            });\n            const oldFlags = flags;\n            flags |= 2 /* InsertFlags.NoAfterUndoStop */;\n            let didType = false;\n            const typeListener = this.editor.onWillType(() => {\n                typeListener.dispose();\n                didType = true;\n                if (!(oldFlags & 2 /* InsertFlags.NoAfterUndoStop */)) {\n                    this.editor.pushUndoStop();\n                }\n            });\n            tasks.push(item.resolve(cts.token).then(() => {\n                if (!item.completion.additionalTextEdits || cts.token.isCancellationRequested) {\n                    return undefined;\n                }\n                if (position && item.completion.additionalTextEdits.some(edit => Position.isBefore(position, Range.getStartPosition(edit.range)))) {\n                    return false;\n                }\n                if (didType) {\n                    this.editor.pushUndoStop();\n                }\n                const scrollState = StableEditorScrollState.capture(this.editor);\n                this.editor.executeEdits('suggestController.additionalTextEdits.async', item.completion.additionalTextEdits.map(edit => EditOperation.replaceMove(Range.lift(edit.range), edit.text)));\n                scrollState.restoreRelativeVerticalPositionOfCursor(this.editor);\n                if (didType || !(oldFlags & 2 /* InsertFlags.NoAfterUndoStop */)) {\n                    this.editor.pushUndoStop();\n                }\n                return true;\n            }).then(applied => {\n                this._logService.trace('[suggest] async resolving of edits DONE (ms, applied?)', sw.elapsed(), applied);\n                _additionalEditsAppliedAsync = applied === true ? 1 : applied === false ? 0 : -2;\n            }).finally(() => {\n                docListener.dispose();\n                typeListener.dispose();\n            }));\n        }\n        let { insertText } = item.completion;\n        if (!(item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */)) {\n            insertText = SnippetParser.escape(insertText);\n        }\n        // cancel -> stops all listening and closes widget\n        this.model.cancel();\n        snippetController.insert(insertText, {\n            overwriteBefore: info.overwriteBefore,\n            overwriteAfter: info.overwriteAfter,\n            undoStopBefore: false,\n            undoStopAfter: false,\n            adjustWhitespace: !(item.completion.insertTextRules & 1 /* CompletionItemInsertTextRule.KeepWhitespace */),\n            clipboardText: event.model.clipboardText,\n            overtypingCapturer: this._overtypingCapturer.value\n        });\n        if (!(flags & 2 /* InsertFlags.NoAfterUndoStop */)) {\n            this.editor.pushUndoStop();\n        }\n        if (item.completion.command) {\n            if (item.completion.command.id === TriggerSuggestAction.id) {\n                // retigger\n                this.model.trigger({ auto: true, retrigger: true });\n            }\n            else {\n                // exec command, done\n                const sw = new StopWatch();\n                tasks.push(this._commandService.executeCommand(item.completion.command.id, ...(item.completion.command.arguments ? [...item.completion.command.arguments] : [])).catch(e => {\n                    if (item.completion.extensionId) {\n                        onUnexpectedExternalError(e);\n                    }\n                    else {\n                        onUnexpectedError(e);\n                    }\n                }).finally(() => {\n                    _commandExectionDuration = sw.elapsed();\n                }));\n            }\n        }\n        if (flags & 4 /* InsertFlags.KeepAlternativeSuggestions */) {\n            this._alternatives.value.set(event, next => {\n                // cancel resolving of additional edits\n                cts.cancel();\n                // this is not so pretty. when inserting the 'next'\n                // suggestion we undo until we are at the state at\n                // which we were before inserting the previous suggestion...\n                while (model.canUndo()) {\n                    if (modelVersionNow !== model.getAlternativeVersionId()) {\n                        model.undo();\n                    }\n                    this._insertSuggestion(next, 1 /* InsertFlags.NoBeforeUndoStop */ | 2 /* InsertFlags.NoAfterUndoStop */ | (flags & 8 /* InsertFlags.AlternativeOverwriteConfig */ ? 8 /* InsertFlags.AlternativeOverwriteConfig */ : 0));\n                    break;\n                }\n            });\n        }\n        this._alertCompletionItem(item);\n        // clear only now - after all tasks are done\n        Promise.all(tasks).finally(() => {\n            this._reportSuggestionAcceptedTelemetry(item, model, isResolved, _commandExectionDuration, _additionalEditsAppliedAsync, event.index, event.model.items);\n            this.model.clear();\n            cts.dispose();\n        });\n    }\n    _reportSuggestionAcceptedTelemetry(item, model, itemResolved, commandExectionDuration, additionalEditsAppliedAsync, index, completionItems) {\n        if (Math.floor(Math.random() * 100) === 0) {\n            // throttle telemetry event because accepting completions happens a lot\n            return;\n        }\n        const labelMap = new Map();\n        for (let i = 0; i < Math.min(30, completionItems.length); i++) {\n            const label = completionItems[i].textLabel;\n            if (labelMap.has(label)) {\n                labelMap.get(label).push(i);\n            }\n            else {\n                labelMap.set(label, [i]);\n            }\n        }\n        const firstIndexArray = labelMap.get(item.textLabel);\n        const hasDuplicates = firstIndexArray && firstIndexArray.length > 1;\n        const firstIndex = hasDuplicates ? firstIndexArray[0] : -1;\n        this._telemetryService.publicLog2('suggest.acceptedSuggestion', {\n            extensionId: item.extensionId?.value ?? 'unknown',\n            providerId: item.provider._debugDisplayName ?? 'unknown',\n            kind: item.completion.kind,\n            basenameHash: hash(basename(model.uri)).toString(16),\n            languageId: model.getLanguageId(),\n            fileExtension: extname(model.uri),\n            resolveInfo: !item.provider.resolveCompletionItem ? -1 : itemResolved ? 1 : 0,\n            resolveDuration: item.resolveDuration,\n            commandDuration: commandExectionDuration,\n            additionalEditsAsync: additionalEditsAppliedAsync,\n            index,\n            firstIndex,\n        });\n    }\n    getOverwriteInfo(item, toggleMode) {\n        assertType(this.editor.hasModel());\n        let replace = this.editor.getOption(119 /* EditorOption.suggest */).insertMode === 'replace';\n        if (toggleMode) {\n            replace = !replace;\n        }\n        const overwriteBefore = item.position.column - item.editStart.column;\n        const overwriteAfter = (replace ? item.editReplaceEnd.column : item.editInsertEnd.column) - item.position.column;\n        const columnDelta = this.editor.getPosition().column - item.position.column;\n        const suffixDelta = this._lineSuffix.value ? this._lineSuffix.value.delta(this.editor.getPosition()) : 0;\n        return {\n            overwriteBefore: overwriteBefore + columnDelta,\n            overwriteAfter: overwriteAfter + suffixDelta\n        };\n    }\n    _alertCompletionItem(item) {\n        if (isNonEmptyArray(item.completion.additionalTextEdits)) {\n            const msg = nls.localize('aria.alert.snippet', \"Accepting '{0}' made {1} additional edits\", item.textLabel, item.completion.additionalTextEdits.length);\n            alert(msg);\n        }\n    }\n    triggerSuggest(onlyFrom, auto, noFilter) {\n        if (this.editor.hasModel()) {\n            this.model.trigger({\n                auto: auto ?? false,\n                completionOptions: { providerFilter: onlyFrom, kindFilter: noFilter ? new Set() : undefined }\n            });\n            this.editor.revealPosition(this.editor.getPosition(), 0 /* ScrollType.Smooth */);\n            this.editor.focus();\n        }\n    }\n    triggerSuggestAndAcceptBest(arg) {\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        const positionNow = this.editor.getPosition();\n        const fallback = () => {\n            if (positionNow.equals(this.editor.getPosition())) {\n                this._commandService.executeCommand(arg.fallback);\n            }\n        };\n        const makesTextEdit = (item) => {\n            if (item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */ || item.completion.additionalTextEdits) {\n                // snippet, other editor -> makes edit\n                return true;\n            }\n            const position = this.editor.getPosition();\n            const startColumn = item.editStart.column;\n            const endColumn = position.column;\n            if (endColumn - startColumn !== item.completion.insertText.length) {\n                // unequal lengths -> makes edit\n                return true;\n            }\n            const textNow = this.editor.getModel().getValueInRange({\n                startLineNumber: position.lineNumber,\n                startColumn,\n                endLineNumber: position.lineNumber,\n                endColumn\n            });\n            // unequal text -> makes edit\n            return textNow !== item.completion.insertText;\n        };\n        Event.once(this.model.onDidTrigger)(_ => {\n            // wait for trigger because only then the cancel-event is trustworthy\n            const listener = [];\n            Event.any(this.model.onDidTrigger, this.model.onDidCancel)(() => {\n                // retrigger or cancel -> try to type default text\n                dispose(listener);\n                fallback();\n            }, undefined, listener);\n            this.model.onDidSuggest(({ completionModel }) => {\n                dispose(listener);\n                if (completionModel.items.length === 0) {\n                    fallback();\n                    return;\n                }\n                const index = this._memoryService.select(this.editor.getModel(), this.editor.getPosition(), completionModel.items);\n                const item = completionModel.items[index];\n                if (!makesTextEdit(item)) {\n                    fallback();\n                    return;\n                }\n                this.editor.pushUndoStop();\n                this._insertSuggestion({ index, item, model: completionModel }, 4 /* InsertFlags.KeepAlternativeSuggestions */ | 1 /* InsertFlags.NoBeforeUndoStop */ | 2 /* InsertFlags.NoAfterUndoStop */);\n            }, undefined, listener);\n        });\n        this.model.trigger({ auto: false, shy: true });\n        this.editor.revealPosition(positionNow, 0 /* ScrollType.Smooth */);\n        this.editor.focus();\n    }\n    acceptSelectedSuggestion(keepAlternativeSuggestions, alternativeOverwriteConfig) {\n        const item = this.widget.value.getFocusedItem();\n        let flags = 0;\n        if (keepAlternativeSuggestions) {\n            flags |= 4 /* InsertFlags.KeepAlternativeSuggestions */;\n        }\n        if (alternativeOverwriteConfig) {\n            flags |= 8 /* InsertFlags.AlternativeOverwriteConfig */;\n        }\n        this._insertSuggestion(item, flags);\n    }\n    acceptNextSuggestion() {\n        this._alternatives.value.next();\n    }\n    acceptPrevSuggestion() {\n        this._alternatives.value.prev();\n    }\n    cancelSuggestWidget() {\n        this.model.cancel();\n        this.model.clear();\n        this.widget.value.hideWidget();\n    }\n    focusSuggestion() {\n        this.widget.value.focusSelected();\n    }\n    selectNextSuggestion() {\n        this.widget.value.selectNext();\n    }\n    selectNextPageSuggestion() {\n        this.widget.value.selectNextPage();\n    }\n    selectLastSuggestion() {\n        this.widget.value.selectLast();\n    }\n    selectPrevSuggestion() {\n        this.widget.value.selectPrevious();\n    }\n    selectPrevPageSuggestion() {\n        this.widget.value.selectPreviousPage();\n    }\n    selectFirstSuggestion() {\n        this.widget.value.selectFirst();\n    }\n    toggleSuggestionDetails() {\n        this.widget.value.toggleDetails();\n    }\n    toggleExplainMode() {\n        this.widget.value.toggleExplainMode();\n    }\n    toggleSuggestionFocus() {\n        this.widget.value.toggleDetailsFocus();\n    }\n    resetWidgetSize() {\n        this.widget.value.resetPersistedSize();\n    }\n    forceRenderingAbove() {\n        this.widget.value.forceRenderingAbove();\n    }\n    stopForceRenderingAbove() {\n        if (!this.widget.isInitialized) {\n            // This method has no effect if the widget is not initialized yet.\n            return;\n        }\n        this.widget.value.stopForceRenderingAbove();\n    }\n    registerSelector(selector) {\n        return this._selectors.register(selector);\n    }\n};\nSuggestController = SuggestController_1 = __decorate([\n    __param(1, ISuggestMemoryService),\n    __param(2, ICommandService),\n    __param(3, IContextKeyService),\n    __param(4, IInstantiationService),\n    __param(5, ILogService),\n    __param(6, ITelemetryService)\n], SuggestController);\nexport { SuggestController };\nclass PriorityRegistry {\n    constructor(prioritySelector) {\n        this.prioritySelector = prioritySelector;\n        this._items = new Array();\n    }\n    register(value) {\n        if (this._items.indexOf(value) !== -1) {\n            throw new Error('Value is already registered');\n        }\n        this._items.push(value);\n        this._items.sort((s1, s2) => this.prioritySelector(s2) - this.prioritySelector(s1));\n        return {\n            dispose: () => {\n                const idx = this._items.indexOf(value);\n                if (idx >= 0) {\n                    this._items.splice(idx, 1);\n                }\n            }\n        };\n    }\n    get itemsOrderedByPriorityDesc() {\n        return this._items;\n    }\n}\nexport class TriggerSuggestAction extends EditorAction {\n    static { this.id = 'editor.action.triggerSuggest'; }\n    constructor() {\n        super({\n            id: TriggerSuggestAction.id,\n            label: nls.localize('suggest.trigger.label', \"Trigger Suggest\"),\n            alias: 'Trigger Suggest',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCompletionItemProvider, SuggestContext.Visible.toNegated()),\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 10 /* KeyCode.Space */,\n                secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */],\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 10 /* KeyCode.Space */, secondary: [512 /* KeyMod.Alt */ | 9 /* KeyCode.Escape */, 2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */] },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor, args) {\n        const controller = SuggestController.get(editor);\n        if (!controller) {\n            return;\n        }\n        let auto;\n        if (args && typeof args === 'object') {\n            if (args.auto === true) {\n                auto = true;\n            }\n        }\n        controller.triggerSuggest(undefined, auto, undefined);\n    }\n}\nregisterEditorContribution(SuggestController.ID, SuggestController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(TriggerSuggestAction);\nconst weight = 100 /* KeybindingWeight.EditorContrib */ + 90;\nconst SuggestCommand = EditorCommand.bindToContribution(SuggestController.get);\nregisterEditorCommand(new SuggestCommand({\n    id: 'acceptSelectedSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.HasFocusedSuggestion),\n    handler(x) {\n        x.acceptSelectedSuggestion(true, false);\n    },\n    kbOpts: [{\n            // normal tab\n            primary: 2 /* KeyCode.Tab */,\n            kbExpr: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus),\n            weight,\n        }, {\n            // accept on enter has special rules\n            primary: 3 /* KeyCode.Enter */,\n            kbExpr: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus, SuggestContext.AcceptSuggestionsOnEnter, SuggestContext.MakesTextEdit),\n            weight,\n        }],\n    menuOpts: [{\n            menuId: suggestWidgetStatusbarMenu,\n            title: nls.localize('accept.insert', \"Insert\"),\n            group: 'left',\n            order: 1,\n            when: SuggestContext.HasInsertAndReplaceRange.toNegated()\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            title: nls.localize('accept.insert', \"Insert\"),\n            group: 'left',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('insert'))\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            title: nls.localize('accept.replace', \"Replace\"),\n            group: 'left',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('replace'))\n        }]\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'acceptAlternativeSelectedSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus, SuggestContext.HasFocusedSuggestion),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 1024 /* KeyMod.Shift */ | 3 /* KeyCode.Enter */,\n        secondary: [1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */],\n    },\n    handler(x) {\n        x.acceptSelectedSuggestion(false, true);\n    },\n    menuOpts: [{\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'left',\n            order: 2,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('insert')),\n            title: nls.localize('accept.replace', \"Replace\")\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'left',\n            order: 2,\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('replace')),\n            title: nls.localize('accept.insert', \"Insert\")\n        }]\n}));\n// continue to support the old command\nCommandsRegistry.registerCommandAlias('acceptSelectedSuggestionOnEnter', 'acceptSelectedSuggestion');\nregisterEditorCommand(new SuggestCommand({\n    id: 'hideSuggestWidget',\n    precondition: SuggestContext.Visible,\n    handler: x => x.cancelSuggestWidget(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectNextSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectNextSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 18 /* KeyCode.DownArrow */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */],\n        mac: { primary: 18 /* KeyCode.DownArrow */, secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */, 256 /* KeyMod.WinCtrl */ | 44 /* KeyCode.KeyN */] }\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectNextPageSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectNextPageSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 12 /* KeyCode.PageDown */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 12 /* KeyCode.PageDown */]\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectLastSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectLastSuggestion()\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectPrevSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectPrevSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 16 /* KeyCode.UpArrow */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */],\n        mac: { primary: 16 /* KeyCode.UpArrow */, secondary: [2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */, 256 /* KeyMod.WinCtrl */ | 46 /* KeyCode.KeyP */] }\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectPrevPageSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectPrevPageSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 11 /* KeyCode.PageUp */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 11 /* KeyCode.PageUp */]\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'selectFirstSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, ContextKeyExpr.or(SuggestContext.MultipleSuggestions, SuggestContext.HasFocusedSuggestion.negate())),\n    handler: c => c.selectFirstSuggestion()\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'focusSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.HasFocusedSuggestion.negate()),\n    handler: x => x.focusSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 10 /* KeyCode.Space */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */],\n        mac: { primary: 256 /* KeyMod.WinCtrl */ | 10 /* KeyCode.Space */, secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */] }\n    },\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'focusAndAcceptSuggestion',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.HasFocusedSuggestion.negate()),\n    handler: c => {\n        c.focusSuggestion();\n        c.acceptSelectedSuggestion(true, false);\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'toggleSuggestionDetails',\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.HasFocusedSuggestion),\n    handler: x => x.toggleSuggestionDetails(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 10 /* KeyCode.Space */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */],\n        mac: { primary: 256 /* KeyMod.WinCtrl */ | 10 /* KeyCode.Space */, secondary: [2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */] }\n    },\n    menuOpts: [{\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'right',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.DetailsVisible, SuggestContext.CanResolve),\n            title: nls.localize('detail.more', \"Show Less\")\n        }, {\n            menuId: suggestWidgetStatusbarMenu,\n            group: 'right',\n            order: 1,\n            when: ContextKeyExpr.and(SuggestContext.DetailsVisible.toNegated(), SuggestContext.CanResolve),\n            title: nls.localize('detail.less', \"Show More\")\n        }]\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'toggleExplainMode',\n    precondition: SuggestContext.Visible,\n    handler: x => x.toggleExplainMode(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 90 /* KeyCode.Slash */,\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'toggleSuggestionFocus',\n    precondition: SuggestContext.Visible,\n    handler: x => x.toggleSuggestionFocus(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 10 /* KeyCode.Space */,\n        mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 10 /* KeyCode.Space */ }\n    }\n}));\n//#region tab completions\nregisterEditorCommand(new SuggestCommand({\n    id: 'insertBestCompletion',\n    precondition: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), WordContextKey.AtEnd, SuggestContext.Visible.toNegated(), SuggestAlternatives.OtherSuggestions.toNegated(), SnippetController2.InSnippetMode.toNegated()),\n    handler: (x, arg) => {\n        x.triggerSuggestAndAcceptBest(isObject(arg) ? { fallback: 'tab', ...arg } : { fallback: 'tab' });\n    },\n    kbOpts: {\n        weight,\n        primary: 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'insertNextSuggestion',\n    precondition: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), SuggestAlternatives.OtherSuggestions, SuggestContext.Visible.toNegated(), SnippetController2.InSnippetMode.toNegated()),\n    handler: x => x.acceptNextSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new SuggestCommand({\n    id: 'insertPrevSuggestion',\n    precondition: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), SuggestAlternatives.OtherSuggestions, SuggestContext.Visible.toNegated(), SnippetController2.InSnippetMode.toNegated()),\n    handler: x => x.acceptPrevSuggestion(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.textInputFocus,\n        primary: 1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorAction(class extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.resetSuggestSize',\n            label: nls.localize('suggest.reset.label', \"Reset Suggest Widget Size\"),\n            alias: 'Reset Suggest Widget Size',\n            precondition: undefined\n        });\n    }\n    run(_accessor, editor) {\n        SuggestController.get(editor)?.resetWidgetSize();\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { compareBy, numberComparator } from '../../../../../base/common/arrays.js';\nimport { findFirstMax } from '../../../../../base/common/arraysFind.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { SingleTextEdit } from '../../../../common/core/textEdit.js';\nimport { SelectedSuggestionInfo } from '../../../../common/languages.js';\nimport { singleTextEditAugments, singleTextRemoveCommonPrefix } from './singleTextEdit.js';\nimport { SnippetParser } from '../../../snippet/browser/snippetParser.js';\nimport { SnippetSession } from '../../../snippet/browser/snippetSession.js';\nimport { SuggestController } from '../../../suggest/browser/suggestController.js';\nexport class SuggestWidgetAdaptor extends Disposable {\n    get selectedItem() {\n        return this._currentSuggestItemInfo;\n    }\n    constructor(editor, suggestControllerPreselector, onWillAccept) {\n        super();\n        this.editor = editor;\n        this.suggestControllerPreselector = suggestControllerPreselector;\n        this.onWillAccept = onWillAccept;\n        this.isSuggestWidgetVisible = false;\n        this.isShiftKeyPressed = false;\n        this._isActive = false;\n        this._currentSuggestItemInfo = undefined;\n        this._onDidSelectedItemChange = this._register(new Emitter());\n        this.onDidSelectedItemChange = this._onDidSelectedItemChange.event;\n        // See the command acceptAlternativeSelectedSuggestion that is bound to shift+tab\n        this._register(editor.onKeyDown(e => {\n            if (e.shiftKey && !this.isShiftKeyPressed) {\n                this.isShiftKeyPressed = true;\n                this.update(this._isActive);\n            }\n        }));\n        this._register(editor.onKeyUp(e => {\n            if (e.shiftKey && this.isShiftKeyPressed) {\n                this.isShiftKeyPressed = false;\n                this.update(this._isActive);\n            }\n        }));\n        const suggestController = SuggestController.get(this.editor);\n        if (suggestController) {\n            this._register(suggestController.registerSelector({\n                priority: 100,\n                select: (model, pos, suggestItems) => {\n                    const textModel = this.editor.getModel();\n                    if (!textModel) {\n                        // Should not happen\n                        return -1;\n                    }\n                    const i = this.suggestControllerPreselector();\n                    const itemToPreselect = i ? singleTextRemoveCommonPrefix(i, textModel) : undefined;\n                    if (!itemToPreselect) {\n                        return -1;\n                    }\n                    const position = Position.lift(pos);\n                    const candidates = suggestItems\n                        .map((suggestItem, index) => {\n                        const suggestItemInfo = SuggestItemInfo.fromSuggestion(suggestController, textModel, position, suggestItem, this.isShiftKeyPressed);\n                        const suggestItemTextEdit = singleTextRemoveCommonPrefix(suggestItemInfo.toSingleTextEdit(), textModel);\n                        const valid = singleTextEditAugments(itemToPreselect, suggestItemTextEdit);\n                        return { index, valid, prefixLength: suggestItemTextEdit.text.length, suggestItem };\n                    })\n                        .filter(item => item && item.valid && item.prefixLength > 0);\n                    const result = findFirstMax(candidates, compareBy(s => s.prefixLength, numberComparator));\n                    return result ? result.index : -1;\n                }\n            }));\n            let isBoundToSuggestWidget = false;\n            const bindToSuggestWidget = () => {\n                if (isBoundToSuggestWidget) {\n                    return;\n                }\n                isBoundToSuggestWidget = true;\n                this._register(suggestController.widget.value.onDidShow(() => {\n                    this.isSuggestWidgetVisible = true;\n                    this.update(true);\n                }));\n                this._register(suggestController.widget.value.onDidHide(() => {\n                    this.isSuggestWidgetVisible = false;\n                    this.update(false);\n                }));\n                this._register(suggestController.widget.value.onDidFocus(() => {\n                    this.isSuggestWidgetVisible = true;\n                    this.update(true);\n                }));\n            };\n            this._register(Event.once(suggestController.model.onDidTrigger)(e => {\n                bindToSuggestWidget();\n            }));\n            this._register(suggestController.onWillInsertSuggestItem(e => {\n                const position = this.editor.getPosition();\n                const model = this.editor.getModel();\n                if (!position || !model) {\n                    return undefined;\n                }\n                const suggestItemInfo = SuggestItemInfo.fromSuggestion(suggestController, model, position, e.item, this.isShiftKeyPressed);\n                this.onWillAccept(suggestItemInfo);\n            }));\n        }\n        this.update(this._isActive);\n    }\n    update(newActive) {\n        const newInlineCompletion = this.getSuggestItemInfo();\n        if (this._isActive !== newActive || !suggestItemInfoEquals(this._currentSuggestItemInfo, newInlineCompletion)) {\n            this._isActive = newActive;\n            this._currentSuggestItemInfo = newInlineCompletion;\n            this._onDidSelectedItemChange.fire();\n        }\n    }\n    getSuggestItemInfo() {\n        const suggestController = SuggestController.get(this.editor);\n        if (!suggestController || !this.isSuggestWidgetVisible) {\n            return undefined;\n        }\n        const focusedItem = suggestController.widget.value.getFocusedItem();\n        const position = this.editor.getPosition();\n        const model = this.editor.getModel();\n        if (!focusedItem || !position || !model) {\n            return undefined;\n        }\n        return SuggestItemInfo.fromSuggestion(suggestController, model, position, focusedItem.item, this.isShiftKeyPressed);\n    }\n    stopForceRenderingAbove() {\n        const suggestController = SuggestController.get(this.editor);\n        suggestController?.stopForceRenderingAbove();\n    }\n    forceRenderingAbove() {\n        const suggestController = SuggestController.get(this.editor);\n        suggestController?.forceRenderingAbove();\n    }\n}\nexport class SuggestItemInfo {\n    static fromSuggestion(suggestController, model, position, item, toggleMode) {\n        let { insertText } = item.completion;\n        let isSnippetText = false;\n        if (item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */) {\n            const snippet = new SnippetParser().parse(insertText);\n            if (snippet.children.length < 100) {\n                // Adjust whitespace is expensive.\n                SnippetSession.adjustWhitespace(model, position, true, snippet);\n            }\n            insertText = snippet.toString();\n            isSnippetText = true;\n        }\n        const info = suggestController.getOverwriteInfo(item, toggleMode);\n        return new SuggestItemInfo(Range.fromPositions(position.delta(0, -info.overwriteBefore), position.delta(0, Math.max(info.overwriteAfter, 0))), insertText, item.completion.kind, isSnippetText);\n    }\n    constructor(range, insertText, completionItemKind, isSnippetText) {\n        this.range = range;\n        this.insertText = insertText;\n        this.completionItemKind = completionItemKind;\n        this.isSnippetText = isSnippetText;\n    }\n    equals(other) {\n        return this.range.equalsRange(other.range)\n            && this.insertText === other.insertText\n            && this.completionItemKind === other.completionItemKind\n            && this.isSnippetText === other.isSnippetText;\n    }\n    toSelectedSuggestionInfo() {\n        return new SelectedSuggestionInfo(this.range, this.insertText, this.completionItemKind, this.isSnippetText);\n    }\n    toSingleTextEdit() {\n        return new SingleTextEdit(this.range, this.insertText);\n    }\n}\nfunction suggestItemInfoEquals(a, b) {\n    if (a === b) {\n        return true;\n    }\n    if (!a || !b) {\n        return false;\n    }\n    return a.equals(b);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InlineCompletionsController_1;\nimport { createStyleSheetFromObservable } from '../../../../../base/browser/domObservable.js';\nimport { alert } from '../../../../../base/browser/ui/aria/aria.js';\nimport { timeout } from '../../../../../base/common/async.js';\nimport { cancelOnDispose } from '../../../../../base/common/cancellation.js';\nimport { Disposable, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { autorun, constObservable, derived, observableFromEvent, observableSignal, observableValue, transaction, waitForState } from '../../../../../base/common/observable.js';\nimport { derivedDisposable } from '../../../../../base/common/observableInternal/derived.js';\nimport { derivedObservableWithCache, mapObservableArrayCached } from '../../../../../base/common/observableInternal/utils.js';\nimport { isUndefined } from '../../../../../base/common/types.js';\nimport { CoreEditingCommands } from '../../../../browser/coreCommands.js';\nimport { observableCodeEditor, reactToChange, reactToChangeWithStore } from '../../../../browser/observableCodeEditor.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { ILanguageFeatureDebounceService } from '../../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../../common/services/languageFeatures.js';\nimport { inlineSuggestCommitId } from './commandIds.js';\nimport { GhostTextView } from '../view/ghostTextView.js';\nimport { InlineCompletionContextKeys } from './inlineCompletionContextKeys.js';\nimport { InlineCompletionsHintsWidget, InlineSuggestionHintsContentWidget } from '../hintsWidget/inlineCompletionsHintsWidget.js';\nimport { InlineCompletionsModel } from '../model/inlineCompletionsModel.js';\nimport { SuggestWidgetAdaptor } from '../model/suggestWidgetAdaptor.js';\nimport { localize } from '../../../../../nls.js';\nimport { IAccessibilityService } from '../../../../../platform/accessibility/common/accessibility.js';\nimport { AccessibilitySignal, IAccessibilitySignalService } from '../../../../../platform/accessibilitySignal/browser/accessibilitySignalService.js';\nimport { ICommandService } from '../../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nlet InlineCompletionsController = class InlineCompletionsController extends Disposable {\n    static { InlineCompletionsController_1 = this; }\n    static { this.ID = 'editor.contrib.inlineCompletionsController'; }\n    static get(editor) {\n        return editor.getContribution(InlineCompletionsController_1.ID);\n    }\n    constructor(editor, _instantiationService, _contextKeyService, _configurationService, _commandService, _debounceService, _languageFeaturesService, _accessibilitySignalService, _keybindingService, _accessibilityService) {\n        super();\n        this.editor = editor;\n        this._instantiationService = _instantiationService;\n        this._contextKeyService = _contextKeyService;\n        this._configurationService = _configurationService;\n        this._commandService = _commandService;\n        this._debounceService = _debounceService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._accessibilitySignalService = _accessibilitySignalService;\n        this._keybindingService = _keybindingService;\n        this._accessibilityService = _accessibilityService;\n        this._editorObs = observableCodeEditor(this.editor);\n        this._positions = derived(this, reader => this._editorObs.selections.read(reader)?.map(s => s.getEndPosition()) ?? [new Position(1, 1)]);\n        this._suggestWidgetAdaptor = this._register(new SuggestWidgetAdaptor(this.editor, () => {\n            this._editorObs.forceUpdate();\n            return this.model.get()?.selectedInlineCompletion.get()?.toSingleTextEdit(undefined);\n        }, (item) => this._editorObs.forceUpdate(_tx => {\n            /** @description InlineCompletionsController.handleSuggestAccepted */\n            this.model.get()?.handleSuggestAccepted(item);\n        })));\n        this._suggestWidgetSelectedItem = observableFromEvent(this, cb => this._suggestWidgetAdaptor.onDidSelectedItemChange(() => {\n            this._editorObs.forceUpdate(_tx => cb(undefined));\n        }), () => this._suggestWidgetAdaptor.selectedItem);\n        this._enabledInConfig = observableFromEvent(this, this.editor.onDidChangeConfiguration, () => this.editor.getOption(62 /* EditorOption.inlineSuggest */).enabled);\n        this._isScreenReaderEnabled = observableFromEvent(this, this._accessibilityService.onDidChangeScreenReaderOptimized, () => this._accessibilityService.isScreenReaderOptimized());\n        this._editorDictationInProgress = observableFromEvent(this, this._contextKeyService.onDidChangeContext, () => this._contextKeyService.getContext(this.editor.getDomNode()).getValue('editorDictation.inProgress') === true);\n        this._enabled = derived(this, reader => this._enabledInConfig.read(reader) && (!this._isScreenReaderEnabled.read(reader) || !this._editorDictationInProgress.read(reader)));\n        this._debounceValue = this._debounceService.for(this._languageFeaturesService.inlineCompletionsProvider, 'InlineCompletionsDebounce', { min: 50, max: 50 });\n        this.model = derivedDisposable(this, reader => {\n            if (this._editorObs.isReadonly.read(reader)) {\n                return undefined;\n            }\n            const textModel = this._editorObs.model.read(reader);\n            if (!textModel) {\n                return undefined;\n            }\n            const model = this._instantiationService.createInstance(InlineCompletionsModel, textModel, this._suggestWidgetSelectedItem, this._editorObs.versionId, this._positions, this._debounceValue, observableFromEvent(this.editor.onDidChangeConfiguration, () => this.editor.getOption(119 /* EditorOption.suggest */).preview), observableFromEvent(this.editor.onDidChangeConfiguration, () => this.editor.getOption(119 /* EditorOption.suggest */).previewMode), observableFromEvent(this.editor.onDidChangeConfiguration, () => this.editor.getOption(62 /* EditorOption.inlineSuggest */).mode), this._enabled);\n            return model;\n        }).recomputeInitiallyAndOnChange(this._store);\n        this._ghostTexts = derived(this, (reader) => {\n            const model = this.model.read(reader);\n            return model?.ghostTexts.read(reader) ?? [];\n        });\n        this._stablizedGhostTexts = convertItemsToStableObservables(this._ghostTexts, this._store);\n        this._ghostTextWidgets = mapObservableArrayCached(this, this._stablizedGhostTexts, (ghostText, store) => store.add(this._instantiationService.createInstance(GhostTextView, this.editor, {\n            ghostText: ghostText,\n            minReservedLineCount: constObservable(0),\n            targetTextModel: this.model.map(v => v?.textModel),\n        }))).recomputeInitiallyAndOnChange(this._store);\n        this._playAccessibilitySignal = observableSignal(this);\n        this._fontFamily = observableFromEvent(this, this.editor.onDidChangeConfiguration, () => this.editor.getOption(62 /* EditorOption.inlineSuggest */).fontFamily);\n        this._register(new InlineCompletionContextKeys(this._contextKeyService, this.model));\n        this._register(reactToChange(this._editorObs.onDidType, (_value, _changes) => {\n            if (this._enabled.get()) {\n                this.model.get()?.trigger();\n            }\n        }));\n        this._register(this._commandService.onDidExecuteCommand((e) => {\n            // These commands don't trigger onDidType.\n            const commands = new Set([\n                CoreEditingCommands.Tab.id,\n                CoreEditingCommands.DeleteLeft.id,\n                CoreEditingCommands.DeleteRight.id,\n                inlineSuggestCommitId,\n                'acceptSelectedSuggestion',\n            ]);\n            if (commands.has(e.commandId) && editor.hasTextFocus() && this._enabled.get()) {\n                this._editorObs.forceUpdate(tx => {\n                    /** @description onDidExecuteCommand */\n                    this.model.get()?.trigger(tx);\n                });\n            }\n        }));\n        this._register(reactToChange(this._editorObs.selections, (_value, changes) => {\n            if (changes.some(e => e.reason === 3 /* CursorChangeReason.Explicit */ || e.source === 'api')) {\n                this.model.get()?.stop();\n            }\n        }));\n        this._register(this.editor.onDidBlurEditorWidget(() => {\n            // This is a hidden setting very useful for debugging\n            if (this._contextKeyService.getContextKeyValue('accessibleViewIsShown')\n                || this._configurationService.getValue('editor.inlineSuggest.keepOnBlur')\n                || editor.getOption(62 /* EditorOption.inlineSuggest */).keepOnBlur\n                || InlineSuggestionHintsContentWidget.dropDownVisible) {\n                return;\n            }\n            transaction(tx => {\n                /** @description InlineCompletionsController.onDidBlurEditorWidget */\n                this.model.get()?.stop(tx);\n            });\n        }));\n        this._register(autorun(reader => {\n            /** @description InlineCompletionsController.forceRenderingAbove */\n            const state = this.model.read(reader)?.state.read(reader);\n            if (state?.suggestItem) {\n                if (state.primaryGhostText.lineCount >= 2) {\n                    this._suggestWidgetAdaptor.forceRenderingAbove();\n                }\n            }\n            else {\n                this._suggestWidgetAdaptor.stopForceRenderingAbove();\n            }\n        }));\n        this._register(toDisposable(() => {\n            this._suggestWidgetAdaptor.stopForceRenderingAbove();\n        }));\n        const currentInlineCompletionBySemanticId = derivedObservableWithCache(this, (reader, last) => {\n            const model = this.model.read(reader);\n            const state = model?.state.read(reader);\n            if (this._suggestWidgetSelectedItem.get()) {\n                return last;\n            }\n            return state?.inlineCompletion?.semanticId;\n        });\n        this._register(reactToChangeWithStore(derived(reader => {\n            this._playAccessibilitySignal.read(reader);\n            currentInlineCompletionBySemanticId.read(reader);\n            return {};\n        }), async (_value, _deltas, store) => {\n            /** @description InlineCompletionsController.playAccessibilitySignalAndReadSuggestion */\n            const model = this.model.get();\n            const state = model?.state.get();\n            if (!state || !model) {\n                return;\n            }\n            const lineText = model.textModel.getLineContent(state.primaryGhostText.lineNumber);\n            await timeout(50, cancelOnDispose(store));\n            await waitForState(this._suggestWidgetSelectedItem, isUndefined, () => false, cancelOnDispose(store));\n            await this._accessibilitySignalService.playSignal(AccessibilitySignal.inlineSuggestion);\n            if (this.editor.getOption(8 /* EditorOption.screenReaderAnnounceInlineSuggestion */)) {\n                this._provideScreenReaderUpdate(state.primaryGhostText.renderForScreenReader(lineText));\n            }\n        }));\n        this._register(new InlineCompletionsHintsWidget(this.editor, this.model, this._instantiationService));\n        this._register(createStyleSheetFromObservable(derived(reader => {\n            const fontFamily = this._fontFamily.read(reader);\n            if (fontFamily === '' || fontFamily === 'default') {\n                return '';\n            }\n            return `\n.monaco-editor .ghost-text-decoration,\n.monaco-editor .ghost-text-decoration-preview,\n.monaco-editor .ghost-text {\n\tfont-family: ${fontFamily};\n}`;\n        })));\n        // TODO@hediet\n        this._register(this._configurationService.onDidChangeConfiguration(e => {\n            if (e.affectsConfiguration('accessibility.verbosity.inlineCompletions')) {\n                this.editor.updateOptions({ inlineCompletionsAccessibilityVerbose: this._configurationService.getValue('accessibility.verbosity.inlineCompletions') });\n            }\n        }));\n        this.editor.updateOptions({ inlineCompletionsAccessibilityVerbose: this._configurationService.getValue('accessibility.verbosity.inlineCompletions') });\n    }\n    playAccessibilitySignal(tx) {\n        this._playAccessibilitySignal.trigger(tx);\n    }\n    _provideScreenReaderUpdate(content) {\n        const accessibleViewShowing = this._contextKeyService.getContextKeyValue('accessibleViewIsShown');\n        const accessibleViewKeybinding = this._keybindingService.lookupKeybinding('editor.action.accessibleView');\n        let hint;\n        if (!accessibleViewShowing && accessibleViewKeybinding && this.editor.getOption(150 /* EditorOption.inlineCompletionsAccessibilityVerbose */)) {\n            hint = localize('showAccessibleViewHint', \"Inspect this in the accessible view ({0})\", accessibleViewKeybinding.getAriaLabel());\n        }\n        alert(hint ? content + ', ' + hint : content);\n    }\n    shouldShowHoverAt(range) {\n        const ghostText = this.model.get()?.primaryGhostText.get();\n        if (ghostText) {\n            return ghostText.parts.some(p => range.containsPosition(new Position(ghostText.lineNumber, p.column)));\n        }\n        return false;\n    }\n    shouldShowHoverAtViewZone(viewZoneId) {\n        return this._ghostTextWidgets.get()[0]?.ownsViewZone(viewZoneId) ?? false;\n    }\n};\nInlineCompletionsController = InlineCompletionsController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IContextKeyService),\n    __param(3, IConfigurationService),\n    __param(4, ICommandService),\n    __param(5, ILanguageFeatureDebounceService),\n    __param(6, ILanguageFeaturesService),\n    __param(7, IAccessibilitySignalService),\n    __param(8, IKeybindingService),\n    __param(9, IAccessibilityService)\n], InlineCompletionsController);\nexport { InlineCompletionsController };\nfunction convertItemsToStableObservables(items, store) {\n    const result = observableValue('result', []);\n    const innerObservables = [];\n    store.add(autorun(reader => {\n        const itemsValue = items.read(reader);\n        transaction(tx => {\n            if (itemsValue.length !== innerObservables.length) {\n                innerObservables.length = itemsValue.length;\n                for (let i = 0; i < innerObservables.length; i++) {\n                    if (!innerObservables[i]) {\n                        innerObservables[i] = observableValue('item', itemsValue[i]);\n                    }\n                }\n                result.set([...innerObservables], tx);\n            }\n            innerObservables.forEach((o, i) => o.set(itemsValue[i], tx));\n        });\n    }));\n    return result;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { transaction } from '../../../../../base/common/observable.js';\nimport { asyncTransaction } from '../../../../../base/common/observableInternal/base.js';\nimport { EditorAction } from '../../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../../common/editorContextKeys.js';\nimport { showNextInlineSuggestionActionId, showPreviousInlineSuggestionActionId, inlineSuggestCommitId } from './commandIds.js';\nimport { InlineCompletionContextKeys } from './inlineCompletionContextKeys.js';\nimport { InlineCompletionsController } from './inlineCompletionsController.js';\nimport { Context as SuggestContext } from '../../../suggest/browser/suggest.js';\nimport * as nls from '../../../../../nls.js';\nimport { MenuId, Action2 } from '../../../../../platform/actions/common/actions.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr } from '../../../../../platform/contextkey/common/contextkey.js';\nexport class ShowNextInlineSuggestionAction extends EditorAction {\n    static { this.ID = showNextInlineSuggestionActionId; }\n    constructor() {\n        super({\n            id: ShowNextInlineSuggestionAction.ID,\n            label: nls.localize('action.inlineSuggest.showNext', \"Show Next Inline Suggestion\"),\n            alias: 'Show Next Inline Suggestion',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, InlineCompletionContextKeys.inlineSuggestionVisible),\n            kbOpts: {\n                weight: 100,\n                primary: 512 /* KeyMod.Alt */ | 94 /* KeyCode.BracketRight */,\n            },\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineCompletionsController.get(editor);\n        controller?.model.get()?.next();\n    }\n}\nexport class ShowPreviousInlineSuggestionAction extends EditorAction {\n    static { this.ID = showPreviousInlineSuggestionActionId; }\n    constructor() {\n        super({\n            id: ShowPreviousInlineSuggestionAction.ID,\n            label: nls.localize('action.inlineSuggest.showPrevious', \"Show Previous Inline Suggestion\"),\n            alias: 'Show Previous Inline Suggestion',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, InlineCompletionContextKeys.inlineSuggestionVisible),\n            kbOpts: {\n                weight: 100,\n                primary: 512 /* KeyMod.Alt */ | 92 /* KeyCode.BracketLeft */,\n            },\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineCompletionsController.get(editor);\n        controller?.model.get()?.previous();\n    }\n}\nexport class TriggerInlineSuggestionAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inlineSuggest.trigger',\n            label: nls.localize('action.inlineSuggest.trigger', \"Trigger Inline Suggestion\"),\n            alias: 'Trigger Inline Suggestion',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineCompletionsController.get(editor);\n        await asyncTransaction(async (tx) => {\n            /** @description triggerExplicitly from command */\n            await controller?.model.get()?.triggerExplicitly(tx);\n            controller?.playAccessibilitySignal(tx);\n        });\n    }\n}\nexport class AcceptNextWordOfInlineCompletion extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inlineSuggest.acceptNextWord',\n            label: nls.localize('action.inlineSuggest.acceptNextWord', \"Accept Next Word Of Inline Suggestion\"),\n            alias: 'Accept Next Word Of Inline Suggestion',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, InlineCompletionContextKeys.inlineSuggestionVisible),\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */ + 1,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 17 /* KeyCode.RightArrow */,\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.writable, InlineCompletionContextKeys.inlineSuggestionVisible),\n            },\n            menuOpts: [{\n                    menuId: MenuId.InlineSuggestionToolbar,\n                    title: nls.localize('acceptWord', 'Accept Word'),\n                    group: 'primary',\n                    order: 2,\n                }],\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineCompletionsController.get(editor);\n        await controller?.model.get()?.acceptNextWord(controller.editor);\n    }\n}\nexport class AcceptNextLineOfInlineCompletion extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inlineSuggest.acceptNextLine',\n            label: nls.localize('action.inlineSuggest.acceptNextLine', \"Accept Next Line Of Inline Suggestion\"),\n            alias: 'Accept Next Line Of Inline Suggestion',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, InlineCompletionContextKeys.inlineSuggestionVisible),\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */ + 1,\n            },\n            menuOpts: [{\n                    menuId: MenuId.InlineSuggestionToolbar,\n                    title: nls.localize('acceptLine', 'Accept Line'),\n                    group: 'secondary',\n                    order: 2,\n                }],\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineCompletionsController.get(editor);\n        await controller?.model.get()?.acceptNextLine(controller.editor);\n    }\n}\nexport class AcceptInlineCompletion extends EditorAction {\n    constructor() {\n        super({\n            id: inlineSuggestCommitId,\n            label: nls.localize('action.inlineSuggest.accept', \"Accept Inline Suggestion\"),\n            alias: 'Accept Inline Suggestion',\n            precondition: InlineCompletionContextKeys.inlineSuggestionVisible,\n            menuOpts: [{\n                    menuId: MenuId.InlineSuggestionToolbar,\n                    title: nls.localize('accept', \"Accept\"),\n                    group: 'primary',\n                    order: 1,\n                }],\n            kbOpts: {\n                primary: 2 /* KeyCode.Tab */,\n                weight: 200,\n                kbExpr: ContextKeyExpr.and(InlineCompletionContextKeys.inlineSuggestionVisible, EditorContextKeys.tabMovesFocus.toNegated(), InlineCompletionContextKeys.inlineSuggestionHasIndentationLessThanTabSize, SuggestContext.Visible.toNegated(), EditorContextKeys.hoverFocused.toNegated()),\n            }\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineCompletionsController.get(editor);\n        if (controller) {\n            controller.model.get()?.accept(controller.editor);\n            controller.editor.focus();\n        }\n    }\n}\nexport class HideInlineCompletion extends EditorAction {\n    static { this.ID = 'editor.action.inlineSuggest.hide'; }\n    constructor() {\n        super({\n            id: HideInlineCompletion.ID,\n            label: nls.localize('action.inlineSuggest.hide', \"Hide Inline Suggestion\"),\n            alias: 'Hide Inline Suggestion',\n            precondition: InlineCompletionContextKeys.inlineSuggestionVisible,\n            kbOpts: {\n                weight: 100,\n                primary: 9 /* KeyCode.Escape */,\n            }\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineCompletionsController.get(editor);\n        transaction(tx => {\n            controller?.model.get()?.stop(tx);\n        });\n    }\n}\nexport class ToggleAlwaysShowInlineSuggestionToolbar extends Action2 {\n    static { this.ID = 'editor.action.inlineSuggest.toggleAlwaysShowToolbar'; }\n    constructor() {\n        super({\n            id: ToggleAlwaysShowInlineSuggestionToolbar.ID,\n            title: nls.localize('action.inlineSuggest.alwaysShowToolbar', \"Always Show Toolbar\"),\n            f1: false,\n            precondition: undefined,\n            menu: [{\n                    id: MenuId.InlineSuggestionToolbar,\n                    group: 'secondary',\n                    order: 10,\n                }],\n            toggled: ContextKeyExpr.equals('config.editor.inlineSuggest.showToolbar', 'always')\n        });\n    }\n    async run(accessor, editor) {\n        const configService = accessor.get(IConfigurationService);\n        const currentValue = configService.getValue('editor.inlineSuggest.showToolbar');\n        const newValue = currentValue === 'always' ? 'onHover' : 'always';\n        configService.updateValue('editor.inlineSuggest.showToolbar', newValue);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { MarkdownString } from '../../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { autorun, constObservable } from '../../../../../base/common/observable.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { HoverForeignElementAnchor, RenderedHoverParts } from '../../../hover/browser/hoverTypes.js';\nimport { InlineCompletionsController } from '../controller/inlineCompletionsController.js';\nimport { InlineSuggestionHintsContentWidget } from './inlineCompletionsHintsWidget.js';\nimport { MarkdownRenderer } from '../../../../browser/widget/markdownRenderer/browser/markdownRenderer.js';\nimport * as nls from '../../../../../nls.js';\nimport { IAccessibilityService } from '../../../../../platform/accessibility/common/accessibility.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IOpenerService } from '../../../../../platform/opener/common/opener.js';\nimport { ITelemetryService } from '../../../../../platform/telemetry/common/telemetry.js';\nexport class InlineCompletionsHover {\n    constructor(owner, range, controller) {\n        this.owner = owner;\n        this.range = range;\n        this.controller = controller;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* HoverAnchorType.Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n}\nlet InlineCompletionsHoverParticipant = class InlineCompletionsHoverParticipant {\n    constructor(_editor, _languageService, _openerService, accessibilityService, _instantiationService, _telemetryService) {\n        this._editor = _editor;\n        this._languageService = _languageService;\n        this._openerService = _openerService;\n        this.accessibilityService = accessibilityService;\n        this._instantiationService = _instantiationService;\n        this._telemetryService = _telemetryService;\n        this.hoverOrdinal = 4;\n    }\n    suggestHoverAnchor(mouseEvent) {\n        const controller = InlineCompletionsController.get(this._editor);\n        if (!controller) {\n            return null;\n        }\n        const target = mouseEvent.target;\n        if (target.type === 8 /* MouseTargetType.CONTENT_VIEW_ZONE */) {\n            // handle the case where the mouse is over the view zone\n            const viewZoneData = target.detail;\n            if (controller.shouldShowHoverAtViewZone(viewZoneData.viewZoneId)) {\n                return new HoverForeignElementAnchor(1000, this, Range.fromPositions(this._editor.getModel().validatePosition(viewZoneData.positionBefore || viewZoneData.position)), mouseEvent.event.posx, mouseEvent.event.posy, false);\n            }\n        }\n        if (target.type === 7 /* MouseTargetType.CONTENT_EMPTY */) {\n            // handle the case where the mouse is over the empty portion of a line following ghost text\n            if (controller.shouldShowHoverAt(target.range)) {\n                return new HoverForeignElementAnchor(1000, this, target.range, mouseEvent.event.posx, mouseEvent.event.posy, false);\n            }\n        }\n        if (target.type === 6 /* MouseTargetType.CONTENT_TEXT */) {\n            // handle the case where the mouse is directly over ghost text\n            const mightBeForeignElement = target.detail.mightBeForeignElement;\n            if (mightBeForeignElement && controller.shouldShowHoverAt(target.range)) {\n                return new HoverForeignElementAnchor(1000, this, target.range, mouseEvent.event.posx, mouseEvent.event.posy, false);\n            }\n        }\n        return null;\n    }\n    computeSync(anchor, lineDecorations) {\n        if (this._editor.getOption(62 /* EditorOption.inlineSuggest */).showToolbar !== 'onHover') {\n            return [];\n        }\n        const controller = InlineCompletionsController.get(this._editor);\n        if (controller && controller.shouldShowHoverAt(anchor.range)) {\n            return [new InlineCompletionsHover(this, anchor.range, controller)];\n        }\n        return [];\n    }\n    renderHoverParts(context, hoverParts) {\n        const disposables = new DisposableStore();\n        const part = hoverParts[0];\n        this._telemetryService.publicLog2('inlineCompletionHover.shown');\n        if (this.accessibilityService.isScreenReaderOptimized() && !this._editor.getOption(8 /* EditorOption.screenReaderAnnounceInlineSuggestion */)) {\n            disposables.add(this.renderScreenReaderText(context, part));\n        }\n        const model = part.controller.model.get();\n        const w = this._instantiationService.createInstance(InlineSuggestionHintsContentWidget, this._editor, false, constObservable(null), model.selectedInlineCompletionIndex, model.inlineCompletionsCount, model.activeCommands);\n        const widgetNode = w.getDomNode();\n        context.fragment.appendChild(widgetNode);\n        model.triggerExplicitly();\n        disposables.add(w);\n        const renderedHoverPart = {\n            hoverPart: part,\n            hoverElement: widgetNode,\n            dispose() { disposables.dispose(); }\n        };\n        return new RenderedHoverParts([renderedHoverPart]);\n    }\n    renderScreenReaderText(context, part) {\n        const disposables = new DisposableStore();\n        const $ = dom.$;\n        const markdownHoverElement = $('div.hover-row.markdown-hover');\n        const hoverContentsElement = dom.append(markdownHoverElement, $('div.hover-contents', { ['aria-live']: 'assertive' }));\n        const renderer = disposables.add(new MarkdownRenderer({ editor: this._editor }, this._languageService, this._openerService));\n        const render = (code) => {\n            disposables.add(renderer.onDidRenderAsync(() => {\n                hoverContentsElement.className = 'hover-contents code-hover-contents';\n                context.onContentsChanged();\n            }));\n            const inlineSuggestionAvailable = nls.localize('inlineSuggestionFollows', \"Suggestion:\");\n            const renderedContents = disposables.add(renderer.render(new MarkdownString().appendText(inlineSuggestionAvailable).appendCodeblock('text', code)));\n            hoverContentsElement.replaceChildren(renderedContents.element);\n        };\n        disposables.add(autorun(reader => {\n            /** @description update hover */\n            const ghostText = part.controller.model.read(reader)?.primaryGhostText.read(reader);\n            if (ghostText) {\n                const lineText = this._editor.getModel().getLineContent(ghostText.lineNumber);\n                render(ghostText.renderForScreenReader(lineText));\n            }\n            else {\n                dom.reset(hoverContentsElement);\n            }\n        }));\n        context.fragment.appendChild(markdownHoverElement);\n        return disposables;\n    }\n};\nInlineCompletionsHoverParticipant = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IOpenerService),\n    __param(3, IAccessibilityService),\n    __param(4, IInstantiationService),\n    __param(5, ITelemetryService)\n], InlineCompletionsHoverParticipant);\nexport { InlineCompletionsHoverParticipant };\n","export class InlineCompletionsAccessibleView {\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { HoverParticipantRegistry } from '../../hover/browser/hoverTypes.js';\nimport { TriggerInlineSuggestionAction, ShowNextInlineSuggestionAction, ShowPreviousInlineSuggestionAction, AcceptNextWordOfInlineCompletion, AcceptInlineCompletion, HideInlineCompletion, ToggleAlwaysShowInlineSuggestionToolbar, AcceptNextLineOfInlineCompletion } from './controller/commands.js';\nimport { InlineCompletionsHoverParticipant } from './hintsWidget/hoverParticipant.js';\nimport { InlineCompletionsAccessibleView } from './inlineCompletionsAccessibleView.js';\nimport { InlineCompletionsController } from './controller/inlineCompletionsController.js';\nimport { AccessibleViewRegistry } from '../../../../platform/accessibility/browser/accessibleViewRegistry.js';\nimport { registerAction2 } from '../../../../platform/actions/common/actions.js';\nregisterEditorContribution(InlineCompletionsController.ID, InlineCompletionsController, 3 /* EditorContributionInstantiation.Eventually */);\nregisterEditorAction(TriggerInlineSuggestionAction);\nregisterEditorAction(ShowNextInlineSuggestionAction);\nregisterEditorAction(ShowPreviousInlineSuggestionAction);\nregisterEditorAction(AcceptNextWordOfInlineCompletion);\nregisterEditorAction(AcceptNextLineOfInlineCompletion);\nregisterEditorAction(AcceptInlineCompletion);\nregisterEditorAction(HideInlineCompletion);\nregisterAction2(ToggleAlwaysShowInlineSuggestionToolbar);\nHoverParticipantRegistry.register(InlineCompletionsHoverParticipant);\nAccessibleViewRegistry.register(new InlineCompletionsAccessibleView());\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar GotoDefinitionAtPositionEditorContribution_1;\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { MarkdownString } from '../../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport './goToDefinitionAtPosition.css';\nimport { EditorState } from '../../../editorState/browser/editorState.js';\nimport { registerEditorContribution } from '../../../../browser/editorExtensions.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { ClickLinkGesture } from './clickLinkGesture.js';\nimport { PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { DefinitionAction } from '../goToCommands.js';\nimport { getDefinitionsAtPosition } from '../goToSymbol.js';\nimport { ILanguageFeaturesService } from '../../../../common/services/languageFeatures.js';\nimport { ModelDecorationInjectedTextOptions } from '../../../../common/model/textModel.js';\nlet GotoDefinitionAtPositionEditorContribution = class GotoDefinitionAtPositionEditorContribution {\n    static { GotoDefinitionAtPositionEditorContribution_1 = this; }\n    static { this.ID = 'editor.contrib.gotodefinitionatposition'; }\n    static { this.MAX_SOURCE_PREVIEW_LINES = 8; }\n    constructor(editor, textModelResolverService, languageService, languageFeaturesService) {\n        this.textModelResolverService = textModelResolverService;\n        this.languageService = languageService;\n        this.languageFeaturesService = languageFeaturesService;\n        this.toUnhook = new DisposableStore();\n        this.toUnhookForKeyboard = new DisposableStore();\n        this.currentWordAtPosition = null;\n        this.previousPromise = null;\n        this.editor = editor;\n        this.linkDecorations = this.editor.createDecorationsCollection();\n        const linkGesture = new ClickLinkGesture(editor);\n        this.toUnhook.add(linkGesture);\n        this.toUnhook.add(linkGesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, keyboardEvent]) => {\n            this.startFindDefinitionFromMouse(mouseEvent, keyboardEvent ?? undefined);\n        }));\n        this.toUnhook.add(linkGesture.onExecute((mouseEvent) => {\n            if (this.isEnabled(mouseEvent)) {\n                this.gotoDefinition(mouseEvent.target.position, mouseEvent.hasSideBySideModifier)\n                    .catch((error) => {\n                    onUnexpectedError(error);\n                })\n                    .finally(() => {\n                    this.removeLinkDecorations();\n                });\n            }\n        }));\n        this.toUnhook.add(linkGesture.onCancel(() => {\n            this.removeLinkDecorations();\n            this.currentWordAtPosition = null;\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(GotoDefinitionAtPositionEditorContribution_1.ID);\n    }\n    async startFindDefinitionFromCursor(position) {\n        // For issue: https://github.com/microsoft/vscode/issues/46257\n        // equivalent to mouse move with meta/ctrl key\n        // First find the definition and add decorations\n        // to the editor to be shown with the content hover widget\n        await this.startFindDefinition(position);\n        // Add listeners for editor cursor move and key down events\n        // Dismiss the \"extended\" editor decorations when the user hides\n        // the hover widget. There is no event for the widget itself so these\n        // serve as a best effort. After removing the link decorations, the hover\n        // widget is clean and will only show declarations per next request.\n        this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(() => {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            this.toUnhookForKeyboard.clear();\n        }));\n        this.toUnhookForKeyboard.add(this.editor.onKeyDown((e) => {\n            if (e) {\n                this.currentWordAtPosition = null;\n                this.removeLinkDecorations();\n                this.toUnhookForKeyboard.clear();\n            }\n        }));\n    }\n    startFindDefinitionFromMouse(mouseEvent, withKey) {\n        // check if we are active and on a content widget\n        if (mouseEvent.target.type === 9 /* MouseTargetType.CONTENT_WIDGET */ && this.linkDecorations.length > 0) {\n            return;\n        }\n        if (!this.editor.hasModel() || !this.isEnabled(mouseEvent, withKey)) {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            return;\n        }\n        const position = mouseEvent.target.position;\n        this.startFindDefinition(position);\n    }\n    async startFindDefinition(position) {\n        // Dispose listeners for updating decorations when using keyboard to show definition hover\n        this.toUnhookForKeyboard.clear();\n        // Find word at mouse position\n        const word = position ? this.editor.getModel()?.getWordAtPosition(position) : null;\n        if (!word) {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            return;\n        }\n        // Return early if word at position is still the same\n        if (this.currentWordAtPosition && this.currentWordAtPosition.startColumn === word.startColumn && this.currentWordAtPosition.endColumn === word.endColumn && this.currentWordAtPosition.word === word.word) {\n            return;\n        }\n        this.currentWordAtPosition = word;\n        // Find definition and decorate word if found\n        const state = new EditorState(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */ | 2 /* CodeEditorStateFlag.Selection */ | 8 /* CodeEditorStateFlag.Scroll */);\n        if (this.previousPromise) {\n            this.previousPromise.cancel();\n            this.previousPromise = null;\n        }\n        this.previousPromise = createCancelablePromise(token => this.findDefinition(position, token));\n        let results;\n        try {\n            results = await this.previousPromise;\n        }\n        catch (error) {\n            onUnexpectedError(error);\n            return;\n        }\n        if (!results || !results.length || !state.validate(this.editor)) {\n            this.removeLinkDecorations();\n            return;\n        }\n        const linkRange = results[0].originSelectionRange\n            ? Range.lift(results[0].originSelectionRange)\n            : new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\n        // Multiple results\n        if (results.length > 1) {\n            let combinedRange = linkRange;\n            for (const { originSelectionRange } of results) {\n                if (originSelectionRange) {\n                    combinedRange = Range.plusRange(combinedRange, originSelectionRange);\n                }\n            }\n            this.addDecoration(combinedRange, new MarkdownString().appendText(nls.localize('multipleResults', \"Click to show {0} definitions.\", results.length)));\n        }\n        else {\n            // Single result\n            const result = results[0];\n            if (!result.uri) {\n                return;\n            }\n            this.textModelResolverService.createModelReference(result.uri).then(ref => {\n                if (!ref.object || !ref.object.textEditorModel) {\n                    ref.dispose();\n                    return;\n                }\n                const { object: { textEditorModel } } = ref;\n                const { startLineNumber } = result.range;\n                if (startLineNumber < 1 || startLineNumber > textEditorModel.getLineCount()) {\n                    // invalid range\n                    ref.dispose();\n                    return;\n                }\n                const previewValue = this.getPreviewValue(textEditorModel, startLineNumber, result);\n                const languageId = this.languageService.guessLanguageIdByFilepathOrFirstLine(textEditorModel.uri);\n                this.addDecoration(linkRange, previewValue ? new MarkdownString().appendCodeblock(languageId ? languageId : '', previewValue) : undefined);\n                ref.dispose();\n            });\n        }\n    }\n    getPreviewValue(textEditorModel, startLineNumber, result) {\n        let rangeToUse = result.range;\n        const numberOfLinesInRange = rangeToUse.endLineNumber - rangeToUse.startLineNumber;\n        if (numberOfLinesInRange >= GotoDefinitionAtPositionEditorContribution_1.MAX_SOURCE_PREVIEW_LINES) {\n            rangeToUse = this.getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber);\n        }\n        const previewValue = this.stripIndentationFromPreviewRange(textEditorModel, startLineNumber, rangeToUse);\n        return previewValue;\n    }\n    stripIndentationFromPreviewRange(textEditorModel, startLineNumber, previewRange) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        let minIndent = startIndent;\n        for (let endLineNumber = startLineNumber + 1; endLineNumber < previewRange.endLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            minIndent = Math.min(minIndent, endIndent);\n        }\n        const previewValue = textEditorModel.getValueInRange(previewRange).replace(new RegExp(`^\\\\s{${minIndent - 1}}`, 'gm'), '').trim();\n        return previewValue;\n    }\n    getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        const maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution_1.MAX_SOURCE_PREVIEW_LINES);\n        let endLineNumber = startLineNumber + 1;\n        for (; endLineNumber < maxLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            if (startIndent === endIndent) {\n                break;\n            }\n        }\n        return new Range(startLineNumber, 1, endLineNumber + 1, 1);\n    }\n    addDecoration(range, hoverMessage) {\n        const newDecorations = {\n            range: range,\n            options: {\n                description: 'goto-definition-link',\n                inlineClassName: 'goto-definition-link',\n                hoverMessage\n            }\n        };\n        this.linkDecorations.set([newDecorations]);\n    }\n    removeLinkDecorations() {\n        this.linkDecorations.clear();\n    }\n    isEnabled(mouseEvent, withKey) {\n        return this.editor.hasModel()\n            && mouseEvent.isLeftClick\n            && mouseEvent.isNoneOrSingleMouseDown\n            && mouseEvent.target.type === 6 /* MouseTargetType.CONTENT_TEXT */\n            && !(mouseEvent.target.detail.injectedText?.options instanceof ModelDecorationInjectedTextOptions)\n            && (mouseEvent.hasTriggerModifier || (withKey ? withKey.keyCodeIsTriggerKey : false))\n            && this.languageFeaturesService.definitionProvider.has(this.editor.getModel());\n    }\n    findDefinition(position, token) {\n        const model = this.editor.getModel();\n        if (!model) {\n            return Promise.resolve(null);\n        }\n        return getDefinitionsAtPosition(this.languageFeaturesService.definitionProvider, model, position, false, token);\n    }\n    gotoDefinition(position, openToSide) {\n        this.editor.setPosition(position);\n        return this.editor.invokeWithinContext((accessor) => {\n            const canPeek = !openToSide && this.editor.getOption(89 /* EditorOption.definitionLinkOpensInPeek */) && !this.isInPeekEditor(accessor);\n            const action = new DefinitionAction({ openToSide, openInPeek: canPeek, muteMessage: true }, { title: { value: '', original: '' }, id: '', precondition: undefined });\n            return action.run(accessor);\n        });\n    }\n    isInPeekEditor(accessor) {\n        const contextKeyService = accessor.get(IContextKeyService);\n        return PeekContext.inPeekEditor.getValue(contextKeyService);\n    }\n    dispose() {\n        this.toUnhook.dispose();\n        this.toUnhookForKeyboard.dispose();\n    }\n};\nGotoDefinitionAtPositionEditorContribution = GotoDefinitionAtPositionEditorContribution_1 = __decorate([\n    __param(1, ITextModelService),\n    __param(2, ILanguageService),\n    __param(3, ILanguageFeaturesService)\n], GotoDefinitionAtPositionEditorContribution);\nexport { GotoDefinitionAtPositionEditorContribution };\nregisterEditorContribution(GotoDefinitionAtPositionEditorContribution.ID, GotoDefinitionAtPositionEditorContribution, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { binarySearch } from '../../../../base/common/arrays.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { compare } from '../../../../base/common/strings.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../common/core/range.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IMarkerService, MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nexport class MarkerCoordinate {\n    constructor(marker, index, total) {\n        this.marker = marker;\n        this.index = index;\n        this.total = total;\n    }\n}\nlet MarkerList = class MarkerList {\n    constructor(resourceFilter, _markerService, _configService) {\n        this._markerService = _markerService;\n        this._configService = _configService;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._dispoables = new DisposableStore();\n        this._markers = [];\n        this._nextIdx = -1;\n        if (URI.isUri(resourceFilter)) {\n            this._resourceFilter = uri => uri.toString() === resourceFilter.toString();\n        }\n        else if (resourceFilter) {\n            this._resourceFilter = resourceFilter;\n        }\n        const compareOrder = this._configService.getValue('problems.sortOrder');\n        const compareMarker = (a, b) => {\n            let res = compare(a.resource.toString(), b.resource.toString());\n            if (res === 0) {\n                if (compareOrder === 'position') {\n                    res = Range.compareRangesUsingStarts(a, b) || MarkerSeverity.compare(a.severity, b.severity);\n                }\n                else {\n                    res = MarkerSeverity.compare(a.severity, b.severity) || Range.compareRangesUsingStarts(a, b);\n                }\n            }\n            return res;\n        };\n        const updateMarker = () => {\n            this._markers = this._markerService.read({\n                resource: URI.isUri(resourceFilter) ? resourceFilter : undefined,\n                severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\n            });\n            if (typeof resourceFilter === 'function') {\n                this._markers = this._markers.filter(m => this._resourceFilter(m.resource));\n            }\n            this._markers.sort(compareMarker);\n        };\n        updateMarker();\n        this._dispoables.add(_markerService.onMarkerChanged(uris => {\n            if (!this._resourceFilter || uris.some(uri => this._resourceFilter(uri))) {\n                updateMarker();\n                this._nextIdx = -1;\n                this._onDidChange.fire();\n            }\n        }));\n    }\n    dispose() {\n        this._dispoables.dispose();\n        this._onDidChange.dispose();\n    }\n    matches(uri) {\n        if (!this._resourceFilter && !uri) {\n            return true;\n        }\n        if (!this._resourceFilter || !uri) {\n            return false;\n        }\n        return this._resourceFilter(uri);\n    }\n    get selected() {\n        const marker = this._markers[this._nextIdx];\n        return marker && new MarkerCoordinate(marker, this._nextIdx + 1, this._markers.length);\n    }\n    _initIdx(model, position, fwd) {\n        let found = false;\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === model.uri.toString());\n        if (idx < 0) {\n            idx = binarySearch(this._markers, { resource: model.uri }, (a, b) => compare(a.resource.toString(), b.resource.toString()));\n            if (idx < 0) {\n                idx = ~idx;\n            }\n        }\n        for (let i = idx; i < this._markers.length; i++) {\n            let range = Range.lift(this._markers[i]);\n            if (range.isEmpty()) {\n                const word = model.getWordAtPosition(range.getStartPosition());\n                if (word) {\n                    range = new Range(range.startLineNumber, word.startColumn, range.startLineNumber, word.endColumn);\n                }\n            }\n            if (position && (range.containsPosition(position) || position.isBeforeOrEqual(range.getStartPosition()))) {\n                this._nextIdx = i;\n                found = true;\n                break;\n            }\n            if (this._markers[i].resource.toString() !== model.uri.toString()) {\n                break;\n            }\n        }\n        if (!found) {\n            // after the last change\n            this._nextIdx = fwd ? 0 : this._markers.length - 1;\n        }\n        if (this._nextIdx < 0) {\n            this._nextIdx = this._markers.length - 1;\n        }\n    }\n    resetIndex() {\n        this._nextIdx = -1;\n    }\n    move(fwd, model, position) {\n        if (this._markers.length === 0) {\n            return false;\n        }\n        const oldIdx = this._nextIdx;\n        if (this._nextIdx === -1) {\n            this._initIdx(model, position, fwd);\n        }\n        else if (fwd) {\n            this._nextIdx = (this._nextIdx + 1) % this._markers.length;\n        }\n        else if (!fwd) {\n            this._nextIdx = (this._nextIdx - 1 + this._markers.length) % this._markers.length;\n        }\n        if (oldIdx !== this._nextIdx) {\n            return true;\n        }\n        return false;\n    }\n    find(uri, position) {\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === uri.toString());\n        if (idx < 0) {\n            return undefined;\n        }\n        for (; idx < this._markers.length; idx++) {\n            if (Range.containsPosition(this._markers[idx], position)) {\n                return new MarkerCoordinate(this._markers[idx], idx + 1, this._markers.length);\n            }\n        }\n        return undefined;\n    }\n};\nMarkerList = __decorate([\n    __param(1, IMarkerService),\n    __param(2, IConfigurationService)\n], MarkerList);\nexport { MarkerList };\nexport const IMarkerNavigationService = createDecorator('IMarkerNavigationService');\nlet MarkerNavigationService = class MarkerNavigationService {\n    constructor(_markerService, _configService) {\n        this._markerService = _markerService;\n        this._configService = _configService;\n        this._provider = new LinkedList();\n    }\n    getMarkerList(resource) {\n        for (const provider of this._provider) {\n            const result = provider.getMarkerList(resource);\n            if (result) {\n                return result;\n            }\n        }\n        // default\n        return new MarkerList(resource, this._markerService, this._configService);\n    }\n};\nMarkerNavigationService = __decorate([\n    __param(0, IMarkerService),\n    __param(1, IConfigurationService)\n], MarkerNavigationService);\nregisterSingleton(IMarkerNavigationService, MarkerNavigationService, 1 /* InstantiationType.Delayed */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar MarkerNavigationWidget_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { splitLines } from '../../../../base/common/strings.js';\nimport './media/gotoErrorWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { peekViewTitleForeground, peekViewTitleInfoForeground, PeekViewWidget } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { createAndFillInActionBarActions } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IMenuService, MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { SeverityIcon } from '../../../../platform/severityIcon/browser/severityIcon.js';\nimport { contrastBorder, editorBackground, editorErrorBorder, editorErrorForeground, editorInfoBorder, editorInfoForeground, editorWarningBorder, editorWarningForeground, oneOf, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nclass MessageWidget {\n    constructor(parent, editor, onRelatedInformation, _openerService, _labelService) {\n        this._openerService = _openerService;\n        this._labelService = _labelService;\n        this._lines = 0;\n        this._longestLineLength = 0;\n        this._relatedDiagnostics = new WeakMap();\n        this._disposables = new DisposableStore();\n        this._editor = editor;\n        const domNode = document.createElement('div');\n        domNode.className = 'descriptioncontainer';\n        this._messageBlock = document.createElement('div');\n        this._messageBlock.classList.add('message');\n        this._messageBlock.setAttribute('aria-live', 'assertive');\n        this._messageBlock.setAttribute('role', 'alert');\n        domNode.appendChild(this._messageBlock);\n        this._relatedBlock = document.createElement('div');\n        domNode.appendChild(this._relatedBlock);\n        this._disposables.add(dom.addStandardDisposableListener(this._relatedBlock, 'click', event => {\n            event.preventDefault();\n            const related = this._relatedDiagnostics.get(event.target);\n            if (related) {\n                onRelatedInformation(related);\n            }\n        }));\n        this._scrollable = new ScrollableElement(domNode, {\n            horizontal: 1 /* ScrollbarVisibility.Auto */,\n            vertical: 1 /* ScrollbarVisibility.Auto */,\n            useShadows: false,\n            horizontalScrollbarSize: 6,\n            verticalScrollbarSize: 6\n        });\n        parent.appendChild(this._scrollable.getDomNode());\n        this._disposables.add(this._scrollable.onScroll(e => {\n            domNode.style.left = `-${e.scrollLeft}px`;\n            domNode.style.top = `-${e.scrollTop}px`;\n        }));\n        this._disposables.add(this._scrollable);\n    }\n    dispose() {\n        dispose(this._disposables);\n    }\n    update(marker) {\n        const { source, message, relatedInformation, code } = marker;\n        let sourceAndCodeLength = (source?.length || 0) + '()'.length;\n        if (code) {\n            if (typeof code === 'string') {\n                sourceAndCodeLength += code.length;\n            }\n            else {\n                sourceAndCodeLength += code.value.length;\n            }\n        }\n        const lines = splitLines(message);\n        this._lines = lines.length;\n        this._longestLineLength = 0;\n        for (const line of lines) {\n            this._longestLineLength = Math.max(line.length + sourceAndCodeLength, this._longestLineLength);\n        }\n        dom.clearNode(this._messageBlock);\n        this._messageBlock.setAttribute('aria-label', this.getAriaLabel(marker));\n        this._editor.applyFontInfo(this._messageBlock);\n        let lastLineElement = this._messageBlock;\n        for (const line of lines) {\n            lastLineElement = document.createElement('div');\n            lastLineElement.innerText = line;\n            if (line === '') {\n                lastLineElement.style.height = this._messageBlock.style.lineHeight;\n            }\n            this._messageBlock.appendChild(lastLineElement);\n        }\n        if (source || code) {\n            const detailsElement = document.createElement('span');\n            detailsElement.classList.add('details');\n            lastLineElement.appendChild(detailsElement);\n            if (source) {\n                const sourceElement = document.createElement('span');\n                sourceElement.innerText = source;\n                sourceElement.classList.add('source');\n                detailsElement.appendChild(sourceElement);\n            }\n            if (code) {\n                if (typeof code === 'string') {\n                    const codeElement = document.createElement('span');\n                    codeElement.innerText = `(${code})`;\n                    codeElement.classList.add('code');\n                    detailsElement.appendChild(codeElement);\n                }\n                else {\n                    this._codeLink = dom.$('a.code-link');\n                    this._codeLink.setAttribute('href', `${code.target.toString()}`);\n                    this._codeLink.onclick = (e) => {\n                        this._openerService.open(code.target, { allowCommands: true });\n                        e.preventDefault();\n                        e.stopPropagation();\n                    };\n                    const codeElement = dom.append(this._codeLink, dom.$('span'));\n                    codeElement.innerText = code.value;\n                    detailsElement.appendChild(this._codeLink);\n                }\n            }\n        }\n        dom.clearNode(this._relatedBlock);\n        this._editor.applyFontInfo(this._relatedBlock);\n        if (isNonEmptyArray(relatedInformation)) {\n            const relatedInformationNode = this._relatedBlock.appendChild(document.createElement('div'));\n            relatedInformationNode.style.paddingTop = `${Math.floor(this._editor.getOption(67 /* EditorOption.lineHeight */) * 0.66)}px`;\n            this._lines += 1;\n            for (const related of relatedInformation) {\n                const container = document.createElement('div');\n                const relatedResource = document.createElement('a');\n                relatedResource.classList.add('filename');\n                relatedResource.innerText = `${this._labelService.getUriBasenameLabel(related.resource)}(${related.startLineNumber}, ${related.startColumn}): `;\n                relatedResource.title = this._labelService.getUriLabel(related.resource);\n                this._relatedDiagnostics.set(relatedResource, related);\n                const relatedMessage = document.createElement('span');\n                relatedMessage.innerText = related.message;\n                container.appendChild(relatedResource);\n                container.appendChild(relatedMessage);\n                this._lines += 1;\n                relatedInformationNode.appendChild(container);\n            }\n        }\n        const fontInfo = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        const scrollWidth = Math.ceil(fontInfo.typicalFullwidthCharacterWidth * this._longestLineLength * 0.75);\n        const scrollHeight = fontInfo.lineHeight * this._lines;\n        this._scrollable.setScrollDimensions({ scrollWidth, scrollHeight });\n    }\n    layout(height, width) {\n        this._scrollable.getDomNode().style.height = `${height}px`;\n        this._scrollable.getDomNode().style.width = `${width}px`;\n        this._scrollable.setScrollDimensions({ width, height });\n    }\n    getHeightInLines() {\n        return Math.min(17, this._lines);\n    }\n    getAriaLabel(marker) {\n        let severityLabel = '';\n        switch (marker.severity) {\n            case MarkerSeverity.Error:\n                severityLabel = nls.localize('Error', \"Error\");\n                break;\n            case MarkerSeverity.Warning:\n                severityLabel = nls.localize('Warning', \"Warning\");\n                break;\n            case MarkerSeverity.Info:\n                severityLabel = nls.localize('Info', \"Info\");\n                break;\n            case MarkerSeverity.Hint:\n                severityLabel = nls.localize('Hint', \"Hint\");\n                break;\n        }\n        let ariaLabel = nls.localize('marker aria', \"{0} at {1}. \", severityLabel, marker.startLineNumber + ':' + marker.startColumn);\n        const model = this._editor.getModel();\n        if (model && (marker.startLineNumber <= model.getLineCount()) && (marker.startLineNumber >= 1)) {\n            const lineContent = model.getLineContent(marker.startLineNumber);\n            ariaLabel = `${lineContent}, ${ariaLabel}`;\n        }\n        return ariaLabel;\n    }\n}\nlet MarkerNavigationWidget = class MarkerNavigationWidget extends PeekViewWidget {\n    static { MarkerNavigationWidget_1 = this; }\n    static { this.TitleMenu = new MenuId('gotoErrorTitleMenu'); }\n    constructor(editor, _themeService, _openerService, _menuService, instantiationService, _contextKeyService, _labelService) {\n        super(editor, { showArrow: true, showFrame: true, isAccessible: true, frameWidth: 1 }, instantiationService);\n        this._themeService = _themeService;\n        this._openerService = _openerService;\n        this._menuService = _menuService;\n        this._contextKeyService = _contextKeyService;\n        this._labelService = _labelService;\n        this._callOnDispose = new DisposableStore();\n        this._onDidSelectRelatedInformation = new Emitter();\n        this.onDidSelectRelatedInformation = this._onDidSelectRelatedInformation.event;\n        this._severity = MarkerSeverity.Warning;\n        this._backgroundColor = Color.white;\n        this._applyTheme(_themeService.getColorTheme());\n        this._callOnDispose.add(_themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this.create();\n    }\n    _applyTheme(theme) {\n        this._backgroundColor = theme.getColor(editorMarkerNavigationBackground);\n        let colorId = editorMarkerNavigationError;\n        let headerBackground = editorMarkerNavigationErrorHeader;\n        if (this._severity === MarkerSeverity.Warning) {\n            colorId = editorMarkerNavigationWarning;\n            headerBackground = editorMarkerNavigationWarningHeader;\n        }\n        else if (this._severity === MarkerSeverity.Info) {\n            colorId = editorMarkerNavigationInfo;\n            headerBackground = editorMarkerNavigationInfoHeader;\n        }\n        const frameColor = theme.getColor(colorId);\n        const headerBg = theme.getColor(headerBackground);\n        this.style({\n            arrowColor: frameColor,\n            frameColor: frameColor,\n            headerBackgroundColor: headerBg,\n            primaryHeadingColor: theme.getColor(peekViewTitleForeground),\n            secondaryHeadingColor: theme.getColor(peekViewTitleInfoForeground)\n        }); // style() will trigger _applyStyles\n    }\n    _applyStyles() {\n        if (this._parentContainer) {\n            this._parentContainer.style.backgroundColor = this._backgroundColor ? this._backgroundColor.toString() : '';\n        }\n        super._applyStyles();\n    }\n    dispose() {\n        this._callOnDispose.dispose();\n        super.dispose();\n    }\n    _fillHead(container) {\n        super._fillHead(container);\n        this._disposables.add(this._actionbarWidget.actionRunner.onWillRun(e => this.editor.focus()));\n        const actions = [];\n        const menu = this._menuService.getMenuActions(MarkerNavigationWidget_1.TitleMenu, this._contextKeyService);\n        createAndFillInActionBarActions(menu, actions);\n        this._actionbarWidget.push(actions, { label: false, icon: true, index: 0 });\n    }\n    _fillTitleIcon(container) {\n        this._icon = dom.append(container, dom.$(''));\n    }\n    _fillBody(container) {\n        this._parentContainer = container;\n        container.classList.add('marker-widget');\n        this._parentContainer.tabIndex = 0;\n        this._parentContainer.setAttribute('role', 'tooltip');\n        this._container = document.createElement('div');\n        container.appendChild(this._container);\n        this._message = new MessageWidget(this._container, this.editor, related => this._onDidSelectRelatedInformation.fire(related), this._openerService, this._labelService);\n        this._disposables.add(this._message);\n    }\n    show() {\n        throw new Error('call showAtMarker');\n    }\n    showAtMarker(marker, markerIdx, markerCount) {\n        // update:\n        // * title\n        // * message\n        this._container.classList.remove('stale');\n        this._message.update(marker);\n        // update frame color (only applied on 'show')\n        this._severity = marker.severity;\n        this._applyTheme(this._themeService.getColorTheme());\n        // show\n        const range = Range.lift(marker);\n        const editorPosition = this.editor.getPosition();\n        const position = editorPosition && range.containsPosition(editorPosition) ? editorPosition : range.getStartPosition();\n        super.show(position, this.computeRequiredHeight());\n        const model = this.editor.getModel();\n        if (model) {\n            const detail = markerCount > 1\n                ? nls.localize('problems', \"{0} of {1} problems\", markerIdx, markerCount)\n                : nls.localize('change', \"{0} of {1} problem\", markerIdx, markerCount);\n            this.setTitle(basename(model.uri), detail);\n        }\n        this._icon.className = `codicon ${SeverityIcon.className(MarkerSeverity.toSeverity(this._severity))}`;\n        this.editor.revealPositionNearTop(position, 0 /* ScrollType.Smooth */);\n        this.editor.focus();\n    }\n    updateMarker(marker) {\n        this._container.classList.remove('stale');\n        this._message.update(marker);\n    }\n    showStale() {\n        this._container.classList.add('stale');\n        this._relayout();\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        super._doLayoutBody(heightInPixel, widthInPixel);\n        this._heightInPixel = heightInPixel;\n        this._message.layout(heightInPixel, widthInPixel);\n        this._container.style.height = `${heightInPixel}px`;\n    }\n    _onWidth(widthInPixel) {\n        this._message.layout(this._heightInPixel, widthInPixel);\n    }\n    _relayout() {\n        super._relayout(this.computeRequiredHeight());\n    }\n    computeRequiredHeight() {\n        return 3 + this._message.getHeightInLines();\n    }\n};\nMarkerNavigationWidget = MarkerNavigationWidget_1 = __decorate([\n    __param(1, IThemeService),\n    __param(2, IOpenerService),\n    __param(3, IMenuService),\n    __param(4, IInstantiationService),\n    __param(5, IContextKeyService),\n    __param(6, ILabelService)\n], MarkerNavigationWidget);\nexport { MarkerNavigationWidget };\n// theming\nconst errorDefault = oneOf(editorErrorForeground, editorErrorBorder);\nconst warningDefault = oneOf(editorWarningForeground, editorWarningBorder);\nconst infoDefault = oneOf(editorInfoForeground, editorInfoBorder);\nconst editorMarkerNavigationError = registerColor('editorMarkerNavigationError.background', { dark: errorDefault, light: errorDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationError', 'Editor marker navigation widget error color.'));\nconst editorMarkerNavigationErrorHeader = registerColor('editorMarkerNavigationError.headerBackground', { dark: transparent(editorMarkerNavigationError, .1), light: transparent(editorMarkerNavigationError, .1), hcDark: null, hcLight: null }, nls.localize('editorMarkerNavigationErrorHeaderBackground', 'Editor marker navigation widget error heading background.'));\nconst editorMarkerNavigationWarning = registerColor('editorMarkerNavigationWarning.background', { dark: warningDefault, light: warningDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationWarning', 'Editor marker navigation widget warning color.'));\nconst editorMarkerNavigationWarningHeader = registerColor('editorMarkerNavigationWarning.headerBackground', { dark: transparent(editorMarkerNavigationWarning, .1), light: transparent(editorMarkerNavigationWarning, .1), hcDark: '#0C141F', hcLight: transparent(editorMarkerNavigationWarning, .2) }, nls.localize('editorMarkerNavigationWarningBackground', 'Editor marker navigation widget warning heading background.'));\nconst editorMarkerNavigationInfo = registerColor('editorMarkerNavigationInfo.background', { dark: infoDefault, light: infoDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationInfo', 'Editor marker navigation widget info color.'));\nconst editorMarkerNavigationInfoHeader = registerColor('editorMarkerNavigationInfo.headerBackground', { dark: transparent(editorMarkerNavigationInfo, .1), light: transparent(editorMarkerNavigationInfo, .1), hcDark: null, hcLight: null }, nls.localize('editorMarkerNavigationInfoHeaderBackground', 'Editor marker navigation widget info heading background.'));\nconst editorMarkerNavigationBackground = registerColor('editorMarkerNavigation.background', editorBackground, nls.localize('editorMarkerNavigationBackground', 'Editor marker navigation widget background.'));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar MarkerController_1;\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IMarkerNavigationService } from './markerNavigationService.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { MarkerNavigationWidget } from './gotoErrorWidget.js';\nlet MarkerController = class MarkerController {\n    static { MarkerController_1 = this; }\n    static { this.ID = 'editor.contrib.markerController'; }\n    static get(editor) {\n        return editor.getContribution(MarkerController_1.ID);\n    }\n    constructor(editor, _markerNavigationService, _contextKeyService, _editorService, _instantiationService) {\n        this._markerNavigationService = _markerNavigationService;\n        this._contextKeyService = _contextKeyService;\n        this._editorService = _editorService;\n        this._instantiationService = _instantiationService;\n        this._sessionDispoables = new DisposableStore();\n        this._editor = editor;\n        this._widgetVisible = CONTEXT_MARKERS_NAVIGATION_VISIBLE.bindTo(this._contextKeyService);\n    }\n    dispose() {\n        this._cleanUp();\n        this._sessionDispoables.dispose();\n    }\n    _cleanUp() {\n        this._widgetVisible.reset();\n        this._sessionDispoables.clear();\n        this._widget = undefined;\n        this._model = undefined;\n    }\n    _getOrCreateModel(uri) {\n        if (this._model && this._model.matches(uri)) {\n            return this._model;\n        }\n        let reusePosition = false;\n        if (this._model) {\n            reusePosition = true;\n            this._cleanUp();\n        }\n        this._model = this._markerNavigationService.getMarkerList(uri);\n        if (reusePosition) {\n            this._model.move(true, this._editor.getModel(), this._editor.getPosition());\n        }\n        this._widget = this._instantiationService.createInstance(MarkerNavigationWidget, this._editor);\n        this._widget.onDidClose(() => this.close(), this, this._sessionDispoables);\n        this._widgetVisible.set(true);\n        this._sessionDispoables.add(this._model);\n        this._sessionDispoables.add(this._widget);\n        // follow cursor\n        this._sessionDispoables.add(this._editor.onDidChangeCursorPosition(e => {\n            if (!this._model?.selected || !Range.containsPosition(this._model?.selected.marker, e.position)) {\n                this._model?.resetIndex();\n            }\n        }));\n        // update markers\n        this._sessionDispoables.add(this._model.onDidChange(() => {\n            if (!this._widget || !this._widget.position || !this._model) {\n                return;\n            }\n            const info = this._model.find(this._editor.getModel().uri, this._widget.position);\n            if (info) {\n                this._widget.updateMarker(info.marker);\n            }\n            else {\n                this._widget.showStale();\n            }\n        }));\n        // open related\n        this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation(related => {\n            this._editorService.openCodeEditor({\n                resource: related.resource,\n                options: { pinned: true, revealIfOpened: true, selection: Range.lift(related).collapseToStart() }\n            }, this._editor);\n            this.close(false);\n        }));\n        this._sessionDispoables.add(this._editor.onDidChangeModel(() => this._cleanUp()));\n        return this._model;\n    }\n    close(focusEditor = true) {\n        this._cleanUp();\n        if (focusEditor) {\n            this._editor.focus();\n        }\n    }\n    showAtMarker(marker) {\n        if (this._editor.hasModel()) {\n            const model = this._getOrCreateModel(this._editor.getModel().uri);\n            model.resetIndex();\n            model.move(true, this._editor.getModel(), new Position(marker.startLineNumber, marker.startColumn));\n            if (model.selected) {\n                this._widget.showAtMarker(model.selected.marker, model.selected.index, model.selected.total);\n            }\n        }\n    }\n    async nagivate(next, multiFile) {\n        if (this._editor.hasModel()) {\n            const model = this._getOrCreateModel(multiFile ? undefined : this._editor.getModel().uri);\n            model.move(next, this._editor.getModel(), this._editor.getPosition());\n            if (!model.selected) {\n                return;\n            }\n            if (model.selected.marker.resource.toString() !== this._editor.getModel().uri.toString()) {\n                // show in different editor\n                this._cleanUp();\n                const otherEditor = await this._editorService.openCodeEditor({\n                    resource: model.selected.marker.resource,\n                    options: { pinned: false, revealIfOpened: true, selectionRevealType: 2 /* TextEditorSelectionRevealType.NearTop */, selection: model.selected.marker }\n                }, this._editor);\n                if (otherEditor) {\n                    MarkerController_1.get(otherEditor)?.close();\n                    MarkerController_1.get(otherEditor)?.nagivate(next, multiFile);\n                }\n            }\n            else {\n                // show in this editor\n                this._widget.showAtMarker(model.selected.marker, model.selected.index, model.selected.total);\n            }\n        }\n    }\n};\nMarkerController = MarkerController_1 = __decorate([\n    __param(1, IMarkerNavigationService),\n    __param(2, IContextKeyService),\n    __param(3, ICodeEditorService),\n    __param(4, IInstantiationService)\n], MarkerController);\nexport { MarkerController };\nclass MarkerNavigationAction extends EditorAction {\n    constructor(_next, _multiFile, opts) {\n        super(opts);\n        this._next = _next;\n        this._multiFile = _multiFile;\n    }\n    async run(_accessor, editor) {\n        if (editor.hasModel()) {\n            MarkerController.get(editor)?.nagivate(this._next, this._multiFile);\n        }\n    }\n}\nexport class NextMarkerAction extends MarkerNavigationAction {\n    static { this.ID = 'editor.action.marker.next'; }\n    static { this.LABEL = nls.localize('markerAction.next.label', \"Go to Next Problem (Error, Warning, Info)\"); }\n    constructor() {\n        super(true, false, {\n            id: NextMarkerAction.ID,\n            label: NextMarkerAction.LABEL,\n            alias: 'Go to Next Problem (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 512 /* KeyMod.Alt */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MarkerNavigationWidget.TitleMenu,\n                title: NextMarkerAction.LABEL,\n                icon: registerIcon('marker-navigation-next', Codicon.arrowDown, nls.localize('nextMarkerIcon', 'Icon for goto next marker.')),\n                group: 'navigation',\n                order: 1\n            }\n        });\n    }\n}\nclass PrevMarkerAction extends MarkerNavigationAction {\n    static { this.ID = 'editor.action.marker.prev'; }\n    static { this.LABEL = nls.localize('markerAction.previous.label', \"Go to Previous Problem (Error, Warning, Info)\"); }\n    constructor() {\n        super(false, false, {\n            id: PrevMarkerAction.ID,\n            label: PrevMarkerAction.LABEL,\n            alias: 'Go to Previous Problem (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MarkerNavigationWidget.TitleMenu,\n                title: PrevMarkerAction.LABEL,\n                icon: registerIcon('marker-navigation-previous', Codicon.arrowUp, nls.localize('previousMarkerIcon', 'Icon for goto previous marker.')),\n                group: 'navigation',\n                order: 2\n            }\n        });\n    }\n}\nclass NextMarkerInFilesAction extends MarkerNavigationAction {\n    constructor() {\n        super(true, true, {\n            id: 'editor.action.marker.nextInFiles',\n            label: nls.localize('markerAction.nextInFiles.label', \"Go to Next Problem in Files (Error, Warning, Info)\"),\n            alias: 'Go to Next Problem in Files (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarGoMenu,\n                title: nls.localize({ key: 'miGotoNextProblem', comment: ['&& denotes a mnemonic'] }, \"Next &&Problem\"),\n                group: '6_problem_nav',\n                order: 1\n            }\n        });\n    }\n}\nclass PrevMarkerInFilesAction extends MarkerNavigationAction {\n    constructor() {\n        super(false, true, {\n            id: 'editor.action.marker.prevInFiles',\n            label: nls.localize('markerAction.previousInFiles.label', \"Go to Previous Problem in Files (Error, Warning, Info)\"),\n            alias: 'Go to Previous Problem in Files (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 1024 /* KeyMod.Shift */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarGoMenu,\n                title: nls.localize({ key: 'miGotoPreviousProblem', comment: ['&& denotes a mnemonic'] }, \"Previous &&Problem\"),\n                group: '6_problem_nav',\n                order: 2\n            }\n        });\n    }\n}\nregisterEditorContribution(MarkerController.ID, MarkerController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(NextMarkerAction);\nregisterEditorAction(PrevMarkerAction);\nregisterEditorAction(NextMarkerInFilesAction);\nregisterEditorAction(PrevMarkerInFilesAction);\nconst CONTEXT_MARKERS_NAVIGATION_VISIBLE = new RawContextKey('markersNavigationVisible', false);\nconst MarkerCommand = EditorCommand.bindToContribution(MarkerController.get);\nregisterEditorCommand(new MarkerCommand({\n    id: 'closeMarkersNavigation',\n    precondition: CONTEXT_MARKERS_NAVIGATION_VISIBLE,\n    handler: x => x.close(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 50,\n        kbExpr: EditorContextKeys.focus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { DECREASE_HOVER_VERBOSITY_ACTION_ID, DECREASE_HOVER_VERBOSITY_ACTION_LABEL, GO_TO_BOTTOM_HOVER_ACTION_ID, GO_TO_TOP_HOVER_ACTION_ID, INCREASE_HOVER_VERBOSITY_ACTION_ID, INCREASE_HOVER_VERBOSITY_ACTION_LABEL, PAGE_DOWN_HOVER_ACTION_ID, PAGE_UP_HOVER_ACTION_ID, SCROLL_DOWN_HOVER_ACTION_ID, SCROLL_LEFT_HOVER_ACTION_ID, SCROLL_RIGHT_HOVER_ACTION_ID, SCROLL_UP_HOVER_ACTION_ID, SHOW_DEFINITION_PREVIEW_HOVER_ACTION_ID, SHOW_OR_FOCUS_HOVER_ACTION_ID } from './hoverActionIds.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { EditorAction } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { GotoDefinitionAtPositionEditorContribution } from '../../gotoSymbol/browser/link/goToDefinitionAtPosition.js';\nimport { ContentHoverController } from './contentHoverController2.js';\nimport { HoverVerbosityAction } from '../../../common/languages.js';\nimport * as nls from '../../../../nls.js';\nimport './hover.css';\nvar HoverFocusBehavior;\n(function (HoverFocusBehavior) {\n    HoverFocusBehavior[\"NoAutoFocus\"] = \"noAutoFocus\";\n    HoverFocusBehavior[\"FocusIfVisible\"] = \"focusIfVisible\";\n    HoverFocusBehavior[\"AutoFocusImmediately\"] = \"autoFocusImmediately\";\n})(HoverFocusBehavior || (HoverFocusBehavior = {}));\nexport class ShowOrFocusHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: SHOW_OR_FOCUS_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'showOrFocusHover',\n                comment: [\n                    'Label for action that will trigger the showing/focusing of a hover in the editor.',\n                    'If the hover is not visible, it will show the hover.',\n                    'This allows for users to show the hover without using the mouse.'\n                ]\n            }, \"Show or Focus Hover\"),\n            metadata: {\n                description: nls.localize2('showOrFocusHoverDescription', 'Show or focus the editor hover which shows documentation, references, and other content for a symbol at the current cursor position.'),\n                args: [{\n                        name: 'args',\n                        schema: {\n                            type: 'object',\n                            properties: {\n                                'focus': {\n                                    description: 'Controls if and when the hover should take focus upon being triggered by this action.',\n                                    enum: [HoverFocusBehavior.NoAutoFocus, HoverFocusBehavior.FocusIfVisible, HoverFocusBehavior.AutoFocusImmediately],\n                                    enumDescriptions: [\n                                        nls.localize('showOrFocusHover.focus.noAutoFocus', 'The hover will not automatically take focus.'),\n                                        nls.localize('showOrFocusHover.focus.focusIfVisible', 'The hover will take focus only if it is already visible.'),\n                                        nls.localize('showOrFocusHover.focus.autoFocusImmediately', 'The hover will automatically take focus when it appears.'),\n                                    ],\n                                    default: HoverFocusBehavior.FocusIfVisible,\n                                }\n                            },\n                        }\n                    }]\n            },\n            alias: 'Show or Focus Hover',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const controller = ContentHoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        const focusArgument = args?.focus;\n        let focusOption = HoverFocusBehavior.FocusIfVisible;\n        if (Object.values(HoverFocusBehavior).includes(focusArgument)) {\n            focusOption = focusArgument;\n        }\n        else if (typeof focusArgument === 'boolean' && focusArgument) {\n            focusOption = HoverFocusBehavior.AutoFocusImmediately;\n        }\n        const showContentHover = (focus) => {\n            const position = editor.getPosition();\n            const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n            controller.showContentHover(range, 1 /* HoverStartMode.Immediate */, 1 /* HoverStartSource.Keyboard */, focus);\n        };\n        const accessibilitySupportEnabled = editor.getOption(2 /* EditorOption.accessibilitySupport */) === 2 /* AccessibilitySupport.Enabled */;\n        if (controller.isHoverVisible) {\n            if (focusOption !== HoverFocusBehavior.NoAutoFocus) {\n                controller.focus();\n            }\n            else {\n                showContentHover(accessibilitySupportEnabled);\n            }\n        }\n        else {\n            showContentHover(accessibilitySupportEnabled || focusOption === HoverFocusBehavior.AutoFocusImmediately);\n        }\n    }\n}\nexport class ShowDefinitionPreviewHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: SHOW_DEFINITION_PREVIEW_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'showDefinitionPreviewHover',\n                comment: [\n                    'Label for action that will trigger the showing of definition preview hover in the editor.',\n                    'This allows for users to show the definition preview hover without using the mouse.'\n                ]\n            }, \"Show Definition Preview Hover\"),\n            alias: 'Show Definition Preview Hover',\n            precondition: undefined,\n            metadata: {\n                description: nls.localize2('showDefinitionPreviewHoverDescription', 'Show the definition preview hover in the editor.'),\n            },\n        });\n    }\n    run(accessor, editor) {\n        const controller = ContentHoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        const position = editor.getPosition();\n        if (!position) {\n            return;\n        }\n        const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n        const goto = GotoDefinitionAtPositionEditorContribution.get(editor);\n        if (!goto) {\n            return;\n        }\n        const promise = goto.startFindDefinitionFromCursor(position);\n        promise.then(() => {\n            controller.showContentHover(range, 1 /* HoverStartMode.Immediate */, 1 /* HoverStartSource.Keyboard */, true);\n        });\n    }\n}\nexport class ScrollUpHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: SCROLL_UP_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'scrollUpHover',\n                comment: [\n                    'Action that allows to scroll up in the hover widget with the up arrow when the hover widget is focused.'\n                ]\n            }, \"Scroll Up Hover\"),\n            alias: 'Scroll Up Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 16 /* KeyCode.UpArrow */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: nls.localize2('scrollUpHoverDescription', 'Scroll up the editor hover.')\n            },\n        });\n    }\n    run(accessor, editor) {\n        const controller = ContentHoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.scrollUp();\n    }\n}\nexport class ScrollDownHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: SCROLL_DOWN_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'scrollDownHover',\n                comment: [\n                    'Action that allows to scroll down in the hover widget with the up arrow when the hover widget is focused.'\n                ]\n            }, \"Scroll Down Hover\"),\n            alias: 'Scroll Down Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 18 /* KeyCode.DownArrow */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: nls.localize2('scrollDownHoverDescription', 'Scroll down the editor hover.'),\n            },\n        });\n    }\n    run(accessor, editor) {\n        const controller = ContentHoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.scrollDown();\n    }\n}\nexport class ScrollLeftHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: SCROLL_LEFT_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'scrollLeftHover',\n                comment: [\n                    'Action that allows to scroll left in the hover widget with the left arrow when the hover widget is focused.'\n                ]\n            }, \"Scroll Left Hover\"),\n            alias: 'Scroll Left Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 15 /* KeyCode.LeftArrow */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: nls.localize2('scrollLeftHoverDescription', 'Scroll left the editor hover.'),\n            },\n        });\n    }\n    run(accessor, editor) {\n        const controller = ContentHoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.scrollLeft();\n    }\n}\nexport class ScrollRightHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: SCROLL_RIGHT_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'scrollRightHover',\n                comment: [\n                    'Action that allows to scroll right in the hover widget with the right arrow when the hover widget is focused.'\n                ]\n            }, \"Scroll Right Hover\"),\n            alias: 'Scroll Right Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 17 /* KeyCode.RightArrow */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: nls.localize2('scrollRightHoverDescription', 'Scroll right the editor hover.')\n            },\n        });\n    }\n    run(accessor, editor) {\n        const controller = ContentHoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.scrollRight();\n    }\n}\nexport class PageUpHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: PAGE_UP_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'pageUpHover',\n                comment: [\n                    'Action that allows to page up in the hover widget with the page up command when the hover widget is focused.'\n                ]\n            }, \"Page Up Hover\"),\n            alias: 'Page Up Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 11 /* KeyCode.PageUp */,\n                secondary: [512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */],\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: nls.localize2('pageUpHoverDescription', 'Page up the editor hover.'),\n            },\n        });\n    }\n    run(accessor, editor) {\n        const controller = ContentHoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.pageUp();\n    }\n}\nexport class PageDownHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: PAGE_DOWN_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'pageDownHover',\n                comment: [\n                    'Action that allows to page down in the hover widget with the page down command when the hover widget is focused.'\n                ]\n            }, \"Page Down Hover\"),\n            alias: 'Page Down Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 12 /* KeyCode.PageDown */,\n                secondary: [512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */],\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: nls.localize2('pageDownHoverDescription', 'Page down the editor hover.'),\n            },\n        });\n    }\n    run(accessor, editor) {\n        const controller = ContentHoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.pageDown();\n    }\n}\nexport class GoToTopHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: GO_TO_TOP_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'goToTopHover',\n                comment: [\n                    'Action that allows to go to the top of the hover widget with the home command when the hover widget is focused.'\n                ]\n            }, \"Go To Top Hover\"),\n            alias: 'Go To Bottom Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 14 /* KeyCode.Home */,\n                secondary: [2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */],\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: nls.localize2('goToTopHoverDescription', 'Go to the top of the editor hover.'),\n            },\n        });\n    }\n    run(accessor, editor) {\n        const controller = ContentHoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.goToTop();\n    }\n}\nexport class GoToBottomHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: GO_TO_BOTTOM_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'goToBottomHover',\n                comment: [\n                    'Action that allows to go to the bottom in the hover widget with the end command when the hover widget is focused.'\n                ]\n            }, \"Go To Bottom Hover\"),\n            alias: 'Go To Bottom Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 13 /* KeyCode.End */,\n                secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */],\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: nls.localize2('goToBottomHoverDescription', 'Go to the bottom of the editor hover.')\n            },\n        });\n    }\n    run(accessor, editor) {\n        const controller = ContentHoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.goToBottom();\n    }\n}\nexport class IncreaseHoverVerbosityLevel extends EditorAction {\n    constructor() {\n        super({\n            id: INCREASE_HOVER_VERBOSITY_ACTION_ID,\n            label: INCREASE_HOVER_VERBOSITY_ACTION_LABEL,\n            alias: 'Increase Hover Verbosity Level',\n            precondition: EditorContextKeys.hoverVisible\n        });\n    }\n    run(accessor, editor, args) {\n        const hoverController = ContentHoverController.get(editor);\n        if (!hoverController) {\n            return;\n        }\n        const index = args?.index !== undefined ? args.index : hoverController.focusedHoverPartIndex();\n        hoverController.updateHoverVerbosityLevel(HoverVerbosityAction.Increase, index, args?.focus);\n    }\n}\nexport class DecreaseHoverVerbosityLevel extends EditorAction {\n    constructor() {\n        super({\n            id: DECREASE_HOVER_VERBOSITY_ACTION_ID,\n            label: DECREASE_HOVER_VERBOSITY_ACTION_LABEL,\n            alias: 'Decrease Hover Verbosity Level',\n            precondition: EditorContextKeys.hoverVisible\n        });\n    }\n    run(accessor, editor, args) {\n        const hoverController = ContentHoverController.get(editor);\n        if (!hoverController) {\n            return;\n        }\n        const index = args?.index !== undefined ? args.index : hoverController.focusedHoverPartIndex();\n        ContentHoverController.get(editor)?.updateHoverVerbosityLevel(HoverVerbosityAction.Decrease, index, args?.focus);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { createCancelablePromise, disposableTimeout } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { IMarkerDecorationsService } from '../../../common/services/markerDecorations.js';\nimport { getCodeActions, quickFixCommandId } from '../../codeAction/browser/codeAction.js';\nimport { CodeActionController } from '../../codeAction/browser/codeActionController.js';\nimport { CodeActionKind, CodeActionTriggerSource } from '../../codeAction/common/types.js';\nimport { MarkerController, NextMarkerAction } from '../../gotoError/browser/gotoError.js';\nimport { RenderedHoverParts } from './hoverTypes.js';\nimport * as nls from '../../../../nls.js';\nimport { IMarkerData, MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { Progress } from '../../../../platform/progress/common/progress.js';\nconst $ = dom.$;\nexport class MarkerHover {\n    constructor(owner, range, marker) {\n        this.owner = owner;\n        this.range = range;\n        this.marker = marker;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* HoverAnchorType.Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n}\nconst markerCodeActionTrigger = {\n    type: 1 /* CodeActionTriggerType.Invoke */,\n    filter: { include: CodeActionKind.QuickFix },\n    triggerAction: CodeActionTriggerSource.QuickFixHover\n};\nlet MarkerHoverParticipant = class MarkerHoverParticipant {\n    constructor(_editor, _markerDecorationsService, _openerService, _languageFeaturesService) {\n        this._editor = _editor;\n        this._markerDecorationsService = _markerDecorationsService;\n        this._openerService = _openerService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this.hoverOrdinal = 1;\n        this.recentMarkerCodeActionsInfo = undefined;\n    }\n    computeSync(anchor, lineDecorations) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */ && !anchor.supportsMarkerHover) {\n            return [];\n        }\n        const model = this._editor.getModel();\n        const lineNumber = anchor.range.startLineNumber;\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        const result = [];\n        for (const d of lineDecorations) {\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\n            const marker = this._markerDecorationsService.getMarker(model.uri, d);\n            if (!marker) {\n                continue;\n            }\n            const range = new Range(anchor.range.startLineNumber, startColumn, anchor.range.startLineNumber, endColumn);\n            result.push(new MarkerHover(this, range, marker));\n        }\n        return result;\n    }\n    renderHoverParts(context, hoverParts) {\n        if (!hoverParts.length) {\n            return new RenderedHoverParts([]);\n        }\n        const disposables = new DisposableStore();\n        const renderedHoverParts = [];\n        hoverParts.forEach(hoverPart => {\n            const renderedMarkerHover = this._renderMarkerHover(hoverPart);\n            context.fragment.appendChild(renderedMarkerHover.hoverElement);\n            renderedHoverParts.push(renderedMarkerHover);\n        });\n        const markerHoverForStatusbar = hoverParts.length === 1 ? hoverParts[0] : hoverParts.sort((a, b) => MarkerSeverity.compare(a.marker.severity, b.marker.severity))[0];\n        this.renderMarkerStatusbar(context, markerHoverForStatusbar, disposables);\n        return new RenderedHoverParts(renderedHoverParts);\n    }\n    _renderMarkerHover(markerHover) {\n        const disposables = new DisposableStore();\n        const hoverElement = $('div.hover-row');\n        const markerElement = dom.append(hoverElement, $('div.marker.hover-contents'));\n        const { source, message, code, relatedInformation } = markerHover.marker;\n        this._editor.applyFontInfo(markerElement);\n        const messageElement = dom.append(markerElement, $('span'));\n        messageElement.style.whiteSpace = 'pre-wrap';\n        messageElement.innerText = message;\n        if (source || code) {\n            // Code has link\n            if (code && typeof code !== 'string') {\n                const sourceAndCodeElement = $('span');\n                if (source) {\n                    const sourceElement = dom.append(sourceAndCodeElement, $('span'));\n                    sourceElement.innerText = source;\n                }\n                const codeLink = dom.append(sourceAndCodeElement, $('a.code-link'));\n                codeLink.setAttribute('href', code.target.toString());\n                disposables.add(dom.addDisposableListener(codeLink, 'click', (e) => {\n                    this._openerService.open(code.target, { allowCommands: true });\n                    e.preventDefault();\n                    e.stopPropagation();\n                }));\n                const codeElement = dom.append(codeLink, $('span'));\n                codeElement.innerText = code.value;\n                const detailsElement = dom.append(markerElement, sourceAndCodeElement);\n                detailsElement.style.opacity = '0.6';\n                detailsElement.style.paddingLeft = '6px';\n            }\n            else {\n                const detailsElement = dom.append(markerElement, $('span'));\n                detailsElement.style.opacity = '0.6';\n                detailsElement.style.paddingLeft = '6px';\n                detailsElement.innerText = source && code ? `${source}(${code})` : source ? source : `(${code})`;\n            }\n        }\n        if (isNonEmptyArray(relatedInformation)) {\n            for (const { message, resource, startLineNumber, startColumn } of relatedInformation) {\n                const relatedInfoContainer = dom.append(markerElement, $('div'));\n                relatedInfoContainer.style.marginTop = '8px';\n                const a = dom.append(relatedInfoContainer, $('a'));\n                a.innerText = `${basename(resource)}(${startLineNumber}, ${startColumn}): `;\n                a.style.cursor = 'pointer';\n                disposables.add(dom.addDisposableListener(a, 'click', (e) => {\n                    e.stopPropagation();\n                    e.preventDefault();\n                    if (this._openerService) {\n                        const editorOptions = { selection: { startLineNumber, startColumn } };\n                        this._openerService.open(resource, {\n                            fromUserGesture: true,\n                            editorOptions\n                        }).catch(onUnexpectedError);\n                    }\n                }));\n                const messageElement = dom.append(relatedInfoContainer, $('span'));\n                messageElement.innerText = message;\n                this._editor.applyFontInfo(messageElement);\n            }\n        }\n        const renderedHoverPart = {\n            hoverPart: markerHover,\n            hoverElement,\n            dispose: () => disposables.dispose()\n        };\n        return renderedHoverPart;\n    }\n    renderMarkerStatusbar(context, markerHover, disposables) {\n        if (markerHover.marker.severity === MarkerSeverity.Error || markerHover.marker.severity === MarkerSeverity.Warning || markerHover.marker.severity === MarkerSeverity.Info) {\n            const markerController = MarkerController.get(this._editor);\n            if (markerController) {\n                context.statusBar.addAction({\n                    label: nls.localize('view problem', \"View Problem\"),\n                    commandId: NextMarkerAction.ID,\n                    run: () => {\n                        context.hide();\n                        markerController.showAtMarker(markerHover.marker);\n                        this._editor.focus();\n                    }\n                });\n            }\n        }\n        if (!this._editor.getOption(92 /* EditorOption.readOnly */)) {\n            const quickfixPlaceholderElement = context.statusBar.append($('div'));\n            if (this.recentMarkerCodeActionsInfo) {\n                if (IMarkerData.makeKey(this.recentMarkerCodeActionsInfo.marker) === IMarkerData.makeKey(markerHover.marker)) {\n                    if (!this.recentMarkerCodeActionsInfo.hasCodeActions) {\n                        quickfixPlaceholderElement.textContent = nls.localize('noQuickFixes', \"No quick fixes available\");\n                    }\n                }\n                else {\n                    this.recentMarkerCodeActionsInfo = undefined;\n                }\n            }\n            const updatePlaceholderDisposable = this.recentMarkerCodeActionsInfo && !this.recentMarkerCodeActionsInfo.hasCodeActions ? Disposable.None : disposableTimeout(() => quickfixPlaceholderElement.textContent = nls.localize('checkingForQuickFixes', \"Checking for quick fixes...\"), 200, disposables);\n            if (!quickfixPlaceholderElement.textContent) {\n                // Have some content in here to avoid flickering\n                quickfixPlaceholderElement.textContent = String.fromCharCode(0xA0); // &nbsp;\n            }\n            const codeActionsPromise = this.getCodeActions(markerHover.marker);\n            disposables.add(toDisposable(() => codeActionsPromise.cancel()));\n            codeActionsPromise.then(actions => {\n                updatePlaceholderDisposable.dispose();\n                this.recentMarkerCodeActionsInfo = { marker: markerHover.marker, hasCodeActions: actions.validActions.length > 0 };\n                if (!this.recentMarkerCodeActionsInfo.hasCodeActions) {\n                    actions.dispose();\n                    quickfixPlaceholderElement.textContent = nls.localize('noQuickFixes', \"No quick fixes available\");\n                    return;\n                }\n                quickfixPlaceholderElement.style.display = 'none';\n                let showing = false;\n                disposables.add(toDisposable(() => {\n                    if (!showing) {\n                        actions.dispose();\n                    }\n                }));\n                context.statusBar.addAction({\n                    label: nls.localize('quick fixes', \"Quick Fix...\"),\n                    commandId: quickFixCommandId,\n                    run: (target) => {\n                        showing = true;\n                        const controller = CodeActionController.get(this._editor);\n                        const elementPosition = dom.getDomNodePagePosition(target);\n                        // Hide the hover pre-emptively, otherwise the editor can close the code actions\n                        // context menu as well when using keyboard navigation\n                        context.hide();\n                        controller?.showCodeActions(markerCodeActionTrigger, actions, {\n                            x: elementPosition.left,\n                            y: elementPosition.top,\n                            width: elementPosition.width,\n                            height: elementPosition.height\n                        });\n                    }\n                });\n            }, onUnexpectedError);\n        }\n    }\n    getCodeActions(marker) {\n        return createCancelablePromise(cancellationToken => {\n            return getCodeActions(this._languageFeaturesService.codeActionProvider, this._editor.getModel(), new Range(marker.startLineNumber, marker.startColumn, marker.endLineNumber, marker.endColumn), markerCodeActionTrigger, Progress.None, cancellationToken);\n        });\n    }\n};\nMarkerHoverParticipant = __decorate([\n    __param(1, IMarkerDecorationsService),\n    __param(2, IOpenerService),\n    __param(3, ILanguageFeaturesService)\n], MarkerHoverParticipant);\nexport { MarkerHoverParticipant };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { asArray } from '../../../../base/common/arrays.js';\nimport { isEmptyMarkdownString } from '../../../../base/common/htmlContent.js';\nimport { GlyphMarginLane } from '../../../common/model.js';\nexport class MarginHoverComputer {\n    get lineNumber() {\n        return this._lineNumber;\n    }\n    set lineNumber(value) {\n        this._lineNumber = value;\n    }\n    get lane() {\n        return this._laneOrLine;\n    }\n    set lane(value) {\n        this._laneOrLine = value;\n    }\n    constructor(_editor) {\n        this._editor = _editor;\n        this._lineNumber = -1;\n        this._laneOrLine = GlyphMarginLane.Center;\n    }\n    computeSync() {\n        const toHoverMessage = (contents) => {\n            return {\n                value: contents\n            };\n        };\n        const lineDecorations = this._editor.getLineDecorations(this._lineNumber);\n        const result = [];\n        const isLineHover = this._laneOrLine === 'lineNo';\n        if (!lineDecorations) {\n            return result;\n        }\n        for (const d of lineDecorations) {\n            const lane = d.options.glyphMargin?.position ?? GlyphMarginLane.Center;\n            if (!isLineHover && lane !== this._laneOrLine) {\n                continue;\n            }\n            const hoverMessage = isLineHover ? d.options.lineNumberHoverMessage : d.options.glyphMarginHoverMessage;\n            if (!hoverMessage || isEmptyMarkdownString(hoverMessage)) {\n                continue;\n            }\n            result.push(...asArray(hoverMessage).map(toHoverMessage));\n        }\n        return result;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar MarginHoverWidget_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../../browser/widget/markdownRenderer/browser/markdownRenderer.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { HoverOperation } from './hoverOperation.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { HoverWidget } from '../../../../base/browser/ui/hover/hoverWidget.js';\nimport { MarginHoverComputer } from './marginHoverComputer.js';\nimport { isMousePositionWithinElement } from './hoverUtils.js';\nconst $ = dom.$;\nlet MarginHoverWidget = class MarginHoverWidget extends Disposable {\n    static { MarginHoverWidget_1 = this; }\n    static { this.ID = 'editor.contrib.modesGlyphHoverWidget'; }\n    constructor(editor, languageService, openerService) {\n        super();\n        this._renderDisposeables = this._register(new DisposableStore());\n        this._editor = editor;\n        this._isVisible = false;\n        this._messages = [];\n        this._hover = this._register(new HoverWidget());\n        this._hover.containerDomNode.classList.toggle('hidden', !this._isVisible);\n        this._markdownRenderer = this._register(new MarkdownRenderer({ editor: this._editor }, languageService, openerService));\n        this._computer = new MarginHoverComputer(this._editor);\n        this._hoverOperation = this._register(new HoverOperation(this._editor, this._computer));\n        this._register(this._hoverOperation.onResult((result) => {\n            this._withResult(result.value);\n        }));\n        this._register(this._editor.onDidChangeModelDecorations(() => this._onModelDecorationsChanged()));\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(50 /* EditorOption.fontInfo */)) {\n                this._updateFont();\n            }\n        }));\n        this._register(dom.addStandardDisposableListener(this._hover.containerDomNode, 'mouseleave', (e) => {\n            this._onMouseLeave(e);\n        }));\n        this._editor.addOverlayWidget(this);\n    }\n    dispose() {\n        this._editor.removeOverlayWidget(this);\n        super.dispose();\n    }\n    getId() {\n        return MarginHoverWidget_1.ID;\n    }\n    getDomNode() {\n        return this._hover.containerDomNode;\n    }\n    getPosition() {\n        return null;\n    }\n    _updateFont() {\n        const codeClasses = Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName('code'));\n        codeClasses.forEach(node => this._editor.applyFontInfo(node));\n    }\n    _onModelDecorationsChanged() {\n        if (this._isVisible) {\n            // The decorations have changed and the hover is visible,\n            // we need to recompute the displayed text\n            this._hoverOperation.cancel();\n            this._hoverOperation.start(0 /* HoverStartMode.Delayed */);\n        }\n    }\n    showsOrWillShow(mouseEvent) {\n        const target = mouseEvent.target;\n        if (target.type === 2 /* MouseTargetType.GUTTER_GLYPH_MARGIN */ && target.detail.glyphMarginLane) {\n            this._startShowingAt(target.position.lineNumber, target.detail.glyphMarginLane);\n            return true;\n        }\n        if (target.type === 3 /* MouseTargetType.GUTTER_LINE_NUMBERS */) {\n            this._startShowingAt(target.position.lineNumber, 'lineNo');\n            return true;\n        }\n        return false;\n    }\n    _startShowingAt(lineNumber, laneOrLine) {\n        if (this._computer.lineNumber === lineNumber && this._computer.lane === laneOrLine) {\n            // We have to show the widget at the exact same line number as before, so no work is needed\n            return;\n        }\n        this._hoverOperation.cancel();\n        this.hide();\n        this._computer.lineNumber = lineNumber;\n        this._computer.lane = laneOrLine;\n        this._hoverOperation.start(0 /* HoverStartMode.Delayed */);\n    }\n    hide() {\n        this._computer.lineNumber = -1;\n        this._hoverOperation.cancel();\n        if (!this._isVisible) {\n            return;\n        }\n        this._isVisible = false;\n        this._hover.containerDomNode.classList.toggle('hidden', !this._isVisible);\n    }\n    _withResult(result) {\n        this._messages = result;\n        if (this._messages.length > 0) {\n            this._renderMessages(this._computer.lineNumber, this._messages);\n        }\n        else {\n            this.hide();\n        }\n    }\n    _renderMessages(lineNumber, messages) {\n        this._renderDisposeables.clear();\n        const fragment = document.createDocumentFragment();\n        for (const msg of messages) {\n            const markdownHoverElement = $('div.hover-row.markdown-hover');\n            const hoverContentsElement = dom.append(markdownHoverElement, $('div.hover-contents'));\n            const renderedContents = this._renderDisposeables.add(this._markdownRenderer.render(msg.value));\n            hoverContentsElement.appendChild(renderedContents.element);\n            fragment.appendChild(markdownHoverElement);\n        }\n        this._updateContents(fragment);\n        this._showAt(lineNumber);\n    }\n    _updateContents(node) {\n        this._hover.contentsDomNode.textContent = '';\n        this._hover.contentsDomNode.appendChild(node);\n        this._updateFont();\n    }\n    _showAt(lineNumber) {\n        if (!this._isVisible) {\n            this._isVisible = true;\n            this._hover.containerDomNode.classList.toggle('hidden', !this._isVisible);\n        }\n        const editorLayout = this._editor.getLayoutInfo();\n        const topForLineNumber = this._editor.getTopForLineNumber(lineNumber);\n        const editorScrollTop = this._editor.getScrollTop();\n        const lineHeight = this._editor.getOption(67 /* EditorOption.lineHeight */);\n        const nodeHeight = this._hover.containerDomNode.clientHeight;\n        const top = topForLineNumber - editorScrollTop - ((nodeHeight - lineHeight) / 2);\n        const left = editorLayout.glyphMarginLeft + editorLayout.glyphMarginWidth + (this._computer.lane === 'lineNo' ? editorLayout.lineNumbersWidth : 0);\n        this._hover.containerDomNode.style.left = `${left}px`;\n        this._hover.containerDomNode.style.top = `${Math.max(Math.round(top), 0)}px`;\n    }\n    _onMouseLeave(e) {\n        const editorDomNode = this._editor.getDomNode();\n        const isMousePositionOutsideOfEditor = !editorDomNode || !isMousePositionWithinElement(editorDomNode, e.x, e.y);\n        if (isMousePositionOutsideOfEditor) {\n            this.hide();\n        }\n    }\n};\nMarginHoverWidget = MarginHoverWidget_1 = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IOpenerService)\n], MarginHoverWidget);\nexport { MarginHoverWidget };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { isMousePositionWithinElement } from './hoverUtils.js';\nimport './hover.css';\nimport { MarginHoverWidget } from './marginHoverWidget.js';\n// sticky hover widget which doesn't disappear on focus out and such\nconst _sticky = false;\nlet MarginHoverController = class MarginHoverController extends Disposable {\n    static { this.ID = 'editor.contrib.marginHover'; }\n    constructor(_editor, _instantiationService) {\n        super();\n        this._editor = _editor;\n        this._instantiationService = _instantiationService;\n        this.shouldKeepOpenOnEditorMouseMoveOrLeave = false;\n        this._listenersStore = new DisposableStore();\n        this._hoverState = {\n            mouseDown: false\n        };\n        this._reactToEditorMouseMoveRunner = this._register(new RunOnceScheduler(() => this._reactToEditorMouseMove(this._mouseMoveEvent), 0));\n        this._hookListeners();\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(60 /* EditorOption.hover */)) {\n                this._unhookListeners();\n                this._hookListeners();\n            }\n        }));\n    }\n    _hookListeners() {\n        const hoverOpts = this._editor.getOption(60 /* EditorOption.hover */);\n        this._hoverSettings = {\n            enabled: hoverOpts.enabled,\n            sticky: hoverOpts.sticky,\n            hidingDelay: hoverOpts.hidingDelay\n        };\n        if (hoverOpts.enabled) {\n            this._listenersStore.add(this._editor.onMouseDown((e) => this._onEditorMouseDown(e)));\n            this._listenersStore.add(this._editor.onMouseUp(() => this._onEditorMouseUp()));\n            this._listenersStore.add(this._editor.onMouseMove((e) => this._onEditorMouseMove(e)));\n            this._listenersStore.add(this._editor.onKeyDown((e) => this._onKeyDown(e)));\n        }\n        else {\n            this._listenersStore.add(this._editor.onMouseMove((e) => this._onEditorMouseMove(e)));\n            this._listenersStore.add(this._editor.onKeyDown((e) => this._onKeyDown(e)));\n        }\n        this._listenersStore.add(this._editor.onMouseLeave((e) => this._onEditorMouseLeave(e)));\n        this._listenersStore.add(this._editor.onDidChangeModel(() => {\n            this._cancelScheduler();\n            this._hideWidgets();\n        }));\n        this._listenersStore.add(this._editor.onDidChangeModelContent(() => this._cancelScheduler()));\n        this._listenersStore.add(this._editor.onDidScrollChange((e) => this._onEditorScrollChanged(e)));\n    }\n    _unhookListeners() {\n        this._listenersStore.clear();\n    }\n    _cancelScheduler() {\n        this._mouseMoveEvent = undefined;\n        this._reactToEditorMouseMoveRunner.cancel();\n    }\n    _onEditorScrollChanged(e) {\n        if (e.scrollTopChanged || e.scrollLeftChanged) {\n            this._hideWidgets();\n        }\n    }\n    _onEditorMouseDown(mouseEvent) {\n        this._hoverState.mouseDown = true;\n        const shouldNotHideCurrentHoverWidget = this._isMouseOnMarginHoverWidget(mouseEvent);\n        if (shouldNotHideCurrentHoverWidget) {\n            return;\n        }\n        this._hideWidgets();\n    }\n    _isMouseOnMarginHoverWidget(mouseEvent) {\n        const marginHoverWidgetNode = this._glyphWidget?.getDomNode();\n        if (marginHoverWidgetNode) {\n            return isMousePositionWithinElement(marginHoverWidgetNode, mouseEvent.event.posx, mouseEvent.event.posy);\n        }\n        return false;\n    }\n    _onEditorMouseUp() {\n        this._hoverState.mouseDown = false;\n    }\n    _onEditorMouseLeave(mouseEvent) {\n        if (this.shouldKeepOpenOnEditorMouseMoveOrLeave) {\n            return;\n        }\n        this._cancelScheduler();\n        const shouldNotHideCurrentHoverWidget = this._isMouseOnMarginHoverWidget(mouseEvent);\n        if (shouldNotHideCurrentHoverWidget) {\n            return;\n        }\n        if (_sticky) {\n            return;\n        }\n        this._hideWidgets();\n    }\n    _shouldNotRecomputeCurrentHoverWidget(mouseEvent) {\n        const isHoverSticky = this._hoverSettings.sticky;\n        const isMouseOnMarginHoverWidget = this._isMouseOnMarginHoverWidget(mouseEvent);\n        return isHoverSticky && isMouseOnMarginHoverWidget;\n    }\n    _onEditorMouseMove(mouseEvent) {\n        if (this.shouldKeepOpenOnEditorMouseMoveOrLeave) {\n            return;\n        }\n        this._mouseMoveEvent = mouseEvent;\n        const shouldNotRecomputeCurrentHoverWidget = this._shouldNotRecomputeCurrentHoverWidget(mouseEvent);\n        if (shouldNotRecomputeCurrentHoverWidget) {\n            this._reactToEditorMouseMoveRunner.cancel();\n            return;\n        }\n        this._reactToEditorMouseMove(mouseEvent);\n    }\n    _reactToEditorMouseMove(mouseEvent) {\n        if (!mouseEvent) {\n            return;\n        }\n        const glyphWidgetShowsOrWillShow = this._tryShowHoverWidget(mouseEvent);\n        if (glyphWidgetShowsOrWillShow) {\n            return;\n        }\n        if (_sticky) {\n            return;\n        }\n        this._hideWidgets();\n    }\n    _tryShowHoverWidget(mouseEvent) {\n        const glyphWidget = this._getOrCreateGlyphWidget();\n        return glyphWidget.showsOrWillShow(mouseEvent);\n    }\n    _onKeyDown(e) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (e.keyCode === 5 /* KeyCode.Ctrl */\n            || e.keyCode === 6 /* KeyCode.Alt */\n            || e.keyCode === 57 /* KeyCode.Meta */\n            || e.keyCode === 4 /* KeyCode.Shift */) {\n            // Do not hide hover when a modifier key is pressed\n            return;\n        }\n        this._hideWidgets();\n    }\n    _hideWidgets() {\n        if (_sticky) {\n            return;\n        }\n        this._glyphWidget?.hide();\n    }\n    _getOrCreateGlyphWidget() {\n        if (!this._glyphWidget) {\n            this._glyphWidget = this._instantiationService.createInstance(MarginHoverWidget, this._editor);\n        }\n        return this._glyphWidget;\n    }\n    dispose() {\n        super.dispose();\n        this._unhookListeners();\n        this._listenersStore.dispose();\n        this._glyphWidget?.dispose();\n    }\n};\nMarginHoverController = __decorate([\n    __param(1, IInstantiationService)\n], MarginHoverController);\nexport { MarginHoverController };\n","export class HoverAccessibleView {\n}\nexport class HoverAccessibilityHelp {\n}\nexport class ExtHoverAccessibleView {\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { DecreaseHoverVerbosityLevel, GoToBottomHoverAction, GoToTopHoverAction, IncreaseHoverVerbosityLevel, PageDownHoverAction, PageUpHoverAction, ScrollDownHoverAction, ScrollLeftHoverAction, ScrollRightHoverAction, ScrollUpHoverAction, ShowDefinitionPreviewHoverAction, ShowOrFocusHoverAction } from './hoverActions.js';\nimport { registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { editorHoverBorder } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { HoverParticipantRegistry } from './hoverTypes.js';\nimport { MarkdownHoverParticipant } from './markdownHoverParticipant.js';\nimport { MarkerHoverParticipant } from './markerHoverParticipant.js';\nimport { ContentHoverController } from './contentHoverController2.js';\nimport { MarginHoverController } from './marginHoverController.js';\nimport './hover.css';\nimport { AccessibleViewRegistry } from '../../../../platform/accessibility/browser/accessibleViewRegistry.js';\nimport { ExtHoverAccessibleView, HoverAccessibilityHelp, HoverAccessibleView } from './hoverAccessibleViews.js';\nregisterEditorContribution(ContentHoverController.ID, ContentHoverController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorContribution(MarginHoverController.ID, MarginHoverController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(ShowOrFocusHoverAction);\nregisterEditorAction(ShowDefinitionPreviewHoverAction);\nregisterEditorAction(ScrollUpHoverAction);\nregisterEditorAction(ScrollDownHoverAction);\nregisterEditorAction(ScrollLeftHoverAction);\nregisterEditorAction(ScrollRightHoverAction);\nregisterEditorAction(PageUpHoverAction);\nregisterEditorAction(PageDownHoverAction);\nregisterEditorAction(GoToTopHoverAction);\nregisterEditorAction(GoToBottomHoverAction);\nregisterEditorAction(IncreaseHoverVerbosityLevel);\nregisterEditorAction(DecreaseHoverVerbosityLevel);\nHoverParticipantRegistry.register(MarkdownHoverParticipant);\nHoverParticipantRegistry.register(MarkerHoverParticipant);\n// theming\nregisterThemingParticipant((theme, collector) => {\n    const hoverBorder = theme.getColor(editorHoverBorder);\n    if (hoverBorder) {\n        collector.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${hoverBorder.transparent(0.5)}; }`);\n        collector.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${hoverBorder.transparent(0.5)}; }`);\n        collector.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${hoverBorder.transparent(0.5)}; }`);\n    }\n});\nAccessibleViewRegistry.register(new HoverAccessibleView());\nAccessibleViewRegistry.register(new HoverAccessibilityHelp());\nAccessibleViewRegistry.register(new ExtHoverAccessibleView());\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport function getSpaceCnt(str, tabSize) {\n    let spacesCnt = 0;\n    for (let i = 0; i < str.length; i++) {\n        if (str.charAt(i) === '\\t') {\n            spacesCnt += tabSize;\n        }\n        else {\n            spacesCnt++;\n        }\n    }\n    return spacesCnt;\n}\nexport function generateIndent(spacesCnt, tabSize, insertSpaces) {\n    spacesCnt = spacesCnt < 0 ? 0 : spacesCnt;\n    let result = '';\n    if (!insertSpaces) {\n        const tabsCnt = Math.floor(spacesCnt / tabSize);\n        spacesCnt = spacesCnt % tabSize;\n        for (let i = 0; i < tabsCnt; i++) {\n            result += '\\t';\n        }\n    }\n    for (let i = 0; i < spacesCnt; i++) {\n        result += ' ';\n    }\n    return result;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as strings from '../../../../base/common/strings.js';\nimport { ShiftCommand } from '../../../common/commands/shiftCommand.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { normalizeIndentation } from '../../../common/core/indentation.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { ProcessedIndentRulesSupport } from '../../../common/languages/supports/indentationLineProcessor.js';\nexport function getReindentEditOperations(model, languageConfigurationService, startLineNumber, endLineNumber) {\n    if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\n        // Model is empty\n        return [];\n    }\n    const indentationRulesSupport = languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).indentRulesSupport;\n    if (!indentationRulesSupport) {\n        return [];\n    }\n    const processedIndentRulesSupport = new ProcessedIndentRulesSupport(model, indentationRulesSupport, languageConfigurationService);\n    endLineNumber = Math.min(endLineNumber, model.getLineCount());\n    // Skip `unIndentedLinePattern` lines\n    while (startLineNumber <= endLineNumber) {\n        if (!processedIndentRulesSupport.shouldIgnore(startLineNumber)) {\n            break;\n        }\n        startLineNumber++;\n    }\n    if (startLineNumber > endLineNumber - 1) {\n        return [];\n    }\n    const { tabSize, indentSize, insertSpaces } = model.getOptions();\n    const shiftIndent = (indentation, count) => {\n        count = count || 1;\n        return ShiftCommand.shiftIndent(indentation, indentation.length + count, tabSize, indentSize, insertSpaces);\n    };\n    const unshiftIndent = (indentation, count) => {\n        count = count || 1;\n        return ShiftCommand.unshiftIndent(indentation, indentation.length + count, tabSize, indentSize, insertSpaces);\n    };\n    const indentEdits = [];\n    // indentation being passed to lines below\n    // Calculate indentation for the first line\n    // If there is no passed-in indentation, we use the indentation of the first line as base.\n    const currentLineText = model.getLineContent(startLineNumber);\n    let globalIndent = strings.getLeadingWhitespace(currentLineText);\n    // idealIndentForNextLine doesn't equal globalIndent when there is a line matching `indentNextLinePattern`.\n    let idealIndentForNextLine = globalIndent;\n    if (processedIndentRulesSupport.shouldIncrease(startLineNumber)) {\n        idealIndentForNextLine = shiftIndent(idealIndentForNextLine);\n        globalIndent = shiftIndent(globalIndent);\n    }\n    else if (processedIndentRulesSupport.shouldIndentNextLine(startLineNumber)) {\n        idealIndentForNextLine = shiftIndent(idealIndentForNextLine);\n    }\n    startLineNumber++;\n    // Calculate indentation adjustment for all following lines\n    for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\n        if (doesLineStartWithString(model, lineNumber)) {\n            continue;\n        }\n        const text = model.getLineContent(lineNumber);\n        const oldIndentation = strings.getLeadingWhitespace(text);\n        const currentIdealIndent = idealIndentForNextLine;\n        if (processedIndentRulesSupport.shouldDecrease(lineNumber, currentIdealIndent)) {\n            idealIndentForNextLine = unshiftIndent(idealIndentForNextLine);\n            globalIndent = unshiftIndent(globalIndent);\n        }\n        if (oldIndentation !== idealIndentForNextLine) {\n            indentEdits.push(EditOperation.replaceMove(new Selection(lineNumber, 1, lineNumber, oldIndentation.length + 1), normalizeIndentation(idealIndentForNextLine, indentSize, insertSpaces)));\n        }\n        // calculate idealIndentForNextLine\n        if (processedIndentRulesSupport.shouldIgnore(lineNumber)) {\n            // In reindent phase, if the line matches `unIndentedLinePattern` we inherit indentation from above lines\n            // but don't change globalIndent and idealIndentForNextLine.\n            continue;\n        }\n        else if (processedIndentRulesSupport.shouldIncrease(lineNumber, currentIdealIndent)) {\n            globalIndent = shiftIndent(globalIndent);\n            idealIndentForNextLine = globalIndent;\n        }\n        else if (processedIndentRulesSupport.shouldIndentNextLine(lineNumber, currentIdealIndent)) {\n            idealIndentForNextLine = shiftIndent(idealIndentForNextLine);\n        }\n        else {\n            idealIndentForNextLine = globalIndent;\n        }\n    }\n    return indentEdits;\n}\nfunction doesLineStartWithString(model, lineNumber) {\n    if (!model.tokenization.isCheapToTokenize(lineNumber)) {\n        return false;\n    }\n    const lineTokens = model.tokenization.getLineTokens(lineNumber);\n    return lineTokens.getStandardTokenType(0) === 2 /* StandardTokenType.String */;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ShiftCommand } from '../../../common/commands/shiftCommand.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport * as indentUtils from '../common/indentUtils.js';\nimport * as nls from '../../../../nls.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nimport { getGoodIndentForLine, getIndentMetadata } from '../../../common/languages/autoIndent.js';\nimport { getReindentEditOperations } from '../common/indentation.js';\nimport { getStandardTokenTypeAtPosition } from '../../../common/tokens/lineTokens.js';\nexport class IndentationToSpacesAction extends EditorAction {\n    static { this.ID = 'editor.action.indentationToSpaces'; }\n    constructor() {\n        super({\n            id: IndentationToSpacesAction.ID,\n            label: nls.localize('indentationToSpaces', \"Convert Indentation to Spaces\"),\n            alias: 'Convert Indentation to Spaces',\n            precondition: EditorContextKeys.writable,\n            metadata: {\n                description: nls.localize2('indentationToSpacesDescription', \"Convert the tab indentation to spaces.\"),\n            }\n        });\n    }\n    run(accessor, editor) {\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const modelOpts = model.getOptions();\n        const selection = editor.getSelection();\n        if (!selection) {\n            return;\n        }\n        const command = new IndentationToSpacesCommand(selection, modelOpts.tabSize);\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, [command]);\n        editor.pushUndoStop();\n        model.updateOptions({\n            insertSpaces: true\n        });\n    }\n}\nexport class IndentationToTabsAction extends EditorAction {\n    static { this.ID = 'editor.action.indentationToTabs'; }\n    constructor() {\n        super({\n            id: IndentationToTabsAction.ID,\n            label: nls.localize('indentationToTabs', \"Convert Indentation to Tabs\"),\n            alias: 'Convert Indentation to Tabs',\n            precondition: EditorContextKeys.writable,\n            metadata: {\n                description: nls.localize2('indentationToTabsDescription', \"Convert the spaces indentation to tabs.\"),\n            }\n        });\n    }\n    run(accessor, editor) {\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const modelOpts = model.getOptions();\n        const selection = editor.getSelection();\n        if (!selection) {\n            return;\n        }\n        const command = new IndentationToTabsCommand(selection, modelOpts.tabSize);\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, [command]);\n        editor.pushUndoStop();\n        model.updateOptions({\n            insertSpaces: false\n        });\n    }\n}\nexport class ChangeIndentationSizeAction extends EditorAction {\n    constructor(insertSpaces, displaySizeOnly, opts) {\n        super(opts);\n        this.insertSpaces = insertSpaces;\n        this.displaySizeOnly = displaySizeOnly;\n    }\n    run(accessor, editor) {\n        const quickInputService = accessor.get(IQuickInputService);\n        const modelService = accessor.get(IModelService);\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const creationOpts = modelService.getCreationOptions(model.getLanguageId(), model.uri, model.isForSimpleWidget);\n        const modelOpts = model.getOptions();\n        const picks = [1, 2, 3, 4, 5, 6, 7, 8].map(n => ({\n            id: n.toString(),\n            label: n.toString(),\n            // add description for tabSize value set in the configuration\n            description: (n === creationOpts.tabSize && n === modelOpts.tabSize\n                ? nls.localize('configuredTabSize', \"Configured Tab Size\")\n                : n === creationOpts.tabSize\n                    ? nls.localize('defaultTabSize', \"Default Tab Size\")\n                    : n === modelOpts.tabSize\n                        ? nls.localize('currentTabSize', \"Current Tab Size\")\n                        : undefined)\n        }));\n        // auto focus the tabSize set for the current editor\n        const autoFocusIndex = Math.min(model.getOptions().tabSize - 1, 7);\n        setTimeout(() => {\n            quickInputService.pick(picks, { placeHolder: nls.localize({ key: 'selectTabWidth', comment: ['Tab corresponds to the tab key'] }, \"Select Tab Size for Current File\"), activeItem: picks[autoFocusIndex] }).then(pick => {\n                if (pick) {\n                    if (model && !model.isDisposed()) {\n                        const pickedVal = parseInt(pick.label, 10);\n                        if (this.displaySizeOnly) {\n                            model.updateOptions({\n                                tabSize: pickedVal\n                            });\n                        }\n                        else {\n                            model.updateOptions({\n                                tabSize: pickedVal,\n                                indentSize: pickedVal,\n                                insertSpaces: this.insertSpaces\n                            });\n                        }\n                    }\n                }\n            });\n        }, 50 /* quick input is sensitive to being opened so soon after another */);\n    }\n}\nexport class IndentUsingTabs extends ChangeIndentationSizeAction {\n    static { this.ID = 'editor.action.indentUsingTabs'; }\n    constructor() {\n        super(false, false, {\n            id: IndentUsingTabs.ID,\n            label: nls.localize('indentUsingTabs', \"Indent Using Tabs\"),\n            alias: 'Indent Using Tabs',\n            precondition: undefined,\n            metadata: {\n                description: nls.localize2('indentUsingTabsDescription', \"Use indentation with tabs.\"),\n            }\n        });\n    }\n}\nexport class IndentUsingSpaces extends ChangeIndentationSizeAction {\n    static { this.ID = 'editor.action.indentUsingSpaces'; }\n    constructor() {\n        super(true, false, {\n            id: IndentUsingSpaces.ID,\n            label: nls.localize('indentUsingSpaces', \"Indent Using Spaces\"),\n            alias: 'Indent Using Spaces',\n            precondition: undefined,\n            metadata: {\n                description: nls.localize2('indentUsingSpacesDescription', \"Use indentation with spaces.\"),\n            }\n        });\n    }\n}\nexport class ChangeTabDisplaySize extends ChangeIndentationSizeAction {\n    static { this.ID = 'editor.action.changeTabDisplaySize'; }\n    constructor() {\n        super(true, true, {\n            id: ChangeTabDisplaySize.ID,\n            label: nls.localize('changeTabDisplaySize', \"Change Tab Display Size\"),\n            alias: 'Change Tab Display Size',\n            precondition: undefined,\n            metadata: {\n                description: nls.localize2('changeTabDisplaySizeDescription', \"Change the space size equivalent of the tab.\"),\n            }\n        });\n    }\n}\nexport class DetectIndentation extends EditorAction {\n    static { this.ID = 'editor.action.detectIndentation'; }\n    constructor() {\n        super({\n            id: DetectIndentation.ID,\n            label: nls.localize('detectIndentation', \"Detect Indentation from Content\"),\n            alias: 'Detect Indentation from Content',\n            precondition: undefined,\n            metadata: {\n                description: nls.localize2('detectIndentationDescription', \"Detect the indentation from content.\"),\n            }\n        });\n    }\n    run(accessor, editor) {\n        const modelService = accessor.get(IModelService);\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const creationOpts = modelService.getCreationOptions(model.getLanguageId(), model.uri, model.isForSimpleWidget);\n        model.detectIndentation(creationOpts.insertSpaces, creationOpts.tabSize);\n    }\n}\nexport class ReindentLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.reindentlines',\n            label: nls.localize('editor.reindentlines', \"Reindent Lines\"),\n            alias: 'Reindent Lines',\n            precondition: EditorContextKeys.writable,\n            metadata: {\n                description: nls.localize2('editor.reindentlinesDescription', \"Reindent the lines of the editor.\"),\n            }\n        });\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const edits = getReindentEditOperations(model, languageConfigurationService, 1, model.getLineCount());\n        if (edits.length > 0) {\n            editor.pushUndoStop();\n            editor.executeEdits(this.id, edits);\n            editor.pushUndoStop();\n        }\n    }\n}\nexport class ReindentSelectedLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.reindentselectedlines',\n            label: nls.localize('editor.reindentselectedlines', \"Reindent Selected Lines\"),\n            alias: 'Reindent Selected Lines',\n            precondition: EditorContextKeys.writable,\n            metadata: {\n                description: nls.localize2('editor.reindentselectedlinesDescription', \"Reindent the selected lines of the editor.\"),\n            }\n        });\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return;\n        }\n        const edits = [];\n        for (const selection of selections) {\n            let startLineNumber = selection.startLineNumber;\n            let endLineNumber = selection.endLineNumber;\n            if (startLineNumber !== endLineNumber && selection.endColumn === 1) {\n                endLineNumber--;\n            }\n            if (startLineNumber === 1) {\n                if (startLineNumber === endLineNumber) {\n                    continue;\n                }\n            }\n            else {\n                startLineNumber--;\n            }\n            const editOperations = getReindentEditOperations(model, languageConfigurationService, startLineNumber, endLineNumber);\n            edits.push(...editOperations);\n        }\n        if (edits.length > 0) {\n            editor.pushUndoStop();\n            editor.executeEdits(this.id, edits);\n            editor.pushUndoStop();\n        }\n    }\n}\nexport class AutoIndentOnPasteCommand {\n    constructor(edits, initialSelection) {\n        this._initialSelection = initialSelection;\n        this._edits = [];\n        this._selectionId = null;\n        for (const edit of edits) {\n            if (edit.range && typeof edit.text === 'string') {\n                this._edits.push(edit);\n            }\n        }\n    }\n    getEditOperations(model, builder) {\n        for (const edit of this._edits) {\n            builder.addEditOperation(Range.lift(edit.range), edit.text);\n        }\n        let selectionIsSet = false;\n        if (Array.isArray(this._edits) && this._edits.length === 1 && this._initialSelection.isEmpty()) {\n            if (this._edits[0].range.startColumn === this._initialSelection.endColumn &&\n                this._edits[0].range.startLineNumber === this._initialSelection.endLineNumber) {\n                selectionIsSet = true;\n                this._selectionId = builder.trackSelection(this._initialSelection, true);\n            }\n            else if (this._edits[0].range.endColumn === this._initialSelection.startColumn &&\n                this._edits[0].range.endLineNumber === this._initialSelection.startLineNumber) {\n                selectionIsSet = true;\n                this._selectionId = builder.trackSelection(this._initialSelection, false);\n            }\n        }\n        if (!selectionIsSet) {\n            this._selectionId = builder.trackSelection(this._initialSelection);\n        }\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this._selectionId);\n    }\n}\nlet AutoIndentOnPaste = class AutoIndentOnPaste {\n    static { this.ID = 'editor.contrib.autoIndentOnPaste'; }\n    constructor(editor, _languageConfigurationService) {\n        this.editor = editor;\n        this._languageConfigurationService = _languageConfigurationService;\n        this.callOnDispose = new DisposableStore();\n        this.callOnModel = new DisposableStore();\n        this.callOnDispose.add(editor.onDidChangeConfiguration(() => this.update()));\n        this.callOnDispose.add(editor.onDidChangeModel(() => this.update()));\n        this.callOnDispose.add(editor.onDidChangeModelLanguage(() => this.update()));\n    }\n    update() {\n        // clean up\n        this.callOnModel.clear();\n        // we are disabled\n        if (this.editor.getOption(12 /* EditorOption.autoIndent */) < 4 /* EditorAutoIndentStrategy.Full */ || this.editor.getOption(55 /* EditorOption.formatOnPaste */)) {\n            return;\n        }\n        // no model\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        this.callOnModel.add(this.editor.onDidPaste(({ range }) => {\n            this.trigger(range);\n        }));\n    }\n    trigger(range) {\n        const selections = this.editor.getSelections();\n        if (selections === null || selections.length > 1) {\n            return;\n        }\n        const model = this.editor.getModel();\n        if (!model) {\n            return;\n        }\n        const containsOnlyWhitespace = this.rangeContainsOnlyWhitespaceCharacters(model, range);\n        if (containsOnlyWhitespace) {\n            return;\n        }\n        if (isStartOrEndInString(model, range)) {\n            return;\n        }\n        if (!model.tokenization.isCheapToTokenize(range.getStartPosition().lineNumber)) {\n            return;\n        }\n        const autoIndent = this.editor.getOption(12 /* EditorOption.autoIndent */);\n        const { tabSize, indentSize, insertSpaces } = model.getOptions();\n        const textEdits = [];\n        const indentConverter = {\n            shiftIndent: (indentation) => {\n                return ShiftCommand.shiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\n            },\n            unshiftIndent: (indentation) => {\n                return ShiftCommand.unshiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\n            }\n        };\n        let startLineNumber = range.startLineNumber;\n        while (startLineNumber <= range.endLineNumber) {\n            if (this.shouldIgnoreLine(model, startLineNumber)) {\n                startLineNumber++;\n                continue;\n            }\n            break;\n        }\n        if (startLineNumber > range.endLineNumber) {\n            return;\n        }\n        let firstLineText = model.getLineContent(startLineNumber);\n        if (!/\\S/.test(firstLineText.substring(0, range.startColumn - 1))) {\n            const indentOfFirstLine = getGoodIndentForLine(autoIndent, model, model.getLanguageId(), startLineNumber, indentConverter, this._languageConfigurationService);\n            if (indentOfFirstLine !== null) {\n                const oldIndentation = strings.getLeadingWhitespace(firstLineText);\n                const newSpaceCnt = indentUtils.getSpaceCnt(indentOfFirstLine, tabSize);\n                const oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\n                if (newSpaceCnt !== oldSpaceCnt) {\n                    const newIndent = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\n                    textEdits.push({\n                        range: new Range(startLineNumber, 1, startLineNumber, oldIndentation.length + 1),\n                        text: newIndent\n                    });\n                    firstLineText = newIndent + firstLineText.substring(oldIndentation.length);\n                }\n                else {\n                    const indentMetadata = getIndentMetadata(model, startLineNumber, this._languageConfigurationService);\n                    if (indentMetadata === 0 || indentMetadata === 8 /* IndentConsts.UNINDENT_MASK */) {\n                        // we paste content into a line where only contains whitespaces\n                        // after pasting, the indentation of the first line is already correct\n                        // the first line doesn't match any indentation rule\n                        // then no-op.\n                        return;\n                    }\n                }\n            }\n        }\n        const firstLineNumber = startLineNumber;\n        // ignore empty or ignored lines\n        while (startLineNumber < range.endLineNumber) {\n            if (!/\\S/.test(model.getLineContent(startLineNumber + 1))) {\n                startLineNumber++;\n                continue;\n            }\n            break;\n        }\n        if (startLineNumber !== range.endLineNumber) {\n            const virtualModel = {\n                tokenization: {\n                    getLineTokens: (lineNumber) => {\n                        return model.tokenization.getLineTokens(lineNumber);\n                    },\n                    getLanguageId: () => {\n                        return model.getLanguageId();\n                    },\n                    getLanguageIdAtPosition: (lineNumber, column) => {\n                        return model.getLanguageIdAtPosition(lineNumber, column);\n                    },\n                },\n                getLineContent: (lineNumber) => {\n                    if (lineNumber === firstLineNumber) {\n                        return firstLineText;\n                    }\n                    else {\n                        return model.getLineContent(lineNumber);\n                    }\n                }\n            };\n            const indentOfSecondLine = getGoodIndentForLine(autoIndent, virtualModel, model.getLanguageId(), startLineNumber + 1, indentConverter, this._languageConfigurationService);\n            if (indentOfSecondLine !== null) {\n                const newSpaceCntOfSecondLine = indentUtils.getSpaceCnt(indentOfSecondLine, tabSize);\n                const oldSpaceCntOfSecondLine = indentUtils.getSpaceCnt(strings.getLeadingWhitespace(model.getLineContent(startLineNumber + 1)), tabSize);\n                if (newSpaceCntOfSecondLine !== oldSpaceCntOfSecondLine) {\n                    const spaceCntOffset = newSpaceCntOfSecondLine - oldSpaceCntOfSecondLine;\n                    for (let i = startLineNumber + 1; i <= range.endLineNumber; i++) {\n                        const lineContent = model.getLineContent(i);\n                        const originalIndent = strings.getLeadingWhitespace(lineContent);\n                        const originalSpacesCnt = indentUtils.getSpaceCnt(originalIndent, tabSize);\n                        const newSpacesCnt = originalSpacesCnt + spaceCntOffset;\n                        const newIndent = indentUtils.generateIndent(newSpacesCnt, tabSize, insertSpaces);\n                        if (newIndent !== originalIndent) {\n                            textEdits.push({\n                                range: new Range(i, 1, i, originalIndent.length + 1),\n                                text: newIndent\n                            });\n                        }\n                    }\n                }\n            }\n        }\n        if (textEdits.length > 0) {\n            this.editor.pushUndoStop();\n            const cmd = new AutoIndentOnPasteCommand(textEdits, this.editor.getSelection());\n            this.editor.executeCommand('autoIndentOnPaste', cmd);\n            this.editor.pushUndoStop();\n        }\n    }\n    rangeContainsOnlyWhitespaceCharacters(model, range) {\n        const lineContainsOnlyWhitespace = (content) => {\n            return content.trim().length === 0;\n        };\n        let containsOnlyWhitespace = true;\n        if (range.startLineNumber === range.endLineNumber) {\n            const lineContent = model.getLineContent(range.startLineNumber);\n            const linePart = lineContent.substring(range.startColumn - 1, range.endColumn - 1);\n            containsOnlyWhitespace = lineContainsOnlyWhitespace(linePart);\n        }\n        else {\n            for (let i = range.startLineNumber; i <= range.endLineNumber; i++) {\n                const lineContent = model.getLineContent(i);\n                if (i === range.startLineNumber) {\n                    const linePart = lineContent.substring(range.startColumn - 1);\n                    containsOnlyWhitespace = lineContainsOnlyWhitespace(linePart);\n                }\n                else if (i === range.endLineNumber) {\n                    const linePart = lineContent.substring(0, range.endColumn - 1);\n                    containsOnlyWhitespace = lineContainsOnlyWhitespace(linePart);\n                }\n                else {\n                    containsOnlyWhitespace = model.getLineFirstNonWhitespaceColumn(i) === 0;\n                }\n                if (!containsOnlyWhitespace) {\n                    break;\n                }\n            }\n        }\n        return containsOnlyWhitespace;\n    }\n    shouldIgnoreLine(model, lineNumber) {\n        model.tokenization.forceTokenization(lineNumber);\n        const nonWhitespaceColumn = model.getLineFirstNonWhitespaceColumn(lineNumber);\n        if (nonWhitespaceColumn === 0) {\n            return true;\n        }\n        const tokens = model.tokenization.getLineTokens(lineNumber);\n        if (tokens.getCount() > 0) {\n            const firstNonWhitespaceTokenIndex = tokens.findTokenIndexAtOffset(nonWhitespaceColumn);\n            if (firstNonWhitespaceTokenIndex >= 0 && tokens.getStandardTokenType(firstNonWhitespaceTokenIndex) === 1 /* StandardTokenType.Comment */) {\n                return true;\n            }\n        }\n        return false;\n    }\n    dispose() {\n        this.callOnDispose.dispose();\n        this.callOnModel.dispose();\n    }\n};\nAutoIndentOnPaste = __decorate([\n    __param(1, ILanguageConfigurationService)\n], AutoIndentOnPaste);\nexport { AutoIndentOnPaste };\nfunction isStartOrEndInString(model, range) {\n    const isPositionInString = (position) => {\n        const tokenType = getStandardTokenTypeAtPosition(model, position);\n        return tokenType === 2 /* StandardTokenType.String */;\n    };\n    return isPositionInString(range.getStartPosition()) || isPositionInString(range.getEndPosition());\n}\nfunction getIndentationEditOperations(model, builder, tabSize, tabsToSpaces) {\n    if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\n        // Model is empty\n        return;\n    }\n    let spaces = '';\n    for (let i = 0; i < tabSize; i++) {\n        spaces += ' ';\n    }\n    const spacesRegExp = new RegExp(spaces, 'gi');\n    for (let lineNumber = 1, lineCount = model.getLineCount(); lineNumber <= lineCount; lineNumber++) {\n        let lastIndentationColumn = model.getLineFirstNonWhitespaceColumn(lineNumber);\n        if (lastIndentationColumn === 0) {\n            lastIndentationColumn = model.getLineMaxColumn(lineNumber);\n        }\n        if (lastIndentationColumn === 1) {\n            continue;\n        }\n        const originalIndentationRange = new Range(lineNumber, 1, lineNumber, lastIndentationColumn);\n        const originalIndentation = model.getValueInRange(originalIndentationRange);\n        const newIndentation = (tabsToSpaces\n            ? originalIndentation.replace(/\\t/ig, spaces)\n            : originalIndentation.replace(spacesRegExp, '\\t'));\n        builder.addEditOperation(originalIndentationRange, newIndentation);\n    }\n}\nexport class IndentationToSpacesCommand {\n    constructor(selection, tabSize) {\n        this.selection = selection;\n        this.tabSize = tabSize;\n        this.selectionId = null;\n    }\n    getEditOperations(model, builder) {\n        this.selectionId = builder.trackSelection(this.selection);\n        getIndentationEditOperations(model, builder, this.tabSize, true);\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this.selectionId);\n    }\n}\nexport class IndentationToTabsCommand {\n    constructor(selection, tabSize) {\n        this.selection = selection;\n        this.tabSize = tabSize;\n        this.selectionId = null;\n    }\n    getEditOperations(model, builder) {\n        this.selectionId = builder.trackSelection(this.selection);\n        getIndentationEditOperations(model, builder, this.tabSize, false);\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this.selectionId);\n    }\n}\nregisterEditorContribution(AutoIndentOnPaste.ID, AutoIndentOnPaste, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(IndentationToSpacesAction);\nregisterEditorAction(IndentationToTabsAction);\nregisterEditorAction(IndentUsingTabs);\nregisterEditorAction(IndentUsingSpaces);\nregisterEditorAction(ChangeTabDisplaySize);\nregisterEditorAction(DetectIndentation);\nregisterEditorAction(ReindentLinesAction);\nregisterEditorAction(ReindentSelectedLinesAction);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { HoverParticipantRegistry } from '../../hover/browser/hoverTypes.js';\nimport { InlayHintsController } from './inlayHintsController.js';\nimport { InlayHintsHover } from './inlayHintsHover.js';\nregisterEditorContribution(InlayHintsController.ID, InlayHintsController, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nHoverParticipantRegistry.register(InlayHintsHover);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Selection } from '../../../common/core/selection.js';\nexport class InPlaceReplaceCommand {\n    constructor(editRange, originalSelection, text) {\n        this._editRange = editRange;\n        this._originalSelection = originalSelection;\n        this._text = text;\n    }\n    getEditOperations(model, builder) {\n        builder.addTrackedEditOperation(this._editRange, this._text);\n    }\n    computeCursorState(model, helper) {\n        const inverseEditOperations = helper.getInverseEditOperations();\n        const srcRange = inverseEditOperations[0].range;\n        if (!this._originalSelection.isEmpty()) {\n            // Preserve selection and extends to typed text\n            return new Selection(srcRange.endLineNumber, srcRange.endColumn - this._text.length, srcRange.endLineNumber, srcRange.endColumn);\n        }\n        return new Selection(srcRange.endLineNumber, Math.min(this._originalSelection.positionColumn, srcRange.endColumn), srcRange.endLineNumber, Math.min(this._originalSelection.positionColumn, srcRange.endColumn));\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InPlaceReplaceController_1;\nimport { createCancelablePromise, timeout } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { EditorState } from '../../editorState/browser/editorState.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport * as nls from '../../../../nls.js';\nimport { InPlaceReplaceCommand } from './inPlaceReplaceCommand.js';\nimport './inPlaceReplace.css';\nlet InPlaceReplaceController = class InPlaceReplaceController {\n    static { InPlaceReplaceController_1 = this; }\n    static { this.ID = 'editor.contrib.inPlaceReplaceController'; }\n    static get(editor) {\n        return editor.getContribution(InPlaceReplaceController_1.ID);\n    }\n    static { this.DECORATION = ModelDecorationOptions.register({\n        description: 'in-place-replace',\n        className: 'valueSetReplacement'\n    }); }\n    constructor(editor, editorWorkerService) {\n        this.editor = editor;\n        this.editorWorkerService = editorWorkerService;\n        this.decorations = this.editor.createDecorationsCollection();\n    }\n    dispose() {\n    }\n    run(source, up) {\n        // cancel any pending request\n        this.currentRequest?.cancel();\n        const editorSelection = this.editor.getSelection();\n        const model = this.editor.getModel();\n        if (!model || !editorSelection) {\n            return undefined;\n        }\n        let selection = editorSelection;\n        if (selection.startLineNumber !== selection.endLineNumber) {\n            // Can't accept multiline selection\n            return undefined;\n        }\n        const state = new EditorState(this.editor, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */);\n        const modelURI = model.uri;\n        if (!this.editorWorkerService.canNavigateValueSet(modelURI)) {\n            return Promise.resolve(undefined);\n        }\n        this.currentRequest = createCancelablePromise(token => this.editorWorkerService.navigateValueSet(modelURI, selection, up));\n        return this.currentRequest.then(result => {\n            if (!result || !result.range || !result.value) {\n                // No proper result\n                return;\n            }\n            if (!state.validate(this.editor)) {\n                // state has changed\n                return;\n            }\n            // Selection\n            const editRange = Range.lift(result.range);\n            let highlightRange = result.range;\n            const diff = result.value.length - (selection.endColumn - selection.startColumn);\n            // highlight\n            highlightRange = {\n                startLineNumber: highlightRange.startLineNumber,\n                startColumn: highlightRange.startColumn,\n                endLineNumber: highlightRange.endLineNumber,\n                endColumn: highlightRange.startColumn + result.value.length\n            };\n            if (diff > 1) {\n                selection = new Selection(selection.startLineNumber, selection.startColumn, selection.endLineNumber, selection.endColumn + diff - 1);\n            }\n            // Insert new text\n            const command = new InPlaceReplaceCommand(editRange, selection, result.value);\n            this.editor.pushUndoStop();\n            this.editor.executeCommand(source, command);\n            this.editor.pushUndoStop();\n            // add decoration\n            this.decorations.set([{\n                    range: highlightRange,\n                    options: InPlaceReplaceController_1.DECORATION\n                }]);\n            // remove decoration after delay\n            this.decorationRemover?.cancel();\n            this.decorationRemover = timeout(350);\n            this.decorationRemover.then(() => this.decorations.clear()).catch(onUnexpectedError);\n        }).catch(onUnexpectedError);\n    }\n};\nInPlaceReplaceController = InPlaceReplaceController_1 = __decorate([\n    __param(1, IEditorWorkerService)\n], InPlaceReplaceController);\nclass InPlaceReplaceUp extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inPlaceReplace.up',\n            label: nls.localize('InPlaceReplaceAction.previous.label', \"Replace with Previous Value\"),\n            alias: 'Replace with Previous Value',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 87 /* KeyCode.Comma */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = InPlaceReplaceController.get(editor);\n        if (!controller) {\n            return Promise.resolve(undefined);\n        }\n        return controller.run(this.id, false);\n    }\n}\nclass InPlaceReplaceDown extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inPlaceReplace.down',\n            label: nls.localize('InPlaceReplaceAction.next.label', \"Replace with Next Value\"),\n            alias: 'Replace with Next Value',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 89 /* KeyCode.Period */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = InPlaceReplaceController.get(editor);\n        if (!controller) {\n            return Promise.resolve(undefined);\n        }\n        return controller.run(this.id, true);\n    }\n}\nregisterEditorContribution(InPlaceReplaceController.ID, InPlaceReplaceController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(InPlaceReplaceUp);\nregisterEditorAction(InPlaceReplaceDown);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { CursorMoveCommands } from '../../../common/cursor/cursorMoveCommands.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport * as nls from '../../../../nls.js';\nexport class ExpandLineSelectionAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'expandLineSelection',\n            label: nls.localize('expandLineSelection', \"Expand Line Selection\"),\n            alias: 'Expand Line Selection',\n            precondition: undefined,\n            kbOpts: {\n                weight: 0 /* KeybindingWeight.EditorCore */,\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 42 /* KeyCode.KeyL */\n            },\n        });\n    }\n    run(_accessor, editor, args) {\n        args = args || {};\n        if (!editor.hasModel()) {\n            return;\n        }\n        const viewModel = editor._getViewModel();\n        viewModel.model.pushStackElement();\n        viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.expandLineSelection(viewModel, viewModel.getCursorStates()));\n        viewModel.revealAllCursors(args.source, true);\n    }\n}\nregisterEditorAction(ExpandLineSelectionAction);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nexport class CopyLinesCommand {\n    constructor(selection, isCopyingDown, noop) {\n        this._selection = selection;\n        this._isCopyingDown = isCopyingDown;\n        this._noop = noop || false;\n        this._selectionDirection = 0 /* SelectionDirection.LTR */;\n        this._selectionId = null;\n        this._startLineNumberDelta = 0;\n        this._endLineNumberDelta = 0;\n    }\n    getEditOperations(model, builder) {\n        let s = this._selection;\n        this._startLineNumberDelta = 0;\n        this._endLineNumberDelta = 0;\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\n            this._endLineNumberDelta = 1;\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\n        }\n        const sourceLines = [];\n        for (let i = s.startLineNumber; i <= s.endLineNumber; i++) {\n            sourceLines.push(model.getLineContent(i));\n        }\n        const sourceText = sourceLines.join('\\n');\n        if (sourceText === '') {\n            // Duplicating empty line\n            if (this._isCopyingDown) {\n                this._startLineNumberDelta++;\n                this._endLineNumberDelta++;\n            }\n        }\n        if (this._noop) {\n            builder.addEditOperation(new Range(s.endLineNumber, model.getLineMaxColumn(s.endLineNumber), s.endLineNumber + 1, 1), s.endLineNumber === model.getLineCount() ? '' : '\\n');\n        }\n        else {\n            if (!this._isCopyingDown) {\n                builder.addEditOperation(new Range(s.endLineNumber, model.getLineMaxColumn(s.endLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), '\\n' + sourceText);\n            }\n            else {\n                builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), sourceText + '\\n');\n            }\n        }\n        this._selectionId = builder.trackSelection(s);\n        this._selectionDirection = this._selection.getDirection();\n    }\n    computeCursorState(model, helper) {\n        let result = helper.getTrackedSelection(this._selectionId);\n        if (this._startLineNumberDelta !== 0 || this._endLineNumberDelta !== 0) {\n            let startLineNumber = result.startLineNumber;\n            let startColumn = result.startColumn;\n            let endLineNumber = result.endLineNumber;\n            let endColumn = result.endColumn;\n            if (this._startLineNumberDelta !== 0) {\n                startLineNumber = startLineNumber + this._startLineNumberDelta;\n                startColumn = 1;\n            }\n            if (this._endLineNumberDelta !== 0) {\n                endLineNumber = endLineNumber + this._endLineNumberDelta;\n                endColumn = 1;\n            }\n            result = Selection.createWithDirection(startLineNumber, startColumn, endLineNumber, endColumn, this._selectionDirection);\n        }\n        return result;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as strings from '../../../../base/common/strings.js';\nimport { ShiftCommand } from '../../../common/commands/shiftCommand.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { IndentAction } from '../../../common/languages/languageConfiguration.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport * as indentUtils from '../../indentation/common/indentUtils.js';\nimport { getGoodIndentForLine, getIndentMetadata } from '../../../common/languages/autoIndent.js';\nimport { getEnterAction } from '../../../common/languages/enterAction.js';\nlet MoveLinesCommand = class MoveLinesCommand {\n    constructor(selection, isMovingDown, autoIndent, _languageConfigurationService) {\n        this._languageConfigurationService = _languageConfigurationService;\n        this._selection = selection;\n        this._isMovingDown = isMovingDown;\n        this._autoIndent = autoIndent;\n        this._selectionId = null;\n        this._moveEndLineSelectionShrink = false;\n    }\n    getEditOperations(model, builder) {\n        const getLanguageId = () => {\n            return model.getLanguageId();\n        };\n        const getLanguageIdAtPosition = (lineNumber, column) => {\n            return model.getLanguageIdAtPosition(lineNumber, column);\n        };\n        const modelLineCount = model.getLineCount();\n        if (this._isMovingDown && this._selection.endLineNumber === modelLineCount) {\n            this._selectionId = builder.trackSelection(this._selection);\n            return;\n        }\n        if (!this._isMovingDown && this._selection.startLineNumber === 1) {\n            this._selectionId = builder.trackSelection(this._selection);\n            return;\n        }\n        this._moveEndPositionDown = false;\n        let s = this._selection;\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\n            this._moveEndPositionDown = true;\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\n        }\n        const { tabSize, indentSize, insertSpaces } = model.getOptions();\n        const indentConverter = this.buildIndentConverter(tabSize, indentSize, insertSpaces);\n        if (s.startLineNumber === s.endLineNumber && model.getLineMaxColumn(s.startLineNumber) === 1) {\n            // Current line is empty\n            const lineNumber = s.startLineNumber;\n            const otherLineNumber = (this._isMovingDown ? lineNumber + 1 : lineNumber - 1);\n            if (model.getLineMaxColumn(otherLineNumber) === 1) {\n                // Other line number is empty too, so no editing is needed\n                // Add a no-op to force running by the model\n                builder.addEditOperation(new Range(1, 1, 1, 1), null);\n            }\n            else {\n                // Type content from other line number on line number\n                builder.addEditOperation(new Range(lineNumber, 1, lineNumber, 1), model.getLineContent(otherLineNumber));\n                // Remove content from other line number\n                builder.addEditOperation(new Range(otherLineNumber, 1, otherLineNumber, model.getLineMaxColumn(otherLineNumber)), null);\n            }\n            // Track selection at the other line number\n            s = new Selection(otherLineNumber, 1, otherLineNumber, 1);\n        }\n        else {\n            let movingLineNumber;\n            let movingLineText;\n            if (this._isMovingDown) {\n                movingLineNumber = s.endLineNumber + 1;\n                movingLineText = model.getLineContent(movingLineNumber);\n                // Delete line that needs to be moved\n                builder.addEditOperation(new Range(movingLineNumber - 1, model.getLineMaxColumn(movingLineNumber - 1), movingLineNumber, model.getLineMaxColumn(movingLineNumber)), null);\n                let insertingText = movingLineText;\n                if (this.shouldAutoIndent(model, s)) {\n                    const movingLineMatchResult = this.matchEnterRule(model, indentConverter, tabSize, movingLineNumber, s.startLineNumber - 1);\n                    // if s.startLineNumber - 1 matches onEnter rule, we still honor that.\n                    if (movingLineMatchResult !== null) {\n                        const oldIndentation = strings.getLeadingWhitespace(model.getLineContent(movingLineNumber));\n                        const newSpaceCnt = movingLineMatchResult + indentUtils.getSpaceCnt(oldIndentation, tabSize);\n                        const newIndentation = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\n                        insertingText = newIndentation + this.trimStart(movingLineText);\n                    }\n                    else {\n                        // no enter rule matches, let's check indentatin rules then.\n                        const virtualModel = {\n                            tokenization: {\n                                getLineTokens: (lineNumber) => {\n                                    if (lineNumber === s.startLineNumber) {\n                                        return model.tokenization.getLineTokens(movingLineNumber);\n                                    }\n                                    else {\n                                        return model.tokenization.getLineTokens(lineNumber);\n                                    }\n                                },\n                                getLanguageId,\n                                getLanguageIdAtPosition,\n                            },\n                            getLineContent: (lineNumber) => {\n                                if (lineNumber === s.startLineNumber) {\n                                    return model.getLineContent(movingLineNumber);\n                                }\n                                else {\n                                    return model.getLineContent(lineNumber);\n                                }\n                            },\n                        };\n                        const indentOfMovingLine = getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(movingLineNumber, 1), s.startLineNumber, indentConverter, this._languageConfigurationService);\n                        if (indentOfMovingLine !== null) {\n                            const oldIndentation = strings.getLeadingWhitespace(model.getLineContent(movingLineNumber));\n                            const newSpaceCnt = indentUtils.getSpaceCnt(indentOfMovingLine, tabSize);\n                            const oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\n                            if (newSpaceCnt !== oldSpaceCnt) {\n                                const newIndentation = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\n                                insertingText = newIndentation + this.trimStart(movingLineText);\n                            }\n                        }\n                    }\n                    // add edit operations for moving line first to make sure it's executed after we make indentation change\n                    // to s.startLineNumber\n                    builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), insertingText + '\\n');\n                    const ret = this.matchEnterRuleMovingDown(model, indentConverter, tabSize, s.startLineNumber, movingLineNumber, insertingText);\n                    // check if the line being moved before matches onEnter rules, if so let's adjust the indentation by onEnter rules.\n                    if (ret !== null) {\n                        if (ret !== 0) {\n                            this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, ret);\n                        }\n                    }\n                    else {\n                        // it doesn't match onEnter rules, let's check indentation rules then.\n                        const virtualModel = {\n                            tokenization: {\n                                getLineTokens: (lineNumber) => {\n                                    if (lineNumber === s.startLineNumber) {\n                                        // TODO@aiday-mar: the tokens here don't correspond exactly to the corresponding content (after indentation adjustment), have to fix this.\n                                        return model.tokenization.getLineTokens(movingLineNumber);\n                                    }\n                                    else if (lineNumber >= s.startLineNumber + 1 && lineNumber <= s.endLineNumber + 1) {\n                                        return model.tokenization.getLineTokens(lineNumber - 1);\n                                    }\n                                    else {\n                                        return model.tokenization.getLineTokens(lineNumber);\n                                    }\n                                },\n                                getLanguageId,\n                                getLanguageIdAtPosition,\n                            },\n                            getLineContent: (lineNumber) => {\n                                if (lineNumber === s.startLineNumber) {\n                                    return insertingText;\n                                }\n                                else if (lineNumber >= s.startLineNumber + 1 && lineNumber <= s.endLineNumber + 1) {\n                                    return model.getLineContent(lineNumber - 1);\n                                }\n                                else {\n                                    return model.getLineContent(lineNumber);\n                                }\n                            },\n                        };\n                        const newIndentatOfMovingBlock = getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(movingLineNumber, 1), s.startLineNumber + 1, indentConverter, this._languageConfigurationService);\n                        if (newIndentatOfMovingBlock !== null) {\n                            const oldIndentation = strings.getLeadingWhitespace(model.getLineContent(s.startLineNumber));\n                            const newSpaceCnt = indentUtils.getSpaceCnt(newIndentatOfMovingBlock, tabSize);\n                            const oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\n                            if (newSpaceCnt !== oldSpaceCnt) {\n                                const spaceCntOffset = newSpaceCnt - oldSpaceCnt;\n                                this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, spaceCntOffset);\n                            }\n                        }\n                    }\n                }\n                else {\n                    // Insert line that needs to be moved before\n                    builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), insertingText + '\\n');\n                }\n            }\n            else {\n                movingLineNumber = s.startLineNumber - 1;\n                movingLineText = model.getLineContent(movingLineNumber);\n                // Delete line that needs to be moved\n                builder.addEditOperation(new Range(movingLineNumber, 1, movingLineNumber + 1, 1), null);\n                // Insert line that needs to be moved after\n                builder.addEditOperation(new Range(s.endLineNumber, model.getLineMaxColumn(s.endLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), '\\n' + movingLineText);\n                if (this.shouldAutoIndent(model, s)) {\n                    const virtualModel = {\n                        tokenization: {\n                            getLineTokens: (lineNumber) => {\n                                if (lineNumber === movingLineNumber) {\n                                    return model.tokenization.getLineTokens(s.startLineNumber);\n                                }\n                                else {\n                                    return model.tokenization.getLineTokens(lineNumber);\n                                }\n                            },\n                            getLanguageId,\n                            getLanguageIdAtPosition,\n                        },\n                        getLineContent: (lineNumber) => {\n                            if (lineNumber === movingLineNumber) {\n                                return model.getLineContent(s.startLineNumber);\n                            }\n                            else {\n                                return model.getLineContent(lineNumber);\n                            }\n                        },\n                    };\n                    const ret = this.matchEnterRule(model, indentConverter, tabSize, s.startLineNumber, s.startLineNumber - 2);\n                    // check if s.startLineNumber - 2 matches onEnter rules, if so adjust the moving block by onEnter rules.\n                    if (ret !== null) {\n                        if (ret !== 0) {\n                            this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, ret);\n                        }\n                    }\n                    else {\n                        // it doesn't match any onEnter rule, let's check indentation rules then.\n                        const indentOfFirstLine = getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(s.startLineNumber, 1), movingLineNumber, indentConverter, this._languageConfigurationService);\n                        if (indentOfFirstLine !== null) {\n                            // adjust the indentation of the moving block\n                            const oldIndent = strings.getLeadingWhitespace(model.getLineContent(s.startLineNumber));\n                            const newSpaceCnt = indentUtils.getSpaceCnt(indentOfFirstLine, tabSize);\n                            const oldSpaceCnt = indentUtils.getSpaceCnt(oldIndent, tabSize);\n                            if (newSpaceCnt !== oldSpaceCnt) {\n                                const spaceCntOffset = newSpaceCnt - oldSpaceCnt;\n                                this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, spaceCntOffset);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        this._selectionId = builder.trackSelection(s);\n    }\n    buildIndentConverter(tabSize, indentSize, insertSpaces) {\n        return {\n            shiftIndent: (indentation) => {\n                return ShiftCommand.shiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\n            },\n            unshiftIndent: (indentation) => {\n                return ShiftCommand.unshiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\n            }\n        };\n    }\n    parseEnterResult(model, indentConverter, tabSize, line, enter) {\n        if (enter) {\n            let enterPrefix = enter.indentation;\n            if (enter.indentAction === IndentAction.None) {\n                enterPrefix = enter.indentation + enter.appendText;\n            }\n            else if (enter.indentAction === IndentAction.Indent) {\n                enterPrefix = enter.indentation + enter.appendText;\n            }\n            else if (enter.indentAction === IndentAction.IndentOutdent) {\n                enterPrefix = enter.indentation;\n            }\n            else if (enter.indentAction === IndentAction.Outdent) {\n                enterPrefix = indentConverter.unshiftIndent(enter.indentation) + enter.appendText;\n            }\n            const movingLineText = model.getLineContent(line);\n            if (this.trimStart(movingLineText).indexOf(this.trimStart(enterPrefix)) >= 0) {\n                const oldIndentation = strings.getLeadingWhitespace(model.getLineContent(line));\n                let newIndentation = strings.getLeadingWhitespace(enterPrefix);\n                const indentMetadataOfMovelingLine = getIndentMetadata(model, line, this._languageConfigurationService);\n                if (indentMetadataOfMovelingLine !== null && indentMetadataOfMovelingLine & 2 /* IndentConsts.DECREASE_MASK */) {\n                    newIndentation = indentConverter.unshiftIndent(newIndentation);\n                }\n                const newSpaceCnt = indentUtils.getSpaceCnt(newIndentation, tabSize);\n                const oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\n                return newSpaceCnt - oldSpaceCnt;\n            }\n        }\n        return null;\n    }\n    /**\n     *\n     * @param model\n     * @param indentConverter\n     * @param tabSize\n     * @param line the line moving down\n     * @param futureAboveLineNumber the line which will be at the `line` position\n     * @param futureAboveLineText\n     */\n    matchEnterRuleMovingDown(model, indentConverter, tabSize, line, futureAboveLineNumber, futureAboveLineText) {\n        if (strings.lastNonWhitespaceIndex(futureAboveLineText) >= 0) {\n            // break\n            const maxColumn = model.getLineMaxColumn(futureAboveLineNumber);\n            const enter = getEnterAction(this._autoIndent, model, new Range(futureAboveLineNumber, maxColumn, futureAboveLineNumber, maxColumn), this._languageConfigurationService);\n            return this.parseEnterResult(model, indentConverter, tabSize, line, enter);\n        }\n        else {\n            // go upwards, starting from `line - 1`\n            let validPrecedingLine = line - 1;\n            while (validPrecedingLine >= 1) {\n                const lineContent = model.getLineContent(validPrecedingLine);\n                const nonWhitespaceIdx = strings.lastNonWhitespaceIndex(lineContent);\n                if (nonWhitespaceIdx >= 0) {\n                    break;\n                }\n                validPrecedingLine--;\n            }\n            if (validPrecedingLine < 1 || line > model.getLineCount()) {\n                return null;\n            }\n            const maxColumn = model.getLineMaxColumn(validPrecedingLine);\n            const enter = getEnterAction(this._autoIndent, model, new Range(validPrecedingLine, maxColumn, validPrecedingLine, maxColumn), this._languageConfigurationService);\n            return this.parseEnterResult(model, indentConverter, tabSize, line, enter);\n        }\n    }\n    matchEnterRule(model, indentConverter, tabSize, line, oneLineAbove, previousLineText) {\n        let validPrecedingLine = oneLineAbove;\n        while (validPrecedingLine >= 1) {\n            // ship empty lines as empty lines just inherit indentation\n            let lineContent;\n            if (validPrecedingLine === oneLineAbove && previousLineText !== undefined) {\n                lineContent = previousLineText;\n            }\n            else {\n                lineContent = model.getLineContent(validPrecedingLine);\n            }\n            const nonWhitespaceIdx = strings.lastNonWhitespaceIndex(lineContent);\n            if (nonWhitespaceIdx >= 0) {\n                break;\n            }\n            validPrecedingLine--;\n        }\n        if (validPrecedingLine < 1 || line > model.getLineCount()) {\n            return null;\n        }\n        const maxColumn = model.getLineMaxColumn(validPrecedingLine);\n        const enter = getEnterAction(this._autoIndent, model, new Range(validPrecedingLine, maxColumn, validPrecedingLine, maxColumn), this._languageConfigurationService);\n        return this.parseEnterResult(model, indentConverter, tabSize, line, enter);\n    }\n    trimStart(str) {\n        return str.replace(/^\\s+/, '');\n    }\n    shouldAutoIndent(model, selection) {\n        if (this._autoIndent < 4 /* EditorAutoIndentStrategy.Full */) {\n            return false;\n        }\n        // if it's not easy to tokenize, we stop auto indent.\n        if (!model.tokenization.isCheapToTokenize(selection.startLineNumber)) {\n            return false;\n        }\n        const languageAtSelectionStart = model.getLanguageIdAtPosition(selection.startLineNumber, 1);\n        const languageAtSelectionEnd = model.getLanguageIdAtPosition(selection.endLineNumber, 1);\n        if (languageAtSelectionStart !== languageAtSelectionEnd) {\n            return false;\n        }\n        if (this._languageConfigurationService.getLanguageConfiguration(languageAtSelectionStart).indentRulesSupport === null) {\n            return false;\n        }\n        return true;\n    }\n    getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, offset) {\n        for (let i = s.startLineNumber; i <= s.endLineNumber; i++) {\n            const lineContent = model.getLineContent(i);\n            const originalIndent = strings.getLeadingWhitespace(lineContent);\n            const originalSpacesCnt = indentUtils.getSpaceCnt(originalIndent, tabSize);\n            const newSpacesCnt = originalSpacesCnt + offset;\n            const newIndent = indentUtils.generateIndent(newSpacesCnt, tabSize, insertSpaces);\n            if (newIndent !== originalIndent) {\n                builder.addEditOperation(new Range(i, 1, i, originalIndent.length + 1), newIndent);\n                if (i === s.endLineNumber && s.endColumn <= originalIndent.length + 1 && newIndent === '') {\n                    // as users select part of the original indent white spaces\n                    // when we adjust the indentation of endLine, we should adjust the cursor position as well.\n                    this._moveEndLineSelectionShrink = true;\n                }\n            }\n        }\n    }\n    computeCursorState(model, helper) {\n        let result = helper.getTrackedSelection(this._selectionId);\n        if (this._moveEndPositionDown) {\n            result = result.setEndPosition(result.endLineNumber + 1, 1);\n        }\n        if (this._moveEndLineSelectionShrink && result.startLineNumber < result.endLineNumber) {\n            result = result.setEndPosition(result.endLineNumber, 2);\n        }\n        return result;\n    }\n};\nMoveLinesCommand = __decorate([\n    __param(3, ILanguageConfigurationService)\n], MoveLinesCommand);\nexport { MoveLinesCommand };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nexport class SortLinesCommand {\n    static { this._COLLATOR = null; }\n    static getCollator() {\n        if (!SortLinesCommand._COLLATOR) {\n            SortLinesCommand._COLLATOR = new Intl.Collator();\n        }\n        return SortLinesCommand._COLLATOR;\n    }\n    constructor(selection, descending) {\n        this.selection = selection;\n        this.descending = descending;\n        this.selectionId = null;\n    }\n    getEditOperations(model, builder) {\n        const op = sortLines(model, this.selection, this.descending);\n        if (op) {\n            builder.addEditOperation(op.range, op.text);\n        }\n        this.selectionId = builder.trackSelection(this.selection);\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this.selectionId);\n    }\n    static canRun(model, selection, descending) {\n        if (model === null) {\n            return false;\n        }\n        const data = getSortData(model, selection, descending);\n        if (!data) {\n            return false;\n        }\n        for (let i = 0, len = data.before.length; i < len; i++) {\n            if (data.before[i] !== data.after[i]) {\n                return true;\n            }\n        }\n        return false;\n    }\n}\nfunction getSortData(model, selection, descending) {\n    const startLineNumber = selection.startLineNumber;\n    let endLineNumber = selection.endLineNumber;\n    if (selection.endColumn === 1) {\n        endLineNumber--;\n    }\n    // Nothing to sort if user didn't select anything.\n    if (startLineNumber >= endLineNumber) {\n        return null;\n    }\n    const linesToSort = [];\n    // Get the contents of the selection to be sorted.\n    for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\n        linesToSort.push(model.getLineContent(lineNumber));\n    }\n    let sorted = linesToSort.slice(0);\n    sorted.sort(SortLinesCommand.getCollator().compare);\n    // If descending, reverse the order.\n    if (descending === true) {\n        sorted = sorted.reverse();\n    }\n    return {\n        startLineNumber: startLineNumber,\n        endLineNumber: endLineNumber,\n        before: linesToSort,\n        after: sorted\n    };\n}\n/**\n * Generate commands for sorting lines on a model.\n */\nfunction sortLines(model, selection, descending) {\n    const data = getSortData(model, selection, descending);\n    if (!data) {\n        return null;\n    }\n    return EditOperation.replace(new Range(data.startLineNumber, 1, data.endLineNumber, model.getLineMaxColumn(data.endLineNumber)), data.after.join('\\n'));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { CoreEditingCommands } from '../../../browser/coreCommands.js';\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { ReplaceCommand, ReplaceCommandThatPreservesSelection, ReplaceCommandThatSelectsText } from '../../../common/commands/replaceCommand.js';\nimport { TrimTrailingWhitespaceCommand } from '../../../common/commands/trimTrailingWhitespaceCommand.js';\nimport { TypeOperations } from '../../../common/cursor/cursorTypeOperations.js';\nimport { EnterOperation } from '../../../common/cursor/cursorTypeEditOperations.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { CopyLinesCommand } from './copyLinesCommand.js';\nimport { MoveLinesCommand } from './moveLinesCommand.js';\nimport { SortLinesCommand } from './sortLinesCommand.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\n// copy lines\nclass AbstractCopyLinesAction extends EditorAction {\n    constructor(down, opts) {\n        super(opts);\n        this.down = down;\n    }\n    run(_accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const selections = editor.getSelections().map((selection, index) => ({ selection, index, ignore: false }));\n        selections.sort((a, b) => Range.compareRangesUsingStarts(a.selection, b.selection));\n        // Remove selections that would result in copying the same line\n        let prev = selections[0];\n        for (let i = 1; i < selections.length; i++) {\n            const curr = selections[i];\n            if (prev.selection.endLineNumber === curr.selection.startLineNumber) {\n                // these two selections would copy the same line\n                if (prev.index < curr.index) {\n                    // prev wins\n                    curr.ignore = true;\n                }\n                else {\n                    // curr wins\n                    prev.ignore = true;\n                    prev = curr;\n                }\n            }\n        }\n        const commands = [];\n        for (const selection of selections) {\n            commands.push(new CopyLinesCommand(selection.selection, this.down, selection.ignore));\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nclass CopyLinesUpAction extends AbstractCopyLinesAction {\n    constructor() {\n        super(false, {\n            id: 'editor.action.copyLinesUpAction',\n            label: nls.localize('lines.copyUp', \"Copy Line Up\"),\n            alias: 'Copy Line Up',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */,\n                linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '2_line',\n                title: nls.localize({ key: 'miCopyLinesUp', comment: ['&& denotes a mnemonic'] }, \"&&Copy Line Up\"),\n                order: 1\n            }\n        });\n    }\n}\nclass CopyLinesDownAction extends AbstractCopyLinesAction {\n    constructor() {\n        super(true, {\n            id: 'editor.action.copyLinesDownAction',\n            label: nls.localize('lines.copyDown', \"Copy Line Down\"),\n            alias: 'Copy Line Down',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */,\n                linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '2_line',\n                title: nls.localize({ key: 'miCopyLinesDown', comment: ['&& denotes a mnemonic'] }, \"Co&&py Line Down\"),\n                order: 2\n            }\n        });\n    }\n}\nexport class DuplicateSelectionAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.duplicateSelection',\n            label: nls.localize('duplicateSelection', \"Duplicate Selection\"),\n            alias: 'Duplicate Selection',\n            precondition: EditorContextKeys.writable,\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '2_line',\n                title: nls.localize({ key: 'miDuplicateSelection', comment: ['&& denotes a mnemonic'] }, \"&&Duplicate Selection\"),\n                order: 5\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const commands = [];\n        const selections = editor.getSelections();\n        const model = editor.getModel();\n        for (const selection of selections) {\n            if (selection.isEmpty()) {\n                commands.push(new CopyLinesCommand(selection, true));\n            }\n            else {\n                const insertSelection = new Selection(selection.endLineNumber, selection.endColumn, selection.endLineNumber, selection.endColumn);\n                commands.push(new ReplaceCommandThatSelectsText(insertSelection, model.getValueInRange(selection)));\n            }\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\n// move lines\nclass AbstractMoveLinesAction extends EditorAction {\n    constructor(down, opts) {\n        super(opts);\n        this.down = down;\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const commands = [];\n        const selections = editor.getSelections() || [];\n        const autoIndent = editor.getOption(12 /* EditorOption.autoIndent */);\n        for (const selection of selections) {\n            commands.push(new MoveLinesCommand(selection, this.down, autoIndent, languageConfigurationService));\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nclass MoveLinesUpAction extends AbstractMoveLinesAction {\n    constructor() {\n        super(false, {\n            id: 'editor.action.moveLinesUpAction',\n            label: nls.localize('lines.moveUp', \"Move Line Up\"),\n            alias: 'Move Line Up',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */,\n                linux: { primary: 512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '2_line',\n                title: nls.localize({ key: 'miMoveLinesUp', comment: ['&& denotes a mnemonic'] }, \"Mo&&ve Line Up\"),\n                order: 3\n            }\n        });\n    }\n}\nclass MoveLinesDownAction extends AbstractMoveLinesAction {\n    constructor() {\n        super(true, {\n            id: 'editor.action.moveLinesDownAction',\n            label: nls.localize('lines.moveDown', \"Move Line Down\"),\n            alias: 'Move Line Down',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */,\n                linux: { primary: 512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '2_line',\n                title: nls.localize({ key: 'miMoveLinesDown', comment: ['&& denotes a mnemonic'] }, \"Move &&Line Down\"),\n                order: 4\n            }\n        });\n    }\n}\nexport class AbstractSortLinesAction extends EditorAction {\n    constructor(descending, opts) {\n        super(opts);\n        this.descending = descending;\n    }\n    run(_accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const model = editor.getModel();\n        let selections = editor.getSelections();\n        if (selections.length === 1 && selections[0].isEmpty()) {\n            // Apply to whole document.\n            selections = [new Selection(1, 1, model.getLineCount(), model.getLineMaxColumn(model.getLineCount()))];\n        }\n        for (const selection of selections) {\n            if (!SortLinesCommand.canRun(editor.getModel(), selection, this.descending)) {\n                return;\n            }\n        }\n        const commands = [];\n        for (let i = 0, len = selections.length; i < len; i++) {\n            commands[i] = new SortLinesCommand(selections[i], this.descending);\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nexport class SortLinesAscendingAction extends AbstractSortLinesAction {\n    constructor() {\n        super(false, {\n            id: 'editor.action.sortLinesAscending',\n            label: nls.localize('lines.sortAscending', \"Sort Lines Ascending\"),\n            alias: 'Sort Lines Ascending',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nexport class SortLinesDescendingAction extends AbstractSortLinesAction {\n    constructor() {\n        super(true, {\n            id: 'editor.action.sortLinesDescending',\n            label: nls.localize('lines.sortDescending', \"Sort Lines Descending\"),\n            alias: 'Sort Lines Descending',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nexport class DeleteDuplicateLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.removeDuplicateLines',\n            label: nls.localize('lines.deleteDuplicates', \"Delete Duplicate Lines\"),\n            alias: 'Delete Duplicate Lines',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(_accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const model = editor.getModel();\n        if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\n            return;\n        }\n        const edits = [];\n        const endCursorState = [];\n        let linesDeleted = 0;\n        let updateSelection = true;\n        let selections = editor.getSelections();\n        if (selections.length === 1 && selections[0].isEmpty()) {\n            // Apply to whole document.\n            selections = [new Selection(1, 1, model.getLineCount(), model.getLineMaxColumn(model.getLineCount()))];\n            updateSelection = false;\n        }\n        for (const selection of selections) {\n            const uniqueLines = new Set();\n            const lines = [];\n            for (let i = selection.startLineNumber; i <= selection.endLineNumber; i++) {\n                const line = model.getLineContent(i);\n                if (uniqueLines.has(line)) {\n                    continue;\n                }\n                lines.push(line);\n                uniqueLines.add(line);\n            }\n            const selectionToReplace = new Selection(selection.startLineNumber, 1, selection.endLineNumber, model.getLineMaxColumn(selection.endLineNumber));\n            const adjustedSelectionStart = selection.startLineNumber - linesDeleted;\n            const finalSelection = new Selection(adjustedSelectionStart, 1, adjustedSelectionStart + lines.length - 1, lines[lines.length - 1].length);\n            edits.push(EditOperation.replace(selectionToReplace, lines.join('\\n')));\n            endCursorState.push(finalSelection);\n            linesDeleted += (selection.endLineNumber - selection.startLineNumber + 1) - lines.length;\n        }\n        editor.pushUndoStop();\n        editor.executeEdits(this.id, edits, updateSelection ? endCursorState : undefined);\n        editor.pushUndoStop();\n    }\n}\nexport class TrimTrailingWhitespaceAction extends EditorAction {\n    static { this.ID = 'editor.action.trimTrailingWhitespace'; }\n    constructor() {\n        super({\n            id: TrimTrailingWhitespaceAction.ID,\n            label: nls.localize('lines.trimTrailingWhitespace', \"Trim Trailing Whitespace\"),\n            alias: 'Trim Trailing Whitespace',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 54 /* KeyCode.KeyX */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor, args) {\n        let cursors = [];\n        if (args.reason === 'auto-save') {\n            // See https://github.com/editorconfig/editorconfig-vscode/issues/47\n            // It is very convenient for the editor config extension to invoke this action.\n            // So, if we get a reason:'auto-save' passed in, let's preserve cursor positions.\n            cursors = (editor.getSelections() || []).map(s => new Position(s.positionLineNumber, s.positionColumn));\n        }\n        const selection = editor.getSelection();\n        if (selection === null) {\n            return;\n        }\n        const config = _accessor.get(IConfigurationService);\n        const model = editor.getModel();\n        const trimInRegexAndStrings = config.getValue('files.trimTrailingWhitespaceInRegexAndStrings', { overrideIdentifier: model?.getLanguageId(), resource: model?.uri });\n        const command = new TrimTrailingWhitespaceCommand(selection, cursors, trimInRegexAndStrings);\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, [command]);\n        editor.pushUndoStop();\n    }\n}\nexport class DeleteLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.deleteLines',\n            label: nls.localize('lines.delete', \"Delete Line\"),\n            alias: 'Delete Line',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 41 /* KeyCode.KeyK */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const ops = this._getLinesToRemove(editor);\n        const model = editor.getModel();\n        if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\n            // Model is empty\n            return;\n        }\n        let linesDeleted = 0;\n        const edits = [];\n        const cursorState = [];\n        for (let i = 0, len = ops.length; i < len; i++) {\n            const op = ops[i];\n            let startLineNumber = op.startLineNumber;\n            let endLineNumber = op.endLineNumber;\n            let startColumn = 1;\n            let endColumn = model.getLineMaxColumn(endLineNumber);\n            if (endLineNumber < model.getLineCount()) {\n                endLineNumber += 1;\n                endColumn = 1;\n            }\n            else if (startLineNumber > 1) {\n                startLineNumber -= 1;\n                startColumn = model.getLineMaxColumn(startLineNumber);\n            }\n            edits.push(EditOperation.replace(new Selection(startLineNumber, startColumn, endLineNumber, endColumn), ''));\n            cursorState.push(new Selection(startLineNumber - linesDeleted, op.positionColumn, startLineNumber - linesDeleted, op.positionColumn));\n            linesDeleted += (op.endLineNumber - op.startLineNumber + 1);\n        }\n        editor.pushUndoStop();\n        editor.executeEdits(this.id, edits, cursorState);\n        editor.pushUndoStop();\n    }\n    _getLinesToRemove(editor) {\n        // Construct delete operations\n        const operations = editor.getSelections().map((s) => {\n            let endLineNumber = s.endLineNumber;\n            if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\n                endLineNumber -= 1;\n            }\n            return {\n                startLineNumber: s.startLineNumber,\n                selectionStartColumn: s.selectionStartColumn,\n                endLineNumber: endLineNumber,\n                positionColumn: s.positionColumn\n            };\n        });\n        // Sort delete operations\n        operations.sort((a, b) => {\n            if (a.startLineNumber === b.startLineNumber) {\n                return a.endLineNumber - b.endLineNumber;\n            }\n            return a.startLineNumber - b.startLineNumber;\n        });\n        // Merge delete operations which are adjacent or overlapping\n        const mergedOperations = [];\n        let previousOperation = operations[0];\n        for (let i = 1; i < operations.length; i++) {\n            if (previousOperation.endLineNumber + 1 >= operations[i].startLineNumber) {\n                // Merge current operations into the previous one\n                previousOperation.endLineNumber = operations[i].endLineNumber;\n            }\n            else {\n                // Push previous operation\n                mergedOperations.push(previousOperation);\n                previousOperation = operations[i];\n            }\n        }\n        // Push the last operation\n        mergedOperations.push(previousOperation);\n        return mergedOperations;\n    }\n}\nexport class IndentLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.indentLines',\n            label: nls.localize('lines.indent', \"Indent Line\"),\n            alias: 'Indent Line',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 94 /* KeyCode.BracketRight */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        const viewModel = editor._getViewModel();\n        if (!viewModel) {\n            return;\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, TypeOperations.indent(viewModel.cursorConfig, editor.getModel(), editor.getSelections()));\n        editor.pushUndoStop();\n    }\n}\nclass OutdentLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.outdentLines',\n            label: nls.localize('lines.outdent', \"Outdent Line\"),\n            alias: 'Outdent Line',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 92 /* KeyCode.BracketLeft */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        CoreEditingCommands.Outdent.runEditorCommand(_accessor, editor, null);\n    }\n}\nexport class InsertLineBeforeAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.insertLineBefore',\n            label: nls.localize('lines.insertBefore', \"Insert Line Above\"),\n            alias: 'Insert Line Above',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 3 /* KeyCode.Enter */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        const viewModel = editor._getViewModel();\n        if (!viewModel) {\n            return;\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, EnterOperation.lineInsertBefore(viewModel.cursorConfig, editor.getModel(), editor.getSelections()));\n    }\n}\nexport class InsertLineAfterAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.insertLineAfter',\n            label: nls.localize('lines.insertAfter', \"Insert Line Below\"),\n            alias: 'Insert Line Below',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 3 /* KeyCode.Enter */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        const viewModel = editor._getViewModel();\n        if (!viewModel) {\n            return;\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, EnterOperation.lineInsertAfter(viewModel.cursorConfig, editor.getModel(), editor.getSelections()));\n    }\n}\nexport class AbstractDeleteAllToBoundaryAction extends EditorAction {\n    run(_accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const primaryCursor = editor.getSelection();\n        const rangesToDelete = this._getRangesToDelete(editor);\n        // merge overlapping selections\n        const effectiveRanges = [];\n        for (let i = 0, count = rangesToDelete.length - 1; i < count; i++) {\n            const range = rangesToDelete[i];\n            const nextRange = rangesToDelete[i + 1];\n            if (Range.intersectRanges(range, nextRange) === null) {\n                effectiveRanges.push(range);\n            }\n            else {\n                rangesToDelete[i + 1] = Range.plusRange(range, nextRange);\n            }\n        }\n        effectiveRanges.push(rangesToDelete[rangesToDelete.length - 1]);\n        const endCursorState = this._getEndCursorState(primaryCursor, effectiveRanges);\n        const edits = effectiveRanges.map(range => {\n            return EditOperation.replace(range, '');\n        });\n        editor.pushUndoStop();\n        editor.executeEdits(this.id, edits, endCursorState);\n        editor.pushUndoStop();\n    }\n}\nexport class DeleteAllLeftAction extends AbstractDeleteAllToBoundaryAction {\n    constructor() {\n        super({\n            id: 'deleteAllLeft',\n            label: nls.localize('lines.deleteAllLeft', \"Delete All Left\"),\n            alias: 'Delete All Left',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 1 /* KeyCode.Backspace */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _getEndCursorState(primaryCursor, rangesToDelete) {\n        let endPrimaryCursor = null;\n        const endCursorState = [];\n        let deletedLines = 0;\n        rangesToDelete.forEach(range => {\n            let endCursor;\n            if (range.endColumn === 1 && deletedLines > 0) {\n                const newStartLine = range.startLineNumber - deletedLines;\n                endCursor = new Selection(newStartLine, range.startColumn, newStartLine, range.startColumn);\n            }\n            else {\n                endCursor = new Selection(range.startLineNumber, range.startColumn, range.startLineNumber, range.startColumn);\n            }\n            deletedLines += range.endLineNumber - range.startLineNumber;\n            if (range.intersectRanges(primaryCursor)) {\n                endPrimaryCursor = endCursor;\n            }\n            else {\n                endCursorState.push(endCursor);\n            }\n        });\n        if (endPrimaryCursor) {\n            endCursorState.unshift(endPrimaryCursor);\n        }\n        return endCursorState;\n    }\n    _getRangesToDelete(editor) {\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return [];\n        }\n        let rangesToDelete = selections;\n        const model = editor.getModel();\n        if (model === null) {\n            return [];\n        }\n        rangesToDelete.sort(Range.compareRangesUsingStarts);\n        rangesToDelete = rangesToDelete.map(selection => {\n            if (selection.isEmpty()) {\n                if (selection.startColumn === 1) {\n                    const deleteFromLine = Math.max(1, selection.startLineNumber - 1);\n                    const deleteFromColumn = selection.startLineNumber === 1 ? 1 : model.getLineLength(deleteFromLine) + 1;\n                    return new Range(deleteFromLine, deleteFromColumn, selection.startLineNumber, 1);\n                }\n                else {\n                    return new Range(selection.startLineNumber, 1, selection.startLineNumber, selection.startColumn);\n                }\n            }\n            else {\n                return new Range(selection.startLineNumber, 1, selection.endLineNumber, selection.endColumn);\n            }\n        });\n        return rangesToDelete;\n    }\n}\nexport class DeleteAllRightAction extends AbstractDeleteAllToBoundaryAction {\n    constructor() {\n        super({\n            id: 'deleteAllRight',\n            label: nls.localize('lines.deleteAllRight', \"Delete All Right\"),\n            alias: 'Delete All Right',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 41 /* KeyCode.KeyK */, secondary: [2048 /* KeyMod.CtrlCmd */ | 20 /* KeyCode.Delete */] },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _getEndCursorState(primaryCursor, rangesToDelete) {\n        let endPrimaryCursor = null;\n        const endCursorState = [];\n        for (let i = 0, len = rangesToDelete.length, offset = 0; i < len; i++) {\n            const range = rangesToDelete[i];\n            const endCursor = new Selection(range.startLineNumber - offset, range.startColumn, range.startLineNumber - offset, range.startColumn);\n            if (range.intersectRanges(primaryCursor)) {\n                endPrimaryCursor = endCursor;\n            }\n            else {\n                endCursorState.push(endCursor);\n            }\n        }\n        if (endPrimaryCursor) {\n            endCursorState.unshift(endPrimaryCursor);\n        }\n        return endCursorState;\n    }\n    _getRangesToDelete(editor) {\n        const model = editor.getModel();\n        if (model === null) {\n            return [];\n        }\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return [];\n        }\n        const rangesToDelete = selections.map((sel) => {\n            if (sel.isEmpty()) {\n                const maxColumn = model.getLineMaxColumn(sel.startLineNumber);\n                if (sel.startColumn === maxColumn) {\n                    return new Range(sel.startLineNumber, sel.startColumn, sel.startLineNumber + 1, 1);\n                }\n                else {\n                    return new Range(sel.startLineNumber, sel.startColumn, sel.startLineNumber, maxColumn);\n                }\n            }\n            return sel;\n        });\n        rangesToDelete.sort(Range.compareRangesUsingStarts);\n        return rangesToDelete;\n    }\n}\nexport class JoinLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.joinLines',\n            label: nls.localize('lines.joinLines', \"Join Lines\"),\n            alias: 'Join Lines',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 40 /* KeyCode.KeyJ */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(_accessor, editor) {\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return;\n        }\n        let primaryCursor = editor.getSelection();\n        if (primaryCursor === null) {\n            return;\n        }\n        selections.sort(Range.compareRangesUsingStarts);\n        const reducedSelections = [];\n        const lastSelection = selections.reduce((previousValue, currentValue) => {\n            if (previousValue.isEmpty()) {\n                if (previousValue.endLineNumber === currentValue.startLineNumber) {\n                    if (primaryCursor.equalsSelection(previousValue)) {\n                        primaryCursor = currentValue;\n                    }\n                    return currentValue;\n                }\n                if (currentValue.startLineNumber > previousValue.endLineNumber + 1) {\n                    reducedSelections.push(previousValue);\n                    return currentValue;\n                }\n                else {\n                    return new Selection(previousValue.startLineNumber, previousValue.startColumn, currentValue.endLineNumber, currentValue.endColumn);\n                }\n            }\n            else {\n                if (currentValue.startLineNumber > previousValue.endLineNumber) {\n                    reducedSelections.push(previousValue);\n                    return currentValue;\n                }\n                else {\n                    return new Selection(previousValue.startLineNumber, previousValue.startColumn, currentValue.endLineNumber, currentValue.endColumn);\n                }\n            }\n        });\n        reducedSelections.push(lastSelection);\n        const model = editor.getModel();\n        if (model === null) {\n            return;\n        }\n        const edits = [];\n        const endCursorState = [];\n        let endPrimaryCursor = primaryCursor;\n        let lineOffset = 0;\n        for (let i = 0, len = reducedSelections.length; i < len; i++) {\n            const selection = reducedSelections[i];\n            const startLineNumber = selection.startLineNumber;\n            const startColumn = 1;\n            let columnDeltaOffset = 0;\n            let endLineNumber, endColumn;\n            const selectionEndPositionOffset = model.getLineLength(selection.endLineNumber) - selection.endColumn;\n            if (selection.isEmpty() || selection.startLineNumber === selection.endLineNumber) {\n                const position = selection.getStartPosition();\n                if (position.lineNumber < model.getLineCount()) {\n                    endLineNumber = startLineNumber + 1;\n                    endColumn = model.getLineMaxColumn(endLineNumber);\n                }\n                else {\n                    endLineNumber = position.lineNumber;\n                    endColumn = model.getLineMaxColumn(position.lineNumber);\n                }\n            }\n            else {\n                endLineNumber = selection.endLineNumber;\n                endColumn = model.getLineMaxColumn(endLineNumber);\n            }\n            let trimmedLinesContent = model.getLineContent(startLineNumber);\n            for (let i = startLineNumber + 1; i <= endLineNumber; i++) {\n                const lineText = model.getLineContent(i);\n                const firstNonWhitespaceIdx = model.getLineFirstNonWhitespaceColumn(i);\n                if (firstNonWhitespaceIdx >= 1) {\n                    let insertSpace = true;\n                    if (trimmedLinesContent === '') {\n                        insertSpace = false;\n                    }\n                    if (insertSpace && (trimmedLinesContent.charAt(trimmedLinesContent.length - 1) === ' ' ||\n                        trimmedLinesContent.charAt(trimmedLinesContent.length - 1) === '\\t')) {\n                        insertSpace = false;\n                        trimmedLinesContent = trimmedLinesContent.replace(/[\\s\\uFEFF\\xA0]+$/g, ' ');\n                    }\n                    const lineTextWithoutIndent = lineText.substr(firstNonWhitespaceIdx - 1);\n                    trimmedLinesContent += (insertSpace ? ' ' : '') + lineTextWithoutIndent;\n                    if (insertSpace) {\n                        columnDeltaOffset = lineTextWithoutIndent.length + 1;\n                    }\n                    else {\n                        columnDeltaOffset = lineTextWithoutIndent.length;\n                    }\n                }\n                else {\n                    columnDeltaOffset = 0;\n                }\n            }\n            const deleteSelection = new Range(startLineNumber, startColumn, endLineNumber, endColumn);\n            if (!deleteSelection.isEmpty()) {\n                let resultSelection;\n                if (selection.isEmpty()) {\n                    edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\n                    resultSelection = new Selection(deleteSelection.startLineNumber - lineOffset, trimmedLinesContent.length - columnDeltaOffset + 1, startLineNumber - lineOffset, trimmedLinesContent.length - columnDeltaOffset + 1);\n                }\n                else {\n                    if (selection.startLineNumber === selection.endLineNumber) {\n                        edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\n                        resultSelection = new Selection(selection.startLineNumber - lineOffset, selection.startColumn, selection.endLineNumber - lineOffset, selection.endColumn);\n                    }\n                    else {\n                        edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\n                        resultSelection = new Selection(selection.startLineNumber - lineOffset, selection.startColumn, selection.startLineNumber - lineOffset, trimmedLinesContent.length - selectionEndPositionOffset);\n                    }\n                }\n                if (Range.intersectRanges(deleteSelection, primaryCursor) !== null) {\n                    endPrimaryCursor = resultSelection;\n                }\n                else {\n                    endCursorState.push(resultSelection);\n                }\n            }\n            lineOffset += deleteSelection.endLineNumber - deleteSelection.startLineNumber;\n        }\n        endCursorState.unshift(endPrimaryCursor);\n        editor.pushUndoStop();\n        editor.executeEdits(this.id, edits, endCursorState);\n        editor.pushUndoStop();\n    }\n}\nexport class TransposeAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.transpose',\n            label: nls.localize('editor.transpose', \"Transpose Characters around the Cursor\"),\n            alias: 'Transpose Characters around the Cursor',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(_accessor, editor) {\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return;\n        }\n        const model = editor.getModel();\n        if (model === null) {\n            return;\n        }\n        const commands = [];\n        for (let i = 0, len = selections.length; i < len; i++) {\n            const selection = selections[i];\n            if (!selection.isEmpty()) {\n                continue;\n            }\n            const cursor = selection.getStartPosition();\n            const maxColumn = model.getLineMaxColumn(cursor.lineNumber);\n            if (cursor.column >= maxColumn) {\n                if (cursor.lineNumber === model.getLineCount()) {\n                    continue;\n                }\n                // The cursor is at the end of current line and current line is not empty\n                // then we transpose the character before the cursor and the line break if there is any following line.\n                const deleteSelection = new Range(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber + 1, 1);\n                const chars = model.getValueInRange(deleteSelection).split('').reverse().join('');\n                commands.push(new ReplaceCommand(new Selection(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber + 1, 1), chars));\n            }\n            else {\n                const deleteSelection = new Range(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber, cursor.column + 1);\n                const chars = model.getValueInRange(deleteSelection).split('').reverse().join('');\n                commands.push(new ReplaceCommandThatPreservesSelection(deleteSelection, chars, new Selection(cursor.lineNumber, cursor.column + 1, cursor.lineNumber, cursor.column + 1)));\n            }\n        }\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nexport class AbstractCaseAction extends EditorAction {\n    run(_accessor, editor) {\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return;\n        }\n        const model = editor.getModel();\n        if (model === null) {\n            return;\n        }\n        const wordSeparators = editor.getOption(132 /* EditorOption.wordSeparators */);\n        const textEdits = [];\n        for (const selection of selections) {\n            if (selection.isEmpty()) {\n                const cursor = selection.getStartPosition();\n                const word = editor.getConfiguredWordAtPosition(cursor);\n                if (!word) {\n                    continue;\n                }\n                const wordRange = new Range(cursor.lineNumber, word.startColumn, cursor.lineNumber, word.endColumn);\n                const text = model.getValueInRange(wordRange);\n                textEdits.push(EditOperation.replace(wordRange, this._modifyText(text, wordSeparators)));\n            }\n            else {\n                const text = model.getValueInRange(selection);\n                textEdits.push(EditOperation.replace(selection, this._modifyText(text, wordSeparators)));\n            }\n        }\n        editor.pushUndoStop();\n        editor.executeEdits(this.id, textEdits);\n        editor.pushUndoStop();\n    }\n}\nexport class UpperCaseAction extends AbstractCaseAction {\n    constructor() {\n        super({\n            id: 'editor.action.transformToUppercase',\n            label: nls.localize('editor.transformToUppercase', \"Transform to Uppercase\"),\n            alias: 'Transform to Uppercase',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    _modifyText(text, wordSeparators) {\n        return text.toLocaleUpperCase();\n    }\n}\nexport class LowerCaseAction extends AbstractCaseAction {\n    constructor() {\n        super({\n            id: 'editor.action.transformToLowercase',\n            label: nls.localize('editor.transformToLowercase', \"Transform to Lowercase\"),\n            alias: 'Transform to Lowercase',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    _modifyText(text, wordSeparators) {\n        return text.toLocaleLowerCase();\n    }\n}\nclass BackwardsCompatibleRegExp {\n    constructor(_pattern, _flags) {\n        this._pattern = _pattern;\n        this._flags = _flags;\n        this._actual = null;\n        this._evaluated = false;\n    }\n    get() {\n        if (!this._evaluated) {\n            this._evaluated = true;\n            try {\n                this._actual = new RegExp(this._pattern, this._flags);\n            }\n            catch (err) {\n                // this browser does not support this regular expression\n            }\n        }\n        return this._actual;\n    }\n    isSupported() {\n        return (this.get() !== null);\n    }\n}\nexport class TitleCaseAction extends AbstractCaseAction {\n    static { this.titleBoundary = new BackwardsCompatibleRegExp('(^|[^\\\\p{L}\\\\p{N}\\']|((^|\\\\P{L})\\'))\\\\p{L}', 'gmu'); }\n    constructor() {\n        super({\n            id: 'editor.action.transformToTitlecase',\n            label: nls.localize('editor.transformToTitlecase', \"Transform to Title Case\"),\n            alias: 'Transform to Title Case',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    _modifyText(text, wordSeparators) {\n        const titleBoundary = TitleCaseAction.titleBoundary.get();\n        if (!titleBoundary) {\n            // cannot support this\n            return text;\n        }\n        return text\n            .toLocaleLowerCase()\n            .replace(titleBoundary, (b) => b.toLocaleUpperCase());\n    }\n}\nexport class SnakeCaseAction extends AbstractCaseAction {\n    static { this.caseBoundary = new BackwardsCompatibleRegExp('(\\\\p{Ll})(\\\\p{Lu})', 'gmu'); }\n    static { this.singleLetters = new BackwardsCompatibleRegExp('(\\\\p{Lu}|\\\\p{N})(\\\\p{Lu})(\\\\p{Ll})', 'gmu'); }\n    constructor() {\n        super({\n            id: 'editor.action.transformToSnakecase',\n            label: nls.localize('editor.transformToSnakecase', \"Transform to Snake Case\"),\n            alias: 'Transform to Snake Case',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    _modifyText(text, wordSeparators) {\n        const caseBoundary = SnakeCaseAction.caseBoundary.get();\n        const singleLetters = SnakeCaseAction.singleLetters.get();\n        if (!caseBoundary || !singleLetters) {\n            // cannot support this\n            return text;\n        }\n        return (text\n            .replace(caseBoundary, '$1_$2')\n            .replace(singleLetters, '$1_$2$3')\n            .toLocaleLowerCase());\n    }\n}\nexport class CamelCaseAction extends AbstractCaseAction {\n    static { this.wordBoundary = new BackwardsCompatibleRegExp('[_\\\\s-]', 'gm'); }\n    constructor() {\n        super({\n            id: 'editor.action.transformToCamelcase',\n            label: nls.localize('editor.transformToCamelcase', \"Transform to Camel Case\"),\n            alias: 'Transform to Camel Case',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    _modifyText(text, wordSeparators) {\n        const wordBoundary = CamelCaseAction.wordBoundary.get();\n        if (!wordBoundary) {\n            // cannot support this\n            return text;\n        }\n        const words = text.split(wordBoundary);\n        const firstWord = words.shift();\n        return firstWord + words.map((word) => word.substring(0, 1).toLocaleUpperCase() + word.substring(1))\n            .join('');\n    }\n}\nexport class PascalCaseAction extends AbstractCaseAction {\n    static { this.wordBoundary = new BackwardsCompatibleRegExp('[_\\\\s-]', 'gm'); }\n    static { this.wordBoundaryToMaintain = new BackwardsCompatibleRegExp('(?<=\\\\.)', 'gm'); }\n    constructor() {\n        super({\n            id: 'editor.action.transformToPascalcase',\n            label: nls.localize('editor.transformToPascalcase', \"Transform to Pascal Case\"),\n            alias: 'Transform to Pascal Case',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    _modifyText(text, wordSeparators) {\n        const wordBoundary = PascalCaseAction.wordBoundary.get();\n        const wordBoundaryToMaintain = PascalCaseAction.wordBoundaryToMaintain.get();\n        if (!wordBoundary || !wordBoundaryToMaintain) {\n            // cannot support this\n            return text;\n        }\n        const wordsWithMaintainBoundaries = text.split(wordBoundaryToMaintain);\n        const words = wordsWithMaintainBoundaries.map((word) => word.split(wordBoundary)).flat();\n        return words.map((word) => word.substring(0, 1).toLocaleUpperCase() + word.substring(1))\n            .join('');\n    }\n}\nexport class KebabCaseAction extends AbstractCaseAction {\n    static isSupported() {\n        const areAllRegexpsSupported = [\n            this.caseBoundary,\n            this.singleLetters,\n            this.underscoreBoundary,\n        ].every((regexp) => regexp.isSupported());\n        return areAllRegexpsSupported;\n    }\n    static { this.caseBoundary = new BackwardsCompatibleRegExp('(\\\\p{Ll})(\\\\p{Lu})', 'gmu'); }\n    static { this.singleLetters = new BackwardsCompatibleRegExp('(\\\\p{Lu}|\\\\p{N})(\\\\p{Lu}\\\\p{Ll})', 'gmu'); }\n    static { this.underscoreBoundary = new BackwardsCompatibleRegExp('(\\\\S)(_)(\\\\S)', 'gm'); }\n    constructor() {\n        super({\n            id: 'editor.action.transformToKebabcase',\n            label: nls.localize('editor.transformToKebabcase', 'Transform to Kebab Case'),\n            alias: 'Transform to Kebab Case',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    _modifyText(text, _) {\n        const caseBoundary = KebabCaseAction.caseBoundary.get();\n        const singleLetters = KebabCaseAction.singleLetters.get();\n        const underscoreBoundary = KebabCaseAction.underscoreBoundary.get();\n        if (!caseBoundary || !singleLetters || !underscoreBoundary) {\n            // one or more regexps aren't supported\n            return text;\n        }\n        return text\n            .replace(underscoreBoundary, '$1-$3')\n            .replace(caseBoundary, '$1-$2')\n            .replace(singleLetters, '$1-$2')\n            .toLocaleLowerCase();\n    }\n}\nregisterEditorAction(CopyLinesUpAction);\nregisterEditorAction(CopyLinesDownAction);\nregisterEditorAction(DuplicateSelectionAction);\nregisterEditorAction(MoveLinesUpAction);\nregisterEditorAction(MoveLinesDownAction);\nregisterEditorAction(SortLinesAscendingAction);\nregisterEditorAction(SortLinesDescendingAction);\nregisterEditorAction(DeleteDuplicateLinesAction);\nregisterEditorAction(TrimTrailingWhitespaceAction);\nregisterEditorAction(DeleteLinesAction);\nregisterEditorAction(IndentLinesAction);\nregisterEditorAction(OutdentLinesAction);\nregisterEditorAction(InsertLineBeforeAction);\nregisterEditorAction(InsertLineAfterAction);\nregisterEditorAction(DeleteAllLeftAction);\nregisterEditorAction(DeleteAllRightAction);\nregisterEditorAction(JoinLinesAction);\nregisterEditorAction(TransposeAction);\nregisterEditorAction(UpperCaseAction);\nregisterEditorAction(LowerCaseAction);\nif (SnakeCaseAction.caseBoundary.isSupported() && SnakeCaseAction.singleLetters.isSupported()) {\n    registerEditorAction(SnakeCaseAction);\n}\nif (CamelCaseAction.wordBoundary.isSupported()) {\n    registerEditorAction(CamelCaseAction);\n}\nif (PascalCaseAction.wordBoundary.isSupported()) {\n    registerEditorAction(PascalCaseAction);\n}\nif (TitleCaseAction.titleBoundary.isSupported()) {\n    registerEditorAction(TitleCaseAction);\n}\nif (KebabCaseAction.isSupported()) {\n    registerEditorAction(KebabCaseAction);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar LinkedEditingContribution_1;\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { Delayer, first } from '../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { isCancellationError, onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution, registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport * as nls from '../../../../nls.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport './linkedEditing.css';\nexport const CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE = new RawContextKey('LinkedEditingInputVisible', false);\nconst DECORATION_CLASS_NAME = 'linked-editing-decoration';\nlet LinkedEditingContribution = class LinkedEditingContribution extends Disposable {\n    static { LinkedEditingContribution_1 = this; }\n    static { this.ID = 'editor.contrib.linkedEditing'; }\n    static { this.DECORATION = ModelDecorationOptions.register({\n        description: 'linked-editing',\n        stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n        className: DECORATION_CLASS_NAME\n    }); }\n    static get(editor) {\n        return editor.getContribution(LinkedEditingContribution_1.ID);\n    }\n    constructor(editor, contextKeyService, languageFeaturesService, languageConfigurationService, languageFeatureDebounceService) {\n        super();\n        this.languageConfigurationService = languageConfigurationService;\n        this._syncRangesToken = 0;\n        this._localToDispose = this._register(new DisposableStore());\n        this._editor = editor;\n        this._providers = languageFeaturesService.linkedEditingRangeProvider;\n        this._enabled = false;\n        this._visibleContextKey = CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\n        this._debounceInformation = languageFeatureDebounceService.for(this._providers, 'Linked Editing', { max: 200 });\n        this._currentDecorations = this._editor.createDecorationsCollection();\n        this._languageWordPattern = null;\n        this._currentWordPattern = null;\n        this._ignoreChangeEvent = false;\n        this._localToDispose = this._register(new DisposableStore());\n        this._rangeUpdateTriggerPromise = null;\n        this._rangeSyncTriggerPromise = null;\n        this._currentRequestCts = null;\n        this._currentRequestPosition = null;\n        this._currentRequestModelVersion = null;\n        this._register(this._editor.onDidChangeModel(() => this.reinitialize(true)));\n        this._register(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(70 /* EditorOption.linkedEditing */) || e.hasChanged(94 /* EditorOption.renameOnType */)) {\n                this.reinitialize(false);\n            }\n        }));\n        this._register(this._providers.onDidChange(() => this.reinitialize(false)));\n        this._register(this._editor.onDidChangeModelLanguage(() => this.reinitialize(true)));\n        this.reinitialize(true);\n    }\n    reinitialize(forceRefresh) {\n        const model = this._editor.getModel();\n        const isEnabled = model !== null && (this._editor.getOption(70 /* EditorOption.linkedEditing */) || this._editor.getOption(94 /* EditorOption.renameOnType */)) && this._providers.has(model);\n        if (isEnabled === this._enabled && !forceRefresh) {\n            return;\n        }\n        this._enabled = isEnabled;\n        this.clearRanges();\n        this._localToDispose.clear();\n        if (!isEnabled || model === null) {\n            return;\n        }\n        this._localToDispose.add(Event.runAndSubscribe(model.onDidChangeLanguageConfiguration, () => {\n            this._languageWordPattern = this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition();\n        }));\n        const rangeUpdateScheduler = new Delayer(this._debounceInformation.get(model));\n        const triggerRangeUpdate = () => {\n            this._rangeUpdateTriggerPromise = rangeUpdateScheduler.trigger(() => this.updateRanges(), this._debounceDuration ?? this._debounceInformation.get(model));\n        };\n        const rangeSyncScheduler = new Delayer(0);\n        const triggerRangeSync = (token) => {\n            this._rangeSyncTriggerPromise = rangeSyncScheduler.trigger(() => this._syncRanges(token));\n        };\n        this._localToDispose.add(this._editor.onDidChangeCursorPosition(() => {\n            triggerRangeUpdate();\n        }));\n        this._localToDispose.add(this._editor.onDidChangeModelContent((e) => {\n            if (!this._ignoreChangeEvent) {\n                if (this._currentDecorations.length > 0) {\n                    const referenceRange = this._currentDecorations.getRange(0);\n                    if (referenceRange && e.changes.every(c => referenceRange.intersectRanges(c.range))) {\n                        triggerRangeSync(this._syncRangesToken);\n                        return;\n                    }\n                }\n            }\n            triggerRangeUpdate();\n        }));\n        this._localToDispose.add({\n            dispose: () => {\n                rangeUpdateScheduler.dispose();\n                rangeSyncScheduler.dispose();\n            }\n        });\n        this.updateRanges();\n    }\n    _syncRanges(token) {\n        // delayed invocation, make sure we're still on\n        if (!this._editor.hasModel() || token !== this._syncRangesToken || this._currentDecorations.length === 0) {\n            // nothing to do\n            return;\n        }\n        const model = this._editor.getModel();\n        const referenceRange = this._currentDecorations.getRange(0);\n        if (!referenceRange || referenceRange.startLineNumber !== referenceRange.endLineNumber) {\n            return this.clearRanges();\n        }\n        const referenceValue = model.getValueInRange(referenceRange);\n        if (this._currentWordPattern) {\n            const match = referenceValue.match(this._currentWordPattern);\n            const matchLength = match ? match[0].length : 0;\n            if (matchLength !== referenceValue.length) {\n                return this.clearRanges();\n            }\n        }\n        const edits = [];\n        for (let i = 1, len = this._currentDecorations.length; i < len; i++) {\n            const mirrorRange = this._currentDecorations.getRange(i);\n            if (!mirrorRange) {\n                continue;\n            }\n            if (mirrorRange.startLineNumber !== mirrorRange.endLineNumber) {\n                edits.push({\n                    range: mirrorRange,\n                    text: referenceValue\n                });\n            }\n            else {\n                let oldValue = model.getValueInRange(mirrorRange);\n                let newValue = referenceValue;\n                let rangeStartColumn = mirrorRange.startColumn;\n                let rangeEndColumn = mirrorRange.endColumn;\n                const commonPrefixLength = strings.commonPrefixLength(oldValue, newValue);\n                rangeStartColumn += commonPrefixLength;\n                oldValue = oldValue.substr(commonPrefixLength);\n                newValue = newValue.substr(commonPrefixLength);\n                const commonSuffixLength = strings.commonSuffixLength(oldValue, newValue);\n                rangeEndColumn -= commonSuffixLength;\n                oldValue = oldValue.substr(0, oldValue.length - commonSuffixLength);\n                newValue = newValue.substr(0, newValue.length - commonSuffixLength);\n                if (rangeStartColumn !== rangeEndColumn || newValue.length !== 0) {\n                    edits.push({\n                        range: new Range(mirrorRange.startLineNumber, rangeStartColumn, mirrorRange.endLineNumber, rangeEndColumn),\n                        text: newValue\n                    });\n                }\n            }\n        }\n        if (edits.length === 0) {\n            return;\n        }\n        try {\n            this._editor.popUndoStop();\n            this._ignoreChangeEvent = true;\n            const prevEditOperationType = this._editor._getViewModel().getPrevEditOperationType();\n            this._editor.executeEdits('linkedEditing', edits);\n            this._editor._getViewModel().setPrevEditOperationType(prevEditOperationType);\n        }\n        finally {\n            this._ignoreChangeEvent = false;\n        }\n    }\n    dispose() {\n        this.clearRanges();\n        super.dispose();\n    }\n    clearRanges() {\n        this._visibleContextKey.set(false);\n        this._currentDecorations.clear();\n        if (this._currentRequestCts) {\n            this._currentRequestCts.cancel();\n            this._currentRequestCts = null;\n            this._currentRequestPosition = null;\n        }\n    }\n    async updateRanges(force = false) {\n        if (!this._editor.hasModel()) {\n            this.clearRanges();\n            return;\n        }\n        const position = this._editor.getPosition();\n        if (!this._enabled && !force || this._editor.getSelections().length > 1) {\n            // disabled or multicursor\n            this.clearRanges();\n            return;\n        }\n        const model = this._editor.getModel();\n        const modelVersionId = model.getVersionId();\n        if (this._currentRequestPosition && this._currentRequestModelVersion === modelVersionId) {\n            if (position.equals(this._currentRequestPosition)) {\n                return; // same position\n            }\n            if (this._currentDecorations.length > 0) {\n                const range = this._currentDecorations.getRange(0);\n                if (range && range.containsPosition(position)) {\n                    return; // just moving inside the existing primary range\n                }\n            }\n        }\n        // Clear existing decorations while we compute new ones\n        this.clearRanges();\n        this._currentRequestPosition = position;\n        this._currentRequestModelVersion = modelVersionId;\n        const currentRequestCts = this._currentRequestCts = new CancellationTokenSource();\n        try {\n            const sw = new StopWatch(false);\n            const response = await getLinkedEditingRanges(this._providers, model, position, currentRequestCts.token);\n            this._debounceInformation.update(model, sw.elapsed());\n            if (currentRequestCts !== this._currentRequestCts) {\n                return;\n            }\n            this._currentRequestCts = null;\n            if (modelVersionId !== model.getVersionId()) {\n                return;\n            }\n            let ranges = [];\n            if (response?.ranges) {\n                ranges = response.ranges;\n            }\n            this._currentWordPattern = response?.wordPattern || this._languageWordPattern;\n            let foundReferenceRange = false;\n            for (let i = 0, len = ranges.length; i < len; i++) {\n                if (Range.containsPosition(ranges[i], position)) {\n                    foundReferenceRange = true;\n                    if (i !== 0) {\n                        const referenceRange = ranges[i];\n                        ranges.splice(i, 1);\n                        ranges.unshift(referenceRange);\n                    }\n                    break;\n                }\n            }\n            if (!foundReferenceRange) {\n                // Cannot do linked editing if the ranges are not where the cursor is...\n                this.clearRanges();\n                return;\n            }\n            const decorations = ranges.map(range => ({ range: range, options: LinkedEditingContribution_1.DECORATION }));\n            this._visibleContextKey.set(true);\n            this._currentDecorations.set(decorations);\n            this._syncRangesToken++; // cancel any pending syncRanges call\n        }\n        catch (err) {\n            if (!isCancellationError(err)) {\n                onUnexpectedError(err);\n            }\n            if (this._currentRequestCts === currentRequestCts || !this._currentRequestCts) {\n                // stop if we are still the latest request\n                this.clearRanges();\n            }\n        }\n    }\n};\nLinkedEditingContribution = LinkedEditingContribution_1 = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, ILanguageConfigurationService),\n    __param(4, ILanguageFeatureDebounceService)\n], LinkedEditingContribution);\nexport { LinkedEditingContribution };\nexport class LinkedEditingAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.linkedEditing',\n            label: nls.localize('linkedEditing.label', \"Start Linked Editing\"),\n            alias: 'Start Linked Editing',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasRenameProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 60 /* KeyCode.F2 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    runCommand(accessor, args) {\n        const editorService = accessor.get(ICodeEditorService);\n        const [uri, pos] = Array.isArray(args) && args || [undefined, undefined];\n        if (URI.isUri(uri) && Position.isIPosition(pos)) {\n            return editorService.openCodeEditor({ resource: uri }, editorService.getActiveCodeEditor()).then(editor => {\n                if (!editor) {\n                    return;\n                }\n                editor.setPosition(pos);\n                editor.invokeWithinContext(accessor => {\n                    this.reportTelemetry(accessor, editor);\n                    return this.run(accessor, editor);\n                });\n            }, onUnexpectedError);\n        }\n        return super.runCommand(accessor, args);\n    }\n    run(_accessor, editor) {\n        const controller = LinkedEditingContribution.get(editor);\n        if (controller) {\n            return Promise.resolve(controller.updateRanges(true));\n        }\n        return Promise.resolve();\n    }\n}\nconst LinkedEditingCommand = EditorCommand.bindToContribution(LinkedEditingContribution.get);\nregisterEditorCommand(new LinkedEditingCommand({\n    id: 'cancelLinkedEditingInput',\n    precondition: CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE,\n    handler: x => x.clearRanges(),\n    kbOpts: {\n        kbExpr: EditorContextKeys.editorTextFocus,\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nfunction getLinkedEditingRanges(providers, model, position, token) {\n    const orderedByScore = providers.ordered(model);\n    // in order of score ask the linked editing range provider\n    // until someone response with a good result\n    // (good = not null)\n    return first(orderedByScore.map(provider => async () => {\n        try {\n            return await provider.provideLinkedEditingRanges(model, position, token);\n        }\n        catch (e) {\n            onUnexpectedExternalError(e);\n            return undefined;\n        }\n    }), result => !!result && arrays.isNonEmptyArray(result?.ranges));\n}\nexport const editorLinkedEditingBackground = registerColor('editor.linkedEditingBackground', { dark: Color.fromHex('#f00').transparent(0.3), light: Color.fromHex('#f00').transparent(0.3), hcDark: Color.fromHex('#f00').transparent(0.3), hcLight: Color.white }, nls.localize('editorLinkedEditingBackground', 'Background color when the editor auto renames on type.'));\nregisterModelAndPositionCommand('_executeLinkedEditingProvider', (_accessor, model, position) => {\n    const { linkedEditingRangeProvider } = _accessor.get(ILanguageFeaturesService);\n    return getLinkedEditingRanges(linkedEditingRangeProvider, model, position, CancellationToken.None);\n});\nregisterEditorContribution(LinkedEditingContribution.ID, LinkedEditingContribution, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nregisterEditorAction(LinkedEditingAction);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { DisposableStore, isDisposable } from '../../../../base/common/lifecycle.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../common/core/range.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport class Link {\n    constructor(link, provider) {\n        this._link = link;\n        this._provider = provider;\n    }\n    toJSON() {\n        return {\n            range: this.range,\n            url: this.url,\n            tooltip: this.tooltip\n        };\n    }\n    get range() {\n        return this._link.range;\n    }\n    get url() {\n        return this._link.url;\n    }\n    get tooltip() {\n        return this._link.tooltip;\n    }\n    async resolve(token) {\n        if (this._link.url) {\n            return this._link.url;\n        }\n        if (typeof this._provider.resolveLink === 'function') {\n            return Promise.resolve(this._provider.resolveLink(this._link, token)).then(value => {\n                this._link = value || this._link;\n                if (this._link.url) {\n                    // recurse\n                    return this.resolve(token);\n                }\n                return Promise.reject(new Error('missing'));\n            });\n        }\n        return Promise.reject(new Error('missing'));\n    }\n}\nexport class LinksList {\n    constructor(tuples) {\n        this._disposables = new DisposableStore();\n        let links = [];\n        for (const [list, provider] of tuples) {\n            // merge all links\n            const newLinks = list.links.map(link => new Link(link, provider));\n            links = LinksList._union(links, newLinks);\n            // register disposables\n            if (isDisposable(list)) {\n                this._disposables.add(list);\n            }\n        }\n        this.links = links;\n    }\n    dispose() {\n        this._disposables.dispose();\n        this.links.length = 0;\n    }\n    static _union(oldLinks, newLinks) {\n        // reunite oldLinks with newLinks and remove duplicates\n        const result = [];\n        let oldIndex;\n        let oldLen;\n        let newIndex;\n        let newLen;\n        for (oldIndex = 0, newIndex = 0, oldLen = oldLinks.length, newLen = newLinks.length; oldIndex < oldLen && newIndex < newLen;) {\n            const oldLink = oldLinks[oldIndex];\n            const newLink = newLinks[newIndex];\n            if (Range.areIntersectingOrTouching(oldLink.range, newLink.range)) {\n                // Remove the oldLink\n                oldIndex++;\n                continue;\n            }\n            const comparisonResult = Range.compareRangesUsingStarts(oldLink.range, newLink.range);\n            if (comparisonResult < 0) {\n                // oldLink is before\n                result.push(oldLink);\n                oldIndex++;\n            }\n            else {\n                // newLink is before\n                result.push(newLink);\n                newIndex++;\n            }\n        }\n        for (; oldIndex < oldLen; oldIndex++) {\n            result.push(oldLinks[oldIndex]);\n        }\n        for (; newIndex < newLen; newIndex++) {\n            result.push(newLinks[newIndex]);\n        }\n        return result;\n    }\n}\nexport function getLinks(providers, model, token) {\n    const lists = [];\n    // ask all providers for links in parallel\n    const promises = providers.ordered(model).reverse().map((provider, i) => {\n        return Promise.resolve(provider.provideLinks(model, token)).then(result => {\n            if (result) {\n                lists[i] = [result, provider];\n            }\n        }, onUnexpectedExternalError);\n    });\n    return Promise.all(promises).then(() => {\n        const result = new LinksList(coalesce(lists));\n        if (!token.isCancellationRequested) {\n            return result;\n        }\n        result.dispose();\n        return new LinksList([]);\n    });\n}\nCommandsRegistry.registerCommand('_executeLinkProvider', async (accessor, ...args) => {\n    let [uri, resolveCount] = args;\n    assertType(uri instanceof URI);\n    if (typeof resolveCount !== 'number') {\n        resolveCount = 0;\n    }\n    const { linkProvider } = accessor.get(ILanguageFeaturesService);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return [];\n    }\n    const list = await getLinks(linkProvider, model, CancellationToken.None);\n    if (!list) {\n        return [];\n    }\n    // resolve links\n    for (let i = 0; i < Math.min(resolveCount, list.links.length); i++) {\n        await list.links[i].resolve(CancellationToken.None);\n    }\n    const result = list.links.slice(0);\n    list.dispose();\n    return result;\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar LinkDetector_1;\nimport { createCancelablePromise, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport * as resources from '../../../../base/common/resources.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport './links.css';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ClickLinkGesture } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { getLinks } from './getLinks.js';\nimport * as nls from '../../../../nls.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nlet LinkDetector = class LinkDetector extends Disposable {\n    static { LinkDetector_1 = this; }\n    static { this.ID = 'editor.linkDetector'; }\n    static get(editor) {\n        return editor.getContribution(LinkDetector_1.ID);\n    }\n    constructor(editor, openerService, notificationService, languageFeaturesService, languageFeatureDebounceService) {\n        super();\n        this.editor = editor;\n        this.openerService = openerService;\n        this.notificationService = notificationService;\n        this.languageFeaturesService = languageFeaturesService;\n        this.providers = this.languageFeaturesService.linkProvider;\n        this.debounceInformation = languageFeatureDebounceService.for(this.providers, 'Links', { min: 1000, max: 4000 });\n        this.computeLinks = this._register(new RunOnceScheduler(() => this.computeLinksNow(), 1000));\n        this.computePromise = null;\n        this.activeLinksList = null;\n        this.currentOccurrences = {};\n        this.activeLinkDecorationId = null;\n        const clickLinkGesture = this._register(new ClickLinkGesture(editor));\n        this._register(clickLinkGesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, keyboardEvent]) => {\n            this._onEditorMouseMove(mouseEvent, keyboardEvent);\n        }));\n        this._register(clickLinkGesture.onExecute((e) => {\n            this.onEditorMouseUp(e);\n        }));\n        this._register(clickLinkGesture.onCancel((e) => {\n            this.cleanUpActiveLinkDecoration();\n        }));\n        this._register(editor.onDidChangeConfiguration((e) => {\n            if (!e.hasChanged(71 /* EditorOption.links */)) {\n                return;\n            }\n            // Remove any links (for the getting disabled case)\n            this.updateDecorations([]);\n            // Stop any computation (for the getting disabled case)\n            this.stop();\n            // Start computing (for the getting enabled case)\n            this.computeLinks.schedule(0);\n        }));\n        this._register(editor.onDidChangeModelContent((e) => {\n            if (!this.editor.hasModel()) {\n                return;\n            }\n            this.computeLinks.schedule(this.debounceInformation.get(this.editor.getModel()));\n        }));\n        this._register(editor.onDidChangeModel((e) => {\n            this.currentOccurrences = {};\n            this.activeLinkDecorationId = null;\n            this.stop();\n            this.computeLinks.schedule(0);\n        }));\n        this._register(editor.onDidChangeModelLanguage((e) => {\n            this.stop();\n            this.computeLinks.schedule(0);\n        }));\n        this._register(this.providers.onDidChange((e) => {\n            this.stop();\n            this.computeLinks.schedule(0);\n        }));\n        this.computeLinks.schedule(0);\n    }\n    async computeLinksNow() {\n        if (!this.editor.hasModel() || !this.editor.getOption(71 /* EditorOption.links */)) {\n            return;\n        }\n        const model = this.editor.getModel();\n        if (model.isTooLargeForSyncing()) {\n            return;\n        }\n        if (!this.providers.has(model)) {\n            return;\n        }\n        if (this.activeLinksList) {\n            this.activeLinksList.dispose();\n            this.activeLinksList = null;\n        }\n        this.computePromise = createCancelablePromise(token => getLinks(this.providers, model, token));\n        try {\n            const sw = new StopWatch(false);\n            this.activeLinksList = await this.computePromise;\n            this.debounceInformation.update(model, sw.elapsed());\n            if (model.isDisposed()) {\n                return;\n            }\n            this.updateDecorations(this.activeLinksList.links);\n        }\n        catch (err) {\n            onUnexpectedError(err);\n        }\n        finally {\n            this.computePromise = null;\n        }\n    }\n    updateDecorations(links) {\n        const useMetaKey = (this.editor.getOption(78 /* EditorOption.multiCursorModifier */) === 'altKey');\n        const oldDecorations = [];\n        const keys = Object.keys(this.currentOccurrences);\n        for (const decorationId of keys) {\n            const occurence = this.currentOccurrences[decorationId];\n            oldDecorations.push(occurence.decorationId);\n        }\n        const newDecorations = [];\n        if (links) {\n            // Not sure why this is sometimes null\n            for (const link of links) {\n                newDecorations.push(LinkOccurrence.decoration(link, useMetaKey));\n            }\n        }\n        this.editor.changeDecorations((changeAccessor) => {\n            const decorations = changeAccessor.deltaDecorations(oldDecorations, newDecorations);\n            this.currentOccurrences = {};\n            this.activeLinkDecorationId = null;\n            for (let i = 0, len = decorations.length; i < len; i++) {\n                const occurence = new LinkOccurrence(links[i], decorations[i]);\n                this.currentOccurrences[occurence.decorationId] = occurence;\n            }\n        });\n    }\n    _onEditorMouseMove(mouseEvent, withKey) {\n        const useMetaKey = (this.editor.getOption(78 /* EditorOption.multiCursorModifier */) === 'altKey');\n        if (this.isEnabled(mouseEvent, withKey)) {\n            this.cleanUpActiveLinkDecoration(); // always remove previous link decoration as their can only be one\n            const occurrence = this.getLinkOccurrence(mouseEvent.target.position);\n            if (occurrence) {\n                this.editor.changeDecorations((changeAccessor) => {\n                    occurrence.activate(changeAccessor, useMetaKey);\n                    this.activeLinkDecorationId = occurrence.decorationId;\n                });\n            }\n        }\n        else {\n            this.cleanUpActiveLinkDecoration();\n        }\n    }\n    cleanUpActiveLinkDecoration() {\n        const useMetaKey = (this.editor.getOption(78 /* EditorOption.multiCursorModifier */) === 'altKey');\n        if (this.activeLinkDecorationId) {\n            const occurrence = this.currentOccurrences[this.activeLinkDecorationId];\n            if (occurrence) {\n                this.editor.changeDecorations((changeAccessor) => {\n                    occurrence.deactivate(changeAccessor, useMetaKey);\n                });\n            }\n            this.activeLinkDecorationId = null;\n        }\n    }\n    onEditorMouseUp(mouseEvent) {\n        if (!this.isEnabled(mouseEvent)) {\n            return;\n        }\n        const occurrence = this.getLinkOccurrence(mouseEvent.target.position);\n        if (!occurrence) {\n            return;\n        }\n        this.openLinkOccurrence(occurrence, mouseEvent.hasSideBySideModifier, true /* from user gesture */);\n    }\n    openLinkOccurrence(occurrence, openToSide, fromUserGesture = false) {\n        if (!this.openerService) {\n            return;\n        }\n        const { link } = occurrence;\n        link.resolve(CancellationToken.None).then(uri => {\n            // Support for relative file URIs of the shape file://./relativeFile.txt or file:///./relativeFile.txt\n            if (typeof uri === 'string' && this.editor.hasModel()) {\n                const modelUri = this.editor.getModel().uri;\n                if (modelUri.scheme === Schemas.file && uri.startsWith(`${Schemas.file}:`)) {\n                    const parsedUri = URI.parse(uri);\n                    if (parsedUri.scheme === Schemas.file) {\n                        const fsPath = resources.originalFSPath(parsedUri);\n                        let relativePath = null;\n                        if (fsPath.startsWith('/./') || fsPath.startsWith('\\\\.\\\\')) {\n                            relativePath = `.${fsPath.substr(1)}`;\n                        }\n                        else if (fsPath.startsWith('//./') || fsPath.startsWith('\\\\\\\\.\\\\')) {\n                            relativePath = `.${fsPath.substr(2)}`;\n                        }\n                        if (relativePath) {\n                            uri = resources.joinPath(modelUri, relativePath);\n                        }\n                    }\n                }\n            }\n            return this.openerService.open(uri, { openToSide, fromUserGesture, allowContributedOpeners: true, allowCommands: true, fromWorkspace: true });\n        }, err => {\n            const messageOrError = err instanceof Error ? err.message : err;\n            // different error cases\n            if (messageOrError === 'invalid') {\n                this.notificationService.warn(nls.localize('invalid.url', 'Failed to open this link because it is not well-formed: {0}', link.url.toString()));\n            }\n            else if (messageOrError === 'missing') {\n                this.notificationService.warn(nls.localize('missing.url', 'Failed to open this link because its target is missing.'));\n            }\n            else {\n                onUnexpectedError(err);\n            }\n        });\n    }\n    getLinkOccurrence(position) {\n        if (!this.editor.hasModel() || !position) {\n            return null;\n        }\n        const decorations = this.editor.getModel().getDecorationsInRange({\n            startLineNumber: position.lineNumber,\n            startColumn: position.column,\n            endLineNumber: position.lineNumber,\n            endColumn: position.column\n        }, 0, true);\n        for (const decoration of decorations) {\n            const currentOccurrence = this.currentOccurrences[decoration.id];\n            if (currentOccurrence) {\n                return currentOccurrence;\n            }\n        }\n        return null;\n    }\n    isEnabled(mouseEvent, withKey) {\n        return Boolean((mouseEvent.target.type === 6 /* MouseTargetType.CONTENT_TEXT */)\n            && (mouseEvent.hasTriggerModifier || (withKey && withKey.keyCodeIsTriggerKey)));\n    }\n    stop() {\n        this.computeLinks.cancel();\n        if (this.activeLinksList) {\n            this.activeLinksList?.dispose();\n            this.activeLinksList = null;\n        }\n        if (this.computePromise) {\n            this.computePromise.cancel();\n            this.computePromise = null;\n        }\n    }\n    dispose() {\n        super.dispose();\n        this.stop();\n    }\n};\nLinkDetector = LinkDetector_1 = __decorate([\n    __param(1, IOpenerService),\n    __param(2, INotificationService),\n    __param(3, ILanguageFeaturesService),\n    __param(4, ILanguageFeatureDebounceService)\n], LinkDetector);\nexport { LinkDetector };\nconst decoration = {\n    general: ModelDecorationOptions.register({\n        description: 'detected-link',\n        stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n        collapseOnReplaceEdit: true,\n        inlineClassName: 'detected-link'\n    }),\n    active: ModelDecorationOptions.register({\n        description: 'detected-link-active',\n        stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n        collapseOnReplaceEdit: true,\n        inlineClassName: 'detected-link-active'\n    })\n};\nclass LinkOccurrence {\n    static decoration(link, useMetaKey) {\n        return {\n            range: link.range,\n            options: LinkOccurrence._getOptions(link, useMetaKey, false)\n        };\n    }\n    static _getOptions(link, useMetaKey, isActive) {\n        const options = { ...(isActive ? decoration.active : decoration.general) };\n        options.hoverMessage = getHoverMessage(link, useMetaKey);\n        return options;\n    }\n    constructor(link, decorationId) {\n        this.link = link;\n        this.decorationId = decorationId;\n    }\n    activate(changeAccessor, useMetaKey) {\n        changeAccessor.changeDecorationOptions(this.decorationId, LinkOccurrence._getOptions(this.link, useMetaKey, true));\n    }\n    deactivate(changeAccessor, useMetaKey) {\n        changeAccessor.changeDecorationOptions(this.decorationId, LinkOccurrence._getOptions(this.link, useMetaKey, false));\n    }\n}\nfunction getHoverMessage(link, useMetaKey) {\n    const executeCmd = link.url && /^command:/i.test(link.url.toString());\n    const label = link.tooltip\n        ? link.tooltip\n        : executeCmd\n            ? nls.localize('links.navigate.executeCmd', 'Execute command')\n            : nls.localize('links.navigate.follow', 'Follow link');\n    const kb = useMetaKey\n        ? platform.isMacintosh\n            ? nls.localize('links.navigate.kb.meta.mac', \"cmd + click\")\n            : nls.localize('links.navigate.kb.meta', \"ctrl + click\")\n        : platform.isMacintosh\n            ? nls.localize('links.navigate.kb.alt.mac', \"option + click\")\n            : nls.localize('links.navigate.kb.alt', \"alt + click\");\n    if (link.url) {\n        let nativeLabel = '';\n        if (/^command:/i.test(link.url.toString())) {\n            // Don't show complete command arguments in the native tooltip\n            const match = link.url.toString().match(/^command:([^?#]+)/);\n            if (match) {\n                const commandId = match[1];\n                nativeLabel = nls.localize('tooltip.explanation', \"Execute command {0}\", commandId);\n            }\n        }\n        const hoverMessage = new MarkdownString('', true)\n            .appendLink(link.url.toString(true).replace(/ /g, '%20'), label, nativeLabel)\n            .appendMarkdown(` (${kb})`);\n        return hoverMessage;\n    }\n    else {\n        return new MarkdownString().appendText(`${label} (${kb})`);\n    }\n}\nclass OpenLinkAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.openLink',\n            label: nls.localize('label', \"Open Link\"),\n            alias: 'Open Link',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        const linkDetector = LinkDetector.get(editor);\n        if (!linkDetector) {\n            return;\n        }\n        if (!editor.hasModel()) {\n            return;\n        }\n        const selections = editor.getSelections();\n        for (const sel of selections) {\n            const link = linkDetector.getLinkOccurrence(sel.getEndPosition());\n            if (link) {\n                linkDetector.openLinkOccurrence(link, false);\n            }\n        }\n    }\n}\nregisterEditorContribution(LinkDetector.ID, LinkDetector, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nregisterEditorAction(OpenLinkAction);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nclass LongLinesHelper extends Disposable {\n    static { this.ID = 'editor.contrib.longLinesHelper'; }\n    constructor(_editor) {\n        super();\n        this._editor = _editor;\n        this._register(this._editor.onMouseDown((e) => {\n            const stopRenderingLineAfter = this._editor.getOption(118 /* EditorOption.stopRenderingLineAfter */);\n            if (stopRenderingLineAfter >= 0 && e.target.type === 6 /* MouseTargetType.CONTENT_TEXT */ && e.target.position.column >= stopRenderingLineAfter) {\n                this._editor.updateOptions({\n                    stopRenderingLineAfter: -1\n                });\n            }\n        }));\n    }\n}\nregisterEditorContribution(LongLinesHelper.ID, LongLinesHelper, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './highlightDecorations.css';\nimport { OverviewRulerLane } from '../../../common/model.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { DocumentHighlightKind } from '../../../common/languages.js';\nimport * as nls from '../../../../nls.js';\nimport { activeContrastBorder, editorSelectionHighlight, minimapSelectionOccurrenceHighlight, overviewRulerSelectionHighlightForeground, registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant, themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nconst wordHighlightBackground = registerColor('editor.wordHighlightBackground', { dark: '#575757B8', light: '#57575740', hcDark: null, hcLight: null }, nls.localize('wordHighlight', 'Background color of a symbol during read-access, like reading a variable. The color must not be opaque so as not to hide underlying decorations.'), true);\nregisterColor('editor.wordHighlightStrongBackground', { dark: '#004972B8', light: '#0e639c40', hcDark: null, hcLight: null }, nls.localize('wordHighlightStrong', 'Background color of a symbol during write-access, like writing to a variable. The color must not be opaque so as not to hide underlying decorations.'), true);\nregisterColor('editor.wordHighlightTextBackground', wordHighlightBackground, nls.localize('wordHighlightText', 'Background color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations.'), true);\nconst wordHighlightBorder = registerColor('editor.wordHighlightBorder', { light: null, dark: null, hcDark: activeContrastBorder, hcLight: activeContrastBorder }, nls.localize('wordHighlightBorder', 'Border color of a symbol during read-access, like reading a variable.'));\nregisterColor('editor.wordHighlightStrongBorder', { light: null, dark: null, hcDark: activeContrastBorder, hcLight: activeContrastBorder }, nls.localize('wordHighlightStrongBorder', 'Border color of a symbol during write-access, like writing to a variable.'));\nregisterColor('editor.wordHighlightTextBorder', wordHighlightBorder, nls.localize('wordHighlightTextBorder', \"Border color of a textual occurrence for a symbol.\"));\nconst overviewRulerWordHighlightForeground = registerColor('editorOverviewRuler.wordHighlightForeground', '#A0A0A0CC', nls.localize('overviewRulerWordHighlightForeground', 'Overview ruler marker color for symbol highlights. The color must not be opaque so as not to hide underlying decorations.'), true);\nconst overviewRulerWordHighlightStrongForeground = registerColor('editorOverviewRuler.wordHighlightStrongForeground', '#C0A0C0CC', nls.localize('overviewRulerWordHighlightStrongForeground', 'Overview ruler marker color for write-access symbol highlights. The color must not be opaque so as not to hide underlying decorations.'), true);\nconst overviewRulerWordHighlightTextForeground = registerColor('editorOverviewRuler.wordHighlightTextForeground', overviewRulerSelectionHighlightForeground, nls.localize('overviewRulerWordHighlightTextForeground', 'Overview ruler marker color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations.'), true);\nconst _WRITE_OPTIONS = ModelDecorationOptions.register({\n    description: 'word-highlight-strong',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'wordHighlightStrong',\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerWordHighlightStrongForeground),\n        position: OverviewRulerLane.Center\n    },\n    minimap: {\n        color: themeColorFromId(minimapSelectionOccurrenceHighlight),\n        position: 1 /* MinimapPosition.Inline */\n    },\n});\nconst _TEXT_OPTIONS = ModelDecorationOptions.register({\n    description: 'word-highlight-text',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'wordHighlightText',\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerWordHighlightTextForeground),\n        position: OverviewRulerLane.Center\n    },\n    minimap: {\n        color: themeColorFromId(minimapSelectionOccurrenceHighlight),\n        position: 1 /* MinimapPosition.Inline */\n    },\n});\nconst _SELECTION_HIGHLIGHT_OPTIONS = ModelDecorationOptions.register({\n    description: 'selection-highlight-overview',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'selectionHighlight',\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerSelectionHighlightForeground),\n        position: OverviewRulerLane.Center\n    },\n    minimap: {\n        color: themeColorFromId(minimapSelectionOccurrenceHighlight),\n        position: 1 /* MinimapPosition.Inline */\n    },\n});\nconst _SELECTION_HIGHLIGHT_OPTIONS_NO_OVERVIEW = ModelDecorationOptions.register({\n    description: 'selection-highlight',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'selectionHighlight',\n});\nconst _REGULAR_OPTIONS = ModelDecorationOptions.register({\n    description: 'word-highlight',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'wordHighlight',\n    overviewRuler: {\n        color: themeColorFromId(overviewRulerWordHighlightForeground),\n        position: OverviewRulerLane.Center\n    },\n    minimap: {\n        color: themeColorFromId(minimapSelectionOccurrenceHighlight),\n        position: 1 /* MinimapPosition.Inline */\n    },\n});\nexport function getHighlightDecorationOptions(kind) {\n    if (kind === DocumentHighlightKind.Write) {\n        return _WRITE_OPTIONS;\n    }\n    else if (kind === DocumentHighlightKind.Text) {\n        return _TEXT_OPTIONS;\n    }\n    else {\n        return _REGULAR_OPTIONS;\n    }\n}\nexport function getSelectionHighlightDecorationOptions(hasSemanticHighlights) {\n    // Show in overviewRuler only if model has no semantic highlighting\n    return (hasSemanticHighlights ? _SELECTION_HIGHLIGHT_OPTIONS_NO_OVERVIEW : _SELECTION_HIGHLIGHT_OPTIONS);\n}\nregisterThemingParticipant((theme, collector) => {\n    const selectionHighlight = theme.getColor(editorSelectionHighlight);\n    if (selectionHighlight) {\n        collector.addRule(`.monaco-editor .selectionHighlight { background-color: ${selectionHighlight.transparent(0.5)}; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SelectionHighlighter_1;\nimport { status } from '../../../../base/browser/ui/aria/aria.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { CursorMoveCommands } from '../../../common/cursor/cursorMoveCommands.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { CommonFindController } from '../../find/browser/findController.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { getSelectionHighlightDecorationOptions } from '../../wordHighlighter/browser/highlightDecorations.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nfunction announceCursorChange(previousCursorState, cursorState) {\n    const cursorDiff = cursorState.filter(cs => !previousCursorState.find(pcs => pcs.equals(cs)));\n    if (cursorDiff.length >= 1) {\n        const cursorPositions = cursorDiff.map(cs => `line ${cs.viewState.position.lineNumber} column ${cs.viewState.position.column}`).join(', ');\n        const msg = cursorDiff.length === 1 ? nls.localize('cursorAdded', \"Cursor added: {0}\", cursorPositions) : nls.localize('cursorsAdded', \"Cursors added: {0}\", cursorPositions);\n        status(msg);\n    }\n}\nexport class InsertCursorAbove extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.insertCursorAbove',\n            label: nls.localize('mutlicursor.insertAbove', \"Add Cursor Above\"),\n            alias: 'Add Cursor Above',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */,\n                linux: {\n                    primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */,\n                    secondary: [2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */]\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '3_multi',\n                title: nls.localize({ key: 'miInsertCursorAbove', comment: ['&& denotes a mnemonic'] }, \"&&Add Cursor Above\"),\n                order: 2\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        let useLogicalLine = true;\n        if (args && args.logicalLine === false) {\n            useLogicalLine = false;\n        }\n        const viewModel = editor._getViewModel();\n        if (viewModel.cursorConfig.readOnly) {\n            return;\n        }\n        viewModel.model.pushStackElement();\n        const previousCursorState = viewModel.getCursorStates();\n        viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.addCursorUp(viewModel, previousCursorState, useLogicalLine));\n        viewModel.revealTopMostCursor(args.source);\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nexport class InsertCursorBelow extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.insertCursorBelow',\n            label: nls.localize('mutlicursor.insertBelow', \"Add Cursor Below\"),\n            alias: 'Add Cursor Below',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */,\n                linux: {\n                    primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */,\n                    secondary: [2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */]\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '3_multi',\n                title: nls.localize({ key: 'miInsertCursorBelow', comment: ['&& denotes a mnemonic'] }, \"A&&dd Cursor Below\"),\n                order: 3\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        let useLogicalLine = true;\n        if (args && args.logicalLine === false) {\n            useLogicalLine = false;\n        }\n        const viewModel = editor._getViewModel();\n        if (viewModel.cursorConfig.readOnly) {\n            return;\n        }\n        viewModel.model.pushStackElement();\n        const previousCursorState = viewModel.getCursorStates();\n        viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.addCursorDown(viewModel, previousCursorState, useLogicalLine));\n        viewModel.revealBottomMostCursor(args.source);\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nclass InsertCursorAtEndOfEachLineSelected extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.insertCursorAtEndOfEachLineSelected',\n            label: nls.localize('mutlicursor.insertAtEndOfEachLineSelected', \"Add Cursors to Line Ends\"),\n            alias: 'Add Cursors to Line Ends',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 39 /* KeyCode.KeyI */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '3_multi',\n                title: nls.localize({ key: 'miInsertCursorAtEndOfEachLineSelected', comment: ['&& denotes a mnemonic'] }, \"Add C&&ursors to Line Ends\"),\n                order: 4\n            }\n        });\n    }\n    getCursorsForSelection(selection, model, result) {\n        if (selection.isEmpty()) {\n            return;\n        }\n        for (let i = selection.startLineNumber; i < selection.endLineNumber; i++) {\n            const currentLineMaxColumn = model.getLineMaxColumn(i);\n            result.push(new Selection(i, currentLineMaxColumn, i, currentLineMaxColumn));\n        }\n        if (selection.endColumn > 1) {\n            result.push(new Selection(selection.endLineNumber, selection.endColumn, selection.endLineNumber, selection.endColumn));\n        }\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const model = editor.getModel();\n        const selections = editor.getSelections();\n        const viewModel = editor._getViewModel();\n        const previousCursorState = viewModel.getCursorStates();\n        const newSelections = [];\n        selections.forEach((sel) => this.getCursorsForSelection(sel, model, newSelections));\n        if (newSelections.length > 0) {\n            editor.setSelections(newSelections);\n        }\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nclass InsertCursorAtEndOfLineSelected extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.addCursorsToBottom',\n            label: nls.localize('mutlicursor.addCursorsToBottom', \"Add Cursors To Bottom\"),\n            alias: 'Add Cursors To Bottom',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const selections = editor.getSelections();\n        const lineCount = editor.getModel().getLineCount();\n        const newSelections = [];\n        for (let i = selections[0].startLineNumber; i <= lineCount; i++) {\n            newSelections.push(new Selection(i, selections[0].startColumn, i, selections[0].endColumn));\n        }\n        const viewModel = editor._getViewModel();\n        const previousCursorState = viewModel.getCursorStates();\n        if (newSelections.length > 0) {\n            editor.setSelections(newSelections);\n        }\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nclass InsertCursorAtTopOfLineSelected extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.addCursorsToTop',\n            label: nls.localize('mutlicursor.addCursorsToTop', \"Add Cursors To Top\"),\n            alias: 'Add Cursors To Top',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const selections = editor.getSelections();\n        const newSelections = [];\n        for (let i = selections[0].startLineNumber; i >= 1; i--) {\n            newSelections.push(new Selection(i, selections[0].startColumn, i, selections[0].endColumn));\n        }\n        const viewModel = editor._getViewModel();\n        const previousCursorState = viewModel.getCursorStates();\n        if (newSelections.length > 0) {\n            editor.setSelections(newSelections);\n        }\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nexport class MultiCursorSessionResult {\n    constructor(selections, revealRange, revealScrollType) {\n        this.selections = selections;\n        this.revealRange = revealRange;\n        this.revealScrollType = revealScrollType;\n    }\n}\nexport class MultiCursorSession {\n    static create(editor, findController) {\n        if (!editor.hasModel()) {\n            return null;\n        }\n        const findState = findController.getState();\n        // Find widget owns entirely what we search for if:\n        //  - focus is not in the editor (i.e. it is in the find widget)\n        //  - and the search widget is visible\n        //  - and the search string is non-empty\n        if (!editor.hasTextFocus() && findState.isRevealed && findState.searchString.length > 0) {\n            // Find widget owns what is searched for\n            return new MultiCursorSession(editor, findController, false, findState.searchString, findState.wholeWord, findState.matchCase, null);\n        }\n        // Otherwise, the selection gives the search text, and the find widget gives the search settings\n        // The exception is the find state disassociation case: when beginning with a single, collapsed selection\n        let isDisconnectedFromFindController = false;\n        let wholeWord;\n        let matchCase;\n        const selections = editor.getSelections();\n        if (selections.length === 1 && selections[0].isEmpty()) {\n            isDisconnectedFromFindController = true;\n            wholeWord = true;\n            matchCase = true;\n        }\n        else {\n            wholeWord = findState.wholeWord;\n            matchCase = findState.matchCase;\n        }\n        // Selection owns what is searched for\n        const s = editor.getSelection();\n        let searchText;\n        let currentMatch = null;\n        if (s.isEmpty()) {\n            // selection is empty => expand to current word\n            const word = editor.getConfiguredWordAtPosition(s.getStartPosition());\n            if (!word) {\n                return null;\n            }\n            searchText = word.word;\n            currentMatch = new Selection(s.startLineNumber, word.startColumn, s.startLineNumber, word.endColumn);\n        }\n        else {\n            searchText = editor.getModel().getValueInRange(s).replace(/\\r\\n/g, '\\n');\n        }\n        return new MultiCursorSession(editor, findController, isDisconnectedFromFindController, searchText, wholeWord, matchCase, currentMatch);\n    }\n    constructor(_editor, findController, isDisconnectedFromFindController, searchText, wholeWord, matchCase, currentMatch) {\n        this._editor = _editor;\n        this.findController = findController;\n        this.isDisconnectedFromFindController = isDisconnectedFromFindController;\n        this.searchText = searchText;\n        this.wholeWord = wholeWord;\n        this.matchCase = matchCase;\n        this.currentMatch = currentMatch;\n    }\n    addSelectionToNextFindMatch() {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        const nextMatch = this._getNextMatch();\n        if (!nextMatch) {\n            return null;\n        }\n        const allSelections = this._editor.getSelections();\n        return new MultiCursorSessionResult(allSelections.concat(nextMatch), nextMatch, 0 /* ScrollType.Smooth */);\n    }\n    moveSelectionToNextFindMatch() {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        const nextMatch = this._getNextMatch();\n        if (!nextMatch) {\n            return null;\n        }\n        const allSelections = this._editor.getSelections();\n        return new MultiCursorSessionResult(allSelections.slice(0, allSelections.length - 1).concat(nextMatch), nextMatch, 0 /* ScrollType.Smooth */);\n    }\n    _getNextMatch() {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        if (this.currentMatch) {\n            const result = this.currentMatch;\n            this.currentMatch = null;\n            return result;\n        }\n        this.findController.highlightFindOptions();\n        const allSelections = this._editor.getSelections();\n        const lastAddedSelection = allSelections[allSelections.length - 1];\n        const nextMatch = this._editor.getModel().findNextMatch(this.searchText, lastAddedSelection.getEndPosition(), false, this.matchCase, this.wholeWord ? this._editor.getOption(132 /* EditorOption.wordSeparators */) : null, false);\n        if (!nextMatch) {\n            return null;\n        }\n        return new Selection(nextMatch.range.startLineNumber, nextMatch.range.startColumn, nextMatch.range.endLineNumber, nextMatch.range.endColumn);\n    }\n    addSelectionToPreviousFindMatch() {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        const previousMatch = this._getPreviousMatch();\n        if (!previousMatch) {\n            return null;\n        }\n        const allSelections = this._editor.getSelections();\n        return new MultiCursorSessionResult(allSelections.concat(previousMatch), previousMatch, 0 /* ScrollType.Smooth */);\n    }\n    moveSelectionToPreviousFindMatch() {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        const previousMatch = this._getPreviousMatch();\n        if (!previousMatch) {\n            return null;\n        }\n        const allSelections = this._editor.getSelections();\n        return new MultiCursorSessionResult(allSelections.slice(0, allSelections.length - 1).concat(previousMatch), previousMatch, 0 /* ScrollType.Smooth */);\n    }\n    _getPreviousMatch() {\n        if (!this._editor.hasModel()) {\n            return null;\n        }\n        if (this.currentMatch) {\n            const result = this.currentMatch;\n            this.currentMatch = null;\n            return result;\n        }\n        this.findController.highlightFindOptions();\n        const allSelections = this._editor.getSelections();\n        const lastAddedSelection = allSelections[allSelections.length - 1];\n        const previousMatch = this._editor.getModel().findPreviousMatch(this.searchText, lastAddedSelection.getStartPosition(), false, this.matchCase, this.wholeWord ? this._editor.getOption(132 /* EditorOption.wordSeparators */) : null, false);\n        if (!previousMatch) {\n            return null;\n        }\n        return new Selection(previousMatch.range.startLineNumber, previousMatch.range.startColumn, previousMatch.range.endLineNumber, previousMatch.range.endColumn);\n    }\n    selectAll(searchScope) {\n        if (!this._editor.hasModel()) {\n            return [];\n        }\n        this.findController.highlightFindOptions();\n        const editorModel = this._editor.getModel();\n        if (searchScope) {\n            return editorModel.findMatches(this.searchText, searchScope, false, this.matchCase, this.wholeWord ? this._editor.getOption(132 /* EditorOption.wordSeparators */) : null, false, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n        }\n        return editorModel.findMatches(this.searchText, true, false, this.matchCase, this.wholeWord ? this._editor.getOption(132 /* EditorOption.wordSeparators */) : null, false, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n    }\n}\nexport class MultiCursorSelectionController extends Disposable {\n    static { this.ID = 'editor.contrib.multiCursorController'; }\n    static get(editor) {\n        return editor.getContribution(MultiCursorSelectionController.ID);\n    }\n    constructor(editor) {\n        super();\n        this._sessionDispose = this._register(new DisposableStore());\n        this._editor = editor;\n        this._ignoreSelectionChange = false;\n        this._session = null;\n    }\n    dispose() {\n        this._endSession();\n        super.dispose();\n    }\n    _beginSessionIfNeeded(findController) {\n        if (!this._session) {\n            // Create a new session\n            const session = MultiCursorSession.create(this._editor, findController);\n            if (!session) {\n                return;\n            }\n            this._session = session;\n            const newState = { searchString: this._session.searchText };\n            if (this._session.isDisconnectedFromFindController) {\n                newState.wholeWordOverride = 1 /* FindOptionOverride.True */;\n                newState.matchCaseOverride = 1 /* FindOptionOverride.True */;\n                newState.isRegexOverride = 2 /* FindOptionOverride.False */;\n            }\n            findController.getState().change(newState, false);\n            this._sessionDispose.add(this._editor.onDidChangeCursorSelection((e) => {\n                if (this._ignoreSelectionChange) {\n                    return;\n                }\n                this._endSession();\n            }));\n            this._sessionDispose.add(this._editor.onDidBlurEditorText(() => {\n                this._endSession();\n            }));\n            this._sessionDispose.add(findController.getState().onFindReplaceStateChange((e) => {\n                if (e.matchCase || e.wholeWord) {\n                    this._endSession();\n                }\n            }));\n        }\n    }\n    _endSession() {\n        this._sessionDispose.clear();\n        if (this._session && this._session.isDisconnectedFromFindController) {\n            const newState = {\n                wholeWordOverride: 0 /* FindOptionOverride.NotSet */,\n                matchCaseOverride: 0 /* FindOptionOverride.NotSet */,\n                isRegexOverride: 0 /* FindOptionOverride.NotSet */,\n            };\n            this._session.findController.getState().change(newState, false);\n        }\n        this._session = null;\n    }\n    _setSelections(selections) {\n        this._ignoreSelectionChange = true;\n        this._editor.setSelections(selections);\n        this._ignoreSelectionChange = false;\n    }\n    _expandEmptyToWord(model, selection) {\n        if (!selection.isEmpty()) {\n            return selection;\n        }\n        const word = this._editor.getConfiguredWordAtPosition(selection.getStartPosition());\n        if (!word) {\n            return selection;\n        }\n        return new Selection(selection.startLineNumber, word.startColumn, selection.startLineNumber, word.endColumn);\n    }\n    _applySessionResult(result) {\n        if (!result) {\n            return;\n        }\n        this._setSelections(result.selections);\n        if (result.revealRange) {\n            this._editor.revealRangeInCenterIfOutsideViewport(result.revealRange, result.revealScrollType);\n        }\n    }\n    getSession(findController) {\n        return this._session;\n    }\n    addSelectionToNextFindMatch(findController) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (!this._session) {\n            // If there are multiple cursors, handle the case where they do not all select the same text.\n            const allSelections = this._editor.getSelections();\n            if (allSelections.length > 1) {\n                const findState = findController.getState();\n                const matchCase = findState.matchCase;\n                const selectionsContainSameText = modelRangesContainSameText(this._editor.getModel(), allSelections, matchCase);\n                if (!selectionsContainSameText) {\n                    const model = this._editor.getModel();\n                    const resultingSelections = [];\n                    for (let i = 0, len = allSelections.length; i < len; i++) {\n                        resultingSelections[i] = this._expandEmptyToWord(model, allSelections[i]);\n                    }\n                    this._editor.setSelections(resultingSelections);\n                    return;\n                }\n            }\n        }\n        this._beginSessionIfNeeded(findController);\n        if (this._session) {\n            this._applySessionResult(this._session.addSelectionToNextFindMatch());\n        }\n    }\n    addSelectionToPreviousFindMatch(findController) {\n        this._beginSessionIfNeeded(findController);\n        if (this._session) {\n            this._applySessionResult(this._session.addSelectionToPreviousFindMatch());\n        }\n    }\n    moveSelectionToNextFindMatch(findController) {\n        this._beginSessionIfNeeded(findController);\n        if (this._session) {\n            this._applySessionResult(this._session.moveSelectionToNextFindMatch());\n        }\n    }\n    moveSelectionToPreviousFindMatch(findController) {\n        this._beginSessionIfNeeded(findController);\n        if (this._session) {\n            this._applySessionResult(this._session.moveSelectionToPreviousFindMatch());\n        }\n    }\n    selectAll(findController) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        let matches = null;\n        const findState = findController.getState();\n        // Special case: find widget owns entirely what we search for if:\n        // - focus is not in the editor (i.e. it is in the find widget)\n        // - and the search widget is visible\n        // - and the search string is non-empty\n        // - and we're searching for a regex\n        if (findState.isRevealed && findState.searchString.length > 0 && findState.isRegex) {\n            const editorModel = this._editor.getModel();\n            if (findState.searchScope) {\n                matches = editorModel.findMatches(findState.searchString, findState.searchScope, findState.isRegex, findState.matchCase, findState.wholeWord ? this._editor.getOption(132 /* EditorOption.wordSeparators */) : null, false, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n            }\n            else {\n                matches = editorModel.findMatches(findState.searchString, true, findState.isRegex, findState.matchCase, findState.wholeWord ? this._editor.getOption(132 /* EditorOption.wordSeparators */) : null, false, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n            }\n        }\n        else {\n            this._beginSessionIfNeeded(findController);\n            if (!this._session) {\n                return;\n            }\n            matches = this._session.selectAll(findState.searchScope);\n        }\n        if (matches.length > 0) {\n            const editorSelection = this._editor.getSelection();\n            // Have the primary cursor remain the one where the action was invoked\n            for (let i = 0, len = matches.length; i < len; i++) {\n                const match = matches[i];\n                const intersection = match.range.intersectRanges(editorSelection);\n                if (intersection) {\n                    // bingo!\n                    matches[i] = matches[0];\n                    matches[0] = match;\n                    break;\n                }\n            }\n            this._setSelections(matches.map(m => new Selection(m.range.startLineNumber, m.range.startColumn, m.range.endLineNumber, m.range.endColumn)));\n        }\n    }\n}\nexport class MultiCursorSelectionControllerAction extends EditorAction {\n    run(accessor, editor) {\n        const multiCursorController = MultiCursorSelectionController.get(editor);\n        if (!multiCursorController) {\n            return;\n        }\n        const viewModel = editor._getViewModel();\n        if (viewModel) {\n            const previousCursorState = viewModel.getCursorStates();\n            const findController = CommonFindController.get(editor);\n            if (findController) {\n                this._run(multiCursorController, findController);\n            }\n            else {\n                const newFindController = accessor.get(IInstantiationService).createInstance(CommonFindController, editor);\n                this._run(multiCursorController, newFindController);\n                newFindController.dispose();\n            }\n            announceCursorChange(previousCursorState, viewModel.getCursorStates());\n        }\n    }\n}\nexport class AddSelectionToNextFindMatchAction extends MultiCursorSelectionControllerAction {\n    constructor() {\n        super({\n            id: 'editor.action.addSelectionToNextFindMatch',\n            label: nls.localize('addSelectionToNextFindMatch', \"Add Selection To Next Find Match\"),\n            alias: 'Add Selection To Next Find Match',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 34 /* KeyCode.KeyD */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '3_multi',\n                title: nls.localize({ key: 'miAddSelectionToNextFindMatch', comment: ['&& denotes a mnemonic'] }, \"Add &&Next Occurrence\"),\n                order: 5\n            }\n        });\n    }\n    _run(multiCursorController, findController) {\n        multiCursorController.addSelectionToNextFindMatch(findController);\n    }\n}\nexport class AddSelectionToPreviousFindMatchAction extends MultiCursorSelectionControllerAction {\n    constructor() {\n        super({\n            id: 'editor.action.addSelectionToPreviousFindMatch',\n            label: nls.localize('addSelectionToPreviousFindMatch', \"Add Selection To Previous Find Match\"),\n            alias: 'Add Selection To Previous Find Match',\n            precondition: undefined,\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '3_multi',\n                title: nls.localize({ key: 'miAddSelectionToPreviousFindMatch', comment: ['&& denotes a mnemonic'] }, \"Add P&&revious Occurrence\"),\n                order: 6\n            }\n        });\n    }\n    _run(multiCursorController, findController) {\n        multiCursorController.addSelectionToPreviousFindMatch(findController);\n    }\n}\nexport class MoveSelectionToNextFindMatchAction extends MultiCursorSelectionControllerAction {\n    constructor() {\n        super({\n            id: 'editor.action.moveSelectionToNextFindMatch',\n            label: nls.localize('moveSelectionToNextFindMatch', \"Move Last Selection To Next Find Match\"),\n            alias: 'Move Last Selection To Next Find Match',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 34 /* KeyCode.KeyD */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _run(multiCursorController, findController) {\n        multiCursorController.moveSelectionToNextFindMatch(findController);\n    }\n}\nexport class MoveSelectionToPreviousFindMatchAction extends MultiCursorSelectionControllerAction {\n    constructor() {\n        super({\n            id: 'editor.action.moveSelectionToPreviousFindMatch',\n            label: nls.localize('moveSelectionToPreviousFindMatch', \"Move Last Selection To Previous Find Match\"),\n            alias: 'Move Last Selection To Previous Find Match',\n            precondition: undefined\n        });\n    }\n    _run(multiCursorController, findController) {\n        multiCursorController.moveSelectionToPreviousFindMatch(findController);\n    }\n}\nexport class SelectHighlightsAction extends MultiCursorSelectionControllerAction {\n    constructor() {\n        super({\n            id: 'editor.action.selectHighlights',\n            label: nls.localize('selectAllOccurrencesOfFindMatch', \"Select All Occurrences of Find Match\"),\n            alias: 'Select All Occurrences of Find Match',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 42 /* KeyCode.KeyL */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '3_multi',\n                title: nls.localize({ key: 'miSelectHighlights', comment: ['&& denotes a mnemonic'] }, \"Select All &&Occurrences\"),\n                order: 7\n            }\n        });\n    }\n    _run(multiCursorController, findController) {\n        multiCursorController.selectAll(findController);\n    }\n}\nexport class CompatChangeAll extends MultiCursorSelectionControllerAction {\n    constructor() {\n        super({\n            id: 'editor.action.changeAll',\n            label: nls.localize('changeAll.label', \"Change All Occurrences\"),\n            alias: 'Change All Occurrences',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.editorTextFocus),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 60 /* KeyCode.F2 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 1.2\n            }\n        });\n    }\n    _run(multiCursorController, findController) {\n        multiCursorController.selectAll(findController);\n    }\n}\nclass SelectionHighlighterState {\n    constructor(_model, _searchText, _matchCase, _wordSeparators, prevState) {\n        this._model = _model;\n        this._searchText = _searchText;\n        this._matchCase = _matchCase;\n        this._wordSeparators = _wordSeparators;\n        this._modelVersionId = this._model.getVersionId();\n        this._cachedFindMatches = null;\n        if (prevState\n            && this._model === prevState._model\n            && this._searchText === prevState._searchText\n            && this._matchCase === prevState._matchCase\n            && this._wordSeparators === prevState._wordSeparators\n            && this._modelVersionId === prevState._modelVersionId) {\n            this._cachedFindMatches = prevState._cachedFindMatches;\n        }\n    }\n    findMatches() {\n        if (this._cachedFindMatches === null) {\n            this._cachedFindMatches = this._model.findMatches(this._searchText, true, false, this._matchCase, this._wordSeparators, false).map(m => m.range);\n            this._cachedFindMatches.sort(Range.compareRangesUsingStarts);\n        }\n        return this._cachedFindMatches;\n    }\n}\nlet SelectionHighlighter = class SelectionHighlighter extends Disposable {\n    static { SelectionHighlighter_1 = this; }\n    static { this.ID = 'editor.contrib.selectionHighlighter'; }\n    constructor(editor, _languageFeaturesService) {\n        super();\n        this._languageFeaturesService = _languageFeaturesService;\n        this.editor = editor;\n        this._isEnabled = editor.getOption(109 /* EditorOption.selectionHighlight */);\n        this._decorations = editor.createDecorationsCollection();\n        this.updateSoon = this._register(new RunOnceScheduler(() => this._update(), 300));\n        this.state = null;\n        this._register(editor.onDidChangeConfiguration((e) => {\n            this._isEnabled = editor.getOption(109 /* EditorOption.selectionHighlight */);\n        }));\n        this._register(editor.onDidChangeCursorSelection((e) => {\n            if (!this._isEnabled) {\n                // Early exit if nothing needs to be done!\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\n                return;\n            }\n            if (e.selection.isEmpty()) {\n                if (e.reason === 3 /* CursorChangeReason.Explicit */) {\n                    if (this.state) {\n                        // no longer valid\n                        this._setState(null);\n                    }\n                    this.updateSoon.schedule();\n                }\n                else {\n                    this._setState(null);\n                }\n            }\n            else {\n                this._update();\n            }\n        }));\n        this._register(editor.onDidChangeModel((e) => {\n            this._setState(null);\n        }));\n        this._register(editor.onDidChangeModelContent((e) => {\n            if (this._isEnabled) {\n                this.updateSoon.schedule();\n            }\n        }));\n        const findController = CommonFindController.get(editor);\n        if (findController) {\n            this._register(findController.getState().onFindReplaceStateChange((e) => {\n                this._update();\n            }));\n        }\n        this.updateSoon.schedule();\n    }\n    _update() {\n        this._setState(SelectionHighlighter_1._createState(this.state, this._isEnabled, this.editor));\n    }\n    static _createState(oldState, isEnabled, editor) {\n        if (!isEnabled) {\n            return null;\n        }\n        if (!editor.hasModel()) {\n            return null;\n        }\n        const s = editor.getSelection();\n        if (s.startLineNumber !== s.endLineNumber) {\n            // multiline forbidden for perf reasons\n            return null;\n        }\n        const multiCursorController = MultiCursorSelectionController.get(editor);\n        if (!multiCursorController) {\n            return null;\n        }\n        const findController = CommonFindController.get(editor);\n        if (!findController) {\n            return null;\n        }\n        let r = multiCursorController.getSession(findController);\n        if (!r) {\n            const allSelections = editor.getSelections();\n            if (allSelections.length > 1) {\n                const findState = findController.getState();\n                const matchCase = findState.matchCase;\n                const selectionsContainSameText = modelRangesContainSameText(editor.getModel(), allSelections, matchCase);\n                if (!selectionsContainSameText) {\n                    return null;\n                }\n            }\n            r = MultiCursorSession.create(editor, findController);\n        }\n        if (!r) {\n            return null;\n        }\n        if (r.currentMatch) {\n            // This is an empty selection\n            // Do not interfere with semantic word highlighting in the no selection case\n            return null;\n        }\n        if (/^[ \\t]+$/.test(r.searchText)) {\n            // whitespace only selection\n            return null;\n        }\n        if (r.searchText.length > 200) {\n            // very long selection\n            return null;\n        }\n        // TODO: better handling of this case\n        const findState = findController.getState();\n        const caseSensitive = findState.matchCase;\n        // Return early if the find widget shows the exact same matches\n        if (findState.isRevealed) {\n            let findStateSearchString = findState.searchString;\n            if (!caseSensitive) {\n                findStateSearchString = findStateSearchString.toLowerCase();\n            }\n            let mySearchString = r.searchText;\n            if (!caseSensitive) {\n                mySearchString = mySearchString.toLowerCase();\n            }\n            if (findStateSearchString === mySearchString && r.matchCase === findState.matchCase && r.wholeWord === findState.wholeWord && !findState.isRegex) {\n                return null;\n            }\n        }\n        return new SelectionHighlighterState(editor.getModel(), r.searchText, r.matchCase, r.wholeWord ? editor.getOption(132 /* EditorOption.wordSeparators */) : null, oldState);\n    }\n    _setState(newState) {\n        this.state = newState;\n        if (!this.state) {\n            this._decorations.clear();\n            return;\n        }\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        const model = this.editor.getModel();\n        if (model.isTooLargeForTokenization()) {\n            // the file is too large, so searching word under cursor in the whole document would be blocking the UI.\n            return;\n        }\n        const allMatches = this.state.findMatches();\n        const selections = this.editor.getSelections();\n        selections.sort(Range.compareRangesUsingStarts);\n        // do not overlap with selection (issue #64 and #512)\n        const matches = [];\n        for (let i = 0, j = 0, len = allMatches.length, lenJ = selections.length; i < len;) {\n            const match = allMatches[i];\n            if (j >= lenJ) {\n                // finished all editor selections\n                matches.push(match);\n                i++;\n            }\n            else {\n                const cmp = Range.compareRangesUsingStarts(match, selections[j]);\n                if (cmp < 0) {\n                    // match is before sel\n                    if (selections[j].isEmpty() || !Range.areIntersecting(match, selections[j])) {\n                        matches.push(match);\n                    }\n                    i++;\n                }\n                else if (cmp > 0) {\n                    // sel is before match\n                    j++;\n                }\n                else {\n                    // sel is equal to match\n                    i++;\n                    j++;\n                }\n            }\n        }\n        const occurrenceHighlighting = this.editor.getOption(81 /* EditorOption.occurrencesHighlight */) !== 'off';\n        const hasSemanticHighlights = this._languageFeaturesService.documentHighlightProvider.has(model) && occurrenceHighlighting;\n        const decorations = matches.map(r => {\n            return {\n                range: r,\n                options: getSelectionHighlightDecorationOptions(hasSemanticHighlights)\n            };\n        });\n        this._decorations.set(decorations);\n    }\n    dispose() {\n        this._setState(null);\n        super.dispose();\n    }\n};\nSelectionHighlighter = SelectionHighlighter_1 = __decorate([\n    __param(1, ILanguageFeaturesService)\n], SelectionHighlighter);\nexport { SelectionHighlighter };\nfunction modelRangesContainSameText(model, ranges, matchCase) {\n    const selectedText = getValueInRange(model, ranges[0], !matchCase);\n    for (let i = 1, len = ranges.length; i < len; i++) {\n        const range = ranges[i];\n        if (range.isEmpty()) {\n            return false;\n        }\n        const thisSelectedText = getValueInRange(model, range, !matchCase);\n        if (selectedText !== thisSelectedText) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction getValueInRange(model, range, toLowerCase) {\n    const text = model.getValueInRange(range);\n    return (toLowerCase ? text.toLowerCase() : text);\n}\nexport class FocusNextCursor extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.focusNextCursor',\n            label: nls.localize('mutlicursor.focusNextCursor', \"Focus Next Cursor\"),\n            metadata: {\n                description: nls.localize('mutlicursor.focusNextCursor.description', \"Focuses the next cursor\"),\n                args: [],\n            },\n            alias: 'Focus Next Cursor',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const viewModel = editor._getViewModel();\n        if (viewModel.cursorConfig.readOnly) {\n            return;\n        }\n        viewModel.model.pushStackElement();\n        const previousCursorState = Array.from(viewModel.getCursorStates());\n        const firstCursor = previousCursorState.shift();\n        if (!firstCursor) {\n            return;\n        }\n        previousCursorState.push(firstCursor);\n        viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, previousCursorState);\n        viewModel.revealPrimaryCursor(args.source, true);\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nexport class FocusPreviousCursor extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.focusPreviousCursor',\n            label: nls.localize('mutlicursor.focusPreviousCursor', \"Focus Previous Cursor\"),\n            metadata: {\n                description: nls.localize('mutlicursor.focusPreviousCursor.description', \"Focuses the previous cursor\"),\n                args: [],\n            },\n            alias: 'Focus Previous Cursor',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const viewModel = editor._getViewModel();\n        if (viewModel.cursorConfig.readOnly) {\n            return;\n        }\n        viewModel.model.pushStackElement();\n        const previousCursorState = Array.from(viewModel.getCursorStates());\n        const firstCursor = previousCursorState.pop();\n        if (!firstCursor) {\n            return;\n        }\n        previousCursorState.unshift(firstCursor);\n        viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, previousCursorState);\n        viewModel.revealPrimaryCursor(args.source, true);\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\n    }\n}\nregisterEditorContribution(MultiCursorSelectionController.ID, MultiCursorSelectionController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorContribution(SelectionHighlighter.ID, SelectionHighlighter, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nregisterEditorAction(InsertCursorAbove);\nregisterEditorAction(InsertCursorBelow);\nregisterEditorAction(InsertCursorAtEndOfEachLineSelected);\nregisterEditorAction(AddSelectionToNextFindMatchAction);\nregisterEditorAction(AddSelectionToPreviousFindMatchAction);\nregisterEditorAction(MoveSelectionToNextFindMatchAction);\nregisterEditorAction(MoveSelectionToPreviousFindMatchAction);\nregisterEditorAction(SelectHighlightsAction);\nregisterEditorAction(CompatChangeAll);\nregisterEditorAction(InsertCursorAtEndOfLineSelected);\nregisterEditorAction(InsertCursorAtTopOfLineSelected);\nregisterEditorAction(FocusNextCursor);\nregisterEditorAction(FocusPreviousCursor);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport const inlineEditAcceptId = 'editor.action.inlineEdit.accept';\nexport const inlineEditRejectId = 'editor.action.inlineEdit.reject';\nexport const inlineEditJumpToId = 'editor.action.inlineEdit.jumpTo';\nexport const inlineEditJumpBackId = 'editor.action.inlineEdit.jumpBack';\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Disposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { derived, observableFromEvent, observableValue } from '../../../../base/common/observable.js';\nimport './inlineEdit.css';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { InjectedTextCursorStops } from '../../../common/model.js';\nimport { LineDecoration } from '../../../common/viewLayout/lineDecorations.js';\nimport { ColumnRange, applyObservableDecorations } from '../../inlineCompletions/browser/utils.js';\nimport { diffDeleteDecoration, diffLineDeleteDecorationBackgroundWithIndicator } from '../../../browser/widget/diffEditor/registrations.contribution.js';\nexport const INLINE_EDIT_DESCRIPTION = 'inline-edit';\nlet GhostTextWidget = class GhostTextWidget extends Disposable {\n    constructor(editor, model, languageService) {\n        super();\n        this.editor = editor;\n        this.model = model;\n        this.languageService = languageService;\n        this.isDisposed = observableValue(this, false);\n        this.currentTextModel = observableFromEvent(this, this.editor.onDidChangeModel, () => /** @description editor.model */ this.editor.getModel());\n        this.uiState = derived(this, reader => {\n            if (this.isDisposed.read(reader)) {\n                return undefined;\n            }\n            const textModel = this.currentTextModel.read(reader);\n            if (textModel !== this.model.targetTextModel.read(reader)) {\n                return undefined;\n            }\n            const ghostText = this.model.ghostText.read(reader);\n            if (!ghostText) {\n                return undefined;\n            }\n            let range = this.model.range?.read(reader);\n            //if range is empty, we want to remove it\n            if (range && range.startLineNumber === range.endLineNumber && range.startColumn === range.endColumn) {\n                range = undefined;\n            }\n            //check if both range and text are single line - in this case we want to do inline replacement\n            //rather than replacing whole lines\n            const isSingleLine = (range ? range.startLineNumber === range.endLineNumber : true) && ghostText.parts.length === 1 && ghostText.parts[0].lines.length === 1;\n            //check if we're just removing code\n            const isPureRemove = ghostText.parts.length === 1 && ghostText.parts[0].lines.every(l => l.length === 0);\n            const inlineTexts = [];\n            const additionalLines = [];\n            function addToAdditionalLines(lines, className) {\n                if (additionalLines.length > 0) {\n                    const lastLine = additionalLines[additionalLines.length - 1];\n                    if (className) {\n                        lastLine.decorations.push(new LineDecoration(lastLine.content.length + 1, lastLine.content.length + 1 + lines[0].length, className, 0 /* InlineDecorationType.Regular */));\n                    }\n                    lastLine.content += lines[0];\n                    lines = lines.slice(1);\n                }\n                for (const line of lines) {\n                    additionalLines.push({\n                        content: line,\n                        decorations: className ? [new LineDecoration(1, line.length + 1, className, 0 /* InlineDecorationType.Regular */)] : []\n                    });\n                }\n            }\n            const textBufferLine = textModel.getLineContent(ghostText.lineNumber);\n            let hiddenTextStartColumn = undefined;\n            let lastIdx = 0;\n            if (!isPureRemove && (isSingleLine || !range)) {\n                for (const part of ghostText.parts) {\n                    let lines = part.lines;\n                    //If remove range is set, we want to push all new liens to virtual area\n                    if (range && !isSingleLine) {\n                        addToAdditionalLines(lines, INLINE_EDIT_DESCRIPTION);\n                        lines = [];\n                    }\n                    if (hiddenTextStartColumn === undefined) {\n                        inlineTexts.push({\n                            column: part.column,\n                            text: lines[0],\n                            preview: part.preview,\n                        });\n                        lines = lines.slice(1);\n                    }\n                    else {\n                        addToAdditionalLines([textBufferLine.substring(lastIdx, part.column - 1)], undefined);\n                    }\n                    if (lines.length > 0) {\n                        addToAdditionalLines(lines, INLINE_EDIT_DESCRIPTION);\n                        if (hiddenTextStartColumn === undefined && part.column <= textBufferLine.length) {\n                            hiddenTextStartColumn = part.column;\n                        }\n                    }\n                    lastIdx = part.column - 1;\n                }\n                if (hiddenTextStartColumn !== undefined) {\n                    addToAdditionalLines([textBufferLine.substring(lastIdx)], undefined);\n                }\n            }\n            const hiddenRange = hiddenTextStartColumn !== undefined ? new ColumnRange(hiddenTextStartColumn, textBufferLine.length + 1) : undefined;\n            const lineNumber = (isSingleLine || !range) ? ghostText.lineNumber : range.endLineNumber - 1;\n            return {\n                inlineTexts,\n                additionalLines,\n                hiddenRange,\n                lineNumber,\n                additionalReservedLineCount: this.model.minReservedLineCount.read(reader),\n                targetTextModel: textModel,\n                range,\n                isSingleLine,\n                isPureRemove,\n            };\n        });\n        this.decorations = derived(this, reader => {\n            const uiState = this.uiState.read(reader);\n            if (!uiState) {\n                return [];\n            }\n            const decorations = [];\n            if (uiState.hiddenRange) {\n                decorations.push({\n                    range: uiState.hiddenRange.toRange(uiState.lineNumber),\n                    options: { inlineClassName: 'inline-edit-hidden', description: 'inline-edit-hidden', }\n                });\n            }\n            if (uiState.range) {\n                const ranges = [];\n                if (uiState.isSingleLine) {\n                    ranges.push(uiState.range);\n                }\n                else if (!uiState.isPureRemove) {\n                    const lines = uiState.range.endLineNumber - uiState.range.startLineNumber;\n                    for (let i = 0; i < lines; i++) {\n                        const line = uiState.range.startLineNumber + i;\n                        const firstNonWhitespace = uiState.targetTextModel.getLineFirstNonWhitespaceColumn(line);\n                        const lastNonWhitespace = uiState.targetTextModel.getLineLastNonWhitespaceColumn(line);\n                        const range = new Range(line, firstNonWhitespace, line, lastNonWhitespace);\n                        ranges.push(range);\n                    }\n                }\n                for (const range of ranges) {\n                    decorations.push({\n                        range,\n                        options: diffDeleteDecoration\n                    });\n                }\n            }\n            if (uiState.range && !uiState.isSingleLine && uiState.isPureRemove) {\n                const r = new Range(uiState.range.startLineNumber, 1, uiState.range.endLineNumber - 1, 1);\n                decorations.push({\n                    range: r,\n                    options: diffLineDeleteDecorationBackgroundWithIndicator\n                });\n            }\n            for (const p of uiState.inlineTexts) {\n                decorations.push({\n                    range: Range.fromPositions(new Position(uiState.lineNumber, p.column)),\n                    options: {\n                        description: INLINE_EDIT_DESCRIPTION,\n                        after: { content: p.text, inlineClassName: p.preview ? 'inline-edit-decoration-preview' : 'inline-edit-decoration', cursorStops: InjectedTextCursorStops.Left },\n                        showIfCollapsed: true,\n                    }\n                });\n            }\n            return decorations;\n        });\n        this._register(toDisposable(() => { this.isDisposed.set(true, undefined); }));\n        this._register(applyObservableDecorations(this.editor, this.decorations));\n    }\n};\nGhostTextWidget = __decorate([\n    __param(2, ILanguageService)\n], GhostTextWidget);\nexport { GhostTextWidget };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InlineEditHintsContentWidget_1;\nimport { h } from '../../../../base/browser/dom.js';\nimport { KeybindingLabel, unthemedKeybindingLabelOptions } from '../../../../base/browser/ui/keybindingLabel/keybindingLabel.js';\nimport { Separator } from '../../../../base/common/actions.js';\nimport { equals } from '../../../../base/common/arrays.js';\nimport { Disposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, autorunWithStore, derived, observableFromEvent } from '../../../../base/common/observable.js';\nimport { OS } from '../../../../base/common/platform.js';\nimport './inlineEditHintsWidget.css';\nimport { Position } from '../../../common/core/position.js';\nimport { MenuEntryActionViewItem, createAndFillInActionBarActions } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { WorkbenchToolBar } from '../../../../platform/actions/browser/toolbar.js';\nimport { IMenuService, MenuId, MenuItemAction } from '../../../../platform/actions/common/actions.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nlet InlineEditHintsWidget = class InlineEditHintsWidget extends Disposable {\n    constructor(editor, model, instantiationService) {\n        super();\n        this.editor = editor;\n        this.model = model;\n        this.instantiationService = instantiationService;\n        this.alwaysShowToolbar = observableFromEvent(this, this.editor.onDidChangeConfiguration, () => this.editor.getOption(63 /* EditorOption.inlineEdit */).showToolbar === 'always');\n        this.sessionPosition = undefined;\n        this.position = derived(this, reader => {\n            const ghostText = this.model.read(reader)?.model.ghostText.read(reader);\n            if (!this.alwaysShowToolbar.read(reader) || !ghostText || ghostText.parts.length === 0) {\n                this.sessionPosition = undefined;\n                return null;\n            }\n            const firstColumn = ghostText.parts[0].column;\n            if (this.sessionPosition && this.sessionPosition.lineNumber !== ghostText.lineNumber) {\n                this.sessionPosition = undefined;\n            }\n            const position = new Position(ghostText.lineNumber, Math.min(firstColumn, this.sessionPosition?.column ?? Number.MAX_SAFE_INTEGER));\n            this.sessionPosition = position;\n            return position;\n        });\n        this._register(autorunWithStore((reader, store) => {\n            /** @description setup content widget */\n            const model = this.model.read(reader);\n            if (!model || !this.alwaysShowToolbar.read(reader)) {\n                return;\n            }\n            const contentWidget = store.add(this.instantiationService.createInstance(InlineEditHintsContentWidget, this.editor, true, this.position));\n            editor.addContentWidget(contentWidget);\n            store.add(toDisposable(() => editor.removeContentWidget(contentWidget)));\n        }));\n    }\n};\nInlineEditHintsWidget = __decorate([\n    __param(2, IInstantiationService)\n], InlineEditHintsWidget);\nexport { InlineEditHintsWidget };\nlet InlineEditHintsContentWidget = class InlineEditHintsContentWidget extends Disposable {\n    static { InlineEditHintsContentWidget_1 = this; }\n    static { this._dropDownVisible = false; }\n    static { this.id = 0; }\n    constructor(editor, withBorder, _position, instantiationService, _contextKeyService, _menuService) {\n        super();\n        this.editor = editor;\n        this.withBorder = withBorder;\n        this._position = _position;\n        this._contextKeyService = _contextKeyService;\n        this._menuService = _menuService;\n        this.id = `InlineEditHintsContentWidget${InlineEditHintsContentWidget_1.id++}`;\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = false;\n        this.nodes = h('div.inlineEditHints', { className: this.withBorder ? '.withBorder' : '' }, [\n            h('div@toolBar'),\n        ]);\n        this.inlineCompletionsActionsMenus = this._register(this._menuService.createMenu(MenuId.InlineEditActions, this._contextKeyService));\n        this.toolBar = this._register(instantiationService.createInstance(CustomizedMenuWorkbenchToolBar, this.nodes.toolBar, this.editor, MenuId.InlineEditToolbar, {\n            menuOptions: { renderShortTitle: true },\n            toolbarOptions: { primaryGroup: g => g.startsWith('primary') },\n            actionViewItemProvider: (action, options) => {\n                if (action instanceof MenuItemAction) {\n                    return instantiationService.createInstance(StatusBarViewItem, action, undefined);\n                }\n                return undefined;\n            },\n            telemetrySource: 'InlineEditToolbar',\n        }));\n        this._register(this.toolBar.onDidChangeDropdownVisibility(e => {\n            InlineEditHintsContentWidget_1._dropDownVisible = e;\n        }));\n        this._register(autorun(reader => {\n            /** @description update position */\n            this._position.read(reader);\n            this.editor.layoutContentWidget(this);\n        }));\n        this._register(autorun(reader => {\n            /** @description actions menu */\n            const extraActions = [];\n            for (const [_, group] of this.inlineCompletionsActionsMenus.getActions()) {\n                for (const action of group) {\n                    if (action instanceof MenuItemAction) {\n                        extraActions.push(action);\n                    }\n                }\n            }\n            if (extraActions.length > 0) {\n                extraActions.unshift(new Separator());\n            }\n            this.toolBar.setAdditionalSecondaryActions(extraActions);\n        }));\n    }\n    getId() { return this.id; }\n    getDomNode() {\n        return this.nodes.root;\n    }\n    getPosition() {\n        return {\n            position: this._position.get(),\n            preference: [1 /* ContentWidgetPositionPreference.ABOVE */, 2 /* ContentWidgetPositionPreference.BELOW */],\n            positionAffinity: 3 /* PositionAffinity.LeftOfInjectedText */,\n        };\n    }\n};\nInlineEditHintsContentWidget = InlineEditHintsContentWidget_1 = __decorate([\n    __param(3, IInstantiationService),\n    __param(4, IContextKeyService),\n    __param(5, IMenuService)\n], InlineEditHintsContentWidget);\nexport { InlineEditHintsContentWidget };\nclass StatusBarViewItem extends MenuEntryActionViewItem {\n    updateLabel() {\n        const kb = this._keybindingService.lookupKeybinding(this._action.id, this._contextKeyService);\n        if (!kb) {\n            return super.updateLabel();\n        }\n        if (this.label) {\n            const div = h('div.keybinding').root;\n            const k = this._register(new KeybindingLabel(div, OS, { disableTitle: true, ...unthemedKeybindingLabelOptions }));\n            k.set(kb);\n            this.label.textContent = this._action.label;\n            this.label.appendChild(div);\n            this.label.classList.add('inlineEditStatusBarItemLabel');\n        }\n    }\n    updateTooltip() {\n        // NOOP, disable tooltip\n    }\n}\nlet CustomizedMenuWorkbenchToolBar = class CustomizedMenuWorkbenchToolBar extends WorkbenchToolBar {\n    constructor(container, editor, menuId, options2, menuService, contextKeyService, contextMenuService, keybindingService, commandService, telemetryService) {\n        super(container, { resetMenu: menuId, ...options2 }, menuService, contextKeyService, contextMenuService, keybindingService, commandService, telemetryService);\n        this.editor = editor;\n        this.menuId = menuId;\n        this.options2 = options2;\n        this.menuService = menuService;\n        this.contextKeyService = contextKeyService;\n        this.menu = this._store.add(this.menuService.createMenu(this.menuId, this.contextKeyService, { emitEventsForSubmenuChanges: true }));\n        this.additionalActions = [];\n        this.prependedPrimaryActions = [];\n        this._store.add(this.menu.onDidChange(() => this.updateToolbar()));\n        this._store.add(this.editor.onDidChangeCursorPosition(() => this.updateToolbar()));\n        this.updateToolbar();\n    }\n    updateToolbar() {\n        const primary = [];\n        const secondary = [];\n        createAndFillInActionBarActions(this.menu, this.options2?.menuOptions, { primary, secondary }, this.options2?.toolbarOptions?.primaryGroup, this.options2?.toolbarOptions?.shouldInlineSubmenu, this.options2?.toolbarOptions?.useSeparatorsInPrimaryActions);\n        secondary.push(...this.additionalActions);\n        primary.unshift(...this.prependedPrimaryActions);\n        this.setActions(primary, secondary);\n    }\n    setAdditionalSecondaryActions(actions) {\n        if (equals(this.additionalActions, actions, (a, b) => a === b)) {\n            return;\n        }\n        this.additionalActions = actions;\n        this.updateToolbar();\n    }\n};\nCustomizedMenuWorkbenchToolBar = __decorate([\n    __param(4, IMenuService),\n    __param(5, IContextKeyService),\n    __param(6, IContextMenuService),\n    __param(7, IKeybindingService),\n    __param(8, ICommandService),\n    __param(9, ITelemetryService)\n], CustomizedMenuWorkbenchToolBar);\nexport { CustomizedMenuWorkbenchToolBar };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InlineEditSideBySideWidget_1, InlineEditSideBySideContentWidget_1;\nimport { $ } from '../../../../base/browser/dom.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Disposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { ObservablePromise, autorun, autorunWithStore, derived, observableSignalFromEvent } from '../../../../base/common/observable.js';\nimport { derivedDisposable } from '../../../../base/common/observableInternal/derived.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport './inlineEditSideBySideWidget.css';\nimport { observableCodeEditor } from '../../../browser/observableCodeEditor.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/codeEditor/embeddedCodeEditorWidget.js';\nimport { IDiffProviderFactoryService } from '../../../browser/widget/diffEditor/diffProviderFactoryService.js';\nimport { diffAddDecoration, diffAddDecorationEmpty, diffDeleteDecoration, diffDeleteDecorationEmpty, diffLineAddDecorationBackgroundWithIndicator, diffLineDeleteDecorationBackgroundWithIndicator, diffWholeLineAddDecoration, diffWholeLineDeleteDecoration } from '../../../browser/widget/diffEditor/registrations.contribution.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../../../common/languages/modesRegistry.js';\nimport { TextModel } from '../../../common/model/textModel.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nfunction* range(start, end, step = 1) {\n    if (end === undefined) {\n        [end, start] = [start, 0];\n    }\n    for (let n = start; n < end; n += step) {\n        yield n;\n    }\n}\nfunction removeIndentation(lines) {\n    const indentation = lines[0].match(/^\\s*/)?.[0] ?? '';\n    const length = indentation.length;\n    return {\n        text: lines.map(l => l.replace(new RegExp('^' + indentation), '')),\n        shift: length\n    };\n}\nlet InlineEditSideBySideWidget = class InlineEditSideBySideWidget extends Disposable {\n    static { InlineEditSideBySideWidget_1 = this; }\n    static { this._modelId = 0; }\n    static _createUniqueUri() {\n        return URI.from({ scheme: 'inline-edit-widget', path: new Date().toString() + String(InlineEditSideBySideWidget_1._modelId++) });\n    }\n    constructor(_editor, _model, _instantiationService, _diffProviderFactoryService, _modelService) {\n        super();\n        this._editor = _editor;\n        this._model = _model;\n        this._instantiationService = _instantiationService;\n        this._diffProviderFactoryService = _diffProviderFactoryService;\n        this._modelService = _modelService;\n        this._position = derived(this, reader => {\n            const ghostText = this._model.read(reader);\n            if (!ghostText || ghostText.text.length === 0) {\n                return null;\n            }\n            if (ghostText.range.startLineNumber === ghostText.range.endLineNumber && !(ghostText.range.startColumn === ghostText.range.endColumn && ghostText.range.startColumn === 1)) {\n                //for inner-line suggestions we still want to use minimal ghost text\n                return null;\n            }\n            const editorModel = this._editor.getModel();\n            if (!editorModel) {\n                return null;\n            }\n            const lines = Array.from(range(ghostText.range.startLineNumber, ghostText.range.endLineNumber + 1));\n            const lengths = lines.map(lineNumber => editorModel.getLineLastNonWhitespaceColumn(lineNumber));\n            const maxColumn = Math.max(...lengths);\n            const lineOfMaxColumn = lines[lengths.indexOf(maxColumn)];\n            const position = new Position(lineOfMaxColumn, maxColumn);\n            const pos = {\n                top: ghostText.range.startLineNumber,\n                left: position\n            };\n            return pos;\n        });\n        this._text = derived(this, reader => {\n            const ghostText = this._model.read(reader);\n            if (!ghostText) {\n                return { text: '', shift: 0 };\n            }\n            const t = removeIndentation(ghostText.text.split('\\n'));\n            return {\n                text: t.text.join('\\n'),\n                shift: t.shift\n            };\n        });\n        this._originalModel = derivedDisposable(() => this._modelService.createModel('', null, InlineEditSideBySideWidget_1._createUniqueUri())).keepObserved(this._store);\n        this._modifiedModel = derivedDisposable(() => this._modelService.createModel('', null, InlineEditSideBySideWidget_1._createUniqueUri())).keepObserved(this._store);\n        this._diff = derived(this, reader => {\n            return this._diffPromise.read(reader)?.promiseResult.read(reader)?.data;\n        });\n        this._diffPromise = derived(this, reader => {\n            const ghostText = this._model.read(reader);\n            if (!ghostText) {\n                return;\n            }\n            const editorModel = this._editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const originalText = removeIndentation(editorModel.getValueInRange(ghostText.range).split('\\n')).text.join('\\n');\n            const modifiedText = removeIndentation(ghostText.text.split('\\n')).text.join('\\n');\n            this._originalModel.get().setValue(originalText);\n            this._modifiedModel.get().setValue(modifiedText);\n            const d = this._diffProviderFactoryService.createDiffProvider({ diffAlgorithm: 'advanced' });\n            return ObservablePromise.fromFn(async () => {\n                const result = await d.computeDiff(this._originalModel.get(), this._modifiedModel.get(), {\n                    computeMoves: false,\n                    ignoreTrimWhitespace: false,\n                    maxComputationTimeMs: 1000,\n                }, CancellationToken.None);\n                if (result.identical) {\n                    return undefined;\n                }\n                return result.changes;\n            });\n        });\n        this._register(autorunWithStore((reader, store) => {\n            /** @description setup content widget */\n            const model = this._model.read(reader);\n            if (!model) {\n                return;\n            }\n            if (this._position.get() === null) {\n                return;\n            }\n            const contentWidget = store.add(this._instantiationService.createInstance(InlineEditSideBySideContentWidget, this._editor, this._position, this._text.map(t => t.text), this._text.map(t => t.shift), this._diff));\n            _editor.addOverlayWidget(contentWidget);\n            store.add(toDisposable(() => _editor.removeOverlayWidget(contentWidget)));\n        }));\n    }\n};\nInlineEditSideBySideWidget = InlineEditSideBySideWidget_1 = __decorate([\n    __param(2, IInstantiationService),\n    __param(3, IDiffProviderFactoryService),\n    __param(4, IModelService)\n], InlineEditSideBySideWidget);\nexport { InlineEditSideBySideWidget };\nlet InlineEditSideBySideContentWidget = class InlineEditSideBySideContentWidget extends Disposable {\n    static { InlineEditSideBySideContentWidget_1 = this; }\n    static { this.id = 0; }\n    constructor(_editor, _position, _text, _shift, _diff, _instantiationService) {\n        super();\n        this._editor = _editor;\n        this._position = _position;\n        this._text = _text;\n        this._shift = _shift;\n        this._diff = _diff;\n        this._instantiationService = _instantiationService;\n        this.id = `InlineEditSideBySideContentWidget${InlineEditSideBySideContentWidget_1.id++}`;\n        this.allowEditorOverflow = false;\n        this._nodes = $('div.inlineEditSideBySide', undefined);\n        this._scrollChanged = observableSignalFromEvent('editor.onDidScrollChange', this._editor.onDidScrollChange);\n        this._previewEditor = this._register(this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._nodes, {\n            glyphMargin: false,\n            lineNumbers: 'off',\n            minimap: { enabled: false },\n            guides: {\n                indentation: false,\n                bracketPairs: false,\n                bracketPairsHorizontal: false,\n                highlightActiveIndentation: false,\n            },\n            folding: false,\n            selectOnLineNumbers: false,\n            selectionHighlight: false,\n            columnSelection: false,\n            overviewRulerBorder: false,\n            overviewRulerLanes: 0,\n            lineDecorationsWidth: 0,\n            lineNumbersMinChars: 0,\n            scrollbar: { vertical: 'hidden', horizontal: 'hidden', alwaysConsumeMouseWheel: false, handleMouseWheel: false },\n            readOnly: true,\n            wordWrap: 'off',\n            wordWrapOverride1: 'off',\n            wordWrapOverride2: 'off',\n            wrappingIndent: 'none',\n            wrappingStrategy: undefined,\n        }, { contributions: [], isSimpleWidget: true }, this._editor));\n        this._previewEditorObs = observableCodeEditor(this._previewEditor);\n        this._editorObs = observableCodeEditor(this._editor);\n        this._previewTextModel = this._register(this._instantiationService.createInstance(TextModel, '', this._editor.getModel()?.getLanguageId() ?? PLAINTEXT_LANGUAGE_ID, TextModel.DEFAULT_CREATION_OPTIONS, null));\n        this._setText = derived(reader => {\n            const edit = this._text.read(reader);\n            if (!edit) {\n                return;\n            }\n            this._previewTextModel.setValue(edit);\n        }).recomputeInitiallyAndOnChange(this._store);\n        this._decorations = derived(this, (reader) => {\n            this._setText.read(reader);\n            const position = this._position.read(reader);\n            if (!position) {\n                return { org: [], mod: [] };\n            }\n            const diff = this._diff.read(reader);\n            if (!diff) {\n                return { org: [], mod: [] };\n            }\n            const originalDecorations = [];\n            const modifiedDecorations = [];\n            if (diff.length === 1 && diff[0].innerChanges[0].modifiedRange.equalsRange(this._previewTextModel.getFullModelRange())) {\n                return { org: [], mod: [] };\n            }\n            const shift = this._shift.get();\n            const moveRange = (range) => {\n                return new Range(range.startLineNumber + position.top - 1, range.startColumn + shift, range.endLineNumber + position.top - 1, range.endColumn + shift);\n            };\n            for (const m of diff) {\n                if (!m.original.isEmpty) {\n                    originalDecorations.push({ range: moveRange(m.original.toInclusiveRange()), options: diffLineDeleteDecorationBackgroundWithIndicator });\n                }\n                if (!m.modified.isEmpty) {\n                    modifiedDecorations.push({ range: m.modified.toInclusiveRange(), options: diffLineAddDecorationBackgroundWithIndicator });\n                }\n                if (m.modified.isEmpty || m.original.isEmpty) {\n                    if (!m.original.isEmpty) {\n                        originalDecorations.push({ range: moveRange(m.original.toInclusiveRange()), options: diffWholeLineDeleteDecoration });\n                    }\n                    if (!m.modified.isEmpty) {\n                        modifiedDecorations.push({ range: m.modified.toInclusiveRange(), options: diffWholeLineAddDecoration });\n                    }\n                }\n                else {\n                    for (const i of m.innerChanges || []) {\n                        // Don't show empty markers outside the line range\n                        if (m.original.contains(i.originalRange.startLineNumber)) {\n                            originalDecorations.push({ range: moveRange(i.originalRange), options: i.originalRange.isEmpty() ? diffDeleteDecorationEmpty : diffDeleteDecoration });\n                        }\n                        if (m.modified.contains(i.modifiedRange.startLineNumber)) {\n                            modifiedDecorations.push({ range: i.modifiedRange, options: i.modifiedRange.isEmpty() ? diffAddDecorationEmpty : diffAddDecoration });\n                        }\n                    }\n                }\n            }\n            return { org: originalDecorations, mod: modifiedDecorations };\n        });\n        this._originalDecorations = derived(this, reader => {\n            return this._decorations.read(reader).org;\n        });\n        this._modifiedDecorations = derived(this, reader => {\n            return this._decorations.read(reader).mod;\n        });\n        this._previewEditor.setModel(this._previewTextModel);\n        this._register(this._editorObs.setDecorations(this._originalDecorations));\n        this._register(this._previewEditorObs.setDecorations(this._modifiedDecorations));\n        this._register(autorun(reader => {\n            const width = this._previewEditorObs.contentWidth.read(reader);\n            const lines = this._text.read(reader).split('\\n').length - 1;\n            const height = this._editor.getOption(67 /* EditorOption.lineHeight */) * lines;\n            if (width <= 0) {\n                return;\n            }\n            this._previewEditor.layout({ height: height, width: width });\n        }));\n        this._register(autorun(reader => {\n            /** @description update position */\n            this._position.read(reader);\n            this._editor.layoutOverlayWidget(this);\n        }));\n        this._register(autorun(reader => {\n            /** @description scroll change */\n            this._scrollChanged.read(reader);\n            const position = this._position.read(reader);\n            if (!position) {\n                return;\n            }\n            this._editor.layoutOverlayWidget(this);\n        }));\n    }\n    getId() { return this.id; }\n    getDomNode() {\n        return this._nodes;\n    }\n    getPosition() {\n        const position = this._position.get();\n        if (!position) {\n            return null;\n        }\n        const layoutInfo = this._editor.getLayoutInfo();\n        const visibPos = this._editor.getScrolledVisiblePosition(new Position(position.top, 1));\n        if (!visibPos) {\n            return null;\n        }\n        const top = visibPos.top - 1; //-1 to offset the border width\n        const offset = this._editor.getOffsetForColumn(position.left.lineNumber, position.left.column);\n        const left = layoutInfo.contentLeft + offset + 10;\n        return {\n            preference: {\n                left,\n                top,\n            }\n        };\n    }\n};\nInlineEditSideBySideContentWidget = InlineEditSideBySideContentWidget_1 = __decorate([\n    __param(5, IInstantiationService)\n], InlineEditSideBySideContentWidget);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InlineEditController_1;\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, constObservable, observableFromEvent, observableSignalFromEvent, observableValue, transaction } from '../../../../base/common/observable.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { GhostTextWidget } from './ghostTextWidget.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { InlineEditTriggerKind } from '../../../common/languages.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { GhostText, GhostTextPart } from '../../inlineCompletions/browser/model/ghostText.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { InlineEditHintsWidget } from './inlineEditHintsWidget.js';\nimport { createStyleSheet2 } from '../../../../base/browser/dom.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { derivedDisposable } from '../../../../base/common/observableInternal/derived.js';\nimport { InlineEditSideBySideWidget } from './inlineEditSideBySideWidget.js';\nimport { IDiffProviderFactoryService } from '../../../browser/widget/diffEditor/diffProviderFactoryService.js';\nimport { IModelService } from '../../../common/services/model.js';\nlet InlineEditController = class InlineEditController extends Disposable {\n    static { InlineEditController_1 = this; }\n    static { this.ID = 'editor.contrib.inlineEditController'; }\n    static { this.inlineEditVisibleKey = 'inlineEditVisible'; }\n    static { this.inlineEditVisibleContext = new RawContextKey(this.inlineEditVisibleKey, false); }\n    static { this.cursorAtInlineEditKey = 'cursorAtInlineEdit'; }\n    static { this.cursorAtInlineEditContext = new RawContextKey(this.cursorAtInlineEditKey, false); }\n    static get(editor) {\n        return editor.getContribution(InlineEditController_1.ID);\n    }\n    constructor(editor, instantiationService, contextKeyService, languageFeaturesService, _commandService, _configurationService, _diffProviderFactoryService, _modelService) {\n        super();\n        this.editor = editor;\n        this.instantiationService = instantiationService;\n        this.contextKeyService = contextKeyService;\n        this.languageFeaturesService = languageFeaturesService;\n        this._commandService = _commandService;\n        this._configurationService = _configurationService;\n        this._diffProviderFactoryService = _diffProviderFactoryService;\n        this._modelService = _modelService;\n        this._isVisibleContext = InlineEditController_1.inlineEditVisibleContext.bindTo(this.contextKeyService);\n        this._isCursorAtInlineEditContext = InlineEditController_1.cursorAtInlineEditContext.bindTo(this.contextKeyService);\n        this._currentEdit = observableValue(this, undefined);\n        this._currentWidget = derivedDisposable(this._currentEdit, (reader) => {\n            const edit = this._currentEdit.read(reader);\n            if (!edit) {\n                return undefined;\n            }\n            const line = edit.range.endLineNumber;\n            const column = edit.range.endColumn;\n            const textToDisplay = edit.text.endsWith('\\n') && !(edit.range.startLineNumber === edit.range.endLineNumber && edit.range.startColumn === edit.range.endColumn) ? edit.text.slice(0, -1) : edit.text;\n            const ghostText = new GhostText(line, [new GhostTextPart(column, textToDisplay, false)]);\n            //only show ghost text for single line edits\n            //unless it is a pure removal\n            //multi line edits are shown in the side by side widget\n            const isSingleLine = edit.range.startLineNumber === edit.range.endLineNumber && ghostText.parts.length === 1 && ghostText.parts[0].lines.length === 1;\n            const isPureRemoval = edit.text === '';\n            if (!isSingleLine && !isPureRemoval) {\n                return undefined;\n            }\n            const instance = this.instantiationService.createInstance(GhostTextWidget, this.editor, {\n                ghostText: constObservable(ghostText),\n                minReservedLineCount: constObservable(0),\n                targetTextModel: constObservable(this.editor.getModel() ?? undefined),\n                range: constObservable(edit.range)\n            });\n            return instance;\n        });\n        this._isAccepting = observableValue(this, false);\n        this._enabled = observableFromEvent(this, this.editor.onDidChangeConfiguration, () => this.editor.getOption(63 /* EditorOption.inlineEdit */).enabled);\n        this._fontFamily = observableFromEvent(this, this.editor.onDidChangeConfiguration, () => this.editor.getOption(63 /* EditorOption.inlineEdit */).fontFamily);\n        //Automatically request inline edit when the content was changed\n        //Cancel the previous request if there is one\n        //Remove the previous ghost text\n        const modelChangedSignal = observableSignalFromEvent('InlineEditController.modelContentChangedSignal', editor.onDidChangeModelContent);\n        this._register(autorun(reader => {\n            /** @description InlineEditController.modelContentChanged model */\n            if (!this._enabled.read(reader)) {\n                return;\n            }\n            modelChangedSignal.read(reader);\n            if (this._isAccepting.read(reader)) {\n                return;\n            }\n            this.getInlineEdit(editor, true);\n        }));\n        //Check if the cursor is at the ghost text\n        const cursorPosition = observableFromEvent(this, editor.onDidChangeCursorPosition, () => editor.getPosition());\n        this._register(autorun(reader => {\n            /** @description InlineEditController.cursorPositionChanged model */\n            if (!this._enabled.read(reader)) {\n                return;\n            }\n            const pos = cursorPosition.read(reader);\n            if (pos) {\n                this.checkCursorPosition(pos);\n            }\n        }));\n        //Perform stuff when the current edit has changed\n        this._register(autorun((reader) => {\n            /** @description InlineEditController.update model */\n            const currentEdit = this._currentEdit.read(reader);\n            this._isCursorAtInlineEditContext.set(false);\n            if (!currentEdit) {\n                this._isVisibleContext.set(false);\n                return;\n            }\n            this._isVisibleContext.set(true);\n            const pos = editor.getPosition();\n            if (pos) {\n                this.checkCursorPosition(pos);\n            }\n        }));\n        //Clear suggestions on lost focus\n        const editorBlurSingal = observableSignalFromEvent('InlineEditController.editorBlurSignal', editor.onDidBlurEditorWidget);\n        this._register(autorun(async (reader) => {\n            /** @description InlineEditController.editorBlur */\n            if (!this._enabled.read(reader)) {\n                return;\n            }\n            editorBlurSingal.read(reader);\n            // This is a hidden setting very useful for debugging\n            if (this._configurationService.getValue('editor.experimentalInlineEdit.keepOnBlur') || editor.getOption(63 /* EditorOption.inlineEdit */).keepOnBlur) {\n                return;\n            }\n            this._currentRequestCts?.dispose(true);\n            this._currentRequestCts = undefined;\n            await this.clear(false);\n        }));\n        //Invoke provider on focus\n        const editorFocusSignal = observableSignalFromEvent('InlineEditController.editorFocusSignal', editor.onDidFocusEditorText);\n        this._register(autorun(reader => {\n            /** @description InlineEditController.editorFocus */\n            if (!this._enabled.read(reader)) {\n                return;\n            }\n            editorFocusSignal.read(reader);\n            this.getInlineEdit(editor, true);\n        }));\n        //handle changes of font setting\n        const styleElement = this._register(createStyleSheet2());\n        this._register(autorun(reader => {\n            const fontFamily = this._fontFamily.read(reader);\n            styleElement.setStyle(fontFamily === '' || fontFamily === 'default' ? `` : `\n.monaco-editor .inline-edit-decoration,\n.monaco-editor .inline-edit-decoration-preview,\n.monaco-editor .inline-edit {\n\tfont-family: ${fontFamily};\n}`);\n        }));\n        this._register(new InlineEditHintsWidget(this.editor, this._currentWidget, this.instantiationService));\n        this._register(new InlineEditSideBySideWidget(this.editor, this._currentEdit, this.instantiationService, this._diffProviderFactoryService, this._modelService));\n    }\n    checkCursorPosition(position) {\n        if (!this._currentEdit) {\n            this._isCursorAtInlineEditContext.set(false);\n            return;\n        }\n        const gt = this._currentEdit.get();\n        if (!gt) {\n            this._isCursorAtInlineEditContext.set(false);\n            return;\n        }\n        this._isCursorAtInlineEditContext.set(Range.containsPosition(gt.range, position));\n    }\n    validateInlineEdit(editor, edit) {\n        //Multiline inline replacing edit must replace whole lines\n        if (edit.text.includes('\\n') && edit.range.startLineNumber !== edit.range.endLineNumber && edit.range.startColumn !== edit.range.endColumn) {\n            const firstColumn = edit.range.startColumn;\n            if (firstColumn !== 1) {\n                return false;\n            }\n            const lastLine = edit.range.endLineNumber;\n            const lastColumn = edit.range.endColumn;\n            const lineLength = editor.getModel()?.getLineLength(lastLine) ?? 0;\n            if (lastColumn !== lineLength + 1) {\n                return false;\n            }\n        }\n        return true;\n    }\n    async fetchInlineEdit(editor, auto) {\n        if (this._currentRequestCts) {\n            this._currentRequestCts.dispose(true);\n        }\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const modelVersion = model.getVersionId();\n        const providers = this.languageFeaturesService.inlineEditProvider.all(model);\n        if (providers.length === 0) {\n            return;\n        }\n        const provider = providers[0];\n        this._currentRequestCts = new CancellationTokenSource();\n        const token = this._currentRequestCts.token;\n        const triggerKind = auto ? InlineEditTriggerKind.Automatic : InlineEditTriggerKind.Invoke;\n        const shouldDebounce = auto;\n        if (shouldDebounce) {\n            await wait(50, token);\n        }\n        if (token.isCancellationRequested || model.isDisposed() || model.getVersionId() !== modelVersion) {\n            return;\n        }\n        const edit = await provider.provideInlineEdit(model, { triggerKind }, token);\n        if (!edit) {\n            return;\n        }\n        if (token.isCancellationRequested || model.isDisposed() || model.getVersionId() !== modelVersion) {\n            return;\n        }\n        if (!this.validateInlineEdit(editor, edit)) {\n            return;\n        }\n        return edit;\n    }\n    async getInlineEdit(editor, auto) {\n        this._isCursorAtInlineEditContext.set(false);\n        await this.clear();\n        const edit = await this.fetchInlineEdit(editor, auto);\n        if (!edit) {\n            return;\n        }\n        this._currentEdit.set(edit, undefined);\n    }\n    async trigger() {\n        await this.getInlineEdit(this.editor, false);\n    }\n    async jumpBack() {\n        if (!this._jumpBackPosition) {\n            return;\n        }\n        this.editor.setPosition(this._jumpBackPosition);\n        //if position is outside viewports, scroll to it\n        this.editor.revealPositionInCenterIfOutsideViewport(this._jumpBackPosition);\n    }\n    async accept() {\n        this._isAccepting.set(true, undefined);\n        const data = this._currentEdit.get();\n        if (!data) {\n            return;\n        }\n        //It should only happen in case of last line suggestion\n        let text = data.text;\n        if (data.text.startsWith('\\n')) {\n            text = data.text.substring(1);\n        }\n        this.editor.pushUndoStop();\n        this.editor.executeEdits('acceptCurrent', [EditOperation.replace(Range.lift(data.range), text)]);\n        if (data.accepted) {\n            await this._commandService\n                .executeCommand(data.accepted.id, ...(data.accepted.arguments || []))\n                .then(undefined, onUnexpectedExternalError);\n        }\n        this.freeEdit(data);\n        transaction((tx) => {\n            this._currentEdit.set(undefined, tx);\n            this._isAccepting.set(false, tx);\n        });\n    }\n    jumpToCurrent() {\n        this._jumpBackPosition = this.editor.getSelection()?.getStartPosition();\n        const data = this._currentEdit.get();\n        if (!data) {\n            return;\n        }\n        const position = Position.lift({ lineNumber: data.range.startLineNumber, column: data.range.startColumn });\n        this.editor.setPosition(position);\n        //if position is outside viewports, scroll to it\n        this.editor.revealPositionInCenterIfOutsideViewport(position);\n    }\n    async clear(sendRejection = true) {\n        const edit = this._currentEdit.get();\n        if (edit && edit?.rejected && sendRejection) {\n            await this._commandService\n                .executeCommand(edit.rejected.id, ...(edit.rejected.arguments || []))\n                .then(undefined, onUnexpectedExternalError);\n        }\n        if (edit) {\n            this.freeEdit(edit);\n        }\n        this._currentEdit.set(undefined, undefined);\n    }\n    freeEdit(edit) {\n        const model = this.editor.getModel();\n        if (!model) {\n            return;\n        }\n        const providers = this.languageFeaturesService.inlineEditProvider.all(model);\n        if (providers.length === 0) {\n            return;\n        }\n        providers[0].freeInlineEdit(edit);\n    }\n};\nInlineEditController = InlineEditController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IContextKeyService),\n    __param(3, ILanguageFeaturesService),\n    __param(4, ICommandService),\n    __param(5, IConfigurationService),\n    __param(6, IDiffProviderFactoryService),\n    __param(7, IModelService)\n], InlineEditController);\nexport { InlineEditController };\nfunction wait(ms, cancellationToken) {\n    return new Promise(resolve => {\n        let d = undefined;\n        const handle = setTimeout(() => {\n            if (d) {\n                d.dispose();\n            }\n            resolve();\n        }, ms);\n        if (cancellationToken) {\n            d = cancellationToken.onCancellationRequested(() => {\n                clearTimeout(handle);\n                if (d) {\n                    d.dispose();\n                }\n                resolve();\n            });\n        }\n    });\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { inlineEditAcceptId, inlineEditJumpBackId, inlineEditJumpToId, inlineEditRejectId } from './commandIds.js';\nimport { InlineEditController } from './inlineEditController.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nexport class AcceptInlineEdit extends EditorAction {\n    constructor() {\n        super({\n            id: inlineEditAcceptId,\n            label: 'Accept Inline Edit',\n            alias: 'Accept Inline Edit',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, InlineEditController.inlineEditVisibleContext),\n            kbOpts: [\n                {\n                    weight: 100 /* KeybindingWeight.EditorContrib */ + 1,\n                    primary: 2 /* KeyCode.Tab */,\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.writable, InlineEditController.inlineEditVisibleContext, InlineEditController.cursorAtInlineEditContext)\n                }\n            ],\n            menuOpts: [{\n                    menuId: MenuId.InlineEditToolbar,\n                    title: 'Accept',\n                    group: 'primary',\n                    order: 1,\n                }],\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineEditController.get(editor);\n        await controller?.accept();\n    }\n}\nexport class TriggerInlineEdit extends EditorAction {\n    constructor() {\n        const activeExpr = ContextKeyExpr.and(EditorContextKeys.writable, ContextKeyExpr.not(InlineEditController.inlineEditVisibleKey));\n        super({\n            id: 'editor.action.inlineEdit.trigger',\n            label: 'Trigger Inline Edit',\n            alias: 'Trigger Inline Edit',\n            precondition: activeExpr,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */ + 1,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 86 /* KeyCode.Equal */,\n                kbExpr: activeExpr\n            },\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineEditController.get(editor);\n        controller?.trigger();\n    }\n}\nexport class JumpToInlineEdit extends EditorAction {\n    constructor() {\n        const activeExpr = ContextKeyExpr.and(EditorContextKeys.writable, InlineEditController.inlineEditVisibleContext, ContextKeyExpr.not(InlineEditController.cursorAtInlineEditKey));\n        super({\n            id: inlineEditJumpToId,\n            label: 'Jump to Inline Edit',\n            alias: 'Jump to Inline Edit',\n            precondition: activeExpr,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */ + 1,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 86 /* KeyCode.Equal */,\n                kbExpr: activeExpr\n            },\n            menuOpts: [{\n                    menuId: MenuId.InlineEditToolbar,\n                    title: 'Jump To Edit',\n                    group: 'primary',\n                    order: 3,\n                    when: activeExpr\n                }],\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineEditController.get(editor);\n        controller?.jumpToCurrent();\n    }\n}\nexport class JumpBackInlineEdit extends EditorAction {\n    constructor() {\n        const activeExpr = ContextKeyExpr.and(EditorContextKeys.writable, InlineEditController.cursorAtInlineEditContext);\n        super({\n            id: inlineEditJumpBackId,\n            label: 'Jump Back from Inline Edit',\n            alias: 'Jump Back from Inline Edit',\n            precondition: activeExpr,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */ + 10,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 86 /* KeyCode.Equal */,\n                kbExpr: activeExpr\n            },\n            menuOpts: [{\n                    menuId: MenuId.InlineEditToolbar,\n                    title: 'Jump Back',\n                    group: 'primary',\n                    order: 3,\n                    when: activeExpr\n                }],\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineEditController.get(editor);\n        controller?.jumpBack();\n    }\n}\nexport class RejectInlineEdit extends EditorAction {\n    constructor() {\n        const activeExpr = ContextKeyExpr.and(EditorContextKeys.writable, InlineEditController.inlineEditVisibleContext);\n        super({\n            id: inlineEditRejectId,\n            label: 'Reject Inline Edit',\n            alias: 'Reject Inline Edit',\n            precondition: activeExpr,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */,\n                primary: 9 /* KeyCode.Escape */,\n                kbExpr: activeExpr\n            },\n            menuOpts: [{\n                    menuId: MenuId.InlineEditToolbar,\n                    title: 'Reject',\n                    group: 'secondary',\n                    order: 2,\n                }],\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineEditController.get(editor);\n        await controller?.clear();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\n// import { HoverParticipantRegistry } from 'vs/editor/contrib/hover/browser/hoverTypes';\nimport { AcceptInlineEdit, JumpBackInlineEdit, JumpToInlineEdit, RejectInlineEdit, TriggerInlineEdit } from './commands.js';\n// import { InlineEditHoverParticipant } from 'vs/editor/contrib/inlineEdit/browser/hoverParticipant';\nimport { InlineEditController } from './inlineEditController.js';\nregisterEditorAction(AcceptInlineEdit);\nregisterEditorAction(RejectInlineEdit);\nregisterEditorAction(JumpToInlineEdit);\nregisterEditorAction(JumpBackInlineEdit);\nregisterEditorAction(TriggerInlineEdit);\nregisterEditorContribution(InlineEditController.ID, InlineEditController, 3 /* EditorContributionInstantiation.Eventually */);\n// HoverParticipantRegistry.register(InlineEditHoverParticipant);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { localize } from '../../../../nls.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nexport const inlineEditAcceptId = 'editor.action.inlineEdits.accept';\nexport const showPreviousInlineEditActionId = 'editor.action.inlineEdits.showPrevious';\nexport const showNextInlineEditActionId = 'editor.action.inlineEdits.showNext';\nexport const inlineEditVisible = new RawContextKey('inlineEditsVisible', false, localize('inlineEditsVisible', \"Whether an inline edit is visible\"));\nexport const isPinnedContextKey = new RawContextKey('inlineEditsIsPinned', false, localize('isPinned', \"Whether an inline edit is visible\"));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { h } from '../../../../base/browser/dom.js';\nimport { structuralEquals } from '../../../../base/common/equals.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, constObservable, derivedObservableWithCache, derivedOpts } from '../../../../base/common/observable.js';\nimport { derivedWithStore } from '../../../../base/common/observableInternal/derived.js';\nimport { observableCodeEditor } from '../../../browser/observableCodeEditor.js';\n/**\n * Use the editor option to set the placeholder text.\n*/\nexport class PlaceholderTextContribution extends Disposable {\n    static { this.ID = 'editor.contrib.placeholderText'; }\n    constructor(_editor) {\n        super();\n        this._editor = _editor;\n        this._editorObs = observableCodeEditor(this._editor);\n        this._placeholderText = this._editorObs.getOption(88 /* EditorOption.placeholder */);\n        this._state = derivedOpts({ owner: this, equalsFn: structuralEquals }, reader => {\n            const p = this._placeholderText.read(reader);\n            if (!p) {\n                return undefined;\n            }\n            if (!this._editorObs.valueIsEmpty.read(reader)) {\n                return undefined;\n            }\n            return { placeholder: p };\n        });\n        this._shouldViewBeAlive = isOrWasTrue(this, reader => this._state.read(reader)?.placeholder !== undefined);\n        this._view = derivedWithStore((reader, store) => {\n            if (!this._shouldViewBeAlive.read(reader)) {\n                return;\n            }\n            const element = h('div.editorPlaceholder');\n            store.add(autorun(reader => {\n                const data = this._state.read(reader);\n                const shouldBeVisibile = data?.placeholder !== undefined;\n                element.root.style.display = shouldBeVisibile ? 'block' : 'none';\n                element.root.innerText = data?.placeholder ?? '';\n            }));\n            store.add(autorun(reader => {\n                const info = this._editorObs.layoutInfo.read(reader);\n                element.root.style.left = `${info.contentLeft}px`;\n                element.root.style.width = (info.contentWidth - info.verticalScrollbarWidth) + 'px';\n                element.root.style.top = `${this._editor.getTopForLineNumber(0)}px`;\n            }));\n            store.add(autorun(reader => {\n                element.root.style.fontFamily = this._editorObs.getOption(49 /* EditorOption.fontFamily */).read(reader);\n                element.root.style.fontSize = this._editorObs.getOption(52 /* EditorOption.fontSize */).read(reader) + 'px';\n                element.root.style.lineHeight = this._editorObs.getOption(67 /* EditorOption.lineHeight */).read(reader) + 'px';\n            }));\n            store.add(this._editorObs.createOverlayWidget({\n                allowEditorOverflow: false,\n                minContentWidthInPx: constObservable(0),\n                position: constObservable(null),\n                domNode: element.root,\n            }));\n        });\n        this._view.recomputeInitiallyAndOnChange(this._store);\n    }\n}\nfunction isOrWasTrue(owner, fn) {\n    return derivedObservableWithCache(owner, (reader, lastValue) => {\n        if (lastValue === true) {\n            return true;\n        }\n        return fn(reader);\n    });\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { h, svgElem } from '../../../../base/browser/dom.js';\nimport { DEFAULT_FONT_FAMILY } from '../../../../base/browser/fonts.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { autorun, constObservable, derived } from '../../../../base/common/observable.js';\nimport { derivedWithSetter } from '../../../../base/common/observableInternal/derived.js';\nimport './inlineEditsWidget.css';\nimport { EditorExtensionsRegistry } from '../../../browser/editorExtensions.js';\nimport { observableCodeEditor } from '../../../browser/observableCodeEditor.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/codeEditor/embeddedCodeEditorWidget.js';\nimport { diffAddDecoration, diffAddDecorationEmpty, diffDeleteDecoration, diffDeleteDecorationEmpty, diffLineAddDecorationBackgroundWithIndicator, diffLineDeleteDecorationBackgroundWithIndicator, diffWholeLineAddDecoration, diffWholeLineDeleteDecoration } from '../../../browser/widget/diffEditor/registrations.contribution.js';\nimport { appendRemoveOnDispose, applyStyle } from '../../../browser/widget/diffEditor/utils.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../../../common/languages/modesRegistry.js';\nimport { TextModel } from '../../../common/model/textModel.js';\nimport { ContextMenuController } from '../../contextmenu/browser/contextmenu.js';\nimport { PlaceholderTextContribution } from '../../placeholderText/browser/placeholderTextContribution.js';\nimport { SuggestController } from '../../suggest/browser/suggestController.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nexport class InlineEdit {\n    constructor(range, newLines, changes) {\n        this.range = range;\n        this.newLines = newLines;\n        this.changes = changes;\n    }\n}\nlet InlineEditsWidget = class InlineEditsWidget extends Disposable {\n    constructor(_editor, _edit, _userPrompt, _instantiationService) {\n        super();\n        this._editor = _editor;\n        this._edit = _edit;\n        this._userPrompt = _userPrompt;\n        this._instantiationService = _instantiationService;\n        this._editorObs = observableCodeEditor(this._editor);\n        this._elements = h('div.inline-edits-widget', {\n            style: {\n                position: 'absolute',\n                overflow: 'visible',\n                top: '0px',\n                left: '0px',\n            },\n        }, [\n            h('div@editorContainer', { style: { position: 'absolute', top: '0px', left: '0px', width: '500px', height: '500px', } }, [\n                h('div.toolbar@toolbar', { style: { position: 'absolute', top: '-25px', left: '0px' } }),\n                h('div.promptEditor@promptEditor', { style: { position: 'absolute', top: '-25px', left: '80px', width: '300px', height: '22px' } }),\n                h('div.preview@editor', { style: { position: 'absolute', top: '0px', left: '0px' } }),\n            ]),\n            svgElem('svg', { style: { overflow: 'visible', pointerEvents: 'none' }, }, [\n                svgElem('defs', [\n                    svgElem('linearGradient', {\n                        id: 'Gradient2',\n                        x1: '0',\n                        y1: '0',\n                        x2: '1',\n                        y2: '0',\n                    }, [\n                        /*svgElem('stop', { offset: '0%', class: 'gradient-start', }),\n                        svgElem('stop', { offset: '0%', class: 'gradient-start', }),\n                        svgElem('stop', { offset: '20%', class: 'gradient-stop', }),*/\n                        svgElem('stop', { offset: '0%', class: 'gradient-stop', }),\n                        svgElem('stop', { offset: '100%', class: 'gradient-stop', }),\n                    ]),\n                ]),\n                svgElem('path@path', {\n                    d: '',\n                    fill: 'url(#Gradient2)',\n                }),\n            ]),\n        ]);\n        this._previewTextModel = this._register(this._instantiationService.createInstance(TextModel, '', PLAINTEXT_LANGUAGE_ID, TextModel.DEFAULT_CREATION_OPTIONS, null));\n        this._setText = derived(reader => {\n            const edit = this._edit.read(reader);\n            if (!edit) {\n                return;\n            }\n            this._previewTextModel.setValue(edit.newLines.join('\\n'));\n        }).recomputeInitiallyAndOnChange(this._store);\n        this._promptTextModel = this._register(this._instantiationService.createInstance(TextModel, '', PLAINTEXT_LANGUAGE_ID, TextModel.DEFAULT_CREATION_OPTIONS, null));\n        this._promptEditor = this._register(this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._elements.promptEditor, {\n            glyphMargin: false,\n            lineNumbers: 'off',\n            minimap: { enabled: false },\n            guides: {\n                indentation: false,\n                bracketPairs: false,\n                bracketPairsHorizontal: false,\n                highlightActiveIndentation: false,\n            },\n            folding: false,\n            selectOnLineNumbers: false,\n            selectionHighlight: false,\n            columnSelection: false,\n            overviewRulerBorder: false,\n            overviewRulerLanes: 0,\n            lineDecorationsWidth: 0,\n            lineNumbersMinChars: 0,\n            placeholder: 'Describe the change you want...',\n            fontFamily: DEFAULT_FONT_FAMILY,\n        }, {\n            contributions: EditorExtensionsRegistry.getSomeEditorContributions([\n                SuggestController.ID,\n                PlaceholderTextContribution.ID,\n                ContextMenuController.ID,\n            ]),\n            isSimpleWidget: true\n        }, this._editor));\n        this._previewEditor = this._register(this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._elements.editor, {\n            glyphMargin: false,\n            lineNumbers: 'off',\n            minimap: { enabled: false },\n            guides: {\n                indentation: false,\n                bracketPairs: false,\n                bracketPairsHorizontal: false,\n                highlightActiveIndentation: false,\n            },\n            folding: false,\n            selectOnLineNumbers: false,\n            selectionHighlight: false,\n            columnSelection: false,\n            overviewRulerBorder: false,\n            overviewRulerLanes: 0,\n            lineDecorationsWidth: 0,\n            lineNumbersMinChars: 0,\n        }, { contributions: [], }, this._editor));\n        this._previewEditorObs = observableCodeEditor(this._previewEditor);\n        this._decorations = derived(this, (reader) => {\n            this._setText.read(reader);\n            const diff = this._edit.read(reader)?.changes;\n            if (!diff) {\n                return [];\n            }\n            const originalDecorations = [];\n            const modifiedDecorations = [];\n            if (diff.length === 1 && diff[0].innerChanges[0].modifiedRange.equalsRange(this._previewTextModel.getFullModelRange())) {\n                return [];\n            }\n            for (const m of diff) {\n                if (!m.original.isEmpty) {\n                    originalDecorations.push({ range: m.original.toInclusiveRange(), options: diffLineDeleteDecorationBackgroundWithIndicator });\n                }\n                if (!m.modified.isEmpty) {\n                    modifiedDecorations.push({ range: m.modified.toInclusiveRange(), options: diffLineAddDecorationBackgroundWithIndicator });\n                }\n                if (m.modified.isEmpty || m.original.isEmpty) {\n                    if (!m.original.isEmpty) {\n                        originalDecorations.push({ range: m.original.toInclusiveRange(), options: diffWholeLineDeleteDecoration });\n                    }\n                    if (!m.modified.isEmpty) {\n                        modifiedDecorations.push({ range: m.modified.toInclusiveRange(), options: diffWholeLineAddDecoration });\n                    }\n                }\n                else {\n                    for (const i of m.innerChanges || []) {\n                        // Don't show empty markers outside the line range\n                        if (m.original.contains(i.originalRange.startLineNumber)) {\n                            originalDecorations.push({ range: i.originalRange, options: i.originalRange.isEmpty() ? diffDeleteDecorationEmpty : diffDeleteDecoration });\n                        }\n                        if (m.modified.contains(i.modifiedRange.startLineNumber)) {\n                            modifiedDecorations.push({ range: i.modifiedRange, options: i.modifiedRange.isEmpty() ? diffAddDecorationEmpty : diffAddDecoration });\n                        }\n                    }\n                }\n            }\n            return modifiedDecorations;\n        });\n        this._layout1 = derived(this, reader => {\n            const model = this._editor.getModel();\n            const inlineEdit = this._edit.read(reader);\n            if (!inlineEdit) {\n                return null;\n            }\n            const range = inlineEdit.range;\n            let maxLeft = 0;\n            for (let i = range.startLineNumber; i < range.endLineNumberExclusive; i++) {\n                const column = model.getLineMaxColumn(i);\n                const left = this._editor.getOffsetForColumn(i, column);\n                maxLeft = Math.max(maxLeft, left);\n            }\n            const layoutInfo = this._editor.getLayoutInfo();\n            const contentLeft = layoutInfo.contentLeft;\n            return { left: contentLeft + maxLeft };\n        });\n        this._layout = derived(this, (reader) => {\n            const inlineEdit = this._edit.read(reader);\n            if (!inlineEdit) {\n                return null;\n            }\n            const range = inlineEdit.range;\n            const scrollLeft = this._editorObs.scrollLeft.read(reader);\n            const left = this._layout1.read(reader).left + 20 - scrollLeft;\n            const selectionTop = this._editor.getTopForLineNumber(range.startLineNumber) - this._editorObs.scrollTop.read(reader);\n            const selectionBottom = this._editor.getTopForLineNumber(range.endLineNumberExclusive) - this._editorObs.scrollTop.read(reader);\n            const topCode = new Point(left, selectionTop);\n            const bottomCode = new Point(left, selectionBottom);\n            const codeHeight = selectionBottom - selectionTop;\n            const codeEditDist = 50;\n            const editHeight = this._editor.getOption(67 /* EditorOption.lineHeight */) * inlineEdit.newLines.length;\n            const difference = codeHeight - editHeight;\n            const topEdit = new Point(left + codeEditDist, selectionTop + (difference / 2));\n            const bottomEdit = new Point(left + codeEditDist, selectionBottom - (difference / 2));\n            return {\n                topCode,\n                bottomCode,\n                codeHeight,\n                topEdit,\n                bottomEdit,\n                editHeight,\n            };\n        });\n        const visible = derived(this, reader => this._edit.read(reader) !== undefined || this._userPrompt.read(reader) !== undefined);\n        this._register(applyStyle(this._elements.root, {\n            display: derived(this, reader => visible.read(reader) ? 'block' : 'none')\n        }));\n        this._register(appendRemoveOnDispose(this._editor.getDomNode(), this._elements.root));\n        this._register(observableCodeEditor(_editor).createOverlayWidget({\n            domNode: this._elements.root,\n            position: constObservable(null),\n            allowEditorOverflow: false,\n            minContentWidthInPx: derived(reader => {\n                const x = this._layout1.read(reader)?.left;\n                if (x === undefined) {\n                    return 0;\n                }\n                const width = this._previewEditorObs.contentWidth.read(reader);\n                return x + width;\n            }),\n        }));\n        this._previewEditor.setModel(this._previewTextModel);\n        this._register(this._previewEditorObs.setDecorations(this._decorations));\n        this._register(autorun(reader => {\n            const layoutInfo = this._layout.read(reader);\n            if (!layoutInfo) {\n                return;\n            }\n            const { topCode, bottomCode, topEdit, bottomEdit, editHeight } = layoutInfo;\n            const straightWidthCode = 10;\n            const straightWidthEdit = 0;\n            const bezierDist = 40;\n            const path = new PathBuilder()\n                .moveTo(topCode)\n                .lineTo(topCode.deltaX(straightWidthCode))\n                .curveTo(topCode.deltaX(straightWidthCode + bezierDist), topEdit.deltaX(-bezierDist - straightWidthEdit), topEdit.deltaX(-straightWidthEdit))\n                .lineTo(topEdit)\n                .lineTo(bottomEdit)\n                .lineTo(bottomEdit.deltaX(-straightWidthEdit))\n                .curveTo(bottomEdit.deltaX(-bezierDist - straightWidthEdit), bottomCode.deltaX(straightWidthCode + bezierDist), bottomCode.deltaX(straightWidthCode))\n                .lineTo(bottomCode)\n                .build();\n            this._elements.path.setAttribute('d', path);\n            this._elements.editorContainer.style.top = `${topEdit.y}px`;\n            this._elements.editorContainer.style.left = `${topEdit.x}px`;\n            this._elements.editorContainer.style.height = `${editHeight}px`;\n            const width = this._previewEditorObs.contentWidth.read(reader);\n            this._previewEditor.layout({ height: editHeight, width });\n        }));\n        this._promptEditor.setModel(this._promptTextModel);\n        this._promptEditor.layout();\n        this._register(createTwoWaySync(mapSettableObservable(this._userPrompt, v => v ?? '', v => v), observableCodeEditor(this._promptEditor).value));\n        this._register(autorun(reader => {\n            const isFocused = observableCodeEditor(this._promptEditor).isFocused.read(reader);\n            this._elements.root.classList.toggle('focused', isFocused);\n        }));\n    }\n};\nInlineEditsWidget = __decorate([\n    __param(3, IInstantiationService)\n], InlineEditsWidget);\nexport { InlineEditsWidget };\nfunction mapSettableObservable(obs, fn1, fn2) {\n    return derivedWithSetter(undefined, reader => fn1(obs.read(reader)), (value, tx) => obs.set(fn2(value), tx));\n}\nclass Point {\n    constructor(x, y) {\n        this.x = x;\n        this.y = y;\n    }\n    deltaX(delta) {\n        return new Point(this.x + delta, this.y);\n    }\n}\nclass PathBuilder {\n    constructor() {\n        this._data = '';\n    }\n    moveTo(point) {\n        this._data += `M ${point.x} ${point.y} `;\n        return this;\n    }\n    lineTo(point) {\n        this._data += `L ${point.x} ${point.y} `;\n        return this;\n    }\n    curveTo(cp1, cp2, to) {\n        this._data += `C ${cp1.x} ${cp1.y} ${cp2.x} ${cp2.y} ${to.x} ${to.y} `;\n        return this;\n    }\n    build() {\n        return this._data;\n    }\n}\nfunction createTwoWaySync(main, target) {\n    const store = new DisposableStore();\n    store.add(autorun(reader => {\n        const value = main.read(reader);\n        target.set(value, undefined);\n    }));\n    store.add(autorun(reader => {\n        const value = target.read(reader);\n        main.set(value, undefined);\n    }));\n    return store;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InlineEditsModel_1;\nimport { timeout } from '../../../../base/common/async.js';\nimport { CancellationToken, cancelOnDispose } from '../../../../base/common/cancellation.js';\nimport { itemsEquals, structuralEquals } from '../../../../base/common/equals.js';\nimport { BugIndicatingError } from '../../../../base/common/errors.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { ObservablePromise, derived, derivedHandleChanges, derivedOpts, disposableObservableValue, observableSignal, observableValue, recomputeInitiallyAndOnChange, subtransaction } from '../../../../base/common/observable.js';\nimport { derivedDisposable } from '../../../../base/common/observableInternal/derived.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IDiffProviderFactoryService } from '../../../browser/widget/diffEditor/diffProviderFactoryService.js';\nimport { LineRange } from '../../../common/core/lineRange.js';\nimport { InlineCompletionTriggerKind } from '../../../common/languages.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { provideInlineCompletions } from '../../inlineCompletions/browser/model/provideInlineCompletions.js';\nimport { InlineEdit } from './inlineEditsWidget.js';\nlet InlineEditsModel = class InlineEditsModel extends Disposable {\n    static { InlineEditsModel_1 = this; }\n    static { this._modelId = 0; }\n    static _createUniqueUri() {\n        return URI.from({ scheme: 'inline-edits', path: new Date().toString() + String(InlineEditsModel_1._modelId++) });\n    }\n    constructor(textModel, _textModelVersionId, _selection, _debounceValue, languageFeaturesService, _diffProviderFactoryService, _modelService) {\n        super();\n        this.textModel = textModel;\n        this._textModelVersionId = _textModelVersionId;\n        this._selection = _selection;\n        this._debounceValue = _debounceValue;\n        this.languageFeaturesService = languageFeaturesService;\n        this._diffProviderFactoryService = _diffProviderFactoryService;\n        this._modelService = _modelService;\n        this._forceUpdateExplicitlySignal = observableSignal(this);\n        // We use a semantic id to keep the same inline completion selected even if the provider reorders the completions.\n        this._selectedInlineCompletionId = observableValue(this, undefined);\n        this._isActive = observableValue(this, false);\n        this._originalModel = derivedDisposable(() => this._modelService.createModel('', null, InlineEditsModel_1._createUniqueUri())).keepObserved(this._store);\n        this._modifiedModel = derivedDisposable(() => this._modelService.createModel('', null, InlineEditsModel_1._createUniqueUri())).keepObserved(this._store);\n        this._pinnedRange = new TrackedRange(this.textModel, this._textModelVersionId);\n        this.isPinned = this._pinnedRange.range.map(range => !!range);\n        this.userPrompt = observableValue(this, undefined);\n        this.inlineEdit = derived(this, reader => {\n            return this._inlineEdit.read(reader)?.promiseResult.read(reader)?.data;\n        });\n        this._inlineEdit = derived(this, reader => {\n            const edit = this.selectedInlineEdit.read(reader);\n            if (!edit) {\n                return undefined;\n            }\n            const range = edit.inlineCompletion.range;\n            if (edit.inlineCompletion.insertText.trim() === '') {\n                return undefined;\n            }\n            let newLines = edit.inlineCompletion.insertText.split(/\\r\\n|\\r|\\n/);\n            function removeIndentation(lines) {\n                const indentation = lines[0].match(/^\\s*/)?.[0] ?? '';\n                return lines.map(l => l.replace(new RegExp('^' + indentation), ''));\n            }\n            newLines = removeIndentation(newLines);\n            const existing = this.textModel.getValueInRange(range);\n            let existingLines = existing.split(/\\r\\n|\\r|\\n/);\n            existingLines = removeIndentation(existingLines);\n            this._originalModel.get().setValue(existingLines.join('\\n'));\n            this._modifiedModel.get().setValue(newLines.join('\\n'));\n            const d = this._diffProviderFactoryService.createDiffProvider({ diffAlgorithm: 'advanced' });\n            return ObservablePromise.fromFn(async () => {\n                const result = await d.computeDiff(this._originalModel.get(), this._modifiedModel.get(), {\n                    computeMoves: false,\n                    ignoreTrimWhitespace: false,\n                    maxComputationTimeMs: 1000,\n                }, CancellationToken.None);\n                if (result.identical) {\n                    return undefined;\n                }\n                return new InlineEdit(LineRange.fromRangeInclusive(range), removeIndentation(newLines), result.changes);\n            });\n        });\n        this._fetchStore = this._register(new DisposableStore());\n        this._inlineEditsFetchResult = disposableObservableValue(this, undefined);\n        this._inlineEdits = derivedOpts({ owner: this, equalsFn: structuralEquals }, reader => {\n            return this._inlineEditsFetchResult.read(reader)?.completions.map(c => new InlineEditData(c)) ?? [];\n        });\n        this._fetchInlineEditsPromise = derivedHandleChanges({\n            owner: this,\n            createEmptyChangeSummary: () => ({\n                inlineCompletionTriggerKind: InlineCompletionTriggerKind.Automatic\n            }),\n            handleChange: (ctx, changeSummary) => {\n                /** @description fetch inline completions */\n                if (ctx.didChange(this._forceUpdateExplicitlySignal)) {\n                    changeSummary.inlineCompletionTriggerKind = InlineCompletionTriggerKind.Explicit;\n                }\n                return true;\n            },\n        }, async (reader, changeSummary) => {\n            this._fetchStore.clear();\n            this._forceUpdateExplicitlySignal.read(reader);\n            /*if (!this._isActive.read(reader)) {\n                return undefined;\n            }*/\n            this._textModelVersionId.read(reader);\n            function mapValue(value, fn) {\n                return fn(value);\n            }\n            const selection = this._pinnedRange.range.read(reader) ?? mapValue(this._selection.read(reader), v => v.isEmpty() ? undefined : v);\n            if (!selection) {\n                this._inlineEditsFetchResult.set(undefined, undefined);\n                this.userPrompt.set(undefined, undefined);\n                return undefined;\n            }\n            const context = {\n                triggerKind: changeSummary.inlineCompletionTriggerKind,\n                selectedSuggestionInfo: undefined,\n                userPrompt: this.userPrompt.read(reader),\n            };\n            const token = cancelOnDispose(this._fetchStore);\n            await timeout(200, token);\n            const result = await provideInlineCompletions(this.languageFeaturesService.inlineCompletionsProvider, selection, this.textModel, context, token);\n            if (token.isCancellationRequested) {\n                return;\n            }\n            this._inlineEditsFetchResult.set(result, undefined);\n        });\n        this._filteredInlineEditItems = derivedOpts({ owner: this, equalsFn: itemsEquals() }, reader => {\n            return this._inlineEdits.read(reader);\n        });\n        this.selectedInlineCompletionIndex = derived(this, (reader) => {\n            const selectedInlineCompletionId = this._selectedInlineCompletionId.read(reader);\n            const filteredCompletions = this._filteredInlineEditItems.read(reader);\n            const idx = this._selectedInlineCompletionId === undefined ? -1\n                : filteredCompletions.findIndex(v => v.semanticId === selectedInlineCompletionId);\n            if (idx === -1) {\n                // Reset the selection so that the selection does not jump back when it appears again\n                this._selectedInlineCompletionId.set(undefined, undefined);\n                return 0;\n            }\n            return idx;\n        });\n        this.selectedInlineEdit = derived(this, (reader) => {\n            const filteredCompletions = this._filteredInlineEditItems.read(reader);\n            const idx = this.selectedInlineCompletionIndex.read(reader);\n            return filteredCompletions[idx];\n        });\n        this._register(recomputeInitiallyAndOnChange(this._fetchInlineEditsPromise));\n    }\n    async triggerExplicitly(tx) {\n        subtransaction(tx, tx => {\n            this._isActive.set(true, tx);\n            this._forceUpdateExplicitlySignal.trigger(tx);\n        });\n        await this._fetchInlineEditsPromise.get();\n    }\n    stop(tx) {\n        subtransaction(tx, tx => {\n            this.userPrompt.set(undefined, tx);\n            this._isActive.set(false, tx);\n            this._inlineEditsFetchResult.set(undefined, tx);\n            this._pinnedRange.setRange(undefined, tx);\n            //this._source.clear(tx);\n        });\n    }\n    async _deltaSelectedInlineCompletionIndex(delta) {\n        await this.triggerExplicitly();\n        const completions = this._filteredInlineEditItems.get() || [];\n        if (completions.length > 0) {\n            const newIdx = (this.selectedInlineCompletionIndex.get() + delta + completions.length) % completions.length;\n            this._selectedInlineCompletionId.set(completions[newIdx].semanticId, undefined);\n        }\n        else {\n            this._selectedInlineCompletionId.set(undefined, undefined);\n        }\n    }\n    async next() {\n        await this._deltaSelectedInlineCompletionIndex(1);\n    }\n    async previous() {\n        await this._deltaSelectedInlineCompletionIndex(-1);\n    }\n    async accept(editor) {\n        if (editor.getModel() !== this.textModel) {\n            throw new BugIndicatingError();\n        }\n        const edit = this.selectedInlineEdit.get();\n        if (!edit) {\n            return;\n        }\n        editor.pushUndoStop();\n        editor.executeEdits('inlineSuggestion.accept', [\n            edit.inlineCompletion.toSingleTextEdit().toSingleEditOperation()\n        ]);\n        this.stop();\n    }\n};\nInlineEditsModel = InlineEditsModel_1 = __decorate([\n    __param(4, ILanguageFeaturesService),\n    __param(5, IDiffProviderFactoryService),\n    __param(6, IModelService)\n], InlineEditsModel);\nexport { InlineEditsModel };\nclass InlineEditData {\n    constructor(inlineCompletion) {\n        this.inlineCompletion = inlineCompletion;\n        this.semanticId = this.inlineCompletion.hash();\n    }\n}\nclass TrackedRange extends Disposable {\n    constructor(_textModel, _versionId) {\n        super();\n        this._textModel = _textModel;\n        this._versionId = _versionId;\n        this._decorations = observableValue(this, []);\n        this.range = derived(this, reader => {\n            this._versionId.read(reader);\n            const deco = this._decorations.read(reader)[0];\n            if (!deco) {\n                return null;\n            }\n            return this._textModel.getDecorationRange(deco) ?? null;\n        });\n        this._register(toDisposable(() => {\n            this._textModel.deltaDecorations(this._decorations.get(), []);\n        }));\n    }\n    setRange(range, tx) {\n        this._decorations.set(this._textModel.deltaDecorations(this._decorations.get(), range ? [{ range, options: { description: 'trackedRange' } }] : []), tx);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InlineEditsController_1;\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { derived, derivedObservableWithCache, observableValue } from '../../../../base/common/observable.js';\nimport { derivedDisposable, derivedWithSetter } from '../../../../base/common/observableInternal/derived.js';\nimport { observableCodeEditor } from '../../../browser/observableCodeEditor.js';\nimport { readHotReloadableExport } from '../../../../base/common/hotReloadHelpers.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { inlineEditVisible, isPinnedContextKey } from './consts.js';\nimport { InlineEditsModel } from './inlineEditsModel.js';\nimport { InlineEditsWidget } from './inlineEditsWidget.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { bindContextKey, observableConfigValue } from '../../../../platform/observable/common/platformObservableUtils.js';\nlet InlineEditsController = class InlineEditsController extends Disposable {\n    static { InlineEditsController_1 = this; }\n    static { this.ID = 'editor.contrib.inlineEditsController'; }\n    static get(editor) {\n        return editor.getContribution(InlineEditsController_1.ID);\n    }\n    constructor(editor, _instantiationService, _contextKeyService, _debounceService, _languageFeaturesService, _configurationService) {\n        super();\n        this.editor = editor;\n        this._instantiationService = _instantiationService;\n        this._contextKeyService = _contextKeyService;\n        this._debounceService = _debounceService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._configurationService = _configurationService;\n        this._enabled = observableConfigValue('editor.inlineEdits.enabled', false, this._configurationService);\n        this._editorObs = observableCodeEditor(this.editor);\n        this._selection = derived(this, reader => this._editorObs.cursorSelection.read(reader) ?? new Selection(1, 1, 1, 1));\n        this._debounceValue = this._debounceService.for(this._languageFeaturesService.inlineCompletionsProvider, 'InlineEditsDebounce', { min: 50, max: 50 });\n        this.model = derivedDisposable(this, reader => {\n            if (!this._enabled.read(reader)) {\n                return undefined;\n            }\n            if (this._editorObs.isReadonly.read(reader)) {\n                return undefined;\n            }\n            const textModel = this._editorObs.model.read(reader);\n            if (!textModel) {\n                return undefined;\n            }\n            const model = this._instantiationService.createInstance(readHotReloadableExport(InlineEditsModel, reader), textModel, this._editorObs.versionId, this._selection, this._debounceValue);\n            return model;\n        });\n        this._hadInlineEdit = derivedObservableWithCache(this, (reader, lastValue) => lastValue || this.model.read(reader)?.inlineEdit.read(reader) !== undefined);\n        this._widget = derivedDisposable(this, reader => {\n            if (!this._hadInlineEdit.read(reader)) {\n                return undefined;\n            }\n            return this._instantiationService.createInstance(readHotReloadableExport(InlineEditsWidget, reader), this.editor, this.model.map((m, reader) => m?.inlineEdit.read(reader)), flattenSettableObservable((reader) => this.model.read(reader)?.userPrompt ?? observableValue('empty', '')));\n        });\n        this._register(bindContextKey(inlineEditVisible, this._contextKeyService, r => !!this.model.read(r)?.inlineEdit.read(r)));\n        this._register(bindContextKey(isPinnedContextKey, this._contextKeyService, r => !!this.model.read(r)?.isPinned.read(r)));\n        this.model.recomputeInitiallyAndOnChange(this._store);\n        this._widget.recomputeInitiallyAndOnChange(this._store);\n    }\n};\nInlineEditsController = InlineEditsController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IContextKeyService),\n    __param(3, ILanguageFeatureDebounceService),\n    __param(4, ILanguageFeaturesService),\n    __param(5, IConfigurationService)\n], InlineEditsController);\nexport { InlineEditsController };\nfunction flattenSettableObservable(fn) {\n    return derivedWithSetter(undefined, reader => {\n        const obs = fn(reader);\n        return obs.read(reader);\n    }, (value, tx) => {\n        fn(undefined).set(value, tx);\n    });\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { transaction } from '../../../../base/common/observable.js';\nimport { asyncTransaction } from '../../../../base/common/observableInternal/base.js';\nimport { EditorAction } from '../../../browser/editorExtensions.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/codeEditor/embeddedCodeEditorWidget.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { inlineEditAcceptId, inlineEditVisible, showNextInlineEditActionId, showPreviousInlineEditActionId } from './consts.js';\nimport { InlineEditsController } from './inlineEditsController.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nfunction labelAndAlias(str) {\n    return {\n        label: str.value,\n        alias: str.original,\n    };\n}\nexport class ShowNextInlineEditAction extends EditorAction {\n    static { this.ID = showNextInlineEditActionId; }\n    constructor() {\n        super({\n            id: ShowNextInlineEditAction.ID,\n            ...labelAndAlias(nls.localize2('action.inlineEdits.showNext', \"Show Next Inline Edit\")),\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, inlineEditVisible),\n            kbOpts: {\n                weight: 100,\n                primary: 512 /* KeyMod.Alt */ | 94 /* KeyCode.BracketRight */,\n            },\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineEditsController.get(editor);\n        controller?.model.get()?.next();\n    }\n}\nexport class ShowPreviousInlineEditAction extends EditorAction {\n    static { this.ID = showPreviousInlineEditActionId; }\n    constructor() {\n        super({\n            id: ShowPreviousInlineEditAction.ID,\n            ...labelAndAlias(nls.localize2('action.inlineEdits.showPrevious', \"Show Previous Inline Edit\")),\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, inlineEditVisible),\n            kbOpts: {\n                weight: 100,\n                primary: 512 /* KeyMod.Alt */ | 92 /* KeyCode.BracketLeft */,\n            },\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineEditsController.get(editor);\n        controller?.model.get()?.previous();\n    }\n}\nexport class TriggerInlineEditAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inlineEdits.trigger',\n            ...labelAndAlias(nls.localize2('action.inlineEdits.trigger', \"Trigger Inline Edit\")),\n            precondition: EditorContextKeys.writable\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineEditsController.get(editor);\n        await asyncTransaction(async (tx) => {\n            /** @description triggerExplicitly from command */\n            await controller?.model.get()?.triggerExplicitly(tx);\n        });\n    }\n}\nexport class AcceptInlineEdit extends EditorAction {\n    constructor() {\n        super({\n            id: inlineEditAcceptId,\n            ...labelAndAlias(nls.localize2('action.inlineEdits.accept', \"Accept Inline Edit\")),\n            precondition: inlineEditVisible,\n            menuOpts: {\n                menuId: MenuId.InlineEditsActions,\n                title: nls.localize('inlineEditsActions', \"Accept Inline Edit\"),\n                group: 'primary',\n                order: 1,\n                icon: Codicon.check,\n            },\n            kbOpts: {\n                primary: 2048 /* KeyMod.CtrlCmd */ | 10 /* KeyCode.Space */,\n                weight: 20000,\n                kbExpr: inlineEditVisible,\n            }\n        });\n    }\n    async run(accessor, editor) {\n        if (editor instanceof EmbeddedCodeEditorWidget) {\n            editor = editor.getParentEditor();\n        }\n        const controller = InlineEditsController.get(editor);\n        if (controller) {\n            controller.model.get()?.accept(controller.editor);\n            controller.editor.focus();\n        }\n    }\n}\n/*\nTODO@hediet\nexport class PinInlineEdit extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inlineEdits.pin',\n            ...labelAndAlias(nls.localize2('action.inlineEdits.pin', \"Pin Inline Edit\")),\n            precondition: undefined,\n            kbOpts: {\n                primary: KeyMod.Shift | KeyCode.Space,\n                weight: 20000,\n            }\n        });\n    }\n\n    public async run(accessor: ServicesAccessor | undefined, editor: ICodeEditor): Promise<void> {\n        const controller = InlineEditsController.get(editor);\n        if (controller) {\n            controller.model.get()?.togglePin();\n        }\n    }\n}\n\nMenuRegistry.appendMenuItem(MenuId.InlineEditsActions, {\n    command: {\n        id: 'editor.action.inlineEdits.pin',\n        title: nls.localize('Pin', \"Pin\"),\n        icon: Codicon.pin,\n    },\n    group: 'primary',\n    order: 1,\n    when: isPinnedContextKey.negate(),\n});\n\nMenuRegistry.appendMenuItem(MenuId.InlineEditsActions, {\n    command: {\n        id: 'editor.action.inlineEdits.unpin',\n        title: nls.localize('Unpin', \"Unpin\"),\n        icon: Codicon.pinned,\n    },\n    group: 'primary',\n    order: 1,\n    when: isPinnedContextKey,\n});*/\nexport class HideInlineEdit extends EditorAction {\n    static { this.ID = 'editor.action.inlineEdits.hide'; }\n    constructor() {\n        super({\n            id: HideInlineEdit.ID,\n            ...labelAndAlias(nls.localize2('action.inlineEdits.hide', \"Hide Inline Edit\")),\n            precondition: inlineEditVisible,\n            kbOpts: {\n                weight: 100,\n                primary: 9 /* KeyCode.Escape */,\n            }\n        });\n    }\n    async run(accessor, editor) {\n        const controller = InlineEditsController.get(editor);\n        transaction(tx => {\n            controller?.model.get()?.stop(tx);\n        });\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { TriggerInlineEditAction, ShowNextInlineEditAction, ShowPreviousInlineEditAction, AcceptInlineEdit, HideInlineEdit } from './commands.js';\nimport { InlineEditsController } from './inlineEditsController.js';\nregisterEditorContribution(InlineEditsController.ID, InlineEditsController, 3 /* EditorContributionInstantiation.Eventually */);\nregisterEditorAction(TriggerInlineEditAction);\nregisterEditorAction(ShowNextInlineEditAction);\nregisterEditorAction(ShowPreviousInlineEditAction);\nregisterEditorAction(AcceptInlineEdit);\nregisterEditorAction(HideInlineEdit);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Position } from '../../../common/core/position.js';\nimport * as languages from '../../../common/languages.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nexport const Context = {\n    Visible: new RawContextKey('parameterHintsVisible', false),\n    MultipleSignatures: new RawContextKey('parameterHintsMultipleSignatures', false),\n};\nexport async function provideSignatureHelp(registry, model, position, context, token) {\n    const supports = registry.ordered(model);\n    for (const support of supports) {\n        try {\n            const result = await support.provideSignatureHelp(model, position, token, context);\n            if (result) {\n                return result;\n            }\n        }\n        catch (err) {\n            onUnexpectedExternalError(err);\n        }\n    }\n    return undefined;\n}\nCommandsRegistry.registerCommand('_executeSignatureHelpProvider', async (accessor, ...args) => {\n    const [uri, position, triggerCharacter] = args;\n    assertType(URI.isUri(uri));\n    assertType(Position.isIPosition(position));\n    assertType(typeof triggerCharacter === 'string' || !triggerCharacter);\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const ref = await accessor.get(ITextModelService).createModelReference(uri);\n    try {\n        const result = await provideSignatureHelp(languageFeaturesService.signatureHelpProvider, ref.object.textEditorModel, Position.lift(position), {\n            triggerKind: languages.SignatureHelpTriggerKind.Invoke,\n            isRetrigger: false,\n            triggerCharacter,\n        }, CancellationToken.None);\n        if (!result) {\n            return undefined;\n        }\n        setTimeout(() => result.dispose(), 0);\n        return result.value;\n    }\n    finally {\n        ref.dispose();\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createCancelablePromise, Delayer } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { CharacterSet } from '../../../common/core/characterClassifier.js';\nimport * as languages from '../../../common/languages.js';\nimport { provideSignatureHelp } from './provideSignatureHelp.js';\nvar ParameterHintState;\n(function (ParameterHintState) {\n    ParameterHintState.Default = { type: 0 /* Type.Default */ };\n    class Pending {\n        constructor(request, previouslyActiveHints) {\n            this.request = request;\n            this.previouslyActiveHints = previouslyActiveHints;\n            this.type = 2 /* Type.Pending */;\n        }\n    }\n    ParameterHintState.Pending = Pending;\n    class Active {\n        constructor(hints) {\n            this.hints = hints;\n            this.type = 1 /* Type.Active */;\n        }\n    }\n    ParameterHintState.Active = Active;\n})(ParameterHintState || (ParameterHintState = {}));\nexport class ParameterHintsModel extends Disposable {\n    static { this.DEFAULT_DELAY = 120; } // ms\n    constructor(editor, providers, delay = ParameterHintsModel.DEFAULT_DELAY) {\n        super();\n        this._onChangedHints = this._register(new Emitter());\n        this.onChangedHints = this._onChangedHints.event;\n        this.triggerOnType = false;\n        this._state = ParameterHintState.Default;\n        this._pendingTriggers = [];\n        this._lastSignatureHelpResult = this._register(new MutableDisposable());\n        this.triggerChars = new CharacterSet();\n        this.retriggerChars = new CharacterSet();\n        this.triggerId = 0;\n        this.editor = editor;\n        this.providers = providers;\n        this.throttledDelayer = new Delayer(delay);\n        this._register(this.editor.onDidBlurEditorWidget(() => this.cancel()));\n        this._register(this.editor.onDidChangeConfiguration(() => this.onEditorConfigurationChange()));\n        this._register(this.editor.onDidChangeModel(e => this.onModelChanged()));\n        this._register(this.editor.onDidChangeModelLanguage(_ => this.onModelChanged()));\n        this._register(this.editor.onDidChangeCursorSelection(e => this.onCursorChange(e)));\n        this._register(this.editor.onDidChangeModelContent(e => this.onModelContentChange()));\n        this._register(this.providers.onDidChange(this.onModelChanged, this));\n        this._register(this.editor.onDidType(text => this.onDidType(text)));\n        this.onEditorConfigurationChange();\n        this.onModelChanged();\n    }\n    get state() { return this._state; }\n    set state(value) {\n        if (this._state.type === 2 /* ParameterHintState.Type.Pending */) {\n            this._state.request.cancel();\n        }\n        this._state = value;\n    }\n    cancel(silent = false) {\n        this.state = ParameterHintState.Default;\n        this.throttledDelayer.cancel();\n        if (!silent) {\n            this._onChangedHints.fire(undefined);\n        }\n    }\n    trigger(context, delay) {\n        const model = this.editor.getModel();\n        if (!model || !this.providers.has(model)) {\n            return;\n        }\n        const triggerId = ++this.triggerId;\n        this._pendingTriggers.push(context);\n        this.throttledDelayer.trigger(() => {\n            return this.doTrigger(triggerId);\n        }, delay)\n            .catch(onUnexpectedError);\n    }\n    next() {\n        if (this.state.type !== 1 /* ParameterHintState.Type.Active */) {\n            return;\n        }\n        const length = this.state.hints.signatures.length;\n        const activeSignature = this.state.hints.activeSignature;\n        const last = (activeSignature % length) === (length - 1);\n        const cycle = this.editor.getOption(86 /* EditorOption.parameterHints */).cycle;\n        // If there is only one signature, or we're on last signature of list\n        if ((length < 2 || last) && !cycle) {\n            this.cancel();\n            return;\n        }\n        this.updateActiveSignature(last && cycle ? 0 : activeSignature + 1);\n    }\n    previous() {\n        if (this.state.type !== 1 /* ParameterHintState.Type.Active */) {\n            return;\n        }\n        const length = this.state.hints.signatures.length;\n        const activeSignature = this.state.hints.activeSignature;\n        const first = activeSignature === 0;\n        const cycle = this.editor.getOption(86 /* EditorOption.parameterHints */).cycle;\n        // If there is only one signature, or we're on first signature of list\n        if ((length < 2 || first) && !cycle) {\n            this.cancel();\n            return;\n        }\n        this.updateActiveSignature(first && cycle ? length - 1 : activeSignature - 1);\n    }\n    updateActiveSignature(activeSignature) {\n        if (this.state.type !== 1 /* ParameterHintState.Type.Active */) {\n            return;\n        }\n        this.state = new ParameterHintState.Active({ ...this.state.hints, activeSignature });\n        this._onChangedHints.fire(this.state.hints);\n    }\n    async doTrigger(triggerId) {\n        const isRetrigger = this.state.type === 1 /* ParameterHintState.Type.Active */ || this.state.type === 2 /* ParameterHintState.Type.Pending */;\n        const activeSignatureHelp = this.getLastActiveHints();\n        this.cancel(true);\n        if (this._pendingTriggers.length === 0) {\n            return false;\n        }\n        const context = this._pendingTriggers.reduce(mergeTriggerContexts);\n        this._pendingTriggers = [];\n        const triggerContext = {\n            triggerKind: context.triggerKind,\n            triggerCharacter: context.triggerCharacter,\n            isRetrigger: isRetrigger,\n            activeSignatureHelp: activeSignatureHelp\n        };\n        if (!this.editor.hasModel()) {\n            return false;\n        }\n        const model = this.editor.getModel();\n        const position = this.editor.getPosition();\n        this.state = new ParameterHintState.Pending(createCancelablePromise(token => provideSignatureHelp(this.providers, model, position, triggerContext, token)), activeSignatureHelp);\n        try {\n            const result = await this.state.request;\n            // Check that we are still resolving the correct signature help\n            if (triggerId !== this.triggerId) {\n                result?.dispose();\n                return false;\n            }\n            if (!result || !result.value.signatures || result.value.signatures.length === 0) {\n                result?.dispose();\n                this._lastSignatureHelpResult.clear();\n                this.cancel();\n                return false;\n            }\n            else {\n                this.state = new ParameterHintState.Active(result.value);\n                this._lastSignatureHelpResult.value = result;\n                this._onChangedHints.fire(this.state.hints);\n                return true;\n            }\n        }\n        catch (error) {\n            if (triggerId === this.triggerId) {\n                this.state = ParameterHintState.Default;\n            }\n            onUnexpectedError(error);\n            return false;\n        }\n    }\n    getLastActiveHints() {\n        switch (this.state.type) {\n            case 1 /* ParameterHintState.Type.Active */: return this.state.hints;\n            case 2 /* ParameterHintState.Type.Pending */: return this.state.previouslyActiveHints;\n            default: return undefined;\n        }\n    }\n    get isTriggered() {\n        return this.state.type === 1 /* ParameterHintState.Type.Active */\n            || this.state.type === 2 /* ParameterHintState.Type.Pending */\n            || this.throttledDelayer.isTriggered();\n    }\n    onModelChanged() {\n        this.cancel();\n        this.triggerChars.clear();\n        this.retriggerChars.clear();\n        const model = this.editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const support of this.providers.ordered(model)) {\n            for (const ch of support.signatureHelpTriggerCharacters || []) {\n                if (ch.length) {\n                    const charCode = ch.charCodeAt(0);\n                    this.triggerChars.add(charCode);\n                    // All trigger characters are also considered retrigger characters\n                    this.retriggerChars.add(charCode);\n                }\n            }\n            for (const ch of support.signatureHelpRetriggerCharacters || []) {\n                if (ch.length) {\n                    this.retriggerChars.add(ch.charCodeAt(0));\n                }\n            }\n        }\n    }\n    onDidType(text) {\n        if (!this.triggerOnType) {\n            return;\n        }\n        const lastCharIndex = text.length - 1;\n        const triggerCharCode = text.charCodeAt(lastCharIndex);\n        if (this.triggerChars.has(triggerCharCode) || this.isTriggered && this.retriggerChars.has(triggerCharCode)) {\n            this.trigger({\n                triggerKind: languages.SignatureHelpTriggerKind.TriggerCharacter,\n                triggerCharacter: text.charAt(lastCharIndex),\n            });\n        }\n    }\n    onCursorChange(e) {\n        if (e.source === 'mouse') {\n            this.cancel();\n        }\n        else if (this.isTriggered) {\n            this.trigger({ triggerKind: languages.SignatureHelpTriggerKind.ContentChange });\n        }\n    }\n    onModelContentChange() {\n        if (this.isTriggered) {\n            this.trigger({ triggerKind: languages.SignatureHelpTriggerKind.ContentChange });\n        }\n    }\n    onEditorConfigurationChange() {\n        this.triggerOnType = this.editor.getOption(86 /* EditorOption.parameterHints */).enabled;\n        if (!this.triggerOnType) {\n            this.cancel();\n        }\n    }\n    dispose() {\n        this.cancel(true);\n        super.dispose();\n    }\n}\nfunction mergeTriggerContexts(previous, current) {\n    switch (current.triggerKind) {\n        case languages.SignatureHelpTriggerKind.Invoke:\n            // Invoke overrides previous triggers.\n            return current;\n        case languages.SignatureHelpTriggerKind.ContentChange:\n            // Ignore content changes triggers\n            return previous;\n        case languages.SignatureHelpTriggerKind.TriggerCharacter:\n        default:\n            return current;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ParameterHintsWidget_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport * as aria from '../../../../base/browser/ui/aria/aria.js';\nimport { DomScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { escapeRegExpCharacters } from '../../../../base/common/strings.js';\nimport { assertIsDefined } from '../../../../base/common/types.js';\nimport './parameterHints.css';\nimport { EDITOR_FONT_DEFAULTS } from '../../../common/config/editorOptions.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { MarkdownRenderer } from '../../../browser/widget/markdownRenderer/browser/markdownRenderer.js';\nimport { Context } from './provideSignatureHelp.js';\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { listHighlightForeground, registerColor } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nconst $ = dom.$;\nconst parameterHintsNextIcon = registerIcon('parameter-hints-next', Codicon.chevronDown, nls.localize('parameterHintsNextIcon', 'Icon for show next parameter hint.'));\nconst parameterHintsPreviousIcon = registerIcon('parameter-hints-previous', Codicon.chevronUp, nls.localize('parameterHintsPreviousIcon', 'Icon for show previous parameter hint.'));\nlet ParameterHintsWidget = class ParameterHintsWidget extends Disposable {\n    static { ParameterHintsWidget_1 = this; }\n    static { this.ID = 'editor.widget.parameterHintsWidget'; }\n    constructor(editor, model, contextKeyService, openerService, languageService, telemetryService) {\n        super();\n        this.editor = editor;\n        this.model = model;\n        this.telemetryService = telemetryService;\n        this.renderDisposeables = this._register(new DisposableStore());\n        this.visible = false;\n        this.announcedLabel = null;\n        // Editor.IContentWidget.allowEditorOverflow\n        this.allowEditorOverflow = true;\n        this.markdownRenderer = this._register(new MarkdownRenderer({ editor }, languageService, openerService));\n        this.keyVisible = Context.Visible.bindTo(contextKeyService);\n        this.keyMultipleSignatures = Context.MultipleSignatures.bindTo(contextKeyService);\n    }\n    createParameterHintDOMNodes() {\n        const element = $('.editor-widget.parameter-hints-widget');\n        const wrapper = dom.append(element, $('.phwrapper'));\n        wrapper.tabIndex = -1;\n        const controls = dom.append(wrapper, $('.controls'));\n        const previous = dom.append(controls, $('.button' + ThemeIcon.asCSSSelector(parameterHintsPreviousIcon)));\n        const overloads = dom.append(controls, $('.overloads'));\n        const next = dom.append(controls, $('.button' + ThemeIcon.asCSSSelector(parameterHintsNextIcon)));\n        this._register(dom.addDisposableListener(previous, 'click', e => {\n            dom.EventHelper.stop(e);\n            this.previous();\n        }));\n        this._register(dom.addDisposableListener(next, 'click', e => {\n            dom.EventHelper.stop(e);\n            this.next();\n        }));\n        const body = $('.body');\n        const scrollbar = new DomScrollableElement(body, {\n            alwaysConsumeMouseWheel: true,\n        });\n        this._register(scrollbar);\n        wrapper.appendChild(scrollbar.getDomNode());\n        const signature = dom.append(body, $('.signature'));\n        const docs = dom.append(body, $('.docs'));\n        element.style.userSelect = 'text';\n        this.domNodes = {\n            element,\n            signature,\n            overloads,\n            docs,\n            scrollbar,\n        };\n        this.editor.addContentWidget(this);\n        this.hide();\n        this._register(this.editor.onDidChangeCursorSelection(e => {\n            if (this.visible) {\n                this.editor.layoutContentWidget(this);\n            }\n        }));\n        const updateFont = () => {\n            if (!this.domNodes) {\n                return;\n            }\n            const fontInfo = this.editor.getOption(50 /* EditorOption.fontInfo */);\n            const element = this.domNodes.element;\n            element.style.fontSize = `${fontInfo.fontSize}px`;\n            element.style.lineHeight = `${fontInfo.lineHeight / fontInfo.fontSize}`;\n            element.style.setProperty('--vscode-parameterHintsWidget-editorFontFamily', fontInfo.fontFamily);\n            element.style.setProperty('--vscode-parameterHintsWidget-editorFontFamilyDefault', EDITOR_FONT_DEFAULTS.fontFamily);\n        };\n        updateFont();\n        this._register(Event.chain(this.editor.onDidChangeConfiguration.bind(this.editor), $ => $.filter(e => e.hasChanged(50 /* EditorOption.fontInfo */)))(updateFont));\n        this._register(this.editor.onDidLayoutChange(e => this.updateMaxHeight()));\n        this.updateMaxHeight();\n    }\n    show() {\n        if (this.visible) {\n            return;\n        }\n        if (!this.domNodes) {\n            this.createParameterHintDOMNodes();\n        }\n        this.keyVisible.set(true);\n        this.visible = true;\n        setTimeout(() => {\n            this.domNodes?.element.classList.add('visible');\n        }, 100);\n        this.editor.layoutContentWidget(this);\n    }\n    hide() {\n        this.renderDisposeables.clear();\n        if (!this.visible) {\n            return;\n        }\n        this.keyVisible.reset();\n        this.visible = false;\n        this.announcedLabel = null;\n        this.domNodes?.element.classList.remove('visible');\n        this.editor.layoutContentWidget(this);\n    }\n    getPosition() {\n        if (this.visible) {\n            return {\n                position: this.editor.getPosition(),\n                preference: [1 /* ContentWidgetPositionPreference.ABOVE */, 2 /* ContentWidgetPositionPreference.BELOW */]\n            };\n        }\n        return null;\n    }\n    render(hints) {\n        this.renderDisposeables.clear();\n        if (!this.domNodes) {\n            return;\n        }\n        const multiple = hints.signatures.length > 1;\n        this.domNodes.element.classList.toggle('multiple', multiple);\n        this.keyMultipleSignatures.set(multiple);\n        this.domNodes.signature.innerText = '';\n        this.domNodes.docs.innerText = '';\n        const signature = hints.signatures[hints.activeSignature];\n        if (!signature) {\n            return;\n        }\n        const code = dom.append(this.domNodes.signature, $('.code'));\n        const hasParameters = signature.parameters.length > 0;\n        const activeParameterIndex = signature.activeParameter ?? hints.activeParameter;\n        if (!hasParameters) {\n            const label = dom.append(code, $('span'));\n            label.textContent = signature.label;\n        }\n        else {\n            this.renderParameters(code, signature, activeParameterIndex);\n        }\n        const activeParameter = signature.parameters[activeParameterIndex];\n        if (activeParameter?.documentation) {\n            const documentation = $('span.documentation');\n            if (typeof activeParameter.documentation === 'string') {\n                documentation.textContent = activeParameter.documentation;\n            }\n            else {\n                const renderedContents = this.renderMarkdownDocs(activeParameter.documentation);\n                documentation.appendChild(renderedContents.element);\n            }\n            dom.append(this.domNodes.docs, $('p', {}, documentation));\n        }\n        if (signature.documentation === undefined) {\n            /** no op */\n        }\n        else if (typeof signature.documentation === 'string') {\n            dom.append(this.domNodes.docs, $('p', {}, signature.documentation));\n        }\n        else {\n            const renderedContents = this.renderMarkdownDocs(signature.documentation);\n            dom.append(this.domNodes.docs, renderedContents.element);\n        }\n        const hasDocs = this.hasDocs(signature, activeParameter);\n        this.domNodes.signature.classList.toggle('has-docs', hasDocs);\n        this.domNodes.docs.classList.toggle('empty', !hasDocs);\n        this.domNodes.overloads.textContent =\n            String(hints.activeSignature + 1).padStart(hints.signatures.length.toString().length, '0') + '/' + hints.signatures.length;\n        if (activeParameter) {\n            let labelToAnnounce = '';\n            const param = signature.parameters[activeParameterIndex];\n            if (Array.isArray(param.label)) {\n                labelToAnnounce = signature.label.substring(param.label[0], param.label[1]);\n            }\n            else {\n                labelToAnnounce = param.label;\n            }\n            if (param.documentation) {\n                labelToAnnounce += typeof param.documentation === 'string' ? `, ${param.documentation}` : `, ${param.documentation.value}`;\n            }\n            if (signature.documentation) {\n                labelToAnnounce += typeof signature.documentation === 'string' ? `, ${signature.documentation}` : `, ${signature.documentation.value}`;\n            }\n            // Select method gets called on every user type while parameter hints are visible.\n            // We do not want to spam the user with same announcements, so we only announce if the current parameter changed.\n            if (this.announcedLabel !== labelToAnnounce) {\n                aria.alert(nls.localize('hint', \"{0}, hint\", labelToAnnounce));\n                this.announcedLabel = labelToAnnounce;\n            }\n        }\n        this.editor.layoutContentWidget(this);\n        this.domNodes.scrollbar.scanDomNode();\n    }\n    renderMarkdownDocs(markdown) {\n        const stopWatch = new StopWatch();\n        const renderedContents = this.renderDisposeables.add(this.markdownRenderer.render(markdown, {\n            asyncRenderCallback: () => {\n                this.domNodes?.scrollbar.scanDomNode();\n            }\n        }));\n        renderedContents.element.classList.add('markdown-docs');\n        const renderDuration = stopWatch.elapsed();\n        if (renderDuration > 300) {\n            this.telemetryService.publicLog2('parameterHints.parseMarkdown', {\n                renderDuration\n            });\n        }\n        return renderedContents;\n    }\n    hasDocs(signature, activeParameter) {\n        if (activeParameter && typeof activeParameter.documentation === 'string' && assertIsDefined(activeParameter.documentation).length > 0) {\n            return true;\n        }\n        if (activeParameter && typeof activeParameter.documentation === 'object' && assertIsDefined(activeParameter.documentation).value.length > 0) {\n            return true;\n        }\n        if (signature.documentation && typeof signature.documentation === 'string' && assertIsDefined(signature.documentation).length > 0) {\n            return true;\n        }\n        if (signature.documentation && typeof signature.documentation === 'object' && assertIsDefined(signature.documentation.value).length > 0) {\n            return true;\n        }\n        return false;\n    }\n    renderParameters(parent, signature, activeParameterIndex) {\n        const [start, end] = this.getParameterLabelOffsets(signature, activeParameterIndex);\n        const beforeSpan = document.createElement('span');\n        beforeSpan.textContent = signature.label.substring(0, start);\n        const paramSpan = document.createElement('span');\n        paramSpan.textContent = signature.label.substring(start, end);\n        paramSpan.className = 'parameter active';\n        const afterSpan = document.createElement('span');\n        afterSpan.textContent = signature.label.substring(end);\n        dom.append(parent, beforeSpan, paramSpan, afterSpan);\n    }\n    getParameterLabelOffsets(signature, paramIdx) {\n        const param = signature.parameters[paramIdx];\n        if (!param) {\n            return [0, 0];\n        }\n        else if (Array.isArray(param.label)) {\n            return param.label;\n        }\n        else if (!param.label.length) {\n            return [0, 0];\n        }\n        else {\n            const regex = new RegExp(`(\\\\W|^)${escapeRegExpCharacters(param.label)}(?=\\\\W|$)`, 'g');\n            regex.test(signature.label);\n            const idx = regex.lastIndex - param.label.length;\n            return idx >= 0\n                ? [idx, regex.lastIndex]\n                : [0, 0];\n        }\n    }\n    next() {\n        this.editor.focus();\n        this.model.next();\n    }\n    previous() {\n        this.editor.focus();\n        this.model.previous();\n    }\n    getDomNode() {\n        if (!this.domNodes) {\n            this.createParameterHintDOMNodes();\n        }\n        return this.domNodes.element;\n    }\n    getId() {\n        return ParameterHintsWidget_1.ID;\n    }\n    updateMaxHeight() {\n        if (!this.domNodes) {\n            return;\n        }\n        const height = Math.max(this.editor.getLayoutInfo().height / 4, 250);\n        const maxHeight = `${height}px`;\n        this.domNodes.element.style.maxHeight = maxHeight;\n        const wrapper = this.domNodes.element.getElementsByClassName('phwrapper');\n        if (wrapper.length) {\n            wrapper[0].style.maxHeight = maxHeight;\n        }\n    }\n};\nParameterHintsWidget = ParameterHintsWidget_1 = __decorate([\n    __param(2, IContextKeyService),\n    __param(3, IOpenerService),\n    __param(4, ILanguageService),\n    __param(5, ITelemetryService)\n], ParameterHintsWidget);\nexport { ParameterHintsWidget };\nregisterColor('editorHoverWidget.highlightForeground', listHighlightForeground, nls.localize('editorHoverWidgetHighlightForeground', 'Foreground color of the active item in the parameter hint.'));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ParameterHintsController_1;\nimport { Lazy } from '../../../../base/common/lazy.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport * as languages from '../../../common/languages.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ParameterHintsModel } from './parameterHintsModel.js';\nimport { Context } from './provideSignatureHelp.js';\nimport * as nls from '../../../../nls.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ParameterHintsWidget } from './parameterHintsWidget.js';\nlet ParameterHintsController = class ParameterHintsController extends Disposable {\n    static { ParameterHintsController_1 = this; }\n    static { this.ID = 'editor.controller.parameterHints'; }\n    static get(editor) {\n        return editor.getContribution(ParameterHintsController_1.ID);\n    }\n    constructor(editor, instantiationService, languageFeaturesService) {\n        super();\n        this.editor = editor;\n        this.model = this._register(new ParameterHintsModel(editor, languageFeaturesService.signatureHelpProvider));\n        this._register(this.model.onChangedHints(newParameterHints => {\n            if (newParameterHints) {\n                this.widget.value.show();\n                this.widget.value.render(newParameterHints);\n            }\n            else {\n                this.widget.rawValue?.hide();\n            }\n        }));\n        this.widget = new Lazy(() => this._register(instantiationService.createInstance(ParameterHintsWidget, this.editor, this.model)));\n    }\n    cancel() {\n        this.model.cancel();\n    }\n    previous() {\n        this.widget.rawValue?.previous();\n    }\n    next() {\n        this.widget.rawValue?.next();\n    }\n    trigger(context) {\n        this.model.trigger(context, 0);\n    }\n};\nParameterHintsController = ParameterHintsController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, ILanguageFeaturesService)\n], ParameterHintsController);\nexport { ParameterHintsController };\nexport class TriggerParameterHintsAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.triggerParameterHints',\n            label: nls.localize('parameterHints.trigger.label', \"Trigger Parameter Hints\"),\n            alias: 'Trigger Parameter Hints',\n            precondition: EditorContextKeys.hasSignatureHelpProvider,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 10 /* KeyCode.Space */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = ParameterHintsController.get(editor);\n        controller?.trigger({\n            triggerKind: languages.SignatureHelpTriggerKind.Invoke\n        });\n    }\n}\nregisterEditorContribution(ParameterHintsController.ID, ParameterHintsController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(TriggerParameterHintsAction);\nconst weight = 100 /* KeybindingWeight.EditorContrib */ + 75;\nconst ParameterHintsCommand = EditorCommand.bindToContribution(ParameterHintsController.get);\nregisterEditorCommand(new ParameterHintsCommand({\n    id: 'closeParameterHints',\n    precondition: Context.Visible,\n    handler: x => x.cancel(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.focus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new ParameterHintsCommand({\n    id: 'showPrevParameterHint',\n    precondition: ContextKeyExpr.and(Context.Visible, Context.MultipleSignatures),\n    handler: x => x.previous(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.focus,\n        primary: 16 /* KeyCode.UpArrow */,\n        secondary: [512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */],\n        mac: { primary: 16 /* KeyCode.UpArrow */, secondary: [512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */, 256 /* KeyMod.WinCtrl */ | 46 /* KeyCode.KeyP */] }\n    }\n}));\nregisterEditorCommand(new ParameterHintsCommand({\n    id: 'showNextParameterHint',\n    precondition: ContextKeyExpr.and(Context.Visible, Context.MultipleSignatures),\n    handler: x => x.next(),\n    kbOpts: {\n        weight: weight,\n        kbExpr: EditorContextKeys.focus,\n        primary: 18 /* KeyCode.DownArrow */,\n        secondary: [512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */],\n        mac: { primary: 18 /* KeyCode.DownArrow */, secondary: [512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */, 256 /* KeyMod.WinCtrl */ | 44 /* KeyCode.KeyN */] }\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './placeholderText.css';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ghostTextForeground } from '../../../common/core/editorColorRegistry.js';\nimport { localize } from '../../../../nls.js';\nimport { registerColor } from '../../../../platform/theme/common/colorUtils.js';\nimport { PlaceholderTextContribution } from './placeholderTextContribution.js';\nimport { wrapInReloadableClass1 } from '../../../../platform/observable/common/wrapInReloadableClass.js';\nregisterEditorContribution(PlaceholderTextContribution.ID, wrapInReloadableClass1(() => PlaceholderTextContribution), 0 /* EditorContributionInstantiation.Eager */);\nregisterColor('editor.placeholder.foreground', ghostTextForeground, localize('placeholderForeground', 'Foreground color of the placeholder text in the editor.'));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { StandardKeyboardEvent } from '../../../../base/browser/keyboardEvent.js';\nimport * as aria from '../../../../base/browser/ui/aria/aria.js';\nimport { getBaseLayerHoverDelegate } from '../../../../base/browser/ui/hover/hoverDelegate2.js';\nimport { getDefaultHoverDelegate } from '../../../../base/browser/ui/hover/hoverDelegateFactory.js';\nimport { renderIcon } from '../../../../base/browser/ui/iconLabel/iconLabels.js';\nimport { List } from '../../../../base/browser/ui/list/listWidget.js';\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { DeferredPromise, raceCancellation } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { assertType, isDefined } from '../../../../base/common/types.js';\nimport './renameWidget.css';\nimport * as domFontInfo from '../../../browser/config/domFontInfo.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { NewSymbolNameTag, NewSymbolNameTriggerKind } from '../../../common/languages.js';\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { getListStyles } from '../../../../platform/theme/browser/defaultStyles.js';\nimport { editorWidgetBackground, inputBackground, inputBorder, inputForeground, quickInputListFocusBackground, quickInputListFocusForeground, widgetBorder, widgetShadow } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\n/** for debugging */\nconst _sticky = false;\nexport const CONTEXT_RENAME_INPUT_VISIBLE = new RawContextKey('renameInputVisible', false, nls.localize('renameInputVisible', \"Whether the rename input widget is visible\"));\nexport const CONTEXT_RENAME_INPUT_FOCUSED = new RawContextKey('renameInputFocused', false, nls.localize('renameInputFocused', \"Whether the rename input widget is focused\"));\nlet RenameWidget = class RenameWidget {\n    constructor(_editor, _acceptKeybindings, _themeService, _keybindingService, contextKeyService, _logService) {\n        this._editor = _editor;\n        this._acceptKeybindings = _acceptKeybindings;\n        this._themeService = _themeService;\n        this._keybindingService = _keybindingService;\n        this._logService = _logService;\n        // implement IContentWidget\n        this.allowEditorOverflow = true;\n        this._disposables = new DisposableStore();\n        this._visibleContextKey = CONTEXT_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\n        this._isEditingRenameCandidate = false;\n        this._nRenameSuggestionsInvocations = 0;\n        this._hadAutomaticRenameSuggestionsInvocation = false;\n        this._candidates = new Set();\n        this._beforeFirstInputFieldEditSW = new StopWatch();\n        this._inputWithButton = new InputWithButton();\n        this._disposables.add(this._inputWithButton);\n        this._editor.addContentWidget(this);\n        this._disposables.add(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(50 /* EditorOption.fontInfo */)) {\n                this._updateFont();\n            }\n        }));\n        this._disposables.add(_themeService.onDidColorThemeChange(this._updateStyles, this));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._editor.removeContentWidget(this);\n    }\n    getId() {\n        return '__renameInputWidget';\n    }\n    getDomNode() {\n        if (!this._domNode) {\n            this._domNode = document.createElement('div');\n            this._domNode.className = 'monaco-editor rename-box';\n            this._domNode.appendChild(this._inputWithButton.domNode);\n            this._renameCandidateListView = this._disposables.add(new RenameCandidateListView(this._domNode, {\n                fontInfo: this._editor.getOption(50 /* EditorOption.fontInfo */),\n                onFocusChange: (newSymbolName) => {\n                    this._inputWithButton.input.value = newSymbolName;\n                    this._isEditingRenameCandidate = false; // @ulugbekna: reset\n                },\n                onSelectionChange: () => {\n                    this._isEditingRenameCandidate = false; // @ulugbekna: because user picked a rename suggestion\n                    this.acceptInput(false); // we don't allow preview with mouse click for now\n                }\n            }));\n            this._disposables.add(this._inputWithButton.onDidInputChange(() => {\n                if (this._renameCandidateListView?.focusedCandidate !== undefined) {\n                    this._isEditingRenameCandidate = true;\n                }\n                this._timeBeforeFirstInputFieldEdit ??= this._beforeFirstInputFieldEditSW.elapsed();\n                if (this._renameCandidateProvidersCts?.token.isCancellationRequested === false) {\n                    this._renameCandidateProvidersCts.cancel();\n                }\n                this._renameCandidateListView?.clearFocus();\n            }));\n            this._label = document.createElement('div');\n            this._label.className = 'rename-label';\n            this._domNode.appendChild(this._label);\n            this._updateFont();\n            this._updateStyles(this._themeService.getColorTheme());\n        }\n        return this._domNode;\n    }\n    _updateStyles(theme) {\n        if (!this._domNode) {\n            return;\n        }\n        const widgetShadowColor = theme.getColor(widgetShadow);\n        const widgetBorderColor = theme.getColor(widgetBorder);\n        this._domNode.style.backgroundColor = String(theme.getColor(editorWidgetBackground) ?? '');\n        this._domNode.style.boxShadow = widgetShadowColor ? ` 0 0 8px 2px ${widgetShadowColor}` : '';\n        this._domNode.style.border = widgetBorderColor ? `1px solid ${widgetBorderColor}` : '';\n        this._domNode.style.color = String(theme.getColor(inputForeground) ?? '');\n        const border = theme.getColor(inputBorder);\n        this._inputWithButton.domNode.style.backgroundColor = String(theme.getColor(inputBackground) ?? '');\n        this._inputWithButton.input.style.backgroundColor = String(theme.getColor(inputBackground) ?? '');\n        this._inputWithButton.domNode.style.borderWidth = border ? '1px' : '0px';\n        this._inputWithButton.domNode.style.borderStyle = border ? 'solid' : 'none';\n        this._inputWithButton.domNode.style.borderColor = border?.toString() ?? 'none';\n    }\n    _updateFont() {\n        if (this._domNode === undefined) {\n            return;\n        }\n        assertType(this._label !== undefined, 'RenameWidget#_updateFont: _label must not be undefined given _domNode is defined');\n        this._editor.applyFontInfo(this._inputWithButton.input);\n        const fontInfo = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        this._label.style.fontSize = `${this._computeLabelFontSize(fontInfo.fontSize)}px`;\n    }\n    _computeLabelFontSize(editorFontSize) {\n        return editorFontSize * 0.8;\n    }\n    getPosition() {\n        if (!this._visible) {\n            return null;\n        }\n        if (!this._editor.hasModel() || // @ulugbekna: shouldn't happen\n            !this._editor.getDomNode() // @ulugbekna: can happen during tests based on suggestWidget's similar predicate check\n        ) {\n            return null;\n        }\n        const bodyBox = dom.getClientArea(this.getDomNode().ownerDocument.body);\n        const editorBox = dom.getDomNodePagePosition(this._editor.getDomNode());\n        const cursorBoxTop = this._getTopForPosition();\n        this._nPxAvailableAbove = cursorBoxTop + editorBox.top;\n        this._nPxAvailableBelow = bodyBox.height - this._nPxAvailableAbove;\n        const lineHeight = this._editor.getOption(67 /* EditorOption.lineHeight */);\n        const { totalHeight: candidateViewHeight } = RenameCandidateView.getLayoutInfo({ lineHeight });\n        const positionPreference = this._nPxAvailableBelow > candidateViewHeight * 6 /* approximate # of candidates to fit in (inclusive of rename input box & rename label) */\n            ? [2 /* ContentWidgetPositionPreference.BELOW */, 1 /* ContentWidgetPositionPreference.ABOVE */]\n            : [1 /* ContentWidgetPositionPreference.ABOVE */, 2 /* ContentWidgetPositionPreference.BELOW */];\n        return {\n            position: this._position,\n            preference: positionPreference,\n        };\n    }\n    beforeRender() {\n        const [accept, preview] = this._acceptKeybindings;\n        this._label.innerText = nls.localize({ key: 'label', comment: ['placeholders are keybindings, e.g \"F2 to Rename, Shift+F2 to Preview\"'] }, \"{0} to Rename, {1} to Preview\", this._keybindingService.lookupKeybinding(accept)?.getLabel(), this._keybindingService.lookupKeybinding(preview)?.getLabel());\n        this._domNode.style.minWidth = `200px`; // to prevent from widening when candidates come in\n        return null;\n    }\n    afterRender(position) {\n        // FIXME@ulugbekna: commenting trace log out until we start unmounting the widget from editor properly - https://github.com/microsoft/vscode/issues/226975\n        // this._trace('invoking afterRender, position: ', position ? 'not null' : 'null');\n        if (position === null) {\n            // cancel rename when input widget isn't rendered anymore\n            this.cancelInput(true, 'afterRender (because position is null)');\n            return;\n        }\n        if (!this._editor.hasModel() || // shouldn't happen\n            !this._editor.getDomNode() // can happen during tests based on suggestWidget's similar predicate check\n        ) {\n            return;\n        }\n        assertType(this._renameCandidateListView);\n        assertType(this._nPxAvailableAbove !== undefined);\n        assertType(this._nPxAvailableBelow !== undefined);\n        const inputBoxHeight = dom.getTotalHeight(this._inputWithButton.domNode);\n        const labelHeight = dom.getTotalHeight(this._label);\n        let totalHeightAvailable;\n        if (position === 2 /* ContentWidgetPositionPreference.BELOW */) {\n            totalHeightAvailable = this._nPxAvailableBelow;\n        }\n        else {\n            totalHeightAvailable = this._nPxAvailableAbove;\n        }\n        this._renameCandidateListView.layout({\n            height: totalHeightAvailable - labelHeight - inputBoxHeight,\n            width: dom.getTotalWidth(this._inputWithButton.domNode),\n        });\n    }\n    acceptInput(wantsPreview) {\n        this._trace(`invoking acceptInput`);\n        this._currentAcceptInput?.(wantsPreview);\n    }\n    cancelInput(focusEditor, caller) {\n        // this._trace(`invoking cancelInput, caller: ${caller}, _currentCancelInput: ${this._currentAcceptInput ? 'not undefined' : 'undefined'}`);\n        this._currentCancelInput?.(focusEditor);\n    }\n    focusNextRenameSuggestion() {\n        if (!this._renameCandidateListView?.focusNext()) {\n            this._inputWithButton.input.value = this._currentName;\n        }\n    }\n    focusPreviousRenameSuggestion() {\n        if (!this._renameCandidateListView?.focusPrevious()) {\n            this._inputWithButton.input.value = this._currentName;\n        }\n    }\n    /**\n     * @param requestRenameCandidates is `undefined` when there are no rename suggestion providers\n     */\n    getInput(where, currentName, supportPreview, requestRenameCandidates, cts) {\n        const { start: selectionStart, end: selectionEnd } = this._getSelection(where, currentName);\n        this._renameCts = cts;\n        const disposeOnDone = new DisposableStore();\n        this._nRenameSuggestionsInvocations = 0;\n        this._hadAutomaticRenameSuggestionsInvocation = false;\n        if (requestRenameCandidates === undefined) {\n            this._inputWithButton.button.style.display = 'none';\n        }\n        else {\n            this._inputWithButton.button.style.display = 'flex';\n            this._requestRenameCandidatesOnce = requestRenameCandidates;\n            this._requestRenameCandidates(currentName, false);\n            disposeOnDone.add(dom.addDisposableListener(this._inputWithButton.button, 'click', () => this._requestRenameCandidates(currentName, true)));\n            disposeOnDone.add(dom.addDisposableListener(this._inputWithButton.button, dom.EventType.KEY_DOWN, (e) => {\n                const keyEvent = new StandardKeyboardEvent(e);\n                if (keyEvent.equals(3 /* KeyCode.Enter */) || keyEvent.equals(10 /* KeyCode.Space */)) {\n                    keyEvent.stopPropagation();\n                    keyEvent.preventDefault();\n                    this._requestRenameCandidates(currentName, true);\n                }\n            }));\n        }\n        this._isEditingRenameCandidate = false;\n        this._domNode.classList.toggle('preview', supportPreview);\n        this._position = new Position(where.startLineNumber, where.startColumn);\n        this._currentName = currentName;\n        this._inputWithButton.input.value = currentName;\n        this._inputWithButton.input.setAttribute('selectionStart', selectionStart.toString());\n        this._inputWithButton.input.setAttribute('selectionEnd', selectionEnd.toString());\n        this._inputWithButton.input.size = Math.max((where.endColumn - where.startColumn) * 1.1, 20); // determines width\n        this._beforeFirstInputFieldEditSW.reset();\n        disposeOnDone.add(toDisposable(() => {\n            this._renameCts = undefined;\n            cts.dispose(true);\n        })); // @ulugbekna: this may result in `this.cancelInput` being called twice, but it should be safe since we set it to undefined after 1st call\n        disposeOnDone.add(toDisposable(() => {\n            if (this._renameCandidateProvidersCts !== undefined) {\n                this._renameCandidateProvidersCts.dispose(true);\n                this._renameCandidateProvidersCts = undefined;\n            }\n        }));\n        disposeOnDone.add(toDisposable(() => this._candidates.clear()));\n        const inputResult = new DeferredPromise();\n        inputResult.p.finally(() => {\n            disposeOnDone.dispose();\n            this._hide();\n        });\n        this._currentCancelInput = (focusEditor) => {\n            this._trace('invoking _currentCancelInput');\n            this._currentAcceptInput = undefined;\n            this._currentCancelInput = undefined;\n            // fixme session cleanup\n            this._renameCandidateListView?.clearCandidates();\n            inputResult.complete(focusEditor);\n            return true;\n        };\n        this._currentAcceptInput = (wantsPreview) => {\n            this._trace('invoking _currentAcceptInput');\n            assertType(this._renameCandidateListView !== undefined);\n            const nRenameSuggestions = this._renameCandidateListView.nCandidates;\n            let newName;\n            let source;\n            const focusedCandidate = this._renameCandidateListView.focusedCandidate;\n            if (focusedCandidate !== undefined) {\n                this._trace('using new name from renameSuggestion');\n                newName = focusedCandidate;\n                source = { k: 'renameSuggestion' };\n            }\n            else {\n                this._trace('using new name from inputField');\n                newName = this._inputWithButton.input.value;\n                source = this._isEditingRenameCandidate ? { k: 'userEditedRenameSuggestion' } : { k: 'inputField' };\n            }\n            if (newName === currentName || newName.trim().length === 0 /* is just whitespace */) {\n                this.cancelInput(true, '_currentAcceptInput (because newName === value || newName.trim().length === 0)');\n                return;\n            }\n            this._currentAcceptInput = undefined;\n            this._currentCancelInput = undefined;\n            this._renameCandidateListView.clearCandidates();\n            // fixme session cleanup\n            inputResult.complete({\n                newName,\n                wantsPreview: supportPreview && wantsPreview,\n                stats: {\n                    source,\n                    nRenameSuggestions,\n                    timeBeforeFirstInputFieldEdit: this._timeBeforeFirstInputFieldEdit,\n                    nRenameSuggestionsInvocations: this._nRenameSuggestionsInvocations,\n                    hadAutomaticRenameSuggestionsInvocation: this._hadAutomaticRenameSuggestionsInvocation,\n                }\n            });\n        };\n        disposeOnDone.add(cts.token.onCancellationRequested(() => this.cancelInput(true, 'cts.token.onCancellationRequested')));\n        if (!_sticky) {\n            disposeOnDone.add(this._editor.onDidBlurEditorWidget(() => this.cancelInput(!this._domNode?.ownerDocument.hasFocus(), 'editor.onDidBlurEditorWidget')));\n        }\n        this._show();\n        return inputResult.p;\n    }\n    _requestRenameCandidates(currentName, isManuallyTriggered) {\n        if (this._requestRenameCandidatesOnce === undefined) {\n            return;\n        }\n        if (this._renameCandidateProvidersCts !== undefined) {\n            this._renameCandidateProvidersCts.dispose(true);\n        }\n        assertType(this._renameCts);\n        if (this._inputWithButton.buttonState !== 'stop') {\n            this._renameCandidateProvidersCts = new CancellationTokenSource();\n            const triggerKind = isManuallyTriggered ? NewSymbolNameTriggerKind.Invoke : NewSymbolNameTriggerKind.Automatic;\n            const candidates = this._requestRenameCandidatesOnce(triggerKind, this._renameCandidateProvidersCts.token);\n            if (candidates.length === 0) {\n                this._inputWithButton.setSparkleButton();\n                return;\n            }\n            if (!isManuallyTriggered) {\n                this._hadAutomaticRenameSuggestionsInvocation = true;\n            }\n            this._nRenameSuggestionsInvocations += 1;\n            this._inputWithButton.setStopButton();\n            this._updateRenameCandidates(candidates, currentName, this._renameCts.token);\n        }\n    }\n    /**\n     * This allows selecting only part of the symbol name in the input field based on the selection in the editor\n     */\n    _getSelection(where, currentName) {\n        assertType(this._editor.hasModel());\n        const selection = this._editor.getSelection();\n        let start = 0;\n        let end = currentName.length;\n        if (!Range.isEmpty(selection) && !Range.spansMultipleLines(selection) && Range.containsRange(where, selection)) {\n            start = Math.max(0, selection.startColumn - where.startColumn);\n            end = Math.min(where.endColumn, selection.endColumn) - where.startColumn;\n        }\n        return { start, end };\n    }\n    _show() {\n        this._trace('invoking _show');\n        this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber, 0 /* ScrollType.Smooth */);\n        this._visible = true;\n        this._visibleContextKey.set(true);\n        this._editor.layoutContentWidget(this);\n        // TODO@ulugbekna: could this be simply run in `afterRender`?\n        setTimeout(() => {\n            this._inputWithButton.input.focus();\n            this._inputWithButton.input.setSelectionRange(parseInt(this._inputWithButton.input.getAttribute('selectionStart')), parseInt(this._inputWithButton.input.getAttribute('selectionEnd')));\n        }, 100);\n    }\n    async _updateRenameCandidates(candidates, currentName, token) {\n        const trace = (...args) => this._trace('_updateRenameCandidates', ...args);\n        trace('start');\n        const namesListResults = await raceCancellation(Promise.allSettled(candidates), token);\n        this._inputWithButton.setSparkleButton();\n        if (namesListResults === undefined) {\n            trace('returning early - received updateRenameCandidates results - undefined');\n            return;\n        }\n        const newNames = namesListResults.flatMap(namesListResult => namesListResult.status === 'fulfilled' && isDefined(namesListResult.value)\n            ? namesListResult.value\n            : []);\n        trace(`received updateRenameCandidates results - total (unfiltered) ${newNames.length} candidates.`);\n        // deduplicate and filter out the current value\n        const distinctNames = arrays.distinct(newNames, v => v.newSymbolName);\n        trace(`distinct candidates - ${distinctNames.length} candidates.`);\n        const validDistinctNames = distinctNames.filter(({ newSymbolName }) => newSymbolName.trim().length > 0 && newSymbolName !== this._inputWithButton.input.value && newSymbolName !== currentName && !this._candidates.has(newSymbolName));\n        trace(`valid distinct candidates - ${newNames.length} candidates.`);\n        validDistinctNames.forEach(n => this._candidates.add(n.newSymbolName));\n        if (validDistinctNames.length < 1) {\n            trace('returning early - no valid distinct candidates');\n            return;\n        }\n        // show the candidates\n        trace('setting candidates');\n        this._renameCandidateListView.setCandidates(validDistinctNames);\n        // ask editor to re-layout given that the widget is now of a different size after rendering rename candidates\n        trace('asking editor to re-layout');\n        this._editor.layoutContentWidget(this);\n    }\n    _hide() {\n        this._trace('invoked _hide');\n        this._visible = false;\n        this._visibleContextKey.reset();\n        this._editor.layoutContentWidget(this);\n    }\n    _getTopForPosition() {\n        const visibleRanges = this._editor.getVisibleRanges();\n        let firstLineInViewport;\n        if (visibleRanges.length > 0) {\n            firstLineInViewport = visibleRanges[0].startLineNumber;\n        }\n        else {\n            this._logService.warn('RenameWidget#_getTopForPosition: this should not happen - visibleRanges is empty');\n            firstLineInViewport = Math.max(1, this._position.lineNumber - 5); // @ulugbekna: fallback to current line minus 5\n        }\n        return this._editor.getTopForLineNumber(this._position.lineNumber) - this._editor.getTopForLineNumber(firstLineInViewport);\n    }\n    _trace(...args) {\n        this._logService.trace('RenameWidget', ...args);\n    }\n};\nRenameWidget = __decorate([\n    __param(2, IThemeService),\n    __param(3, IKeybindingService),\n    __param(4, IContextKeyService),\n    __param(5, ILogService)\n], RenameWidget);\nexport { RenameWidget };\nclass RenameCandidateListView {\n    // FIXME@ulugbekna: rewrite using event emitters\n    constructor(parent, opts) {\n        this._disposables = new DisposableStore();\n        this._availableHeight = 0;\n        this._minimumWidth = 0;\n        this._lineHeight = opts.fontInfo.lineHeight;\n        this._typicalHalfwidthCharacterWidth = opts.fontInfo.typicalHalfwidthCharacterWidth;\n        this._listContainer = document.createElement('div');\n        this._listContainer.className = 'rename-box rename-candidate-list-container';\n        parent.appendChild(this._listContainer);\n        this._listWidget = RenameCandidateListView._createListWidget(this._listContainer, this._candidateViewHeight, opts.fontInfo);\n        this._listWidget.onDidChangeFocus(e => {\n            if (e.elements.length === 1) {\n                opts.onFocusChange(e.elements[0].newSymbolName);\n            }\n        }, this._disposables);\n        this._listWidget.onDidChangeSelection(e => {\n            if (e.elements.length === 1) {\n                opts.onSelectionChange();\n            }\n        }, this._disposables);\n        this._disposables.add(this._listWidget.onDidBlur(e => {\n            this._listWidget.setFocus([]);\n        }));\n        this._listWidget.style(getListStyles({\n            listInactiveFocusForeground: quickInputListFocusForeground,\n            listInactiveFocusBackground: quickInputListFocusBackground,\n        }));\n    }\n    dispose() {\n        this._listWidget.dispose();\n        this._disposables.dispose();\n    }\n    // height - max height allowed by parent element\n    layout({ height, width }) {\n        this._availableHeight = height;\n        this._minimumWidth = width;\n    }\n    setCandidates(candidates) {\n        // insert candidates into list widget\n        this._listWidget.splice(0, 0, candidates);\n        // adjust list widget layout\n        const height = this._pickListHeight(this._listWidget.length);\n        const width = this._pickListWidth(candidates);\n        this._listWidget.layout(height, width);\n        // adjust list container layout\n        this._listContainer.style.height = `${height}px`;\n        this._listContainer.style.width = `${width}px`;\n        aria.status(nls.localize('renameSuggestionsReceivedAria', \"Received {0} rename suggestions\", candidates.length));\n    }\n    clearCandidates() {\n        this._listContainer.style.height = '0px';\n        this._listContainer.style.width = '0px';\n        this._listWidget.splice(0, this._listWidget.length, []);\n    }\n    get nCandidates() {\n        return this._listWidget.length;\n    }\n    get focusedCandidate() {\n        if (this._listWidget.length === 0) {\n            return;\n        }\n        const selectedElement = this._listWidget.getSelectedElements()[0];\n        if (selectedElement !== undefined) {\n            return selectedElement.newSymbolName;\n        }\n        const focusedElement = this._listWidget.getFocusedElements()[0];\n        if (focusedElement !== undefined) {\n            return focusedElement.newSymbolName;\n        }\n        return;\n    }\n    focusNext() {\n        if (this._listWidget.length === 0) {\n            return false;\n        }\n        const focusedIxs = this._listWidget.getFocus();\n        if (focusedIxs.length === 0) {\n            this._listWidget.focusFirst();\n            this._listWidget.reveal(0);\n            return true;\n        }\n        else {\n            if (focusedIxs[0] === this._listWidget.length - 1) {\n                this._listWidget.setFocus([]);\n                this._listWidget.reveal(0); // @ulugbekna: without this, it seems like focused element is obstructed\n                return false;\n            }\n            else {\n                this._listWidget.focusNext();\n                const focused = this._listWidget.getFocus()[0];\n                this._listWidget.reveal(focused);\n                return true;\n            }\n        }\n    }\n    /**\n     * @returns true if focus is moved to previous element\n     */\n    focusPrevious() {\n        if (this._listWidget.length === 0) {\n            return false;\n        }\n        const focusedIxs = this._listWidget.getFocus();\n        if (focusedIxs.length === 0) {\n            this._listWidget.focusLast();\n            const focused = this._listWidget.getFocus()[0];\n            this._listWidget.reveal(focused);\n            return true;\n        }\n        else {\n            if (focusedIxs[0] === 0) {\n                this._listWidget.setFocus([]);\n                return false;\n            }\n            else {\n                this._listWidget.focusPrevious();\n                const focused = this._listWidget.getFocus()[0];\n                this._listWidget.reveal(focused);\n                return true;\n            }\n        }\n    }\n    clearFocus() {\n        this._listWidget.setFocus([]);\n    }\n    get _candidateViewHeight() {\n        const { totalHeight } = RenameCandidateView.getLayoutInfo({ lineHeight: this._lineHeight });\n        return totalHeight;\n    }\n    _pickListHeight(nCandidates) {\n        const heightToFitAllCandidates = this._candidateViewHeight * nCandidates;\n        const MAX_N_CANDIDATES = 7; // @ulugbekna: max # of candidates we want to show at once\n        const height = Math.min(heightToFitAllCandidates, this._availableHeight, this._candidateViewHeight * MAX_N_CANDIDATES);\n        return height;\n    }\n    _pickListWidth(candidates) {\n        const longestCandidateWidth = Math.ceil(Math.max(...candidates.map(c => c.newSymbolName.length)) * this._typicalHalfwidthCharacterWidth);\n        const width = Math.max(this._minimumWidth, 4 /* padding */ + 16 /* sparkle icon */ + 5 /* margin-left */ + longestCandidateWidth + 10 /* (possibly visible) scrollbar width */ // TODO@ulugbekna: approximate calc - clean this up\n        );\n        return width;\n    }\n    static _createListWidget(container, candidateViewHeight, fontInfo) {\n        const virtualDelegate = new class {\n            getTemplateId(element) {\n                return 'candidate';\n            }\n            getHeight(element) {\n                return candidateViewHeight;\n            }\n        };\n        const renderer = new class {\n            constructor() {\n                this.templateId = 'candidate';\n            }\n            renderTemplate(container) {\n                return new RenameCandidateView(container, fontInfo);\n            }\n            renderElement(candidate, index, templateData) {\n                templateData.populate(candidate);\n            }\n            disposeTemplate(templateData) {\n                templateData.dispose();\n            }\n        };\n        return new List('NewSymbolNameCandidates', container, virtualDelegate, [renderer], {\n            keyboardSupport: false, // @ulugbekna: because we handle keyboard events through proper commands & keybinding service, see `rename.ts`\n            mouseSupport: true,\n            multipleSelectionSupport: false,\n        });\n    }\n}\nclass InputWithButton {\n    constructor() {\n        this._onDidInputChange = new Emitter();\n        this.onDidInputChange = this._onDidInputChange.event;\n        this._disposables = new DisposableStore();\n    }\n    get domNode() {\n        if (!this._domNode) {\n            this._domNode = document.createElement('div');\n            this._domNode.className = 'rename-input-with-button';\n            this._domNode.style.display = 'flex';\n            this._domNode.style.flexDirection = 'row';\n            this._domNode.style.alignItems = 'center';\n            this._inputNode = document.createElement('input');\n            this._inputNode.className = 'rename-input';\n            this._inputNode.type = 'text';\n            this._inputNode.style.border = 'none';\n            this._inputNode.setAttribute('aria-label', nls.localize('renameAriaLabel', \"Rename input. Type new name and press Enter to commit.\"));\n            this._domNode.appendChild(this._inputNode);\n            this._buttonNode = document.createElement('div');\n            this._buttonNode.className = 'rename-suggestions-button';\n            this._buttonNode.setAttribute('tabindex', '0');\n            this._buttonGenHoverText = nls.localize('generateRenameSuggestionsButton', \"Generate new name suggestions\");\n            this._buttonCancelHoverText = nls.localize('cancelRenameSuggestionsButton', \"Cancel\");\n            this._buttonHover = getBaseLayerHoverDelegate().setupManagedHover(getDefaultHoverDelegate('element'), this._buttonNode, this._buttonGenHoverText);\n            this._disposables.add(this._buttonHover);\n            this._domNode.appendChild(this._buttonNode);\n            // notify if selection changes to cancel request to rename-suggestion providers\n            this._disposables.add(dom.addDisposableListener(this.input, dom.EventType.INPUT, () => this._onDidInputChange.fire()));\n            this._disposables.add(dom.addDisposableListener(this.input, dom.EventType.KEY_DOWN, (e) => {\n                const keyEvent = new StandardKeyboardEvent(e);\n                if (keyEvent.keyCode === 15 /* KeyCode.LeftArrow */ || keyEvent.keyCode === 17 /* KeyCode.RightArrow */) {\n                    this._onDidInputChange.fire();\n                }\n            }));\n            this._disposables.add(dom.addDisposableListener(this.input, dom.EventType.CLICK, () => this._onDidInputChange.fire()));\n            // focus \"container\" border instead of input box\n            this._disposables.add(dom.addDisposableListener(this.input, dom.EventType.FOCUS, () => {\n                this.domNode.style.outlineWidth = '1px';\n                this.domNode.style.outlineStyle = 'solid';\n                this.domNode.style.outlineOffset = '-1px';\n                this.domNode.style.outlineColor = 'var(--vscode-focusBorder)';\n            }));\n            this._disposables.add(dom.addDisposableListener(this.input, dom.EventType.BLUR, () => {\n                this.domNode.style.outline = 'none';\n            }));\n        }\n        return this._domNode;\n    }\n    get input() {\n        assertType(this._inputNode);\n        return this._inputNode;\n    }\n    get button() {\n        assertType(this._buttonNode);\n        return this._buttonNode;\n    }\n    get buttonState() {\n        return this._buttonState;\n    }\n    setSparkleButton() {\n        this._buttonState = 'sparkle';\n        this._sparkleIcon ??= renderIcon(Codicon.sparkle);\n        dom.clearNode(this.button);\n        this.button.appendChild(this._sparkleIcon);\n        this.button.setAttribute('aria-label', 'Generating new name suggestions');\n        this._buttonHover?.update(this._buttonGenHoverText);\n        this.input.focus();\n    }\n    setStopButton() {\n        this._buttonState = 'stop';\n        this._stopIcon ??= renderIcon(Codicon.primitiveSquare);\n        dom.clearNode(this.button);\n        this.button.appendChild(this._stopIcon);\n        this.button.setAttribute('aria-label', 'Cancel generating new name suggestions');\n        this._buttonHover?.update(this._buttonCancelHoverText);\n        this.input.focus();\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n}\nclass RenameCandidateView {\n    static { this._PADDING = 2; }\n    constructor(parent, fontInfo) {\n        this._domNode = document.createElement('div');\n        this._domNode.className = 'rename-box rename-candidate';\n        this._domNode.style.display = `flex`;\n        this._domNode.style.columnGap = `5px`;\n        this._domNode.style.alignItems = `center`;\n        this._domNode.style.height = `${fontInfo.lineHeight}px`;\n        this._domNode.style.padding = `${RenameCandidateView._PADDING}px`;\n        // @ulugbekna: needed to keep space when the `icon.style.display` is set to `none`\n        const iconContainer = document.createElement('div');\n        iconContainer.style.display = `flex`;\n        iconContainer.style.alignItems = `center`;\n        iconContainer.style.width = iconContainer.style.height = `${fontInfo.lineHeight * 0.8}px`;\n        this._domNode.appendChild(iconContainer);\n        this._icon = renderIcon(Codicon.sparkle);\n        this._icon.style.display = `none`;\n        iconContainer.appendChild(this._icon);\n        this._label = document.createElement('div');\n        domFontInfo.applyFontInfo(this._label, fontInfo);\n        this._domNode.appendChild(this._label);\n        parent.appendChild(this._domNode);\n    }\n    populate(value) {\n        this._updateIcon(value);\n        this._updateLabel(value);\n    }\n    _updateIcon(value) {\n        const isAIGenerated = !!value.tags?.includes(NewSymbolNameTag.AIGenerated);\n        this._icon.style.display = isAIGenerated ? 'inherit' : 'none';\n    }\n    _updateLabel(value) {\n        this._label.innerText = value.newSymbolName;\n    }\n    static getLayoutInfo({ lineHeight }) {\n        const totalHeight = lineHeight + RenameCandidateView._PADDING * 2 /* top & bottom padding */;\n        return { totalHeight };\n    }\n    dispose() {\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar RenameController_1;\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { raceCancellation } from '../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { CancellationError, onUnexpectedError } from '../../../../base/common/errors.js';\nimport { isMarkdownString } from '../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution, registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { IBulkEditService } from '../../../browser/services/bulkEditService.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { NewSymbolNameTriggerKind } from '../../../common/languages.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ITextResourceConfigurationService } from '../../../common/services/textResourceConfiguration.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport * as nls from '../../../../nls.js';\nimport { Action2, registerAction2 } from '../../../../platform/actions/common/actions.js';\nimport { Extensions } from '../../../../platform/configuration/common/configurationRegistry.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\nimport { CONTEXT_RENAME_INPUT_VISIBLE, RenameWidget } from './renameWidget.js';\nclass RenameSkeleton {\n    constructor(model, position, registry) {\n        this.model = model;\n        this.position = position;\n        this._providerRenameIdx = 0;\n        this._providers = registry.ordered(model);\n    }\n    hasProvider() {\n        return this._providers.length > 0;\n    }\n    async resolveRenameLocation(token) {\n        const rejects = [];\n        for (this._providerRenameIdx = 0; this._providerRenameIdx < this._providers.length; this._providerRenameIdx++) {\n            const provider = this._providers[this._providerRenameIdx];\n            if (!provider.resolveRenameLocation) {\n                break;\n            }\n            const res = await provider.resolveRenameLocation(this.model, this.position, token);\n            if (!res) {\n                continue;\n            }\n            if (res.rejectReason) {\n                rejects.push(res.rejectReason);\n                continue;\n            }\n            return res;\n        }\n        // we are here when no provider prepared a location which means we can\n        // just rely on the word under cursor and start with the first provider\n        this._providerRenameIdx = 0;\n        const word = this.model.getWordAtPosition(this.position);\n        if (!word) {\n            return {\n                range: Range.fromPositions(this.position),\n                text: '',\n                rejectReason: rejects.length > 0 ? rejects.join('\\n') : undefined\n            };\n        }\n        return {\n            range: new Range(this.position.lineNumber, word.startColumn, this.position.lineNumber, word.endColumn),\n            text: word.word,\n            rejectReason: rejects.length > 0 ? rejects.join('\\n') : undefined\n        };\n    }\n    async provideRenameEdits(newName, token) {\n        return this._provideRenameEdits(newName, this._providerRenameIdx, [], token);\n    }\n    async _provideRenameEdits(newName, i, rejects, token) {\n        const provider = this._providers[i];\n        if (!provider) {\n            return {\n                edits: [],\n                rejectReason: rejects.join('\\n')\n            };\n        }\n        const result = await provider.provideRenameEdits(this.model, this.position, newName, token);\n        if (!result) {\n            return this._provideRenameEdits(newName, i + 1, rejects.concat(nls.localize('no result', \"No result.\")), token);\n        }\n        else if (result.rejectReason) {\n            return this._provideRenameEdits(newName, i + 1, rejects.concat(result.rejectReason), token);\n        }\n        return result;\n    }\n}\nexport async function rename(registry, model, position, newName) {\n    const skeleton = new RenameSkeleton(model, position, registry);\n    const loc = await skeleton.resolveRenameLocation(CancellationToken.None);\n    if (loc?.rejectReason) {\n        return { edits: [], rejectReason: loc.rejectReason };\n    }\n    return skeleton.provideRenameEdits(newName, CancellationToken.None);\n}\n// ---  register actions and commands\nlet RenameController = class RenameController {\n    static { RenameController_1 = this; }\n    static { this.ID = 'editor.contrib.renameController'; }\n    static get(editor) {\n        return editor.getContribution(RenameController_1.ID);\n    }\n    constructor(editor, _instaService, _notificationService, _bulkEditService, _progressService, _logService, _configService, _languageFeaturesService, _telemetryService) {\n        this.editor = editor;\n        this._instaService = _instaService;\n        this._notificationService = _notificationService;\n        this._bulkEditService = _bulkEditService;\n        this._progressService = _progressService;\n        this._logService = _logService;\n        this._configService = _configService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._telemetryService = _telemetryService;\n        this._disposableStore = new DisposableStore();\n        this._cts = new CancellationTokenSource();\n        this._renameWidget = this._disposableStore.add(this._instaService.createInstance(RenameWidget, this.editor, ['acceptRenameInput', 'acceptRenameInputWithPreview']));\n    }\n    dispose() {\n        this._disposableStore.dispose();\n        this._cts.dispose(true);\n    }\n    async run() {\n        const trace = this._logService.trace.bind(this._logService, '[rename]');\n        // set up cancellation token to prevent reentrant rename, this\n        // is the parent to the resolve- and rename-tokens\n        this._cts.dispose(true);\n        this._cts = new CancellationTokenSource();\n        if (!this.editor.hasModel()) {\n            trace('editor has no model');\n            return undefined;\n        }\n        const position = this.editor.getPosition();\n        const skeleton = new RenameSkeleton(this.editor.getModel(), position, this._languageFeaturesService.renameProvider);\n        if (!skeleton.hasProvider()) {\n            trace('skeleton has no provider');\n            return undefined;\n        }\n        // part 1 - resolve rename location\n        const cts1 = new EditorStateCancellationTokenSource(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */, undefined, this._cts.token);\n        let loc;\n        try {\n            trace('resolving rename location');\n            const resolveLocationOperation = skeleton.resolveRenameLocation(cts1.token);\n            this._progressService.showWhile(resolveLocationOperation, 250);\n            loc = await resolveLocationOperation;\n            trace('resolved rename location');\n        }\n        catch (e) {\n            if (e instanceof CancellationError) {\n                trace('resolve rename location cancelled', JSON.stringify(e, null, '\\t'));\n            }\n            else {\n                trace('resolve rename location failed', e instanceof Error ? e : JSON.stringify(e, null, '\\t'));\n                if (typeof e === 'string' || isMarkdownString(e)) {\n                    MessageController.get(this.editor)?.showMessage(e || nls.localize('resolveRenameLocationFailed', \"An unknown error occurred while resolving rename location\"), position);\n                }\n            }\n            return undefined;\n        }\n        finally {\n            cts1.dispose();\n        }\n        if (!loc) {\n            trace('returning early - no loc');\n            return undefined;\n        }\n        if (loc.rejectReason) {\n            trace(`returning early - rejected with reason: ${loc.rejectReason}`, loc.rejectReason);\n            MessageController.get(this.editor)?.showMessage(loc.rejectReason, position);\n            return undefined;\n        }\n        if (cts1.token.isCancellationRequested) {\n            trace('returning early - cts1 cancelled');\n            return undefined;\n        }\n        // part 2 - do rename at location\n        const cts2 = new EditorStateCancellationTokenSource(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */, loc.range, this._cts.token);\n        const model = this.editor.getModel(); // @ulugbekna: assumes editor still has a model, otherwise, cts1 should've been cancelled\n        const newSymbolNamesProviders = this._languageFeaturesService.newSymbolNamesProvider.all(model);\n        const resolvedNewSymbolnamesProviders = await Promise.all(newSymbolNamesProviders.map(async (p) => [p, await p.supportsAutomaticNewSymbolNamesTriggerKind ?? false]));\n        const requestRenameSuggestions = (triggerKind, cts) => {\n            let providers = resolvedNewSymbolnamesProviders.slice();\n            if (triggerKind === NewSymbolNameTriggerKind.Automatic) {\n                providers = providers.filter(([_, supportsAutomatic]) => supportsAutomatic);\n            }\n            return providers.map(([p,]) => p.provideNewSymbolNames(model, loc.range, triggerKind, cts));\n        };\n        trace('creating rename input field and awaiting its result');\n        const supportPreview = this._bulkEditService.hasPreviewHandler() && this._configService.getValue(this.editor.getModel().uri, 'editor.rename.enablePreview');\n        const inputFieldResult = await this._renameWidget.getInput(loc.range, loc.text, supportPreview, newSymbolNamesProviders.length > 0 ? requestRenameSuggestions : undefined, cts2);\n        trace('received response from rename input field');\n        if (newSymbolNamesProviders.length > 0) { // @ulugbekna: we're interested only in telemetry for rename suggestions currently\n            this._reportTelemetry(newSymbolNamesProviders.length, model.getLanguageId(), inputFieldResult);\n        }\n        // no result, only hint to focus the editor or not\n        if (typeof inputFieldResult === 'boolean') {\n            trace(`returning early - rename input field response - ${inputFieldResult}`);\n            if (inputFieldResult) {\n                this.editor.focus();\n            }\n            cts2.dispose();\n            return undefined;\n        }\n        this.editor.focus();\n        trace('requesting rename edits');\n        const renameOperation = raceCancellation(skeleton.provideRenameEdits(inputFieldResult.newName, cts2.token), cts2.token).then(async (renameResult) => {\n            if (!renameResult) {\n                trace('returning early - no rename edits result');\n                return;\n            }\n            if (!this.editor.hasModel()) {\n                trace('returning early - no model after rename edits are provided');\n                return;\n            }\n            if (renameResult.rejectReason) {\n                trace(`returning early - rejected with reason: ${renameResult.rejectReason}`);\n                this._notificationService.info(renameResult.rejectReason);\n                return;\n            }\n            // collapse selection to active end\n            this.editor.setSelection(Range.fromPositions(this.editor.getSelection().getPosition()));\n            trace('applying edits');\n            this._bulkEditService.apply(renameResult, {\n                editor: this.editor,\n                showPreview: inputFieldResult.wantsPreview,\n                label: nls.localize('label', \"Renaming '{0}' to '{1}'\", loc?.text, inputFieldResult.newName),\n                code: 'undoredo.rename',\n                quotableLabel: nls.localize('quotableLabel', \"Renaming {0} to {1}\", loc?.text, inputFieldResult.newName),\n                respectAutoSaveConfig: true\n            }).then(result => {\n                trace('edits applied');\n                if (result.ariaSummary) {\n                    alert(nls.localize('aria', \"Successfully renamed '{0}' to '{1}'. Summary: {2}\", loc.text, inputFieldResult.newName, result.ariaSummary));\n                }\n            }).catch(err => {\n                trace(`error when applying edits ${JSON.stringify(err, null, '\\t')}`);\n                this._notificationService.error(nls.localize('rename.failedApply', \"Rename failed to apply edits\"));\n                this._logService.error(err);\n            });\n        }, err => {\n            trace('error when providing rename edits', JSON.stringify(err, null, '\\t'));\n            this._notificationService.error(nls.localize('rename.failed', \"Rename failed to compute edits\"));\n            this._logService.error(err);\n        }).finally(() => {\n            cts2.dispose();\n        });\n        trace('returning rename operation');\n        this._progressService.showWhile(renameOperation, 250);\n        return renameOperation;\n    }\n    acceptRenameInput(wantsPreview) {\n        this._renameWidget.acceptInput(wantsPreview);\n    }\n    cancelRenameInput() {\n        this._renameWidget.cancelInput(true, 'cancelRenameInput command');\n    }\n    focusNextRenameSuggestion() {\n        this._renameWidget.focusNextRenameSuggestion();\n    }\n    focusPreviousRenameSuggestion() {\n        this._renameWidget.focusPreviousRenameSuggestion();\n    }\n    _reportTelemetry(nRenameSuggestionProviders, languageId, inputFieldResult) {\n        const value = typeof inputFieldResult === 'boolean'\n            ? {\n                kind: 'cancelled',\n                languageId,\n                nRenameSuggestionProviders,\n            }\n            : {\n                kind: 'accepted',\n                languageId,\n                nRenameSuggestionProviders,\n                source: inputFieldResult.stats.source.k,\n                nRenameSuggestions: inputFieldResult.stats.nRenameSuggestions,\n                timeBeforeFirstInputFieldEdit: inputFieldResult.stats.timeBeforeFirstInputFieldEdit,\n                wantsPreview: inputFieldResult.wantsPreview,\n                nRenameSuggestionsInvocations: inputFieldResult.stats.nRenameSuggestionsInvocations,\n                hadAutomaticRenameSuggestionsInvocation: inputFieldResult.stats.hadAutomaticRenameSuggestionsInvocation,\n            };\n        this._telemetryService.publicLog2('renameInvokedEvent', value);\n    }\n};\nRenameController = RenameController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, INotificationService),\n    __param(3, IBulkEditService),\n    __param(4, IEditorProgressService),\n    __param(5, ILogService),\n    __param(6, ITextResourceConfigurationService),\n    __param(7, ILanguageFeaturesService),\n    __param(8, ITelemetryService)\n], RenameController);\n// ---- action implementation\nexport class RenameAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.rename',\n            label: nls.localize('rename.label', \"Rename Symbol\"),\n            alias: 'Rename Symbol',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasRenameProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 60 /* KeyCode.F2 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 1.1\n            }\n        });\n    }\n    runCommand(accessor, args) {\n        const editorService = accessor.get(ICodeEditorService);\n        const [uri, pos] = Array.isArray(args) && args || [undefined, undefined];\n        if (URI.isUri(uri) && Position.isIPosition(pos)) {\n            return editorService.openCodeEditor({ resource: uri }, editorService.getActiveCodeEditor()).then(editor => {\n                if (!editor) {\n                    return;\n                }\n                editor.setPosition(pos);\n                editor.invokeWithinContext(accessor => {\n                    this.reportTelemetry(accessor, editor);\n                    return this.run(accessor, editor);\n                });\n            }, onUnexpectedError);\n        }\n        return super.runCommand(accessor, args);\n    }\n    run(accessor, editor) {\n        const logService = accessor.get(ILogService);\n        const controller = RenameController.get(editor);\n        if (controller) {\n            logService.trace('[RenameAction] got controller, running...');\n            return controller.run();\n        }\n        logService.trace('[RenameAction] returning early - controller missing');\n        return Promise.resolve();\n    }\n}\nregisterEditorContribution(RenameController.ID, RenameController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(RenameAction);\nconst RenameCommand = EditorCommand.bindToContribution(RenameController.get);\nregisterEditorCommand(new RenameCommand({\n    id: 'acceptRenameInput',\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\n    handler: x => x.acceptRenameInput(false),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, ContextKeyExpr.not('isComposing')),\n        primary: 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new RenameCommand({\n    id: 'acceptRenameInputWithPreview',\n    precondition: ContextKeyExpr.and(CONTEXT_RENAME_INPUT_VISIBLE, ContextKeyExpr.has('config.editor.rename.enablePreview')),\n    handler: x => x.acceptRenameInput(true),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, ContextKeyExpr.not('isComposing')),\n        primary: 2048 /* KeyMod.CtrlCmd */ + 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new RenameCommand({\n    id: 'cancelRenameInput',\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\n    handler: x => x.cancelRenameInput(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        kbExpr: EditorContextKeys.focus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterAction2(class FocusNextRenameSuggestion extends Action2 {\n    constructor() {\n        super({\n            id: 'focusNextRenameSuggestion',\n            title: {\n                ...nls.localize2('focusNextRenameSuggestion', \"Focus Next Rename Suggestion\"),\n            },\n            precondition: CONTEXT_RENAME_INPUT_VISIBLE,\n            keybinding: [\n                {\n                    primary: 18 /* KeyCode.DownArrow */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n                }\n            ]\n        });\n    }\n    run(accessor) {\n        const currentEditor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n        if (!currentEditor) {\n            return;\n        }\n        const controller = RenameController.get(currentEditor);\n        if (!controller) {\n            return;\n        }\n        controller.focusNextRenameSuggestion();\n    }\n});\nregisterAction2(class FocusPreviousRenameSuggestion extends Action2 {\n    constructor() {\n        super({\n            id: 'focusPreviousRenameSuggestion',\n            title: {\n                ...nls.localize2('focusPreviousRenameSuggestion', \"Focus Previous Rename Suggestion\"),\n            },\n            precondition: CONTEXT_RENAME_INPUT_VISIBLE,\n            keybinding: [\n                {\n                    primary: 16 /* KeyCode.UpArrow */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n                }\n            ]\n        });\n    }\n    run(accessor) {\n        const currentEditor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n        if (!currentEditor) {\n            return;\n        }\n        const controller = RenameController.get(currentEditor);\n        if (!controller) {\n            return;\n        }\n        controller.focusPreviousRenameSuggestion();\n    }\n});\n// ---- api bridge command\nregisterModelAndPositionCommand('_executeDocumentRenameProvider', function (accessor, model, position, ...args) {\n    const [newName] = args;\n    assertType(typeof newName === 'string');\n    const { renameProvider } = accessor.get(ILanguageFeaturesService);\n    return rename(renameProvider, model, position, newName);\n});\nregisterModelAndPositionCommand('_executePrepareRename', async function (accessor, model, position) {\n    const { renameProvider } = accessor.get(ILanguageFeaturesService);\n    const skeleton = new RenameSkeleton(model, position, renameProvider);\n    const loc = await skeleton.resolveRenameLocation(CancellationToken.None);\n    if (loc?.rejectReason) {\n        throw new Error(loc.rejectReason);\n    }\n    return loc;\n});\n//todo@jrieken use editor options world\nRegistry.as(Extensions.Configuration).registerConfiguration({\n    id: 'editor',\n    properties: {\n        'editor.rename.enablePreview': {\n            scope: 5 /* ConfigurationScope.LANGUAGE_OVERRIDABLE */,\n            description: nls.localize('enablePreview', \"Enable/disable the ability to preview changes before renaming\"),\n            default: true,\n            type: 'boolean'\n        }\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nlet SectionHeaderDetector = class SectionHeaderDetector extends Disposable {\n    static { this.ID = 'editor.sectionHeaderDetector'; }\n    constructor(editor, languageConfigurationService, editorWorkerService) {\n        super();\n        this.editor = editor;\n        this.languageConfigurationService = languageConfigurationService;\n        this.editorWorkerService = editorWorkerService;\n        this.decorations = this.editor.createDecorationsCollection();\n        this.options = this.createOptions(editor.getOption(73 /* EditorOption.minimap */));\n        this.computePromise = null;\n        this.currentOccurrences = {};\n        this._register(editor.onDidChangeModel((e) => {\n            this.currentOccurrences = {};\n            this.options = this.createOptions(editor.getOption(73 /* EditorOption.minimap */));\n            this.stop();\n            this.computeSectionHeaders.schedule(0);\n        }));\n        this._register(editor.onDidChangeModelLanguage((e) => {\n            this.currentOccurrences = {};\n            this.options = this.createOptions(editor.getOption(73 /* EditorOption.minimap */));\n            this.stop();\n            this.computeSectionHeaders.schedule(0);\n        }));\n        this._register(languageConfigurationService.onDidChange((e) => {\n            const editorLanguageId = this.editor.getModel()?.getLanguageId();\n            if (editorLanguageId && e.affects(editorLanguageId)) {\n                this.currentOccurrences = {};\n                this.options = this.createOptions(editor.getOption(73 /* EditorOption.minimap */));\n                this.stop();\n                this.computeSectionHeaders.schedule(0);\n            }\n        }));\n        this._register(editor.onDidChangeConfiguration(e => {\n            if (this.options && !e.hasChanged(73 /* EditorOption.minimap */)) {\n                return;\n            }\n            this.options = this.createOptions(editor.getOption(73 /* EditorOption.minimap */));\n            // Remove any links (for the getting disabled case)\n            this.updateDecorations([]);\n            // Stop any computation (for the getting disabled case)\n            this.stop();\n            // Start computing (for the getting enabled case)\n            this.computeSectionHeaders.schedule(0);\n        }));\n        this._register(this.editor.onDidChangeModelContent(e => {\n            this.computeSectionHeaders.schedule();\n        }));\n        this._register(editor.onDidChangeModelTokens((e) => {\n            if (!this.computeSectionHeaders.isScheduled()) {\n                this.computeSectionHeaders.schedule(1000);\n            }\n        }));\n        this.computeSectionHeaders = this._register(new RunOnceScheduler(() => {\n            this.findSectionHeaders();\n        }, 250));\n        this.computeSectionHeaders.schedule(0);\n    }\n    createOptions(minimap) {\n        if (!minimap || !this.editor.hasModel()) {\n            return undefined;\n        }\n        const languageId = this.editor.getModel().getLanguageId();\n        if (!languageId) {\n            return undefined;\n        }\n        const commentsConfiguration = this.languageConfigurationService.getLanguageConfiguration(languageId).comments;\n        const foldingRules = this.languageConfigurationService.getLanguageConfiguration(languageId).foldingRules;\n        if (!commentsConfiguration && !foldingRules?.markers) {\n            return undefined;\n        }\n        return {\n            foldingRules,\n            findMarkSectionHeaders: minimap.showMarkSectionHeaders,\n            findRegionSectionHeaders: minimap.showRegionSectionHeaders,\n        };\n    }\n    findSectionHeaders() {\n        if (!this.editor.hasModel()\n            || (!this.options?.findMarkSectionHeaders && !this.options?.findRegionSectionHeaders)) {\n            return;\n        }\n        const model = this.editor.getModel();\n        if (model.isDisposed() || model.isTooLargeForSyncing()) {\n            return;\n        }\n        const modelVersionId = model.getVersionId();\n        this.editorWorkerService.findSectionHeaders(model.uri, this.options)\n            .then((sectionHeaders) => {\n            if (model.isDisposed() || model.getVersionId() !== modelVersionId) {\n                // model changed in the meantime\n                return;\n            }\n            this.updateDecorations(sectionHeaders);\n        });\n    }\n    updateDecorations(sectionHeaders) {\n        const model = this.editor.getModel();\n        if (model) {\n            // Remove all section headers that should be in comments and are not in comments\n            sectionHeaders = sectionHeaders.filter((sectionHeader) => {\n                if (!sectionHeader.shouldBeInComments) {\n                    return true;\n                }\n                const validRange = model.validateRange(sectionHeader.range);\n                const tokens = model.tokenization.getLineTokens(validRange.startLineNumber);\n                const idx = tokens.findTokenIndexAtOffset(validRange.startColumn - 1);\n                const tokenType = tokens.getStandardTokenType(idx);\n                const languageId = tokens.getLanguageId(idx);\n                return (languageId === model.getLanguageId() && tokenType === 1 /* StandardTokenType.Comment */);\n            });\n        }\n        const oldDecorations = Object.values(this.currentOccurrences).map(occurrence => occurrence.decorationId);\n        const newDecorations = sectionHeaders.map(sectionHeader => decoration(sectionHeader));\n        this.editor.changeDecorations((changeAccessor) => {\n            const decorations = changeAccessor.deltaDecorations(oldDecorations, newDecorations);\n            this.currentOccurrences = {};\n            for (let i = 0, len = decorations.length; i < len; i++) {\n                const occurrence = { sectionHeader: sectionHeaders[i], decorationId: decorations[i] };\n                this.currentOccurrences[occurrence.decorationId] = occurrence;\n            }\n        });\n    }\n    stop() {\n        this.computeSectionHeaders.cancel();\n        if (this.computePromise) {\n            this.computePromise.cancel();\n            this.computePromise = null;\n        }\n    }\n    dispose() {\n        super.dispose();\n        this.stop();\n        this.decorations.clear();\n    }\n};\nSectionHeaderDetector = __decorate([\n    __param(1, ILanguageConfigurationService),\n    __param(2, IEditorWorkerService)\n], SectionHeaderDetector);\nexport { SectionHeaderDetector };\nfunction decoration(sectionHeader) {\n    return {\n        range: sectionHeader.range,\n        options: ModelDecorationOptions.createDynamic({\n            description: 'section-header',\n            stickiness: 3 /* TrackedRangeStickiness.GrowsOnlyWhenTypingAfter */,\n            collapseOnReplaceEdit: true,\n            minimap: {\n                color: undefined,\n                position: 1 /* MinimapPosition.Inline */,\n                sectionHeaderStyle: sectionHeader.hasSeparatorLine ? 2 /* MinimapSectionHeaderStyle.Underlined */ : 1 /* MinimapSectionHeaderStyle.Normal */,\n                sectionHeaderText: sectionHeader.text,\n            },\n        })\n    };\n}\nregisterEditorContribution(SectionHeaderDetector.ID, SectionHeaderDetector, 1 /* EditorContributionInstantiation.AfterFirstRender */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { encodeSemanticTokensDto } from '../../../common/services/semanticTokensDto.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport function isSemanticTokens(v) {\n    return v && !!(v.data);\n}\nexport function isSemanticTokensEdits(v) {\n    return v && Array.isArray(v.edits);\n}\nexport class DocumentSemanticTokensResult {\n    constructor(provider, tokens, error) {\n        this.provider = provider;\n        this.tokens = tokens;\n        this.error = error;\n    }\n}\nexport function hasDocumentSemanticTokensProvider(registry, model) {\n    return registry.has(model);\n}\nfunction getDocumentSemanticTokensProviders(registry, model) {\n    const groups = registry.orderedGroups(model);\n    return (groups.length > 0 ? groups[0] : []);\n}\nexport async function getDocumentSemanticTokens(registry, model, lastProvider, lastResultId, token) {\n    const providers = getDocumentSemanticTokensProviders(registry, model);\n    // Get tokens from all providers at the same time.\n    const results = await Promise.all(providers.map(async (provider) => {\n        let result;\n        let error = null;\n        try {\n            result = await provider.provideDocumentSemanticTokens(model, (provider === lastProvider ? lastResultId : null), token);\n        }\n        catch (err) {\n            error = err;\n            result = null;\n        }\n        if (!result || (!isSemanticTokens(result) && !isSemanticTokensEdits(result))) {\n            result = null;\n        }\n        return new DocumentSemanticTokensResult(provider, result, error);\n    }));\n    // Try to return the first result with actual tokens or\n    // the first result which threw an error (!!)\n    for (const result of results) {\n        if (result.error) {\n            throw result.error;\n        }\n        if (result.tokens) {\n            return result;\n        }\n    }\n    // Return the first result, even if it doesn't have tokens\n    if (results.length > 0) {\n        return results[0];\n    }\n    return null;\n}\nfunction _getDocumentSemanticTokensProviderHighestGroup(registry, model) {\n    const result = registry.orderedGroups(model);\n    return (result.length > 0 ? result[0] : null);\n}\nclass DocumentRangeSemanticTokensResult {\n    constructor(provider, tokens) {\n        this.provider = provider;\n        this.tokens = tokens;\n    }\n}\nexport function hasDocumentRangeSemanticTokensProvider(providers, model) {\n    return providers.has(model);\n}\nfunction getDocumentRangeSemanticTokensProviders(providers, model) {\n    const groups = providers.orderedGroups(model);\n    return (groups.length > 0 ? groups[0] : []);\n}\nexport async function getDocumentRangeSemanticTokens(registry, model, range, token) {\n    const providers = getDocumentRangeSemanticTokensProviders(registry, model);\n    // Get tokens from all providers at the same time.\n    const results = await Promise.all(providers.map(async (provider) => {\n        let result;\n        try {\n            result = await provider.provideDocumentRangeSemanticTokens(model, range, token);\n        }\n        catch (err) {\n            onUnexpectedExternalError(err);\n            result = null;\n        }\n        if (!result || !isSemanticTokens(result)) {\n            result = null;\n        }\n        return new DocumentRangeSemanticTokensResult(provider, result);\n    }));\n    // Try to return the first result with actual tokens\n    for (const result of results) {\n        if (result.tokens) {\n            return result;\n        }\n    }\n    // Return the first result, even if it doesn't have tokens\n    if (results.length > 0) {\n        return results[0];\n    }\n    return null;\n}\nCommandsRegistry.registerCommand('_provideDocumentSemanticTokensLegend', async (accessor, ...args) => {\n    const [uri] = args;\n    assertType(uri instanceof URI);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return undefined;\n    }\n    const { documentSemanticTokensProvider } = accessor.get(ILanguageFeaturesService);\n    const providers = _getDocumentSemanticTokensProviderHighestGroup(documentSemanticTokensProvider, model);\n    if (!providers) {\n        // there is no provider => fall back to a document range semantic tokens provider\n        return accessor.get(ICommandService).executeCommand('_provideDocumentRangeSemanticTokensLegend', uri);\n    }\n    return providers[0].getLegend();\n});\nCommandsRegistry.registerCommand('_provideDocumentSemanticTokens', async (accessor, ...args) => {\n    const [uri] = args;\n    assertType(uri instanceof URI);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return undefined;\n    }\n    const { documentSemanticTokensProvider } = accessor.get(ILanguageFeaturesService);\n    if (!hasDocumentSemanticTokensProvider(documentSemanticTokensProvider, model)) {\n        // there is no provider => fall back to a document range semantic tokens provider\n        return accessor.get(ICommandService).executeCommand('_provideDocumentRangeSemanticTokens', uri, model.getFullModelRange());\n    }\n    const r = await getDocumentSemanticTokens(documentSemanticTokensProvider, model, null, null, CancellationToken.None);\n    if (!r) {\n        return undefined;\n    }\n    const { provider, tokens } = r;\n    if (!tokens || !isSemanticTokens(tokens)) {\n        return undefined;\n    }\n    const buff = encodeSemanticTokensDto({\n        id: 0,\n        type: 'full',\n        data: tokens.data\n    });\n    if (tokens.resultId) {\n        provider.releaseDocumentSemanticTokens(tokens.resultId);\n    }\n    return buff;\n});\nCommandsRegistry.registerCommand('_provideDocumentRangeSemanticTokensLegend', async (accessor, ...args) => {\n    const [uri, range] = args;\n    assertType(uri instanceof URI);\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return undefined;\n    }\n    const { documentRangeSemanticTokensProvider } = accessor.get(ILanguageFeaturesService);\n    const providers = getDocumentRangeSemanticTokensProviders(documentRangeSemanticTokensProvider, model);\n    if (providers.length === 0) {\n        // no providers\n        return undefined;\n    }\n    if (providers.length === 1) {\n        // straight forward case, just a single provider\n        return providers[0].getLegend();\n    }\n    if (!range || !Range.isIRange(range)) {\n        // if no range is provided, we cannot support multiple providers\n        // as we cannot fall back to the one which would give results\n        // => return the first legend for backwards compatibility and print a warning\n        console.warn(`provideDocumentRangeSemanticTokensLegend might be out-of-sync with provideDocumentRangeSemanticTokens unless a range argument is passed in`);\n        return providers[0].getLegend();\n    }\n    const result = await getDocumentRangeSemanticTokens(documentRangeSemanticTokensProvider, model, Range.lift(range), CancellationToken.None);\n    if (!result) {\n        return undefined;\n    }\n    return result.provider.getLegend();\n});\nCommandsRegistry.registerCommand('_provideDocumentRangeSemanticTokens', async (accessor, ...args) => {\n    const [uri, range] = args;\n    assertType(uri instanceof URI);\n    assertType(Range.isIRange(range));\n    const model = accessor.get(IModelService).getModel(uri);\n    if (!model) {\n        return undefined;\n    }\n    const { documentRangeSemanticTokensProvider } = accessor.get(ILanguageFeaturesService);\n    const result = await getDocumentRangeSemanticTokens(documentRangeSemanticTokensProvider, model, Range.lift(range), CancellationToken.None);\n    if (!result || !result.tokens) {\n        // there is no provider or it didn't return tokens\n        return undefined;\n    }\n    return encodeSemanticTokensDto({\n        id: 0,\n        type: 'full',\n        data: result.tokens.data\n    });\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport const SEMANTIC_HIGHLIGHTING_SETTING_ID = 'editor.semanticHighlighting';\nexport function isSemanticColoringEnabled(model, themeService, configurationService) {\n    const setting = configurationService.getValue(SEMANTIC_HIGHLIGHTING_SETTING_ID, { overrideIdentifier: model.getLanguageId(), resource: model.uri })?.enabled;\n    if (typeof setting === 'boolean') {\n        return setting;\n    }\n    return themeService.getColorTheme().semanticHighlighting;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ModelSemanticColoring_1;\nimport { Disposable, dispose } from '../../../../base/common/lifecycle.js';\nimport * as errors from '../../../../base/common/errors.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { toMultilineTokens2 } from '../../../common/services/semanticTokensProviderStyling.js';\nimport { getDocumentSemanticTokens, hasDocumentSemanticTokensProvider, isSemanticTokens, isSemanticTokensEdits } from '../common/getSemanticTokens.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ISemanticTokensStylingService } from '../../../common/services/semanticTokensStyling.js';\nimport { registerEditorFeature } from '../../../common/editorFeatures.js';\nimport { SEMANTIC_HIGHLIGHTING_SETTING_ID, isSemanticColoringEnabled } from '../common/semanticTokensConfig.js';\nlet DocumentSemanticTokensFeature = class DocumentSemanticTokensFeature extends Disposable {\n    constructor(semanticTokensStylingService, modelService, themeService, configurationService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this._watchers = Object.create(null);\n        const register = (model) => {\n            this._watchers[model.uri.toString()] = new ModelSemanticColoring(model, semanticTokensStylingService, themeService, languageFeatureDebounceService, languageFeaturesService);\n        };\n        const deregister = (model, modelSemanticColoring) => {\n            modelSemanticColoring.dispose();\n            delete this._watchers[model.uri.toString()];\n        };\n        const handleSettingOrThemeChange = () => {\n            for (const model of modelService.getModels()) {\n                const curr = this._watchers[model.uri.toString()];\n                if (isSemanticColoringEnabled(model, themeService, configurationService)) {\n                    if (!curr) {\n                        register(model);\n                    }\n                }\n                else {\n                    if (curr) {\n                        deregister(model, curr);\n                    }\n                }\n            }\n        };\n        modelService.getModels().forEach(model => {\n            if (isSemanticColoringEnabled(model, themeService, configurationService)) {\n                register(model);\n            }\n        });\n        this._register(modelService.onModelAdded((model) => {\n            if (isSemanticColoringEnabled(model, themeService, configurationService)) {\n                register(model);\n            }\n        }));\n        this._register(modelService.onModelRemoved((model) => {\n            const curr = this._watchers[model.uri.toString()];\n            if (curr) {\n                deregister(model, curr);\n            }\n        }));\n        this._register(configurationService.onDidChangeConfiguration(e => {\n            if (e.affectsConfiguration(SEMANTIC_HIGHLIGHTING_SETTING_ID)) {\n                handleSettingOrThemeChange();\n            }\n        }));\n        this._register(themeService.onDidColorThemeChange(handleSettingOrThemeChange));\n    }\n    dispose() {\n        // Dispose all watchers\n        for (const watcher of Object.values(this._watchers)) {\n            watcher.dispose();\n        }\n        super.dispose();\n    }\n};\nDocumentSemanticTokensFeature = __decorate([\n    __param(0, ISemanticTokensStylingService),\n    __param(1, IModelService),\n    __param(2, IThemeService),\n    __param(3, IConfigurationService),\n    __param(4, ILanguageFeatureDebounceService),\n    __param(5, ILanguageFeaturesService)\n], DocumentSemanticTokensFeature);\nexport { DocumentSemanticTokensFeature };\nlet ModelSemanticColoring = class ModelSemanticColoring extends Disposable {\n    static { ModelSemanticColoring_1 = this; }\n    static { this.REQUEST_MIN_DELAY = 300; }\n    static { this.REQUEST_MAX_DELAY = 2000; }\n    constructor(model, _semanticTokensStylingService, themeService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this._semanticTokensStylingService = _semanticTokensStylingService;\n        this._isDisposed = false;\n        this._model = model;\n        this._provider = languageFeaturesService.documentSemanticTokensProvider;\n        this._debounceInformation = languageFeatureDebounceService.for(this._provider, 'DocumentSemanticTokens', { min: ModelSemanticColoring_1.REQUEST_MIN_DELAY, max: ModelSemanticColoring_1.REQUEST_MAX_DELAY });\n        this._fetchDocumentSemanticTokens = this._register(new RunOnceScheduler(() => this._fetchDocumentSemanticTokensNow(), ModelSemanticColoring_1.REQUEST_MIN_DELAY));\n        this._currentDocumentResponse = null;\n        this._currentDocumentRequestCancellationTokenSource = null;\n        this._documentProvidersChangeListeners = [];\n        this._providersChangedDuringRequest = false;\n        this._register(this._model.onDidChangeContent(() => {\n            if (!this._fetchDocumentSemanticTokens.isScheduled()) {\n                this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n            }\n        }));\n        this._register(this._model.onDidChangeAttached(() => {\n            if (!this._fetchDocumentSemanticTokens.isScheduled()) {\n                this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n            }\n        }));\n        this._register(this._model.onDidChangeLanguage(() => {\n            // clear any outstanding state\n            if (this._currentDocumentResponse) {\n                this._currentDocumentResponse.dispose();\n                this._currentDocumentResponse = null;\n            }\n            if (this._currentDocumentRequestCancellationTokenSource) {\n                this._currentDocumentRequestCancellationTokenSource.cancel();\n                this._currentDocumentRequestCancellationTokenSource = null;\n            }\n            this._setDocumentSemanticTokens(null, null, null, []);\n            this._fetchDocumentSemanticTokens.schedule(0);\n        }));\n        const bindDocumentChangeListeners = () => {\n            dispose(this._documentProvidersChangeListeners);\n            this._documentProvidersChangeListeners = [];\n            for (const provider of this._provider.all(model)) {\n                if (typeof provider.onDidChange === 'function') {\n                    this._documentProvidersChangeListeners.push(provider.onDidChange(() => {\n                        if (this._currentDocumentRequestCancellationTokenSource) {\n                            // there is already a request running,\n                            this._providersChangedDuringRequest = true;\n                            return;\n                        }\n                        this._fetchDocumentSemanticTokens.schedule(0);\n                    }));\n                }\n            }\n        };\n        bindDocumentChangeListeners();\n        this._register(this._provider.onDidChange(() => {\n            bindDocumentChangeListeners();\n            this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n        }));\n        this._register(themeService.onDidColorThemeChange(_ => {\n            // clear out existing tokens\n            this._setDocumentSemanticTokens(null, null, null, []);\n            this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n        }));\n        this._fetchDocumentSemanticTokens.schedule(0);\n    }\n    dispose() {\n        if (this._currentDocumentResponse) {\n            this._currentDocumentResponse.dispose();\n            this._currentDocumentResponse = null;\n        }\n        if (this._currentDocumentRequestCancellationTokenSource) {\n            this._currentDocumentRequestCancellationTokenSource.cancel();\n            this._currentDocumentRequestCancellationTokenSource = null;\n        }\n        dispose(this._documentProvidersChangeListeners);\n        this._documentProvidersChangeListeners = [];\n        this._setDocumentSemanticTokens(null, null, null, []);\n        this._isDisposed = true;\n        super.dispose();\n    }\n    _fetchDocumentSemanticTokensNow() {\n        if (this._currentDocumentRequestCancellationTokenSource) {\n            // there is already a request running, let it finish...\n            return;\n        }\n        if (!hasDocumentSemanticTokensProvider(this._provider, this._model)) {\n            // there is no provider\n            if (this._currentDocumentResponse) {\n                // there are semantic tokens set\n                this._model.tokenization.setSemanticTokens(null, false);\n            }\n            return;\n        }\n        if (!this._model.isAttachedToEditor()) {\n            // this document is not visible, there is no need to fetch semantic tokens for it\n            return;\n        }\n        const cancellationTokenSource = new CancellationTokenSource();\n        const lastProvider = this._currentDocumentResponse ? this._currentDocumentResponse.provider : null;\n        const lastResultId = this._currentDocumentResponse ? this._currentDocumentResponse.resultId || null : null;\n        const request = getDocumentSemanticTokens(this._provider, this._model, lastProvider, lastResultId, cancellationTokenSource.token);\n        this._currentDocumentRequestCancellationTokenSource = cancellationTokenSource;\n        this._providersChangedDuringRequest = false;\n        const pendingChanges = [];\n        const contentChangeListener = this._model.onDidChangeContent((e) => {\n            pendingChanges.push(e);\n        });\n        const sw = new StopWatch(false);\n        request.then((res) => {\n            this._debounceInformation.update(this._model, sw.elapsed());\n            this._currentDocumentRequestCancellationTokenSource = null;\n            contentChangeListener.dispose();\n            if (!res) {\n                this._setDocumentSemanticTokens(null, null, null, pendingChanges);\n            }\n            else {\n                const { provider, tokens } = res;\n                const styling = this._semanticTokensStylingService.getStyling(provider);\n                this._setDocumentSemanticTokens(provider, tokens || null, styling, pendingChanges);\n            }\n        }, (err) => {\n            const isExpectedError = err && (errors.isCancellationError(err) || (typeof err.message === 'string' && err.message.indexOf('busy') !== -1));\n            if (!isExpectedError) {\n                errors.onUnexpectedError(err);\n            }\n            // Semantic tokens eats up all errors and considers errors to mean that the result is temporarily not available\n            // The API does not have a special error kind to express this...\n            this._currentDocumentRequestCancellationTokenSource = null;\n            contentChangeListener.dispose();\n            if (pendingChanges.length > 0 || this._providersChangedDuringRequest) {\n                // More changes occurred while the request was running\n                if (!this._fetchDocumentSemanticTokens.isScheduled()) {\n                    this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n                }\n            }\n        });\n    }\n    static _copy(src, srcOffset, dest, destOffset, length) {\n        // protect against overflows\n        length = Math.min(length, dest.length - destOffset, src.length - srcOffset);\n        for (let i = 0; i < length; i++) {\n            dest[destOffset + i] = src[srcOffset + i];\n        }\n    }\n    _setDocumentSemanticTokens(provider, tokens, styling, pendingChanges) {\n        const currentResponse = this._currentDocumentResponse;\n        const rescheduleIfNeeded = () => {\n            if ((pendingChanges.length > 0 || this._providersChangedDuringRequest) && !this._fetchDocumentSemanticTokens.isScheduled()) {\n                this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model));\n            }\n        };\n        if (this._currentDocumentResponse) {\n            this._currentDocumentResponse.dispose();\n            this._currentDocumentResponse = null;\n        }\n        if (this._isDisposed) {\n            // disposed!\n            if (provider && tokens) {\n                provider.releaseDocumentSemanticTokens(tokens.resultId);\n            }\n            return;\n        }\n        if (!provider || !styling) {\n            this._model.tokenization.setSemanticTokens(null, false);\n            return;\n        }\n        if (!tokens) {\n            this._model.tokenization.setSemanticTokens(null, true);\n            rescheduleIfNeeded();\n            return;\n        }\n        if (isSemanticTokensEdits(tokens)) {\n            if (!currentResponse) {\n                // not possible!\n                this._model.tokenization.setSemanticTokens(null, true);\n                return;\n            }\n            if (tokens.edits.length === 0) {\n                // nothing to do!\n                tokens = {\n                    resultId: tokens.resultId,\n                    data: currentResponse.data\n                };\n            }\n            else {\n                let deltaLength = 0;\n                for (const edit of tokens.edits) {\n                    deltaLength += (edit.data ? edit.data.length : 0) - edit.deleteCount;\n                }\n                const srcData = currentResponse.data;\n                const destData = new Uint32Array(srcData.length + deltaLength);\n                let srcLastStart = srcData.length;\n                let destLastStart = destData.length;\n                for (let i = tokens.edits.length - 1; i >= 0; i--) {\n                    const edit = tokens.edits[i];\n                    if (edit.start > srcData.length) {\n                        styling.warnInvalidEditStart(currentResponse.resultId, tokens.resultId, i, edit.start, srcData.length);\n                        // The edits are invalid and there's no way to recover\n                        this._model.tokenization.setSemanticTokens(null, true);\n                        return;\n                    }\n                    const copyCount = srcLastStart - (edit.start + edit.deleteCount);\n                    if (copyCount > 0) {\n                        ModelSemanticColoring_1._copy(srcData, srcLastStart - copyCount, destData, destLastStart - copyCount, copyCount);\n                        destLastStart -= copyCount;\n                    }\n                    if (edit.data) {\n                        ModelSemanticColoring_1._copy(edit.data, 0, destData, destLastStart - edit.data.length, edit.data.length);\n                        destLastStart -= edit.data.length;\n                    }\n                    srcLastStart = edit.start;\n                }\n                if (srcLastStart > 0) {\n                    ModelSemanticColoring_1._copy(srcData, 0, destData, 0, srcLastStart);\n                }\n                tokens = {\n                    resultId: tokens.resultId,\n                    data: destData\n                };\n            }\n        }\n        if (isSemanticTokens(tokens)) {\n            this._currentDocumentResponse = new SemanticTokensResponse(provider, tokens.resultId, tokens.data);\n            const result = toMultilineTokens2(tokens, styling, this._model.getLanguageId());\n            // Adjust incoming semantic tokens\n            if (pendingChanges.length > 0) {\n                // More changes occurred while the request was running\n                // We need to:\n                // 1. Adjust incoming semantic tokens\n                // 2. Request them again\n                for (const change of pendingChanges) {\n                    for (const area of result) {\n                        for (const singleChange of change.changes) {\n                            area.applyEdit(singleChange.range, singleChange.text);\n                        }\n                    }\n                }\n            }\n            this._model.tokenization.setSemanticTokens(result, true);\n        }\n        else {\n            this._model.tokenization.setSemanticTokens(null, true);\n        }\n        rescheduleIfNeeded();\n    }\n};\nModelSemanticColoring = ModelSemanticColoring_1 = __decorate([\n    __param(1, ISemanticTokensStylingService),\n    __param(2, IThemeService),\n    __param(3, ILanguageFeatureDebounceService),\n    __param(4, ILanguageFeaturesService)\n], ModelSemanticColoring);\nclass SemanticTokensResponse {\n    constructor(provider, resultId, data) {\n        this.provider = provider;\n        this.resultId = resultId;\n        this.data = data;\n    }\n    dispose() {\n        this.provider.releaseDocumentSemanticTokens(this.resultId);\n    }\n}\nregisterEditorFeature(DocumentSemanticTokensFeature);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { createCancelablePromise, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { getDocumentRangeSemanticTokens, hasDocumentRangeSemanticTokensProvider } from '../common/getSemanticTokens.js';\nimport { isSemanticColoringEnabled, SEMANTIC_HIGHLIGHTING_SETTING_ID } from '../common/semanticTokensConfig.js';\nimport { toMultilineTokens2 } from '../../../common/services/semanticTokensProviderStyling.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ISemanticTokensStylingService } from '../../../common/services/semanticTokensStyling.js';\nlet ViewportSemanticTokensContribution = class ViewportSemanticTokensContribution extends Disposable {\n    static { this.ID = 'editor.contrib.viewportSemanticTokens'; }\n    constructor(editor, _semanticTokensStylingService, _themeService, _configurationService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this._semanticTokensStylingService = _semanticTokensStylingService;\n        this._themeService = _themeService;\n        this._configurationService = _configurationService;\n        this._editor = editor;\n        this._provider = languageFeaturesService.documentRangeSemanticTokensProvider;\n        this._debounceInformation = languageFeatureDebounceService.for(this._provider, 'DocumentRangeSemanticTokens', { min: 100, max: 500 });\n        this._tokenizeViewport = this._register(new RunOnceScheduler(() => this._tokenizeViewportNow(), 100));\n        this._outstandingRequests = [];\n        const scheduleTokenizeViewport = () => {\n            if (this._editor.hasModel()) {\n                this._tokenizeViewport.schedule(this._debounceInformation.get(this._editor.getModel()));\n            }\n        };\n        this._register(this._editor.onDidScrollChange(() => {\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._editor.onDidChangeModel(() => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._editor.onDidChangeModelContent((e) => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._provider.onDidChange(() => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        this._register(this._configurationService.onDidChangeConfiguration(e => {\n            if (e.affectsConfiguration(SEMANTIC_HIGHLIGHTING_SETTING_ID)) {\n                this._cancelAll();\n                scheduleTokenizeViewport();\n            }\n        }));\n        this._register(this._themeService.onDidColorThemeChange(() => {\n            this._cancelAll();\n            scheduleTokenizeViewport();\n        }));\n        scheduleTokenizeViewport();\n    }\n    _cancelAll() {\n        for (const request of this._outstandingRequests) {\n            request.cancel();\n        }\n        this._outstandingRequests = [];\n    }\n    _removeOutstandingRequest(req) {\n        for (let i = 0, len = this._outstandingRequests.length; i < len; i++) {\n            if (this._outstandingRequests[i] === req) {\n                this._outstandingRequests.splice(i, 1);\n                return;\n            }\n        }\n    }\n    _tokenizeViewportNow() {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        if (model.tokenization.hasCompleteSemanticTokens()) {\n            return;\n        }\n        if (!isSemanticColoringEnabled(model, this._themeService, this._configurationService)) {\n            if (model.tokenization.hasSomeSemanticTokens()) {\n                model.tokenization.setSemanticTokens(null, false);\n            }\n            return;\n        }\n        if (!hasDocumentRangeSemanticTokensProvider(this._provider, model)) {\n            if (model.tokenization.hasSomeSemanticTokens()) {\n                model.tokenization.setSemanticTokens(null, false);\n            }\n            return;\n        }\n        const visibleRanges = this._editor.getVisibleRangesPlusViewportAboveBelow();\n        this._outstandingRequests = this._outstandingRequests.concat(visibleRanges.map(range => this._requestRange(model, range)));\n    }\n    _requestRange(model, range) {\n        const requestVersionId = model.getVersionId();\n        const request = createCancelablePromise(token => Promise.resolve(getDocumentRangeSemanticTokens(this._provider, model, range, token)));\n        const sw = new StopWatch(false);\n        request.then((r) => {\n            this._debounceInformation.update(model, sw.elapsed());\n            if (!r || !r.tokens || model.isDisposed() || model.getVersionId() !== requestVersionId) {\n                return;\n            }\n            const { provider, tokens: result } = r;\n            const styling = this._semanticTokensStylingService.getStyling(provider);\n            model.tokenization.setPartialSemanticTokens(range, toMultilineTokens2(result, styling, model.getLanguageId()));\n        }).then(() => this._removeOutstandingRequest(request), () => this._removeOutstandingRequest(request));\n        return request;\n    }\n};\nViewportSemanticTokensContribution = __decorate([\n    __param(1, ISemanticTokensStylingService),\n    __param(2, IThemeService),\n    __param(3, IConfigurationService),\n    __param(4, ILanguageFeatureDebounceService),\n    __param(5, ILanguageFeaturesService)\n], ViewportSemanticTokensContribution);\nexport { ViewportSemanticTokensContribution };\nregisterEditorContribution(ViewportSemanticTokensContribution.ID, ViewportSemanticTokensContribution, 1 /* EditorContributionInstantiation.AfterFirstRender */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { isLowerAsciiLetter, isUpperAsciiLetter } from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nexport class WordSelectionRangeProvider {\n    constructor(selectSubwords = true) {\n        this.selectSubwords = selectSubwords;\n    }\n    provideSelectionRanges(model, positions) {\n        const result = [];\n        for (const position of positions) {\n            const bucket = [];\n            result.push(bucket);\n            if (this.selectSubwords) {\n                this._addInWordRanges(bucket, model, position);\n            }\n            this._addWordRanges(bucket, model, position);\n            this._addWhitespaceLine(bucket, model, position);\n            bucket.push({ range: model.getFullModelRange() });\n        }\n        return result;\n    }\n    _addInWordRanges(bucket, model, pos) {\n        const obj = model.getWordAtPosition(pos);\n        if (!obj) {\n            return;\n        }\n        const { word, startColumn } = obj;\n        const offset = pos.column - startColumn;\n        let start = offset;\n        let end = offset;\n        let lastCh = 0;\n        // LEFT anchor (start)\n        for (; start >= 0; start--) {\n            const ch = word.charCodeAt(start);\n            if ((start !== offset) && (ch === 95 /* CharCode.Underline */ || ch === 45 /* CharCode.Dash */)) {\n                // foo-bar OR foo_bar\n                break;\n            }\n            else if (isLowerAsciiLetter(ch) && isUpperAsciiLetter(lastCh)) {\n                // fooBar\n                break;\n            }\n            lastCh = ch;\n        }\n        start += 1;\n        // RIGHT anchor (end)\n        for (; end < word.length; end++) {\n            const ch = word.charCodeAt(end);\n            if (isUpperAsciiLetter(ch) && isLowerAsciiLetter(lastCh)) {\n                // fooBar\n                break;\n            }\n            else if (ch === 95 /* CharCode.Underline */ || ch === 45 /* CharCode.Dash */) {\n                // foo-bar OR foo_bar\n                break;\n            }\n            lastCh = ch;\n        }\n        if (start < end) {\n            bucket.push({ range: new Range(pos.lineNumber, startColumn + start, pos.lineNumber, startColumn + end) });\n        }\n    }\n    _addWordRanges(bucket, model, pos) {\n        const word = model.getWordAtPosition(pos);\n        if (word) {\n            bucket.push({ range: new Range(pos.lineNumber, word.startColumn, pos.lineNumber, word.endColumn) });\n        }\n    }\n    _addWhitespaceLine(bucket, model, pos) {\n        if (model.getLineLength(pos.lineNumber) > 0\n            && model.getLineFirstNonWhitespaceColumn(pos.lineNumber) === 0\n            && model.getLineLastNonWhitespaceColumn(pos.lineNumber) === 0) {\n            bucket.push({ range: new Range(pos.lineNumber, 1, pos.lineNumber, model.getLineMaxColumn(pos.lineNumber)) });\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar SmartSelectController_1;\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { BracketSelectionRangeProvider } from './bracketSelections.js';\nimport { WordSelectionRangeProvider } from './wordSelections.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nclass SelectionRanges {\n    constructor(index, ranges) {\n        this.index = index;\n        this.ranges = ranges;\n    }\n    mov(fwd) {\n        const index = this.index + (fwd ? 1 : -1);\n        if (index < 0 || index >= this.ranges.length) {\n            return this;\n        }\n        const res = new SelectionRanges(index, this.ranges);\n        if (res.ranges[index].equalsRange(this.ranges[this.index])) {\n            // next range equals this range, retry with next-next\n            return res.mov(fwd);\n        }\n        return res;\n    }\n}\nlet SmartSelectController = class SmartSelectController {\n    static { SmartSelectController_1 = this; }\n    static { this.ID = 'editor.contrib.smartSelectController'; }\n    static get(editor) {\n        return editor.getContribution(SmartSelectController_1.ID);\n    }\n    constructor(_editor, _languageFeaturesService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._ignoreSelection = false;\n    }\n    dispose() {\n        this._selectionListener?.dispose();\n    }\n    async run(forward) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const selections = this._editor.getSelections();\n        const model = this._editor.getModel();\n        if (!this._state) {\n            await provideSelectionRanges(this._languageFeaturesService.selectionRangeProvider, model, selections.map(s => s.getPosition()), this._editor.getOption(114 /* EditorOption.smartSelect */), CancellationToken.None).then(ranges => {\n                if (!arrays.isNonEmptyArray(ranges) || ranges.length !== selections.length) {\n                    // invalid result\n                    return;\n                }\n                if (!this._editor.hasModel() || !arrays.equals(this._editor.getSelections(), selections, (a, b) => a.equalsSelection(b))) {\n                    // invalid editor state\n                    return;\n                }\n                for (let i = 0; i < ranges.length; i++) {\n                    ranges[i] = ranges[i].filter(range => {\n                        // filter ranges inside the selection\n                        return range.containsPosition(selections[i].getStartPosition()) && range.containsPosition(selections[i].getEndPosition());\n                    });\n                    // prepend current selection\n                    ranges[i].unshift(selections[i]);\n                }\n                this._state = ranges.map(ranges => new SelectionRanges(0, ranges));\n                // listen to caret move and forget about state\n                this._selectionListener?.dispose();\n                this._selectionListener = this._editor.onDidChangeCursorPosition(() => {\n                    if (!this._ignoreSelection) {\n                        this._selectionListener?.dispose();\n                        this._state = undefined;\n                    }\n                });\n            });\n        }\n        if (!this._state) {\n            // no state\n            return;\n        }\n        this._state = this._state.map(state => state.mov(forward));\n        const newSelections = this._state.map(state => Selection.fromPositions(state.ranges[state.index].getStartPosition(), state.ranges[state.index].getEndPosition()));\n        this._ignoreSelection = true;\n        try {\n            this._editor.setSelections(newSelections);\n        }\n        finally {\n            this._ignoreSelection = false;\n        }\n    }\n};\nSmartSelectController = SmartSelectController_1 = __decorate([\n    __param(1, ILanguageFeaturesService)\n], SmartSelectController);\nexport { SmartSelectController };\nclass AbstractSmartSelect extends EditorAction {\n    constructor(forward, opts) {\n        super(opts);\n        this._forward = forward;\n    }\n    async run(_accessor, editor) {\n        const controller = SmartSelectController.get(editor);\n        if (controller) {\n            await controller.run(this._forward);\n        }\n    }\n}\nclass GrowSelectionAction extends AbstractSmartSelect {\n    constructor() {\n        super(true, {\n            id: 'editor.action.smartSelect.expand',\n            label: nls.localize('smartSelect.expand', \"Expand Selection\"),\n            alias: 'Expand Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 17 /* KeyCode.RightArrow */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */,\n                    secondary: [256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */],\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '1_basic',\n                title: nls.localize({ key: 'miSmartSelectGrow', comment: ['&& denotes a mnemonic'] }, \"&&Expand Selection\"),\n                order: 2\n            }\n        });\n    }\n}\n// renamed command id\nCommandsRegistry.registerCommandAlias('editor.action.smartSelect.grow', 'editor.action.smartSelect.expand');\nclass ShrinkSelectionAction extends AbstractSmartSelect {\n    constructor() {\n        super(false, {\n            id: 'editor.action.smartSelect.shrink',\n            label: nls.localize('smartSelect.shrink', \"Shrink Selection\"),\n            alias: 'Shrink Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 15 /* KeyCode.LeftArrow */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */,\n                    secondary: [256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */],\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '1_basic',\n                title: nls.localize({ key: 'miSmartSelectShrink', comment: ['&& denotes a mnemonic'] }, \"&&Shrink Selection\"),\n                order: 3\n            }\n        });\n    }\n}\nregisterEditorContribution(SmartSelectController.ID, SmartSelectController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(GrowSelectionAction);\nregisterEditorAction(ShrinkSelectionAction);\nexport async function provideSelectionRanges(registry, model, positions, options, token) {\n    const providers = registry.all(model)\n        .concat(new WordSelectionRangeProvider(options.selectSubwords)); // ALWAYS have word based selection range\n    if (providers.length === 1) {\n        // add word selection and bracket selection when no provider exists\n        providers.unshift(new BracketSelectionRangeProvider());\n    }\n    const work = [];\n    const allRawRanges = [];\n    for (const provider of providers) {\n        work.push(Promise.resolve(provider.provideSelectionRanges(model, positions, token)).then(allProviderRanges => {\n            if (arrays.isNonEmptyArray(allProviderRanges) && allProviderRanges.length === positions.length) {\n                for (let i = 0; i < positions.length; i++) {\n                    if (!allRawRanges[i]) {\n                        allRawRanges[i] = [];\n                    }\n                    for (const oneProviderRanges of allProviderRanges[i]) {\n                        if (Range.isIRange(oneProviderRanges.range) && Range.containsPosition(oneProviderRanges.range, positions[i])) {\n                            allRawRanges[i].push(Range.lift(oneProviderRanges.range));\n                        }\n                    }\n                }\n            }\n        }, onUnexpectedExternalError));\n    }\n    await Promise.all(work);\n    return allRawRanges.map(oneRawRanges => {\n        if (oneRawRanges.length === 0) {\n            return [];\n        }\n        // sort all by start/end position\n        oneRawRanges.sort((a, b) => {\n            if (Position.isBefore(a.getStartPosition(), b.getStartPosition())) {\n                return 1;\n            }\n            else if (Position.isBefore(b.getStartPosition(), a.getStartPosition())) {\n                return -1;\n            }\n            else if (Position.isBefore(a.getEndPosition(), b.getEndPosition())) {\n                return -1;\n            }\n            else if (Position.isBefore(b.getEndPosition(), a.getEndPosition())) {\n                return 1;\n            }\n            else {\n                return 0;\n            }\n        });\n        // remove ranges that don't contain the former range or that are equal to the\n        // former range\n        const oneRanges = [];\n        let last;\n        for (const range of oneRawRanges) {\n            if (!last || (Range.containsRange(range, last) && !Range.equalsRange(range, last))) {\n                oneRanges.push(range);\n                last = range;\n            }\n        }\n        if (!options.selectLeadingAndTrailingWhitespace) {\n            return oneRanges;\n        }\n        // add ranges that expand trivia at line starts and ends whenever a range\n        // wraps onto the a new line\n        const oneRangesWithTrivia = [oneRanges[0]];\n        for (let i = 1; i < oneRanges.length; i++) {\n            const prev = oneRanges[i - 1];\n            const cur = oneRanges[i];\n            if (cur.startLineNumber !== prev.startLineNumber || cur.endLineNumber !== prev.endLineNumber) {\n                // add line/block range without leading/failing whitespace\n                const rangeNoWhitespace = new Range(prev.startLineNumber, model.getLineFirstNonWhitespaceColumn(prev.startLineNumber), prev.endLineNumber, model.getLineLastNonWhitespaceColumn(prev.endLineNumber));\n                if (rangeNoWhitespace.containsRange(prev) && !rangeNoWhitespace.equalsRange(prev) && cur.containsRange(rangeNoWhitespace) && !cur.equalsRange(rangeNoWhitespace)) {\n                    oneRangesWithTrivia.push(rangeNoWhitespace);\n                }\n                // add line/block range\n                const rangeFull = new Range(prev.startLineNumber, 1, prev.endLineNumber, model.getLineMaxColumn(prev.endLineNumber));\n                if (rangeFull.containsRange(prev) && !rangeFull.equalsRange(rangeNoWhitespace) && cur.containsRange(rangeFull) && !cur.equalsRange(rangeFull)) {\n                    oneRangesWithTrivia.push(rangeFull);\n                }\n            }\n            oneRangesWithTrivia.push(cur);\n        }\n        return oneRangesWithTrivia;\n    });\n}\nCommandsRegistry.registerCommand('_executeSelectionRangeProvider', async function (accessor, ...args) {\n    const [resource, positions] = args;\n    assertType(URI.isUri(resource));\n    const registry = accessor.get(ILanguageFeaturesService).selectionRangeProvider;\n    const reference = await accessor.get(ITextModelService).createModelReference(resource);\n    try {\n        return provideSelectionRanges(registry, reference.object.textEditorModel, positions, { selectLeadingAndTrailingWhitespace: true, selectSubwords: true }, CancellationToken.None);\n    }\n    finally {\n        reference.dispose();\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { createTrustedTypesPolicy } from '../../../../base/browser/trustedTypes.js';\nimport { equals } from '../../../../base/common/arrays.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport './stickyScroll.css';\nimport { getColumnOfNodeOffset } from '../../../browser/viewParts/lines/viewLine.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/codeEditor/embeddedCodeEditorWidget.js';\nimport { Position } from '../../../common/core/position.js';\nimport { StringBuilder } from '../../../common/core/stringBuilder.js';\nimport { LineDecoration } from '../../../common/viewLayout/lineDecorations.js';\nimport { RenderLineInput, renderViewLine } from '../../../common/viewLayout/viewLineRenderer.js';\nimport { foldingCollapsedIcon, foldingExpandedIcon } from '../../folding/browser/foldingDecorations.js';\nexport class StickyScrollWidgetState {\n    constructor(startLineNumbers, endLineNumbers, lastLineRelativePosition, showEndForLine = null) {\n        this.startLineNumbers = startLineNumbers;\n        this.endLineNumbers = endLineNumbers;\n        this.lastLineRelativePosition = lastLineRelativePosition;\n        this.showEndForLine = showEndForLine;\n    }\n    equals(other) {\n        return !!other\n            && this.lastLineRelativePosition === other.lastLineRelativePosition\n            && this.showEndForLine === other.showEndForLine\n            && equals(this.startLineNumbers, other.startLineNumbers)\n            && equals(this.endLineNumbers, other.endLineNumbers);\n    }\n    static get Empty() {\n        return new StickyScrollWidgetState([], [], 0);\n    }\n}\nconst _ttPolicy = createTrustedTypesPolicy('stickyScrollViewLayer', { createHTML: value => value });\nconst STICKY_INDEX_ATTR = 'data-sticky-line-index';\nconst STICKY_IS_LINE_ATTR = 'data-sticky-is-line';\nconst STICKY_IS_LINE_NUMBER_ATTR = 'data-sticky-is-line-number';\nconst STICKY_IS_FOLDING_ICON_ATTR = 'data-sticky-is-folding-icon';\nexport class StickyScrollWidget extends Disposable {\n    constructor(_editor) {\n        super();\n        this._editor = _editor;\n        this._foldingIconStore = new DisposableStore();\n        this._rootDomNode = document.createElement('div');\n        this._lineNumbersDomNode = document.createElement('div');\n        this._linesDomNodeScrollable = document.createElement('div');\n        this._linesDomNode = document.createElement('div');\n        this._lineHeight = this._editor.getOption(67 /* EditorOption.lineHeight */);\n        this._renderedStickyLines = [];\n        this._lineNumbers = [];\n        this._lastLineRelativePosition = 0;\n        this._minContentWidthInPx = 0;\n        this._isOnGlyphMargin = false;\n        this._lineNumbersDomNode.className = 'sticky-widget-line-numbers';\n        this._lineNumbersDomNode.setAttribute('role', 'none');\n        this._linesDomNode.className = 'sticky-widget-lines';\n        this._linesDomNode.setAttribute('role', 'list');\n        this._linesDomNodeScrollable.className = 'sticky-widget-lines-scrollable';\n        this._linesDomNodeScrollable.appendChild(this._linesDomNode);\n        this._rootDomNode.className = 'sticky-widget';\n        this._rootDomNode.classList.toggle('peek', _editor instanceof EmbeddedCodeEditorWidget);\n        this._rootDomNode.appendChild(this._lineNumbersDomNode);\n        this._rootDomNode.appendChild(this._linesDomNodeScrollable);\n        const updateScrollLeftPosition = () => {\n            this._linesDomNode.style.left = this._editor.getOption(116 /* EditorOption.stickyScroll */).scrollWithEditor ? `-${this._editor.getScrollLeft()}px` : '0px';\n        };\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(116 /* EditorOption.stickyScroll */)) {\n                updateScrollLeftPosition();\n            }\n            if (e.hasChanged(67 /* EditorOption.lineHeight */)) {\n                this._lineHeight = this._editor.getOption(67 /* EditorOption.lineHeight */);\n            }\n        }));\n        this._register(this._editor.onDidScrollChange((e) => {\n            if (e.scrollLeftChanged) {\n                updateScrollLeftPosition();\n            }\n            if (e.scrollWidthChanged) {\n                this._updateWidgetWidth();\n            }\n        }));\n        this._register(this._editor.onDidChangeModel(() => {\n            updateScrollLeftPosition();\n            this._updateWidgetWidth();\n        }));\n        this._register(this._foldingIconStore);\n        updateScrollLeftPosition();\n        this._register(this._editor.onDidLayoutChange((e) => {\n            this._updateWidgetWidth();\n        }));\n        this._updateWidgetWidth();\n    }\n    get lineNumbers() {\n        return this._lineNumbers;\n    }\n    get lineNumberCount() {\n        return this._lineNumbers.length;\n    }\n    getRenderedStickyLine(lineNumber) {\n        return this._renderedStickyLines.find(stickyLine => stickyLine.lineNumber === lineNumber);\n    }\n    getCurrentLines() {\n        return this._lineNumbers;\n    }\n    setState(_state, foldingModel, _rebuildFromLine) {\n        if (_rebuildFromLine === undefined &&\n            ((!this._previousState && !_state) || (this._previousState && this._previousState.equals(_state)))) {\n            return;\n        }\n        const isWidgetHeightZero = this._isWidgetHeightZero(_state);\n        const state = isWidgetHeightZero ? undefined : _state;\n        const rebuildFromLine = isWidgetHeightZero ? 0 : this._findLineToRebuildWidgetFrom(_state, _rebuildFromLine);\n        this._renderRootNode(state, foldingModel, rebuildFromLine);\n        this._previousState = _state;\n    }\n    _isWidgetHeightZero(state) {\n        if (!state) {\n            return true;\n        }\n        const futureWidgetHeight = state.startLineNumbers.length * this._lineHeight + state.lastLineRelativePosition;\n        if (futureWidgetHeight > 0) {\n            this._lastLineRelativePosition = state.lastLineRelativePosition;\n            const lineNumbers = [...state.startLineNumbers];\n            if (state.showEndForLine !== null) {\n                lineNumbers[state.showEndForLine] = state.endLineNumbers[state.showEndForLine];\n            }\n            this._lineNumbers = lineNumbers;\n        }\n        else {\n            this._lastLineRelativePosition = 0;\n            this._lineNumbers = [];\n        }\n        return futureWidgetHeight === 0;\n    }\n    _findLineToRebuildWidgetFrom(state, _rebuildFromLine) {\n        if (!state || !this._previousState) {\n            return 0;\n        }\n        if (_rebuildFromLine !== undefined) {\n            return _rebuildFromLine;\n        }\n        const previousState = this._previousState;\n        const indexOfLinesAlreadyRendered = state.startLineNumbers.findIndex(startLineNumber => !previousState.startLineNumbers.includes(startLineNumber));\n        return (indexOfLinesAlreadyRendered === -1) ? 0 : indexOfLinesAlreadyRendered;\n    }\n    _updateWidgetWidth() {\n        const layoutInfo = this._editor.getLayoutInfo();\n        const lineNumbersWidth = layoutInfo.contentLeft;\n        this._lineNumbersDomNode.style.width = `${lineNumbersWidth}px`;\n        this._linesDomNodeScrollable.style.setProperty('--vscode-editorStickyScroll-scrollableWidth', `${this._editor.getScrollWidth() - layoutInfo.verticalScrollbarWidth}px`);\n        this._rootDomNode.style.width = `${layoutInfo.width - layoutInfo.verticalScrollbarWidth}px`;\n    }\n    _clearStickyLinesFromLine(clearFromLine) {\n        this._foldingIconStore.clear();\n        // Removing only the lines that need to be rerendered\n        for (let i = clearFromLine; i < this._renderedStickyLines.length; i++) {\n            const stickyLine = this._renderedStickyLines[i];\n            stickyLine.lineNumberDomNode.remove();\n            stickyLine.lineDomNode.remove();\n        }\n        // Keep the lines that need to be updated\n        this._renderedStickyLines = this._renderedStickyLines.slice(0, clearFromLine);\n        this._rootDomNode.style.display = 'none';\n    }\n    _useFoldingOpacityTransition(requireTransitions) {\n        this._lineNumbersDomNode.style.setProperty('--vscode-editorStickyScroll-foldingOpacityTransition', `opacity ${requireTransitions ? 0.5 : 0}s`);\n    }\n    _setFoldingIconsVisibility(allVisible) {\n        for (const line of this._renderedStickyLines) {\n            const foldingIcon = line.foldingIcon;\n            if (!foldingIcon) {\n                continue;\n            }\n            foldingIcon.setVisible(allVisible ? true : foldingIcon.isCollapsed);\n        }\n    }\n    async _renderRootNode(state, foldingModel, rebuildFromLine) {\n        this._clearStickyLinesFromLine(rebuildFromLine);\n        if (!state) {\n            return;\n        }\n        // For existing sticky lines update the top and z-index\n        for (const stickyLine of this._renderedStickyLines) {\n            this._updateTopAndZIndexOfStickyLine(stickyLine);\n        }\n        // For new sticky lines\n        const layoutInfo = this._editor.getLayoutInfo();\n        const linesToRender = this._lineNumbers.slice(rebuildFromLine);\n        for (const [index, line] of linesToRender.entries()) {\n            const stickyLine = this._renderChildNode(index + rebuildFromLine, line, foldingModel, layoutInfo);\n            if (!stickyLine) {\n                continue;\n            }\n            this._linesDomNode.appendChild(stickyLine.lineDomNode);\n            this._lineNumbersDomNode.appendChild(stickyLine.lineNumberDomNode);\n            this._renderedStickyLines.push(stickyLine);\n        }\n        if (foldingModel) {\n            this._setFoldingHoverListeners();\n            this._useFoldingOpacityTransition(!this._isOnGlyphMargin);\n        }\n        const widgetHeight = this._lineNumbers.length * this._lineHeight + this._lastLineRelativePosition;\n        this._rootDomNode.style.display = 'block';\n        this._lineNumbersDomNode.style.height = `${widgetHeight}px`;\n        this._linesDomNodeScrollable.style.height = `${widgetHeight}px`;\n        this._rootDomNode.style.height = `${widgetHeight}px`;\n        this._rootDomNode.style.marginLeft = '0px';\n        this._minContentWidthInPx = Math.max(...this._renderedStickyLines.map(l => l.scrollWidth)) + layoutInfo.verticalScrollbarWidth;\n        this._editor.layoutOverlayWidget(this);\n    }\n    _setFoldingHoverListeners() {\n        const showFoldingControls = this._editor.getOption(111 /* EditorOption.showFoldingControls */);\n        if (showFoldingControls !== 'mouseover') {\n            return;\n        }\n        this._foldingIconStore.add(dom.addDisposableListener(this._lineNumbersDomNode, dom.EventType.MOUSE_ENTER, () => {\n            this._isOnGlyphMargin = true;\n            this._setFoldingIconsVisibility(true);\n        }));\n        this._foldingIconStore.add(dom.addDisposableListener(this._lineNumbersDomNode, dom.EventType.MOUSE_LEAVE, () => {\n            this._isOnGlyphMargin = false;\n            this._useFoldingOpacityTransition(true);\n            this._setFoldingIconsVisibility(false);\n        }));\n    }\n    _renderChildNode(index, line, foldingModel, layoutInfo) {\n        const viewModel = this._editor._getViewModel();\n        if (!viewModel) {\n            return;\n        }\n        const viewLineNumber = viewModel.coordinatesConverter.convertModelPositionToViewPosition(new Position(line, 1)).lineNumber;\n        const lineRenderingData = viewModel.getViewLineRenderingData(viewLineNumber);\n        const lineNumberOption = this._editor.getOption(68 /* EditorOption.lineNumbers */);\n        let actualInlineDecorations;\n        try {\n            actualInlineDecorations = LineDecoration.filter(lineRenderingData.inlineDecorations, viewLineNumber, lineRenderingData.minColumn, lineRenderingData.maxColumn);\n        }\n        catch (err) {\n            actualInlineDecorations = [];\n        }\n        const renderLineInput = new RenderLineInput(true, true, lineRenderingData.content, lineRenderingData.continuesWithWrappedLine, lineRenderingData.isBasicASCII, lineRenderingData.containsRTL, 0, lineRenderingData.tokens, actualInlineDecorations, lineRenderingData.tabSize, lineRenderingData.startVisibleColumn, 1, 1, 1, 500, 'none', true, true, null);\n        const sb = new StringBuilder(2000);\n        const renderOutput = renderViewLine(renderLineInput, sb);\n        let newLine;\n        if (_ttPolicy) {\n            newLine = _ttPolicy.createHTML(sb.build());\n        }\n        else {\n            newLine = sb.build();\n        }\n        const lineHTMLNode = document.createElement('span');\n        lineHTMLNode.setAttribute(STICKY_INDEX_ATTR, String(index));\n        lineHTMLNode.setAttribute(STICKY_IS_LINE_ATTR, '');\n        lineHTMLNode.setAttribute('role', 'listitem');\n        lineHTMLNode.tabIndex = 0;\n        lineHTMLNode.className = 'sticky-line-content';\n        lineHTMLNode.classList.add(`stickyLine${line}`);\n        lineHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n        lineHTMLNode.innerHTML = newLine;\n        const lineNumberHTMLNode = document.createElement('span');\n        lineNumberHTMLNode.setAttribute(STICKY_INDEX_ATTR, String(index));\n        lineNumberHTMLNode.setAttribute(STICKY_IS_LINE_NUMBER_ATTR, '');\n        lineNumberHTMLNode.className = 'sticky-line-number';\n        lineNumberHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n        const lineNumbersWidth = layoutInfo.contentLeft;\n        lineNumberHTMLNode.style.width = `${lineNumbersWidth}px`;\n        const innerLineNumberHTML = document.createElement('span');\n        if (lineNumberOption.renderType === 1 /* RenderLineNumbersType.On */ || lineNumberOption.renderType === 3 /* RenderLineNumbersType.Interval */ && line % 10 === 0) {\n            innerLineNumberHTML.innerText = line.toString();\n        }\n        else if (lineNumberOption.renderType === 2 /* RenderLineNumbersType.Relative */) {\n            innerLineNumberHTML.innerText = Math.abs(line - this._editor.getPosition().lineNumber).toString();\n        }\n        innerLineNumberHTML.className = 'sticky-line-number-inner';\n        innerLineNumberHTML.style.lineHeight = `${this._lineHeight}px`;\n        innerLineNumberHTML.style.width = `${layoutInfo.lineNumbersWidth}px`;\n        innerLineNumberHTML.style.paddingLeft = `${layoutInfo.lineNumbersLeft}px`;\n        lineNumberHTMLNode.appendChild(innerLineNumberHTML);\n        const foldingIcon = this._renderFoldingIconForLine(foldingModel, line);\n        if (foldingIcon) {\n            lineNumberHTMLNode.appendChild(foldingIcon.domNode);\n        }\n        this._editor.applyFontInfo(lineHTMLNode);\n        this._editor.applyFontInfo(innerLineNumberHTML);\n        lineNumberHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n        lineHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n        lineNumberHTMLNode.style.height = `${this._lineHeight}px`;\n        lineHTMLNode.style.height = `${this._lineHeight}px`;\n        const renderedLine = new RenderedStickyLine(index, line, lineHTMLNode, lineNumberHTMLNode, foldingIcon, renderOutput.characterMapping, lineHTMLNode.scrollWidth);\n        return this._updateTopAndZIndexOfStickyLine(renderedLine);\n    }\n    _updateTopAndZIndexOfStickyLine(stickyLine) {\n        const index = stickyLine.index;\n        const lineHTMLNode = stickyLine.lineDomNode;\n        const lineNumberHTMLNode = stickyLine.lineNumberDomNode;\n        const isLastLine = index === this._lineNumbers.length - 1;\n        const lastLineZIndex = '0';\n        const intermediateLineZIndex = '1';\n        lineHTMLNode.style.zIndex = isLastLine ? lastLineZIndex : intermediateLineZIndex;\n        lineNumberHTMLNode.style.zIndex = isLastLine ? lastLineZIndex : intermediateLineZIndex;\n        const lastLineTop = `${index * this._lineHeight + this._lastLineRelativePosition + (stickyLine.foldingIcon?.isCollapsed ? 1 : 0)}px`;\n        const intermediateLineTop = `${index * this._lineHeight}px`;\n        lineHTMLNode.style.top = isLastLine ? lastLineTop : intermediateLineTop;\n        lineNumberHTMLNode.style.top = isLastLine ? lastLineTop : intermediateLineTop;\n        return stickyLine;\n    }\n    _renderFoldingIconForLine(foldingModel, line) {\n        const showFoldingControls = this._editor.getOption(111 /* EditorOption.showFoldingControls */);\n        if (!foldingModel || showFoldingControls === 'never') {\n            return;\n        }\n        const foldingRegions = foldingModel.regions;\n        const indexOfFoldingRegion = foldingRegions.findRange(line);\n        const startLineNumber = foldingRegions.getStartLineNumber(indexOfFoldingRegion);\n        const isFoldingScope = line === startLineNumber;\n        if (!isFoldingScope) {\n            return;\n        }\n        const isCollapsed = foldingRegions.isCollapsed(indexOfFoldingRegion);\n        const foldingIcon = new StickyFoldingIcon(isCollapsed, startLineNumber, foldingRegions.getEndLineNumber(indexOfFoldingRegion), this._lineHeight);\n        foldingIcon.setVisible(this._isOnGlyphMargin ? true : (isCollapsed || showFoldingControls === 'always'));\n        foldingIcon.domNode.setAttribute(STICKY_IS_FOLDING_ICON_ATTR, '');\n        return foldingIcon;\n    }\n    getId() {\n        return 'editor.contrib.stickyScrollWidget';\n    }\n    getDomNode() {\n        return this._rootDomNode;\n    }\n    getPosition() {\n        return {\n            preference: 2 /* OverlayWidgetPositionPreference.TOP_CENTER */,\n            stackOridinal: 10,\n        };\n    }\n    getMinContentWidthInPx() {\n        return this._minContentWidthInPx;\n    }\n    focusLineWithIndex(index) {\n        if (0 <= index && index < this._renderedStickyLines.length) {\n            this._renderedStickyLines[index].lineDomNode.focus();\n        }\n    }\n    /**\n     * Given a leaf dom node, tries to find the editor position.\n     */\n    getEditorPositionFromNode(spanDomNode) {\n        if (!spanDomNode || spanDomNode.children.length > 0) {\n            // This is not a leaf node\n            return null;\n        }\n        const renderedStickyLine = this._getRenderedStickyLineFromChildDomNode(spanDomNode);\n        if (!renderedStickyLine) {\n            return null;\n        }\n        const column = getColumnOfNodeOffset(renderedStickyLine.characterMapping, spanDomNode, 0);\n        return new Position(renderedStickyLine.lineNumber, column);\n    }\n    getLineNumberFromChildDomNode(domNode) {\n        return this._getRenderedStickyLineFromChildDomNode(domNode)?.lineNumber ?? null;\n    }\n    _getRenderedStickyLineFromChildDomNode(domNode) {\n        const index = this.getLineIndexFromChildDomNode(domNode);\n        if (index === null || index < 0 || index >= this._renderedStickyLines.length) {\n            return null;\n        }\n        return this._renderedStickyLines[index];\n    }\n    /**\n     * Given a child dom node, tries to find the line number attribute that was stored in the node.\n     * @returns the attribute value or null if none is found.\n     */\n    getLineIndexFromChildDomNode(domNode) {\n        const lineIndex = this._getAttributeValue(domNode, STICKY_INDEX_ATTR);\n        return lineIndex ? parseInt(lineIndex, 10) : null;\n    }\n    /**\n     * Given a child dom node, tries to find if it is (contained in) a sticky line.\n     * @returns a boolean.\n     */\n    isInStickyLine(domNode) {\n        const isInLine = this._getAttributeValue(domNode, STICKY_IS_LINE_ATTR);\n        return isInLine !== undefined;\n    }\n    /**\n     * Given a child dom node, tries to find if this dom node is (contained in) a sticky folding icon.\n     * @returns a boolean.\n     */\n    isInFoldingIconDomNode(domNode) {\n        const isInFoldingIcon = this._getAttributeValue(domNode, STICKY_IS_FOLDING_ICON_ATTR);\n        return isInFoldingIcon !== undefined;\n    }\n    /**\n     * Given the dom node, finds if it or its parent sequence contains the given attribute.\n     * @returns the attribute value or undefined.\n     */\n    _getAttributeValue(domNode, attribute) {\n        while (domNode && domNode !== this._rootDomNode) {\n            const line = domNode.getAttribute(attribute);\n            if (line !== null) {\n                return line;\n            }\n            domNode = domNode.parentElement;\n        }\n        return;\n    }\n}\nclass RenderedStickyLine {\n    constructor(index, lineNumber, lineDomNode, lineNumberDomNode, foldingIcon, characterMapping, scrollWidth) {\n        this.index = index;\n        this.lineNumber = lineNumber;\n        this.lineDomNode = lineDomNode;\n        this.lineNumberDomNode = lineNumberDomNode;\n        this.foldingIcon = foldingIcon;\n        this.characterMapping = characterMapping;\n        this.scrollWidth = scrollWidth;\n    }\n}\nclass StickyFoldingIcon {\n    constructor(isCollapsed, foldingStartLine, foldingEndLine, dimension) {\n        this.isCollapsed = isCollapsed;\n        this.foldingStartLine = foldingStartLine;\n        this.foldingEndLine = foldingEndLine;\n        this.dimension = dimension;\n        this.domNode = document.createElement('div');\n        this.domNode.style.width = `${dimension}px`;\n        this.domNode.style.height = `${dimension}px`;\n        this.domNode.className = ThemeIcon.asClassName(isCollapsed ? foldingCollapsedIcon : foldingExpandedIcon);\n    }\n    setVisible(visible) {\n        this.domNode.style.cursor = visible ? 'pointer' : 'default';\n        this.domNode.style.opacity = visible ? '1' : '0';\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class StickyRange {\n    constructor(startLineNumber, endLineNumber) {\n        this.startLineNumber = startLineNumber;\n        this.endLineNumber = endLineNumber;\n    }\n}\nexport class StickyElement {\n    constructor(\n    /**\n     * Range of line numbers spanned by the current scope\n     */\n    range, \n    /**\n     * Must be sorted by start line number\n    */\n    children, \n    /**\n     * Parent sticky outline element\n     */\n    parent) {\n        this.range = range;\n        this.children = children;\n        this.parent = parent;\n    }\n}\nexport class StickyModel {\n    constructor(uri, version, element, outlineProviderId) {\n        this.uri = uri;\n        this.version = version;\n        this.element = element;\n        this.outlineProviderId = outlineProviderId;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { OutlineElement, OutlineGroup, OutlineModel } from '../../documentSymbols/browser/outlineModel.js';\nimport { createCancelablePromise, Delayer } from '../../../../base/common/async.js';\nimport { FoldingController, RangesLimitReporter } from '../../folding/browser/folding.js';\nimport { SyntaxRangeProvider } from '../../folding/browser/syntaxRangeProvider.js';\nimport { IndentRangeProvider } from '../../folding/browser/indentRangeProvider.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { StickyElement, StickyModel, StickyRange } from './stickyScrollElement.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nvar ModelProvider;\n(function (ModelProvider) {\n    ModelProvider[\"OUTLINE_MODEL\"] = \"outlineModel\";\n    ModelProvider[\"FOLDING_PROVIDER_MODEL\"] = \"foldingProviderModel\";\n    ModelProvider[\"INDENTATION_MODEL\"] = \"indentationModel\";\n})(ModelProvider || (ModelProvider = {}));\nvar Status;\n(function (Status) {\n    Status[Status[\"VALID\"] = 0] = \"VALID\";\n    Status[Status[\"INVALID\"] = 1] = \"INVALID\";\n    Status[Status[\"CANCELED\"] = 2] = \"CANCELED\";\n})(Status || (Status = {}));\nlet StickyModelProvider = class StickyModelProvider extends Disposable {\n    constructor(_editor, onProviderUpdate, _languageConfigurationService, _languageFeaturesService) {\n        super();\n        this._editor = _editor;\n        this._modelProviders = [];\n        this._modelPromise = null;\n        this._updateScheduler = this._register(new Delayer(300));\n        this._updateOperation = this._register(new DisposableStore());\n        switch (this._editor.getOption(116 /* EditorOption.stickyScroll */).defaultModel) {\n            case ModelProvider.OUTLINE_MODEL:\n                this._modelProviders.push(new StickyModelFromCandidateOutlineProvider(this._editor, _languageFeaturesService));\n            // fall through\n            case ModelProvider.FOLDING_PROVIDER_MODEL:\n                this._modelProviders.push(new StickyModelFromCandidateSyntaxFoldingProvider(this._editor, onProviderUpdate, _languageFeaturesService));\n            // fall through\n            case ModelProvider.INDENTATION_MODEL:\n                this._modelProviders.push(new StickyModelFromCandidateIndentationFoldingProvider(this._editor, _languageConfigurationService));\n                break;\n        }\n    }\n    dispose() {\n        this._modelProviders.forEach(provider => provider.dispose());\n        this._updateOperation.clear();\n        this._cancelModelPromise();\n        super.dispose();\n    }\n    _cancelModelPromise() {\n        if (this._modelPromise) {\n            this._modelPromise.cancel();\n            this._modelPromise = null;\n        }\n    }\n    async update(token) {\n        this._updateOperation.clear();\n        this._updateOperation.add({\n            dispose: () => {\n                this._cancelModelPromise();\n                this._updateScheduler.cancel();\n            }\n        });\n        this._cancelModelPromise();\n        return await this._updateScheduler.trigger(async () => {\n            for (const modelProvider of this._modelProviders) {\n                const { statusPromise, modelPromise } = modelProvider.computeStickyModel(token);\n                this._modelPromise = modelPromise;\n                const status = await statusPromise;\n                if (this._modelPromise !== modelPromise) {\n                    return null;\n                }\n                switch (status) {\n                    case Status.CANCELED:\n                        this._updateOperation.clear();\n                        return null;\n                    case Status.VALID:\n                        return modelProvider.stickyModel;\n                }\n            }\n            return null;\n        }).catch((error) => {\n            onUnexpectedError(error);\n            return null;\n        });\n    }\n};\nStickyModelProvider = __decorate([\n    __param(2, IInstantiationService),\n    __param(3, ILanguageFeaturesService)\n], StickyModelProvider);\nexport { StickyModelProvider };\nclass StickyModelCandidateProvider extends Disposable {\n    constructor(_editor) {\n        super();\n        this._editor = _editor;\n        this._stickyModel = null;\n    }\n    get stickyModel() {\n        return this._stickyModel;\n    }\n    _invalid() {\n        this._stickyModel = null;\n        return Status.INVALID;\n    }\n    computeStickyModel(token) {\n        if (token.isCancellationRequested || !this.isProviderValid()) {\n            return { statusPromise: this._invalid(), modelPromise: null };\n        }\n        const providerModelPromise = createCancelablePromise(token => this.createModelFromProvider(token));\n        return {\n            statusPromise: providerModelPromise.then(providerModel => {\n                if (!this.isModelValid(providerModel)) {\n                    return this._invalid();\n                }\n                if (token.isCancellationRequested) {\n                    return Status.CANCELED;\n                }\n                this._stickyModel = this.createStickyModel(token, providerModel);\n                return Status.VALID;\n            }).then(undefined, (err) => {\n                onUnexpectedError(err);\n                return Status.CANCELED;\n            }),\n            modelPromise: providerModelPromise\n        };\n    }\n    /**\n     * Method which checks whether the model returned by the provider is valid and can be used to compute a sticky model.\n     * This method by default returns true.\n     * @param model model returned by the provider\n     * @returns boolean indicating whether the model is valid\n     */\n    isModelValid(model) {\n        return true;\n    }\n    /**\n     * Method which checks whether the provider is valid before applying it to find the provider model.\n     * This method by default returns true.\n     * @returns boolean indicating whether the provider is valid\n     */\n    isProviderValid() {\n        return true;\n    }\n}\nlet StickyModelFromCandidateOutlineProvider = class StickyModelFromCandidateOutlineProvider extends StickyModelCandidateProvider {\n    constructor(_editor, _languageFeaturesService) {\n        super(_editor);\n        this._languageFeaturesService = _languageFeaturesService;\n    }\n    createModelFromProvider(token) {\n        return OutlineModel.create(this._languageFeaturesService.documentSymbolProvider, this._editor.getModel(), token);\n    }\n    createStickyModel(token, model) {\n        const { stickyOutlineElement, providerID } = this._stickyModelFromOutlineModel(model, this._stickyModel?.outlineProviderId);\n        const textModel = this._editor.getModel();\n        return new StickyModel(textModel.uri, textModel.getVersionId(), stickyOutlineElement, providerID);\n    }\n    isModelValid(model) {\n        return model && model.children.size > 0;\n    }\n    _stickyModelFromOutlineModel(outlineModel, preferredProvider) {\n        let outlineElements;\n        // When several possible outline providers\n        if (Iterable.first(outlineModel.children.values()) instanceof OutlineGroup) {\n            const provider = Iterable.find(outlineModel.children.values(), outlineGroupOfModel => outlineGroupOfModel.id === preferredProvider);\n            if (provider) {\n                outlineElements = provider.children;\n            }\n            else {\n                let tempID = '';\n                let maxTotalSumOfRanges = -1;\n                let optimalOutlineGroup = undefined;\n                for (const [_key, outlineGroup] of outlineModel.children.entries()) {\n                    const totalSumRanges = this._findSumOfRangesOfGroup(outlineGroup);\n                    if (totalSumRanges > maxTotalSumOfRanges) {\n                        optimalOutlineGroup = outlineGroup;\n                        maxTotalSumOfRanges = totalSumRanges;\n                        tempID = outlineGroup.id;\n                    }\n                }\n                preferredProvider = tempID;\n                outlineElements = optimalOutlineGroup.children;\n            }\n        }\n        else {\n            outlineElements = outlineModel.children;\n        }\n        const stickyChildren = [];\n        const outlineElementsArray = Array.from(outlineElements.values()).sort((element1, element2) => {\n            const range1 = new StickyRange(element1.symbol.range.startLineNumber, element1.symbol.range.endLineNumber);\n            const range2 = new StickyRange(element2.symbol.range.startLineNumber, element2.symbol.range.endLineNumber);\n            return this._comparator(range1, range2);\n        });\n        for (const outlineElement of outlineElementsArray) {\n            stickyChildren.push(this._stickyModelFromOutlineElement(outlineElement, outlineElement.symbol.selectionRange.startLineNumber));\n        }\n        const stickyOutlineElement = new StickyElement(undefined, stickyChildren, undefined);\n        return {\n            stickyOutlineElement: stickyOutlineElement,\n            providerID: preferredProvider\n        };\n    }\n    _stickyModelFromOutlineElement(outlineElement, previousStartLine) {\n        const children = [];\n        for (const child of outlineElement.children.values()) {\n            if (child.symbol.selectionRange.startLineNumber !== child.symbol.range.endLineNumber) {\n                if (child.symbol.selectionRange.startLineNumber !== previousStartLine) {\n                    children.push(this._stickyModelFromOutlineElement(child, child.symbol.selectionRange.startLineNumber));\n                }\n                else {\n                    for (const subchild of child.children.values()) {\n                        children.push(this._stickyModelFromOutlineElement(subchild, child.symbol.selectionRange.startLineNumber));\n                    }\n                }\n            }\n        }\n        children.sort((child1, child2) => this._comparator(child1.range, child2.range));\n        const range = new StickyRange(outlineElement.symbol.selectionRange.startLineNumber, outlineElement.symbol.range.endLineNumber);\n        return new StickyElement(range, children, undefined);\n    }\n    _comparator(range1, range2) {\n        if (range1.startLineNumber !== range2.startLineNumber) {\n            return range1.startLineNumber - range2.startLineNumber;\n        }\n        else {\n            return range2.endLineNumber - range1.endLineNumber;\n        }\n    }\n    _findSumOfRangesOfGroup(outline) {\n        let res = 0;\n        for (const child of outline.children.values()) {\n            res += this._findSumOfRangesOfGroup(child);\n        }\n        if (outline instanceof OutlineElement) {\n            return res + outline.symbol.range.endLineNumber - outline.symbol.selectionRange.startLineNumber;\n        }\n        else {\n            return res;\n        }\n    }\n};\nStickyModelFromCandidateOutlineProvider = __decorate([\n    __param(1, ILanguageFeaturesService)\n], StickyModelFromCandidateOutlineProvider);\nclass StickyModelFromCandidateFoldingProvider extends StickyModelCandidateProvider {\n    constructor(editor) {\n        super(editor);\n        this._foldingLimitReporter = new RangesLimitReporter(editor);\n    }\n    createStickyModel(token, model) {\n        const foldingElement = this._fromFoldingRegions(model);\n        const textModel = this._editor.getModel();\n        return new StickyModel(textModel.uri, textModel.getVersionId(), foldingElement, undefined);\n    }\n    isModelValid(model) {\n        return model !== null;\n    }\n    _fromFoldingRegions(foldingRegions) {\n        const length = foldingRegions.length;\n        const orderedStickyElements = [];\n        // The root sticky outline element\n        const stickyOutlineElement = new StickyElement(undefined, [], undefined);\n        for (let i = 0; i < length; i++) {\n            // Finding the parent index of the current range\n            const parentIndex = foldingRegions.getParentIndex(i);\n            let parentNode;\n            if (parentIndex !== -1) {\n                // Access the reference of the parent node\n                parentNode = orderedStickyElements[parentIndex];\n            }\n            else {\n                // In that case the parent node is the root node\n                parentNode = stickyOutlineElement;\n            }\n            const child = new StickyElement(new StickyRange(foldingRegions.getStartLineNumber(i), foldingRegions.getEndLineNumber(i) + 1), [], parentNode);\n            parentNode.children.push(child);\n            orderedStickyElements.push(child);\n        }\n        return stickyOutlineElement;\n    }\n}\nlet StickyModelFromCandidateIndentationFoldingProvider = class StickyModelFromCandidateIndentationFoldingProvider extends StickyModelFromCandidateFoldingProvider {\n    constructor(editor, _languageConfigurationService) {\n        super(editor);\n        this._languageConfigurationService = _languageConfigurationService;\n        this.provider = this._register(new IndentRangeProvider(editor.getModel(), this._languageConfigurationService, this._foldingLimitReporter));\n    }\n    async createModelFromProvider(token) {\n        return this.provider.compute(token);\n    }\n};\nStickyModelFromCandidateIndentationFoldingProvider = __decorate([\n    __param(1, ILanguageConfigurationService)\n], StickyModelFromCandidateIndentationFoldingProvider);\nlet StickyModelFromCandidateSyntaxFoldingProvider = class StickyModelFromCandidateSyntaxFoldingProvider extends StickyModelFromCandidateFoldingProvider {\n    constructor(editor, onProviderUpdate, _languageFeaturesService) {\n        super(editor);\n        this._languageFeaturesService = _languageFeaturesService;\n        const selectedProviders = FoldingController.getFoldingRangeProviders(this._languageFeaturesService, editor.getModel());\n        if (selectedProviders.length > 0) {\n            this.provider = this._register(new SyntaxRangeProvider(editor.getModel(), selectedProviders, onProviderUpdate, this._foldingLimitReporter, undefined));\n        }\n    }\n    isProviderValid() {\n        return this.provider !== undefined;\n    }\n    async createModelFromProvider(token) {\n        return this.provider?.compute(token) ?? null;\n    }\n};\nStickyModelFromCandidateSyntaxFoldingProvider = __decorate([\n    __param(2, ILanguageFeaturesService)\n], StickyModelFromCandidateSyntaxFoldingProvider);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { binarySearch } from '../../../../base/common/arrays.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { StickyModelProvider } from './stickyScrollModelProvider.js';\nexport class StickyLineCandidate {\n    constructor(startLineNumber, endLineNumber, nestingDepth) {\n        this.startLineNumber = startLineNumber;\n        this.endLineNumber = endLineNumber;\n        this.nestingDepth = nestingDepth;\n    }\n}\nlet StickyLineCandidateProvider = class StickyLineCandidateProvider extends Disposable {\n    constructor(editor, _languageFeaturesService, _languageConfigurationService) {\n        super();\n        this._languageFeaturesService = _languageFeaturesService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._onDidChangeStickyScroll = this._register(new Emitter());\n        this.onDidChangeStickyScroll = this._onDidChangeStickyScroll.event;\n        this._model = null;\n        this._cts = null;\n        this._stickyModelProvider = null;\n        this._editor = editor;\n        this._sessionStore = this._register(new DisposableStore());\n        this._updateSoon = this._register(new RunOnceScheduler(() => this.update(), 50));\n        this._register(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(116 /* EditorOption.stickyScroll */)) {\n                this.readConfiguration();\n            }\n        }));\n        this.readConfiguration();\n    }\n    readConfiguration() {\n        this._sessionStore.clear();\n        const options = this._editor.getOption(116 /* EditorOption.stickyScroll */);\n        if (!options.enabled) {\n            return;\n        }\n        this._sessionStore.add(this._editor.onDidChangeModel(() => {\n            // We should not show an old model for a different file, it will always be wrong.\n            // So we clear the model here immediately and then trigger an update.\n            this._model = null;\n            this.updateStickyModelProvider();\n            this._onDidChangeStickyScroll.fire();\n            this.update();\n        }));\n        this._sessionStore.add(this._editor.onDidChangeHiddenAreas(() => this.update()));\n        this._sessionStore.add(this._editor.onDidChangeModelContent(() => this._updateSoon.schedule()));\n        this._sessionStore.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(() => this.update()));\n        this._sessionStore.add(toDisposable(() => {\n            this._stickyModelProvider?.dispose();\n            this._stickyModelProvider = null;\n        }));\n        this.updateStickyModelProvider();\n        this.update();\n    }\n    getVersionId() {\n        return this._model?.version;\n    }\n    updateStickyModelProvider() {\n        this._stickyModelProvider?.dispose();\n        this._stickyModelProvider = null;\n        const editor = this._editor;\n        if (editor.hasModel()) {\n            this._stickyModelProvider = new StickyModelProvider(editor, () => this._updateSoon.schedule(), this._languageConfigurationService, this._languageFeaturesService);\n        }\n    }\n    async update() {\n        this._cts?.dispose(true);\n        this._cts = new CancellationTokenSource();\n        await this.updateStickyModel(this._cts.token);\n        this._onDidChangeStickyScroll.fire();\n    }\n    async updateStickyModel(token) {\n        if (!this._editor.hasModel() || !this._stickyModelProvider || this._editor.getModel().isTooLargeForTokenization()) {\n            this._model = null;\n            return;\n        }\n        const model = await this._stickyModelProvider.update(token);\n        if (token.isCancellationRequested) {\n            // the computation was canceled, so do not overwrite the model\n            return;\n        }\n        this._model = model;\n    }\n    updateIndex(index) {\n        if (index === -1) {\n            index = 0;\n        }\n        else if (index < 0) {\n            index = -index - 2;\n        }\n        return index;\n    }\n    getCandidateStickyLinesIntersectingFromStickyModel(range, outlineModel, result, depth, lastStartLineNumber) {\n        if (outlineModel.children.length === 0) {\n            return;\n        }\n        let lastLine = lastStartLineNumber;\n        const childrenStartLines = [];\n        for (let i = 0; i < outlineModel.children.length; i++) {\n            const child = outlineModel.children[i];\n            if (child.range) {\n                childrenStartLines.push(child.range.startLineNumber);\n            }\n        }\n        const lowerBound = this.updateIndex(binarySearch(childrenStartLines, range.startLineNumber, (a, b) => { return a - b; }));\n        const upperBound = this.updateIndex(binarySearch(childrenStartLines, range.startLineNumber + depth, (a, b) => { return a - b; }));\n        for (let i = lowerBound; i <= upperBound; i++) {\n            const child = outlineModel.children[i];\n            if (!child) {\n                return;\n            }\n            if (child.range) {\n                const childStartLine = child.range.startLineNumber;\n                const childEndLine = child.range.endLineNumber;\n                if (range.startLineNumber <= childEndLine + 1 && childStartLine - 1 <= range.endLineNumber && childStartLine !== lastLine) {\n                    lastLine = childStartLine;\n                    result.push(new StickyLineCandidate(childStartLine, childEndLine - 1, depth + 1));\n                    this.getCandidateStickyLinesIntersectingFromStickyModel(range, child, result, depth + 1, childStartLine);\n                }\n            }\n            else {\n                this.getCandidateStickyLinesIntersectingFromStickyModel(range, child, result, depth, lastStartLineNumber);\n            }\n        }\n    }\n    getCandidateStickyLinesIntersecting(range) {\n        if (!this._model?.element) {\n            return [];\n        }\n        let stickyLineCandidates = [];\n        this.getCandidateStickyLinesIntersectingFromStickyModel(range, this._model.element, stickyLineCandidates, 0, -1);\n        const hiddenRanges = this._editor._getViewModel()?.getHiddenAreas();\n        if (hiddenRanges) {\n            for (const hiddenRange of hiddenRanges) {\n                stickyLineCandidates = stickyLineCandidates.filter(stickyLine => !(stickyLine.startLineNumber >= hiddenRange.startLineNumber && stickyLine.endLineNumber <= hiddenRange.endLineNumber + 1));\n            }\n        }\n        return stickyLineCandidates;\n    }\n};\nStickyLineCandidateProvider = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, ILanguageConfigurationService)\n], StickyLineCandidateProvider);\nexport { StickyLineCandidateProvider };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar StickyScrollController_1;\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { StickyScrollWidget, StickyScrollWidgetState } from './stickyScrollWidget.js';\nimport { StickyLineCandidateProvider } from './stickyScrollProvider.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ClickLinkGesture } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { Range } from '../../../common/core/range.js';\nimport { getDefinitionsAtPosition } from '../../gotoSymbol/browser/goToSymbol.js';\nimport { goToDefinitionWithLocation } from '../../inlayHints/browser/inlayHintsLocations.js';\nimport { Position } from '../../../common/core/position.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { StickyRange } from './stickyScrollElement.js';\nimport { StandardMouseEvent } from '../../../../base/browser/mouseEvent.js';\nimport { FoldingController } from '../../folding/browser/folding.js';\nimport { toggleCollapseState } from '../../folding/browser/foldingModel.js';\nlet StickyScrollController = class StickyScrollController extends Disposable {\n    static { StickyScrollController_1 = this; }\n    static { this.ID = 'store.contrib.stickyScrollController'; }\n    constructor(_editor, _contextMenuService, _languageFeaturesService, _instaService, _languageConfigurationService, _languageFeatureDebounceService, _contextKeyService) {\n        super();\n        this._editor = _editor;\n        this._contextMenuService = _contextMenuService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._instaService = _instaService;\n        this._contextKeyService = _contextKeyService;\n        this._sessionStore = new DisposableStore();\n        this._maxStickyLines = Number.MAX_SAFE_INTEGER;\n        this._candidateDefinitionsLength = -1;\n        this._focusedStickyElementIndex = -1;\n        this._enabled = false;\n        this._focused = false;\n        this._positionRevealed = false;\n        this._onMouseDown = false;\n        this._endLineNumbers = [];\n        this._stickyScrollWidget = new StickyScrollWidget(this._editor);\n        this._stickyLineCandidateProvider = new StickyLineCandidateProvider(this._editor, _languageFeaturesService, _languageConfigurationService);\n        this._register(this._stickyScrollWidget);\n        this._register(this._stickyLineCandidateProvider);\n        this._widgetState = StickyScrollWidgetState.Empty;\n        this._onDidResize();\n        this._readConfiguration();\n        const stickyScrollDomNode = this._stickyScrollWidget.getDomNode();\n        this._register(this._editor.onDidChangeConfiguration(e => {\n            this._readConfigurationChange(e);\n        }));\n        this._register(dom.addDisposableListener(stickyScrollDomNode, dom.EventType.CONTEXT_MENU, async (event) => {\n            this._onContextMenu(dom.getWindow(stickyScrollDomNode), event);\n        }));\n        this._stickyScrollFocusedContextKey = EditorContextKeys.stickyScrollFocused.bindTo(this._contextKeyService);\n        this._stickyScrollVisibleContextKey = EditorContextKeys.stickyScrollVisible.bindTo(this._contextKeyService);\n        const focusTracker = this._register(dom.trackFocus(stickyScrollDomNode));\n        this._register(focusTracker.onDidBlur(_ => {\n            // Suppose that the blurring is caused by scrolling, then keep the focus on the sticky scroll\n            // This is determined by the fact that the height of the widget has become zero and there has been no position revealing\n            if (this._positionRevealed === false && stickyScrollDomNode.clientHeight === 0) {\n                this._focusedStickyElementIndex = -1;\n                this.focus();\n            }\n            // In all other casees, dispose the focus on the sticky scroll\n            else {\n                this._disposeFocusStickyScrollStore();\n            }\n        }));\n        this._register(focusTracker.onDidFocus(_ => {\n            this.focus();\n        }));\n        this._registerMouseListeners();\n        // Suppose that mouse down on the sticky scroll, then do not focus on the sticky scroll because this will be followed by the revealing of a position\n        this._register(dom.addDisposableListener(stickyScrollDomNode, dom.EventType.MOUSE_DOWN, (e) => {\n            this._onMouseDown = true;\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(StickyScrollController_1.ID);\n    }\n    _disposeFocusStickyScrollStore() {\n        this._stickyScrollFocusedContextKey.set(false);\n        this._focusDisposableStore?.dispose();\n        this._focused = false;\n        this._positionRevealed = false;\n        this._onMouseDown = false;\n    }\n    focus() {\n        // If the mouse is down, do not focus on the sticky scroll\n        if (this._onMouseDown) {\n            this._onMouseDown = false;\n            this._editor.focus();\n            return;\n        }\n        const focusState = this._stickyScrollFocusedContextKey.get();\n        if (focusState === true) {\n            return;\n        }\n        this._focused = true;\n        this._focusDisposableStore = new DisposableStore();\n        this._stickyScrollFocusedContextKey.set(true);\n        this._focusedStickyElementIndex = this._stickyScrollWidget.lineNumbers.length - 1;\n        this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n    }\n    focusNext() {\n        if (this._focusedStickyElementIndex < this._stickyScrollWidget.lineNumberCount - 1) {\n            this._focusNav(true);\n        }\n    }\n    focusPrevious() {\n        if (this._focusedStickyElementIndex > 0) {\n            this._focusNav(false);\n        }\n    }\n    selectEditor() {\n        this._editor.focus();\n    }\n    // True is next, false is previous\n    _focusNav(direction) {\n        this._focusedStickyElementIndex = direction ? this._focusedStickyElementIndex + 1 : this._focusedStickyElementIndex - 1;\n        this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n    }\n    goToFocused() {\n        const lineNumbers = this._stickyScrollWidget.lineNumbers;\n        this._disposeFocusStickyScrollStore();\n        this._revealPosition({ lineNumber: lineNumbers[this._focusedStickyElementIndex], column: 1 });\n    }\n    _revealPosition(position) {\n        this._reveaInEditor(position, () => this._editor.revealPosition(position));\n    }\n    _revealLineInCenterIfOutsideViewport(position) {\n        this._reveaInEditor(position, () => this._editor.revealLineInCenterIfOutsideViewport(position.lineNumber, 0 /* ScrollType.Smooth */));\n    }\n    _reveaInEditor(position, revealFunction) {\n        if (this._focused) {\n            this._disposeFocusStickyScrollStore();\n        }\n        this._positionRevealed = true;\n        revealFunction();\n        this._editor.setSelection(Range.fromPositions(position));\n        this._editor.focus();\n    }\n    _registerMouseListeners() {\n        const sessionStore = this._register(new DisposableStore());\n        const gesture = this._register(new ClickLinkGesture(this._editor, {\n            extractLineNumberFromMouseEvent: (e) => {\n                const position = this._stickyScrollWidget.getEditorPositionFromNode(e.target.element);\n                return position ? position.lineNumber : 0;\n            }\n        }));\n        const getMouseEventTarget = (mouseEvent) => {\n            if (!this._editor.hasModel()) {\n                return null;\n            }\n            if (mouseEvent.target.type !== 12 /* MouseTargetType.OVERLAY_WIDGET */ || mouseEvent.target.detail !== this._stickyScrollWidget.getId()) {\n                // not hovering over our widget\n                return null;\n            }\n            const mouseTargetElement = mouseEvent.target.element;\n            if (!mouseTargetElement || mouseTargetElement.innerText !== mouseTargetElement.innerHTML) {\n                // not on a span element rendering text\n                return null;\n            }\n            const position = this._stickyScrollWidget.getEditorPositionFromNode(mouseTargetElement);\n            if (!position) {\n                // not hovering a sticky scroll line\n                return null;\n            }\n            return {\n                range: new Range(position.lineNumber, position.column, position.lineNumber, position.column + mouseTargetElement.innerText.length),\n                textElement: mouseTargetElement\n            };\n        };\n        const stickyScrollWidgetDomNode = this._stickyScrollWidget.getDomNode();\n        this._register(dom.addStandardDisposableListener(stickyScrollWidgetDomNode, dom.EventType.CLICK, (mouseEvent) => {\n            if (mouseEvent.ctrlKey || mouseEvent.altKey || mouseEvent.metaKey) {\n                // modifier pressed\n                return;\n            }\n            if (!mouseEvent.leftButton) {\n                // not left click\n                return;\n            }\n            if (mouseEvent.shiftKey) {\n                // shift click\n                const lineIndex = this._stickyScrollWidget.getLineIndexFromChildDomNode(mouseEvent.target);\n                if (lineIndex === null) {\n                    return;\n                }\n                const position = new Position(this._endLineNumbers[lineIndex], 1);\n                this._revealLineInCenterIfOutsideViewport(position);\n                return;\n            }\n            const isInFoldingIconDomNode = this._stickyScrollWidget.isInFoldingIconDomNode(mouseEvent.target);\n            if (isInFoldingIconDomNode) {\n                // clicked on folding icon\n                const lineNumber = this._stickyScrollWidget.getLineNumberFromChildDomNode(mouseEvent.target);\n                this._toggleFoldingRegionForLine(lineNumber);\n                return;\n            }\n            const isInStickyLine = this._stickyScrollWidget.isInStickyLine(mouseEvent.target);\n            if (!isInStickyLine) {\n                return;\n            }\n            // normal click\n            let position = this._stickyScrollWidget.getEditorPositionFromNode(mouseEvent.target);\n            if (!position) {\n                const lineNumber = this._stickyScrollWidget.getLineNumberFromChildDomNode(mouseEvent.target);\n                if (lineNumber === null) {\n                    // not hovering a sticky scroll line\n                    return;\n                }\n                position = new Position(lineNumber, 1);\n            }\n            this._revealPosition(position);\n        }));\n        this._register(dom.addStandardDisposableListener(stickyScrollWidgetDomNode, dom.EventType.MOUSE_MOVE, (mouseEvent) => {\n            if (mouseEvent.shiftKey) {\n                const currentEndForLineIndex = this._stickyScrollWidget.getLineIndexFromChildDomNode(mouseEvent.target);\n                if (currentEndForLineIndex === null || this._showEndForLine !== null && this._showEndForLine === currentEndForLineIndex) {\n                    return;\n                }\n                this._showEndForLine = currentEndForLineIndex;\n                this._renderStickyScroll();\n                return;\n            }\n            if (this._showEndForLine !== undefined) {\n                this._showEndForLine = undefined;\n                this._renderStickyScroll();\n            }\n        }));\n        this._register(dom.addDisposableListener(stickyScrollWidgetDomNode, dom.EventType.MOUSE_LEAVE, (e) => {\n            if (this._showEndForLine !== undefined) {\n                this._showEndForLine = undefined;\n                this._renderStickyScroll();\n            }\n        }));\n        this._register(gesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, _keyboardEvent]) => {\n            const mouseTarget = getMouseEventTarget(mouseEvent);\n            if (!mouseTarget || !mouseEvent.hasTriggerModifier || !this._editor.hasModel()) {\n                sessionStore.clear();\n                return;\n            }\n            const { range, textElement } = mouseTarget;\n            if (!range.equalsRange(this._stickyRangeProjectedOnEditor)) {\n                this._stickyRangeProjectedOnEditor = range;\n                sessionStore.clear();\n            }\n            else if (textElement.style.textDecoration === 'underline') {\n                return;\n            }\n            const cancellationToken = new CancellationTokenSource();\n            sessionStore.add(toDisposable(() => cancellationToken.dispose(true)));\n            let currentHTMLChild;\n            getDefinitionsAtPosition(this._languageFeaturesService.definitionProvider, this._editor.getModel(), new Position(range.startLineNumber, range.startColumn + 1), false, cancellationToken.token).then((candidateDefinitions => {\n                if (cancellationToken.token.isCancellationRequested) {\n                    return;\n                }\n                if (candidateDefinitions.length !== 0) {\n                    this._candidateDefinitionsLength = candidateDefinitions.length;\n                    const childHTML = textElement;\n                    if (currentHTMLChild !== childHTML) {\n                        sessionStore.clear();\n                        currentHTMLChild = childHTML;\n                        currentHTMLChild.style.textDecoration = 'underline';\n                        sessionStore.add(toDisposable(() => {\n                            currentHTMLChild.style.textDecoration = 'none';\n                        }));\n                    }\n                    else if (!currentHTMLChild) {\n                        currentHTMLChild = childHTML;\n                        currentHTMLChild.style.textDecoration = 'underline';\n                        sessionStore.add(toDisposable(() => {\n                            currentHTMLChild.style.textDecoration = 'none';\n                        }));\n                    }\n                }\n                else {\n                    sessionStore.clear();\n                }\n            }));\n        }));\n        this._register(gesture.onCancel(() => {\n            sessionStore.clear();\n        }));\n        this._register(gesture.onExecute(async (e) => {\n            if (e.target.type !== 12 /* MouseTargetType.OVERLAY_WIDGET */ || e.target.detail !== this._stickyScrollWidget.getId()) {\n                // not hovering over our widget\n                return;\n            }\n            const position = this._stickyScrollWidget.getEditorPositionFromNode(e.target.element);\n            if (!position) {\n                // not hovering a sticky scroll line\n                return;\n            }\n            if (!this._editor.hasModel() || !this._stickyRangeProjectedOnEditor) {\n                return;\n            }\n            if (this._candidateDefinitionsLength > 1) {\n                if (this._focused) {\n                    this._disposeFocusStickyScrollStore();\n                }\n                this._revealPosition({ lineNumber: position.lineNumber, column: 1 });\n            }\n            this._instaService.invokeFunction(goToDefinitionWithLocation, e, this._editor, { uri: this._editor.getModel().uri, range: this._stickyRangeProjectedOnEditor });\n        }));\n    }\n    _onContextMenu(targetWindow, e) {\n        const event = new StandardMouseEvent(targetWindow, e);\n        this._contextMenuService.showContextMenu({\n            menuId: MenuId.StickyScrollContext,\n            getAnchor: () => event,\n        });\n    }\n    _toggleFoldingRegionForLine(line) {\n        if (!this._foldingModel || line === null) {\n            return;\n        }\n        const stickyLine = this._stickyScrollWidget.getRenderedStickyLine(line);\n        const foldingIcon = stickyLine?.foldingIcon;\n        if (!foldingIcon) {\n            return;\n        }\n        toggleCollapseState(this._foldingModel, Number.MAX_VALUE, [line]);\n        foldingIcon.isCollapsed = !foldingIcon.isCollapsed;\n        const scrollTop = (foldingIcon.isCollapsed ?\n            this._editor.getTopForLineNumber(foldingIcon.foldingEndLine)\n            : this._editor.getTopForLineNumber(foldingIcon.foldingStartLine))\n            - this._editor.getOption(67 /* EditorOption.lineHeight */) * stickyLine.index + 1;\n        this._editor.setScrollTop(scrollTop);\n        this._renderStickyScroll(line);\n    }\n    _readConfiguration() {\n        const options = this._editor.getOption(116 /* EditorOption.stickyScroll */);\n        if (options.enabled === false) {\n            this._editor.removeOverlayWidget(this._stickyScrollWidget);\n            this._sessionStore.clear();\n            this._enabled = false;\n            return;\n        }\n        else if (options.enabled && !this._enabled) {\n            // When sticky scroll was just enabled, add the listeners on the sticky scroll\n            this._editor.addOverlayWidget(this._stickyScrollWidget);\n            this._sessionStore.add(this._editor.onDidScrollChange((e) => {\n                if (e.scrollTopChanged) {\n                    this._showEndForLine = undefined;\n                    this._renderStickyScroll();\n                }\n            }));\n            this._sessionStore.add(this._editor.onDidLayoutChange(() => this._onDidResize()));\n            this._sessionStore.add(this._editor.onDidChangeModelTokens((e) => this._onTokensChange(e)));\n            this._sessionStore.add(this._stickyLineCandidateProvider.onDidChangeStickyScroll(() => {\n                this._showEndForLine = undefined;\n                this._renderStickyScroll();\n            }));\n            this._enabled = true;\n        }\n        const lineNumberOption = this._editor.getOption(68 /* EditorOption.lineNumbers */);\n        if (lineNumberOption.renderType === 2 /* RenderLineNumbersType.Relative */) {\n            this._sessionStore.add(this._editor.onDidChangeCursorPosition(() => {\n                this._showEndForLine = undefined;\n                this._renderStickyScroll(0);\n            }));\n        }\n    }\n    _readConfigurationChange(event) {\n        if (event.hasChanged(116 /* EditorOption.stickyScroll */)\n            || event.hasChanged(73 /* EditorOption.minimap */)\n            || event.hasChanged(67 /* EditorOption.lineHeight */)\n            || event.hasChanged(111 /* EditorOption.showFoldingControls */)\n            || event.hasChanged(68 /* EditorOption.lineNumbers */)) {\n            this._readConfiguration();\n        }\n        if (event.hasChanged(68 /* EditorOption.lineNumbers */)) {\n            this._renderStickyScroll(0);\n        }\n    }\n    _needsUpdate(event) {\n        const stickyLineNumbers = this._stickyScrollWidget.getCurrentLines();\n        for (const stickyLineNumber of stickyLineNumbers) {\n            for (const range of event.ranges) {\n                if (stickyLineNumber >= range.fromLineNumber && stickyLineNumber <= range.toLineNumber) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    _onTokensChange(event) {\n        if (this._needsUpdate(event)) {\n            // Rebuilding the whole widget from line 0\n            this._renderStickyScroll(0);\n        }\n    }\n    _onDidResize() {\n        const layoutInfo = this._editor.getLayoutInfo();\n        // Make sure sticky scroll doesn't take up more than 25% of the editor\n        const theoreticalLines = layoutInfo.height / this._editor.getOption(67 /* EditorOption.lineHeight */);\n        this._maxStickyLines = Math.round(theoreticalLines * .25);\n    }\n    async _renderStickyScroll(rebuildFromLine) {\n        const model = this._editor.getModel();\n        if (!model || model.isTooLargeForTokenization()) {\n            this._resetState();\n            return;\n        }\n        const nextRebuildFromLine = this._updateAndGetMinRebuildFromLine(rebuildFromLine);\n        const stickyWidgetVersion = this._stickyLineCandidateProvider.getVersionId();\n        const shouldUpdateState = stickyWidgetVersion === undefined || stickyWidgetVersion === model.getVersionId();\n        if (shouldUpdateState) {\n            if (!this._focused) {\n                await this._updateState(nextRebuildFromLine);\n            }\n            else {\n                // Suppose that previously the sticky scroll widget had height 0, then if there are visible lines, set the last line as focused\n                if (this._focusedStickyElementIndex === -1) {\n                    await this._updateState(nextRebuildFromLine);\n                    this._focusedStickyElementIndex = this._stickyScrollWidget.lineNumberCount - 1;\n                    if (this._focusedStickyElementIndex !== -1) {\n                        this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n                    }\n                }\n                else {\n                    const focusedStickyElementLineNumber = this._stickyScrollWidget.lineNumbers[this._focusedStickyElementIndex];\n                    await this._updateState(nextRebuildFromLine);\n                    // Suppose that after setting the state, there are no sticky lines, set the focused index to -1\n                    if (this._stickyScrollWidget.lineNumberCount === 0) {\n                        this._focusedStickyElementIndex = -1;\n                    }\n                    else {\n                        const previousFocusedLineNumberExists = this._stickyScrollWidget.lineNumbers.includes(focusedStickyElementLineNumber);\n                        // If the line number is still there, do not change anything\n                        // If the line number is not there, set the new focused line to be the last line\n                        if (!previousFocusedLineNumberExists) {\n                            this._focusedStickyElementIndex = this._stickyScrollWidget.lineNumberCount - 1;\n                        }\n                        this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n                    }\n                }\n            }\n        }\n    }\n    _updateAndGetMinRebuildFromLine(rebuildFromLine) {\n        if (rebuildFromLine !== undefined) {\n            const minRebuildFromLineOrInfinity = this._minRebuildFromLine !== undefined ? this._minRebuildFromLine : Infinity;\n            this._minRebuildFromLine = Math.min(rebuildFromLine, minRebuildFromLineOrInfinity);\n        }\n        return this._minRebuildFromLine;\n    }\n    async _updateState(rebuildFromLine) {\n        this._minRebuildFromLine = undefined;\n        this._foldingModel = await FoldingController.get(this._editor)?.getFoldingModel() ?? undefined;\n        this._widgetState = this.findScrollWidgetState();\n        const stickyWidgetHasLines = this._widgetState.startLineNumbers.length > 0;\n        this._stickyScrollVisibleContextKey.set(stickyWidgetHasLines);\n        this._stickyScrollWidget.setState(this._widgetState, this._foldingModel, rebuildFromLine);\n    }\n    async _resetState() {\n        this._minRebuildFromLine = undefined;\n        this._foldingModel = undefined;\n        this._widgetState = StickyScrollWidgetState.Empty;\n        this._stickyScrollVisibleContextKey.set(false);\n        this._stickyScrollWidget.setState(undefined, undefined);\n    }\n    findScrollWidgetState() {\n        const lineHeight = this._editor.getOption(67 /* EditorOption.lineHeight */);\n        const maxNumberStickyLines = Math.min(this._maxStickyLines, this._editor.getOption(116 /* EditorOption.stickyScroll */).maxLineCount);\n        const scrollTop = this._editor.getScrollTop();\n        let lastLineRelativePosition = 0;\n        const startLineNumbers = [];\n        const endLineNumbers = [];\n        const arrayVisibleRanges = this._editor.getVisibleRanges();\n        if (arrayVisibleRanges.length !== 0) {\n            const fullVisibleRange = new StickyRange(arrayVisibleRanges[0].startLineNumber, arrayVisibleRanges[arrayVisibleRanges.length - 1].endLineNumber);\n            const candidateRanges = this._stickyLineCandidateProvider.getCandidateStickyLinesIntersecting(fullVisibleRange);\n            for (const range of candidateRanges) {\n                const start = range.startLineNumber;\n                const end = range.endLineNumber;\n                const depth = range.nestingDepth;\n                if (end - start > 0) {\n                    const topOfElementAtDepth = (depth - 1) * lineHeight;\n                    const bottomOfElementAtDepth = depth * lineHeight;\n                    const bottomOfBeginningLine = this._editor.getBottomForLineNumber(start) - scrollTop;\n                    const topOfEndLine = this._editor.getTopForLineNumber(end) - scrollTop;\n                    const bottomOfEndLine = this._editor.getBottomForLineNumber(end) - scrollTop;\n                    if (topOfElementAtDepth > topOfEndLine && topOfElementAtDepth <= bottomOfEndLine) {\n                        startLineNumbers.push(start);\n                        endLineNumbers.push(end + 1);\n                        lastLineRelativePosition = bottomOfEndLine - bottomOfElementAtDepth;\n                        break;\n                    }\n                    else if (bottomOfElementAtDepth > bottomOfBeginningLine && bottomOfElementAtDepth <= bottomOfEndLine) {\n                        startLineNumbers.push(start);\n                        endLineNumbers.push(end + 1);\n                    }\n                    if (startLineNumbers.length === maxNumberStickyLines) {\n                        break;\n                    }\n                }\n            }\n        }\n        this._endLineNumbers = endLineNumbers;\n        return new StickyScrollWidgetState(startLineNumbers, endLineNumbers, lastLineRelativePosition, this._showEndForLine);\n    }\n    dispose() {\n        super.dispose();\n        this._sessionStore.dispose();\n    }\n};\nStickyScrollController = StickyScrollController_1 = __decorate([\n    __param(1, IContextMenuService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, IInstantiationService),\n    __param(4, ILanguageConfigurationService),\n    __param(5, ILanguageFeatureDebounceService),\n    __param(6, IContextKeyService)\n], StickyScrollController);\nexport { StickyScrollController };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction2 } from '../../../browser/editorExtensions.js';\nimport { localize, localize2 } from '../../../../nls.js';\nimport { Categories } from '../../../../platform/action/common/actionCommonCategories.js';\nimport { Action2, MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { StickyScrollController } from './stickyScrollController.js';\nexport class ToggleStickyScroll extends Action2 {\n    constructor() {\n        super({\n            id: 'editor.action.toggleStickyScroll',\n            title: {\n                ...localize2('toggleEditorStickyScroll', \"Toggle Editor Sticky Scroll\"),\n                mnemonicTitle: localize({ key: 'mitoggleStickyScroll', comment: ['&& denotes a mnemonic'] }, \"&&Toggle Editor Sticky Scroll\"),\n            },\n            metadata: {\n                description: localize2('toggleEditorStickyScroll.description', \"Toggle/enable the editor sticky scroll which shows the nested scopes at the top of the viewport\"),\n            },\n            category: Categories.View,\n            toggled: {\n                condition: ContextKeyExpr.equals('config.editor.stickyScroll.enabled', true),\n                title: localize('stickyScroll', \"Sticky Scroll\"),\n                mnemonicTitle: localize({ key: 'miStickyScroll', comment: ['&& denotes a mnemonic'] }, \"&&Sticky Scroll\"),\n            },\n            menu: [\n                { id: MenuId.CommandPalette },\n                { id: MenuId.MenubarAppearanceMenu, group: '4_editor', order: 3 },\n                { id: MenuId.StickyScrollContext }\n            ]\n        });\n    }\n    async run(accessor) {\n        const configurationService = accessor.get(IConfigurationService);\n        const newValue = !configurationService.getValue('editor.stickyScroll.enabled');\n        return configurationService.updateValue('editor.stickyScroll.enabled', newValue);\n    }\n}\nconst weight = 100 /* KeybindingWeight.EditorContrib */;\nexport class FocusStickyScroll extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.focusStickyScroll',\n            title: {\n                ...localize2('focusStickyScroll', \"Focus on the editor sticky scroll\"),\n                mnemonicTitle: localize({ key: 'mifocusStickyScroll', comment: ['&& denotes a mnemonic'] }, \"&&Focus Sticky Scroll\"),\n            },\n            precondition: ContextKeyExpr.and(ContextKeyExpr.has('config.editor.stickyScroll.enabled'), EditorContextKeys.stickyScrollVisible),\n            menu: [\n                { id: MenuId.CommandPalette },\n            ]\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        StickyScrollController.get(editor)?.focus();\n    }\n}\nexport class SelectNextStickyScrollLine extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.selectNextStickyScrollLine',\n            title: localize2('selectNextStickyScrollLine.title', \"Select the next editor sticky scroll line\"),\n            precondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n            keybinding: {\n                weight,\n                primary: 18 /* KeyCode.DownArrow */\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        StickyScrollController.get(editor)?.focusNext();\n    }\n}\nexport class SelectPreviousStickyScrollLine extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.selectPreviousStickyScrollLine',\n            title: localize2('selectPreviousStickyScrollLine.title', \"Select the previous sticky scroll line\"),\n            precondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n            keybinding: {\n                weight,\n                primary: 16 /* KeyCode.UpArrow */\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        StickyScrollController.get(editor)?.focusPrevious();\n    }\n}\nexport class GoToStickyScrollLine extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.goToFocusedStickyScrollLine',\n            title: localize2('goToFocusedStickyScrollLine.title', \"Go to the focused sticky scroll line\"),\n            precondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n            keybinding: {\n                weight,\n                primary: 3 /* KeyCode.Enter */\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        StickyScrollController.get(editor)?.goToFocused();\n    }\n}\nexport class SelectEditor extends EditorAction2 {\n    constructor() {\n        super({\n            id: 'editor.action.selectEditor',\n            title: localize2('selectEditor.title', \"Select Editor\"),\n            precondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n            keybinding: {\n                weight,\n                primary: 9 /* KeyCode.Escape */\n            }\n        });\n    }\n    runEditorCommand(_accessor, editor) {\n        StickyScrollController.get(editor)?.selectEditor();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ToggleStickyScroll, FocusStickyScroll, SelectEditor, SelectPreviousStickyScrollLine, SelectNextStickyScrollLine, GoToStickyScrollLine } from './stickyScrollActions.js';\nimport { StickyScrollController } from './stickyScrollController.js';\nimport { registerAction2 } from '../../../../platform/actions/common/actions.js';\nregisterEditorContribution(StickyScrollController.ID, StickyScrollController, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nregisterAction2(ToggleStickyScroll);\nregisterAction2(FocusStickyScroll);\nregisterAction2(SelectPreviousStickyScrollLine);\nregisterAction2(SelectNextStickyScrollLine);\nregisterAction2(GoToStickyScrollLine);\nregisterAction2(SelectEditor);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { FuzzyScore } from '../../../../base/common/filters.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { Disposable, RefCountedDisposable } from '../../../../base/common/lifecycle.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { registerEditorFeature } from '../../../common/editorFeatures.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { CompletionModel, LineContext } from './completionModel.js';\nimport { CompletionOptions, provideSuggestionItems, QuickSuggestionsOptions } from './suggest.js';\nimport { ISuggestMemoryService } from './suggestMemory.js';\nimport { SuggestModel } from './suggestModel.js';\nimport { WordDistance } from './wordDistance.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nclass SuggestInlineCompletion {\n    constructor(range, insertText, filterText, additionalTextEdits, command, completion) {\n        this.range = range;\n        this.insertText = insertText;\n        this.filterText = filterText;\n        this.additionalTextEdits = additionalTextEdits;\n        this.command = command;\n        this.completion = completion;\n    }\n}\nlet InlineCompletionResults = class InlineCompletionResults extends RefCountedDisposable {\n    constructor(model, line, word, completionModel, completions, _suggestMemoryService) {\n        super(completions.disposable);\n        this.model = model;\n        this.line = line;\n        this.word = word;\n        this.completionModel = completionModel;\n        this._suggestMemoryService = _suggestMemoryService;\n    }\n    canBeReused(model, line, word) {\n        return this.model === model // same model\n            && this.line === line\n            && this.word.word.length > 0\n            && this.word.startColumn === word.startColumn && this.word.endColumn < word.endColumn // same word\n            && this.completionModel.getIncompleteProvider().size === 0; // no incomplete results\n    }\n    get items() {\n        const result = [];\n        // Split items by preselected index. This ensures the memory-selected item shows first and that better/worst\n        // ranked items are before/after\n        const { items } = this.completionModel;\n        const selectedIndex = this._suggestMemoryService.select(this.model, { lineNumber: this.line, column: this.word.endColumn + this.completionModel.lineContext.characterCountDelta }, items);\n        const first = Iterable.slice(items, selectedIndex);\n        const second = Iterable.slice(items, 0, selectedIndex);\n        let resolveCount = 5;\n        for (const item of Iterable.concat(first, second)) {\n            if (item.score === FuzzyScore.Default) {\n                // skip items that have no overlap\n                continue;\n            }\n            const range = new Range(item.editStart.lineNumber, item.editStart.column, item.editInsertEnd.lineNumber, item.editInsertEnd.column + this.completionModel.lineContext.characterCountDelta // end PLUS character delta\n            );\n            const insertText = item.completion.insertTextRules && (item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */)\n                ? { snippet: item.completion.insertText }\n                : item.completion.insertText;\n            result.push(new SuggestInlineCompletion(range, insertText, item.filterTextLow ?? item.labelLow, item.completion.additionalTextEdits, item.completion.command, item));\n            // resolve the first N suggestions eagerly\n            if (resolveCount-- >= 0) {\n                item.resolve(CancellationToken.None);\n            }\n        }\n        return result;\n    }\n};\nInlineCompletionResults = __decorate([\n    __param(5, ISuggestMemoryService)\n], InlineCompletionResults);\nlet SuggestInlineCompletions = class SuggestInlineCompletions extends Disposable {\n    constructor(_languageFeatureService, _clipboardService, _suggestMemoryService, _editorService) {\n        super();\n        this._languageFeatureService = _languageFeatureService;\n        this._clipboardService = _clipboardService;\n        this._suggestMemoryService = _suggestMemoryService;\n        this._editorService = _editorService;\n        this._store.add(_languageFeatureService.inlineCompletionsProvider.register('*', this));\n    }\n    async provideInlineCompletions(model, position, context, token) {\n        if (context.selectedSuggestionInfo) {\n            return;\n        }\n        let editor;\n        for (const candidate of this._editorService.listCodeEditors()) {\n            if (candidate.getModel() === model) {\n                editor = candidate;\n                break;\n            }\n        }\n        if (!editor) {\n            return;\n        }\n        const config = editor.getOption(90 /* EditorOption.quickSuggestions */);\n        if (QuickSuggestionsOptions.isAllOff(config)) {\n            // quick suggest is off (for this model/language)\n            return;\n        }\n        model.tokenization.tokenizeIfCheap(position.lineNumber);\n        const lineTokens = model.tokenization.getLineTokens(position.lineNumber);\n        const tokenType = lineTokens.getStandardTokenType(lineTokens.findTokenIndexAtOffset(Math.max(position.column - 1 - 1, 0)));\n        if (QuickSuggestionsOptions.valueFor(config, tokenType) !== 'inline') {\n            // quick suggest is off (for this token)\n            return undefined;\n        }\n        // We consider non-empty leading words and trigger characters. The latter only\n        // when no word is being typed (word characters superseed trigger characters)\n        let wordInfo = model.getWordAtPosition(position);\n        let triggerCharacterInfo;\n        if (!wordInfo?.word) {\n            triggerCharacterInfo = this._getTriggerCharacterInfo(model, position);\n        }\n        if (!wordInfo?.word && !triggerCharacterInfo) {\n            // not at word, not a trigger character\n            return;\n        }\n        // ensure that we have word information and that we are at the end of a word\n        // otherwise we stop because we don't want to do quick suggestions inside words\n        if (!wordInfo) {\n            wordInfo = model.getWordUntilPosition(position);\n        }\n        if (wordInfo.endColumn !== position.column) {\n            return;\n        }\n        let result;\n        const leadingLineContents = model.getValueInRange(new Range(position.lineNumber, 1, position.lineNumber, position.column));\n        if (!triggerCharacterInfo && this._lastResult?.canBeReused(model, position.lineNumber, wordInfo)) {\n            // reuse a previous result iff possible, only a refilter is needed\n            // TODO@jrieken this can be improved further and only incomplete results can be updated\n            // console.log(`REUSE with ${wordInfo.word}`);\n            const newLineContext = new LineContext(leadingLineContents, position.column - this._lastResult.word.endColumn);\n            this._lastResult.completionModel.lineContext = newLineContext;\n            this._lastResult.acquire();\n            result = this._lastResult;\n        }\n        else {\n            // refesh model is required\n            const completions = await provideSuggestionItems(this._languageFeatureService.completionProvider, model, position, new CompletionOptions(undefined, SuggestModel.createSuggestFilter(editor).itemKind, triggerCharacterInfo?.providers), triggerCharacterInfo && { triggerKind: 1 /* CompletionTriggerKind.TriggerCharacter */, triggerCharacter: triggerCharacterInfo.ch }, token);\n            let clipboardText;\n            if (completions.needsClipboard) {\n                clipboardText = await this._clipboardService.readText();\n            }\n            const completionModel = new CompletionModel(completions.items, position.column, new LineContext(leadingLineContents, 0), WordDistance.None, editor.getOption(119 /* EditorOption.suggest */), editor.getOption(113 /* EditorOption.snippetSuggestions */), { boostFullMatch: false, firstMatchCanBeWeak: false }, clipboardText);\n            result = new InlineCompletionResults(model, position.lineNumber, wordInfo, completionModel, completions, this._suggestMemoryService);\n        }\n        this._lastResult = result;\n        return result;\n    }\n    handleItemDidShow(_completions, item) {\n        item.completion.resolve(CancellationToken.None);\n    }\n    freeInlineCompletions(result) {\n        result.release();\n    }\n    _getTriggerCharacterInfo(model, position) {\n        const ch = model.getValueInRange(Range.fromPositions({ lineNumber: position.lineNumber, column: position.column - 1 }, position));\n        const providers = new Set();\n        for (const provider of this._languageFeatureService.completionProvider.all(model)) {\n            if (provider.triggerCharacters?.includes(ch)) {\n                providers.add(provider);\n            }\n        }\n        if (providers.size === 0) {\n            return undefined;\n        }\n        return { providers, ch };\n    }\n};\nSuggestInlineCompletions = __decorate([\n    __param(0, ILanguageFeaturesService),\n    __param(1, IClipboardService),\n    __param(2, ISuggestMemoryService),\n    __param(3, ICodeEditorService)\n], SuggestInlineCompletions);\nexport { SuggestInlineCompletions };\nregisterEditorFeature(SuggestInlineCompletions);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport * as nls from '../../../../nls.js';\nclass ForceRetokenizeAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.forceRetokenize',\n            label: nls.localize('forceRetokenize', \"Developer: Force Retokenize\"),\n            alias: 'Developer: Force Retokenize',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const model = editor.getModel();\n        model.tokenization.resetTokenization();\n        const sw = new StopWatch();\n        model.tokenization.forceTokenization(model.getLineCount());\n        sw.stop();\n        console.log(`tokenization took ${sw.elapsed()}`);\n    }\n}\nregisterEditorAction(ForceRetokenizeAction);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { TabFocus } from '../../../browser/config/tabFocus.js';\nimport * as nls from '../../../../nls.js';\nimport { Action2, registerAction2 } from '../../../../platform/actions/common/actions.js';\nexport class ToggleTabFocusModeAction extends Action2 {\n    static { this.ID = 'editor.action.toggleTabFocusMode'; }\n    constructor() {\n        super({\n            id: ToggleTabFocusModeAction.ID,\n            title: nls.localize2({ key: 'toggle.tabMovesFocus', comment: ['Turn on/off use of tab key for moving focus around VS Code'] }, 'Toggle Tab Key Moves Focus'),\n            precondition: undefined,\n            keybinding: {\n                primary: 2048 /* KeyMod.CtrlCmd */ | 43 /* KeyCode.KeyM */,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 43 /* KeyCode.KeyM */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: nls.localize2('tabMovesFocusDescriptions', \"Determines whether the tab key moves focus around the workbench or inserts the tab character in the current editor. This is also called tab trapping, tab navigation, or tab focus mode.\"),\n            },\n            f1: true\n        });\n    }\n    run() {\n        const oldValue = TabFocus.getTabFocusMode();\n        const newValue = !oldValue;\n        TabFocus.setTabFocusMode(newValue);\n        if (newValue) {\n            alert(nls.localize('toggle.tabMovesFocus.on', \"Pressing Tab will now move focus to the next focusable element\"));\n        }\n        else {\n            alert(nls.localize('toggle.tabMovesFocus.off', \"Pressing Tab will now insert the tab character\"));\n        }\n    }\n}\nregisterAction2(ToggleTabFocusModeAction);\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './bannerController.css';\nimport { $, append, clearNode } from '../../../../base/browser/dom.js';\nimport { ActionBar } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { Action } from '../../../../base/common/actions.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../../browser/widget/markdownRenderer/browser/markdownRenderer.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { Link } from '../../../../platform/opener/browser/link.js';\nimport { widgetClose } from '../../../../platform/theme/common/iconRegistry.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nconst BANNER_ELEMENT_HEIGHT = 26;\nlet BannerController = class BannerController extends Disposable {\n    constructor(_editor, instantiationService) {\n        super();\n        this._editor = _editor;\n        this.instantiationService = instantiationService;\n        this.banner = this._register(this.instantiationService.createInstance(Banner));\n    }\n    hide() {\n        this._editor.setBanner(null, 0);\n        this.banner.clear();\n    }\n    show(item) {\n        this.banner.show({\n            ...item,\n            onClose: () => {\n                this.hide();\n                item.onClose?.();\n            }\n        });\n        this._editor.setBanner(this.banner.element, BANNER_ELEMENT_HEIGHT);\n    }\n};\nBannerController = __decorate([\n    __param(1, IInstantiationService)\n], BannerController);\nexport { BannerController };\n// TODO@hediet: Investigate if this can be reused by the workspace banner (bannerPart.ts).\nlet Banner = class Banner extends Disposable {\n    constructor(instantiationService) {\n        super();\n        this.instantiationService = instantiationService;\n        this.markdownRenderer = this.instantiationService.createInstance(MarkdownRenderer, {});\n        this.element = $('div.editor-banner');\n        this.element.tabIndex = 0;\n    }\n    getAriaLabel(item) {\n        if (item.ariaLabel) {\n            return item.ariaLabel;\n        }\n        if (typeof item.message === 'string') {\n            return item.message;\n        }\n        return undefined;\n    }\n    getBannerMessage(message) {\n        if (typeof message === 'string') {\n            const element = $('span');\n            element.innerText = message;\n            return element;\n        }\n        return this.markdownRenderer.render(message).element;\n    }\n    clear() {\n        clearNode(this.element);\n    }\n    show(item) {\n        // Clear previous item\n        clearNode(this.element);\n        // Banner aria label\n        const ariaLabel = this.getAriaLabel(item);\n        if (ariaLabel) {\n            this.element.setAttribute('aria-label', ariaLabel);\n        }\n        // Icon\n        const iconContainer = append(this.element, $('div.icon-container'));\n        iconContainer.setAttribute('aria-hidden', 'true');\n        if (item.icon) {\n            iconContainer.appendChild($(`div${ThemeIcon.asCSSSelector(item.icon)}`));\n        }\n        // Message\n        const messageContainer = append(this.element, $('div.message-container'));\n        messageContainer.setAttribute('aria-hidden', 'true');\n        messageContainer.appendChild(this.getBannerMessage(item.message));\n        // Message Actions\n        this.messageActionsContainer = append(this.element, $('div.message-actions-container'));\n        if (item.actions) {\n            for (const action of item.actions) {\n                this._register(this.instantiationService.createInstance(Link, this.messageActionsContainer, { ...action, tabIndex: -1 }, {}));\n            }\n        }\n        // Action\n        const actionBarContainer = append(this.element, $('div.action-container'));\n        this.actionBar = this._register(new ActionBar(actionBarContainer));\n        this.actionBar.push(this._register(new Action('banner.close', 'Close Banner', ThemeIcon.asClassName(widgetClose), true, () => {\n            if (typeof item.onClose === 'function') {\n                item.onClose();\n            }\n        })), { icon: true, label: false });\n        this.actionBar.setFocusable(false);\n    }\n};\nBanner = __decorate([\n    __param(0, IInstantiationService)\n], Banner);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { InvisibleCharacters, isBasicASCII } from '../../../../base/common/strings.js';\nimport './unicodeHighlighter.css';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { inUntrustedWorkspace, unicodeHighlightConfigKeys } from '../../../common/config/editorOptions.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { UnicodeTextModelHighlighter } from '../../../common/services/unicodeTextModelHighlighter.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { isModelDecorationInComment, isModelDecorationInString, isModelDecorationVisible } from '../../../common/viewModel/viewModelDecorations.js';\nimport { HoverParticipantRegistry } from '../../hover/browser/hoverTypes.js';\nimport { MarkdownHover, renderMarkdownHovers } from '../../hover/browser/markdownHoverParticipant.js';\nimport { BannerController } from './bannerController.js';\nimport * as nls from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { IWorkspaceTrustManagementService } from '../../../../platform/workspace/common/workspaceTrust.js';\nexport const warningIcon = registerIcon('extensions-warning-message', Codicon.warning, nls.localize('warningIcon', 'Icon shown with a warning message in the extensions editor.'));\nlet UnicodeHighlighter = class UnicodeHighlighter extends Disposable {\n    static { this.ID = 'editor.contrib.unicodeHighlighter'; }\n    constructor(_editor, _editorWorkerService, _workspaceTrustService, instantiationService) {\n        super();\n        this._editor = _editor;\n        this._editorWorkerService = _editorWorkerService;\n        this._workspaceTrustService = _workspaceTrustService;\n        this._highlighter = null;\n        this._bannerClosed = false;\n        this._updateState = (state) => {\n            if (state && state.hasMore) {\n                if (this._bannerClosed) {\n                    return;\n                }\n                // This document contains many non-basic ASCII characters.\n                const max = Math.max(state.ambiguousCharacterCount, state.nonBasicAsciiCharacterCount, state.invisibleCharacterCount);\n                let data;\n                if (state.nonBasicAsciiCharacterCount >= max) {\n                    data = {\n                        message: nls.localize('unicodeHighlighting.thisDocumentHasManyNonBasicAsciiUnicodeCharacters', 'This document contains many non-basic ASCII unicode characters'),\n                        command: new DisableHighlightingOfNonBasicAsciiCharactersAction(),\n                    };\n                }\n                else if (state.ambiguousCharacterCount >= max) {\n                    data = {\n                        message: nls.localize('unicodeHighlighting.thisDocumentHasManyAmbiguousUnicodeCharacters', 'This document contains many ambiguous unicode characters'),\n                        command: new DisableHighlightingOfAmbiguousCharactersAction(),\n                    };\n                }\n                else if (state.invisibleCharacterCount >= max) {\n                    data = {\n                        message: nls.localize('unicodeHighlighting.thisDocumentHasManyInvisibleUnicodeCharacters', 'This document contains many invisible unicode characters'),\n                        command: new DisableHighlightingOfInvisibleCharactersAction(),\n                    };\n                }\n                else {\n                    throw new Error('Unreachable');\n                }\n                this._bannerController.show({\n                    id: 'unicodeHighlightBanner',\n                    message: data.message,\n                    icon: warningIcon,\n                    actions: [\n                        {\n                            label: data.command.shortLabel,\n                            href: `command:${data.command.id}`\n                        }\n                    ],\n                    onClose: () => {\n                        this._bannerClosed = true;\n                    },\n                });\n            }\n            else {\n                this._bannerController.hide();\n            }\n        };\n        this._bannerController = this._register(instantiationService.createInstance(BannerController, _editor));\n        this._register(this._editor.onDidChangeModel(() => {\n            this._bannerClosed = false;\n            this._updateHighlighter();\n        }));\n        this._options = _editor.getOption(126 /* EditorOption.unicodeHighlighting */);\n        this._register(_workspaceTrustService.onDidChangeTrust(e => {\n            this._updateHighlighter();\n        }));\n        this._register(_editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(126 /* EditorOption.unicodeHighlighting */)) {\n                this._options = _editor.getOption(126 /* EditorOption.unicodeHighlighting */);\n                this._updateHighlighter();\n            }\n        }));\n        this._updateHighlighter();\n    }\n    dispose() {\n        if (this._highlighter) {\n            this._highlighter.dispose();\n            this._highlighter = null;\n        }\n        super.dispose();\n    }\n    _updateHighlighter() {\n        this._updateState(null);\n        if (this._highlighter) {\n            this._highlighter.dispose();\n            this._highlighter = null;\n        }\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const options = resolveOptions(this._workspaceTrustService.isWorkspaceTrusted(), this._options);\n        if ([\n            options.nonBasicASCII,\n            options.ambiguousCharacters,\n            options.invisibleCharacters,\n        ].every((option) => option === false)) {\n            // Don't do anything if the feature is fully disabled\n            return;\n        }\n        const highlightOptions = {\n            nonBasicASCII: options.nonBasicASCII,\n            ambiguousCharacters: options.ambiguousCharacters,\n            invisibleCharacters: options.invisibleCharacters,\n            includeComments: options.includeComments,\n            includeStrings: options.includeStrings,\n            allowedCodePoints: Object.keys(options.allowedCharacters).map(c => c.codePointAt(0)),\n            allowedLocales: Object.keys(options.allowedLocales).map(locale => {\n                if (locale === '_os') {\n                    const osLocale = new Intl.NumberFormat().resolvedOptions().locale;\n                    return osLocale;\n                }\n                else if (locale === '_vscode') {\n                    return platform.language;\n                }\n                return locale;\n            }),\n        };\n        if (this._editorWorkerService.canComputeUnicodeHighlights(this._editor.getModel().uri)) {\n            this._highlighter = new DocumentUnicodeHighlighter(this._editor, highlightOptions, this._updateState, this._editorWorkerService);\n        }\n        else {\n            this._highlighter = new ViewportUnicodeHighlighter(this._editor, highlightOptions, this._updateState);\n        }\n    }\n    getDecorationInfo(decoration) {\n        if (this._highlighter) {\n            return this._highlighter.getDecorationInfo(decoration);\n        }\n        return null;\n    }\n};\nUnicodeHighlighter = __decorate([\n    __param(1, IEditorWorkerService),\n    __param(2, IWorkspaceTrustManagementService),\n    __param(3, IInstantiationService)\n], UnicodeHighlighter);\nexport { UnicodeHighlighter };\nfunction resolveOptions(trusted, options) {\n    return {\n        nonBasicASCII: options.nonBasicASCII === inUntrustedWorkspace ? !trusted : options.nonBasicASCII,\n        ambiguousCharacters: options.ambiguousCharacters,\n        invisibleCharacters: options.invisibleCharacters,\n        includeComments: options.includeComments === inUntrustedWorkspace ? !trusted : options.includeComments,\n        includeStrings: options.includeStrings === inUntrustedWorkspace ? !trusted : options.includeStrings,\n        allowedCharacters: options.allowedCharacters,\n        allowedLocales: options.allowedLocales,\n    };\n}\nlet DocumentUnicodeHighlighter = class DocumentUnicodeHighlighter extends Disposable {\n    constructor(_editor, _options, _updateState, _editorWorkerService) {\n        super();\n        this._editor = _editor;\n        this._options = _options;\n        this._updateState = _updateState;\n        this._editorWorkerService = _editorWorkerService;\n        this._model = this._editor.getModel();\n        this._decorations = this._editor.createDecorationsCollection();\n        this._updateSoon = this._register(new RunOnceScheduler(() => this._update(), 250));\n        this._register(this._editor.onDidChangeModelContent(() => {\n            this._updateSoon.schedule();\n        }));\n        this._updateSoon.schedule();\n    }\n    dispose() {\n        this._decorations.clear();\n        super.dispose();\n    }\n    _update() {\n        if (this._model.isDisposed()) {\n            return;\n        }\n        if (!this._model.mightContainNonBasicASCII()) {\n            this._decorations.clear();\n            return;\n        }\n        const modelVersionId = this._model.getVersionId();\n        this._editorWorkerService\n            .computedUnicodeHighlights(this._model.uri, this._options)\n            .then((info) => {\n            if (this._model.isDisposed()) {\n                return;\n            }\n            if (this._model.getVersionId() !== modelVersionId) {\n                // model changed in the meantime\n                return;\n            }\n            this._updateState(info);\n            const decorations = [];\n            if (!info.hasMore) {\n                // Don't show decoration if there are too many.\n                // In this case, a banner is shown.\n                for (const range of info.ranges) {\n                    decorations.push({\n                        range: range,\n                        options: Decorations.instance.getDecorationFromOptions(this._options),\n                    });\n                }\n            }\n            this._decorations.set(decorations);\n        });\n    }\n    getDecorationInfo(decoration) {\n        if (!this._decorations.has(decoration)) {\n            return null;\n        }\n        const model = this._editor.getModel();\n        if (!isModelDecorationVisible(model, decoration)) {\n            return null;\n        }\n        const text = model.getValueInRange(decoration.range);\n        return {\n            reason: computeReason(text, this._options),\n            inComment: isModelDecorationInComment(model, decoration),\n            inString: isModelDecorationInString(model, decoration),\n        };\n    }\n};\nDocumentUnicodeHighlighter = __decorate([\n    __param(3, IEditorWorkerService)\n], DocumentUnicodeHighlighter);\nclass ViewportUnicodeHighlighter extends Disposable {\n    constructor(_editor, _options, _updateState) {\n        super();\n        this._editor = _editor;\n        this._options = _options;\n        this._updateState = _updateState;\n        this._model = this._editor.getModel();\n        this._decorations = this._editor.createDecorationsCollection();\n        this._updateSoon = this._register(new RunOnceScheduler(() => this._update(), 250));\n        this._register(this._editor.onDidLayoutChange(() => {\n            this._updateSoon.schedule();\n        }));\n        this._register(this._editor.onDidScrollChange(() => {\n            this._updateSoon.schedule();\n        }));\n        this._register(this._editor.onDidChangeHiddenAreas(() => {\n            this._updateSoon.schedule();\n        }));\n        this._register(this._editor.onDidChangeModelContent(() => {\n            this._updateSoon.schedule();\n        }));\n        this._updateSoon.schedule();\n    }\n    dispose() {\n        this._decorations.clear();\n        super.dispose();\n    }\n    _update() {\n        if (this._model.isDisposed()) {\n            return;\n        }\n        if (!this._model.mightContainNonBasicASCII()) {\n            this._decorations.clear();\n            return;\n        }\n        const ranges = this._editor.getVisibleRanges();\n        const decorations = [];\n        const totalResult = {\n            ranges: [],\n            ambiguousCharacterCount: 0,\n            invisibleCharacterCount: 0,\n            nonBasicAsciiCharacterCount: 0,\n            hasMore: false,\n        };\n        for (const range of ranges) {\n            const result = UnicodeTextModelHighlighter.computeUnicodeHighlights(this._model, this._options, range);\n            for (const r of result.ranges) {\n                totalResult.ranges.push(r);\n            }\n            totalResult.ambiguousCharacterCount += totalResult.ambiguousCharacterCount;\n            totalResult.invisibleCharacterCount += totalResult.invisibleCharacterCount;\n            totalResult.nonBasicAsciiCharacterCount += totalResult.nonBasicAsciiCharacterCount;\n            totalResult.hasMore = totalResult.hasMore || result.hasMore;\n        }\n        if (!totalResult.hasMore) {\n            // Don't show decorations if there are too many.\n            // A banner will be shown instead.\n            for (const range of totalResult.ranges) {\n                decorations.push({ range, options: Decorations.instance.getDecorationFromOptions(this._options) });\n            }\n        }\n        this._updateState(totalResult);\n        this._decorations.set(decorations);\n    }\n    getDecorationInfo(decoration) {\n        if (!this._decorations.has(decoration)) {\n            return null;\n        }\n        const model = this._editor.getModel();\n        const text = model.getValueInRange(decoration.range);\n        if (!isModelDecorationVisible(model, decoration)) {\n            return null;\n        }\n        return {\n            reason: computeReason(text, this._options),\n            inComment: isModelDecorationInComment(model, decoration),\n            inString: isModelDecorationInString(model, decoration),\n        };\n    }\n}\nconst configureUnicodeHighlightOptionsStr = nls.localize('unicodeHighlight.configureUnicodeHighlightOptions', 'Configure Unicode Highlight Options');\nlet UnicodeHighlighterHoverParticipant = class UnicodeHighlighterHoverParticipant {\n    constructor(_editor, _languageService, _openerService) {\n        this._editor = _editor;\n        this._languageService = _languageService;\n        this._openerService = _openerService;\n        this.hoverOrdinal = 5;\n    }\n    computeSync(anchor, lineDecorations) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */) {\n            return [];\n        }\n        const model = this._editor.getModel();\n        const unicodeHighlighter = this._editor.getContribution(UnicodeHighlighter.ID);\n        if (!unicodeHighlighter) {\n            return [];\n        }\n        const result = [];\n        const existedReason = new Set();\n        let index = 300;\n        for (const d of lineDecorations) {\n            const highlightInfo = unicodeHighlighter.getDecorationInfo(d);\n            if (!highlightInfo) {\n                continue;\n            }\n            const char = model.getValueInRange(d.range);\n            // text refers to a single character.\n            const codePoint = char.codePointAt(0);\n            const codePointStr = formatCodePointMarkdown(codePoint);\n            let reason;\n            switch (highlightInfo.reason.kind) {\n                case 0 /* UnicodeHighlighterReasonKind.Ambiguous */: {\n                    if (isBasicASCII(highlightInfo.reason.confusableWith)) {\n                        reason = nls.localize('unicodeHighlight.characterIsAmbiguousASCII', 'The character {0} could be confused with the ASCII character {1}, which is more common in source code.', codePointStr, formatCodePointMarkdown(highlightInfo.reason.confusableWith.codePointAt(0)));\n                    }\n                    else {\n                        reason = nls.localize('unicodeHighlight.characterIsAmbiguous', 'The character {0} could be confused with the character {1}, which is more common in source code.', codePointStr, formatCodePointMarkdown(highlightInfo.reason.confusableWith.codePointAt(0)));\n                    }\n                    break;\n                }\n                case 1 /* UnicodeHighlighterReasonKind.Invisible */:\n                    reason = nls.localize('unicodeHighlight.characterIsInvisible', 'The character {0} is invisible.', codePointStr);\n                    break;\n                case 2 /* UnicodeHighlighterReasonKind.NonBasicAscii */:\n                    reason = nls.localize('unicodeHighlight.characterIsNonBasicAscii', 'The character {0} is not a basic ASCII character.', codePointStr);\n                    break;\n            }\n            if (existedReason.has(reason)) {\n                continue;\n            }\n            existedReason.add(reason);\n            const adjustSettingsArgs = {\n                codePoint: codePoint,\n                reason: highlightInfo.reason,\n                inComment: highlightInfo.inComment,\n                inString: highlightInfo.inString,\n            };\n            const adjustSettings = nls.localize('unicodeHighlight.adjustSettings', 'Adjust settings');\n            const uri = `command:${ShowExcludeOptions.ID}?${encodeURIComponent(JSON.stringify(adjustSettingsArgs))}`;\n            const markdown = new MarkdownString('', true)\n                .appendMarkdown(reason)\n                .appendText(' ')\n                .appendLink(uri, adjustSettings, configureUnicodeHighlightOptionsStr);\n            result.push(new MarkdownHover(this, d.range, [markdown], false, index++));\n        }\n        return result;\n    }\n    renderHoverParts(context, hoverParts) {\n        return renderMarkdownHovers(context, hoverParts, this._editor, this._languageService, this._openerService);\n    }\n};\nUnicodeHighlighterHoverParticipant = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IOpenerService)\n], UnicodeHighlighterHoverParticipant);\nexport { UnicodeHighlighterHoverParticipant };\nfunction codePointToHex(codePoint) {\n    return `U+${codePoint.toString(16).padStart(4, '0')}`;\n}\nfunction formatCodePointMarkdown(codePoint) {\n    let value = `\\`${codePointToHex(codePoint)}\\``;\n    if (!InvisibleCharacters.isInvisibleCharacter(codePoint)) {\n        // Don't render any control characters or any invisible characters, as they cannot be seen anyways.\n        value += ` \"${`${renderCodePointAsInlineCode(codePoint)}`}\"`;\n    }\n    return value;\n}\nfunction renderCodePointAsInlineCode(codePoint) {\n    if (codePoint === 96 /* CharCode.BackTick */) {\n        return '`` ` ``';\n    }\n    return '`' + String.fromCodePoint(codePoint) + '`';\n}\nfunction computeReason(char, options) {\n    return UnicodeTextModelHighlighter.computeUnicodeHighlightReason(char, options);\n}\nclass Decorations {\n    constructor() {\n        this.map = new Map();\n    }\n    static { this.instance = new Decorations(); }\n    getDecorationFromOptions(options) {\n        return this.getDecoration(!options.includeComments, !options.includeStrings);\n    }\n    getDecoration(hideInComments, hideInStrings) {\n        const key = `${hideInComments}${hideInStrings}`;\n        let options = this.map.get(key);\n        if (!options) {\n            options = ModelDecorationOptions.createDynamic({\n                description: 'unicode-highlight',\n                stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n                className: 'unicode-highlight',\n                showIfCollapsed: true,\n                overviewRuler: null,\n                minimap: null,\n                hideInCommentTokens: hideInComments,\n                hideInStringTokens: hideInStrings,\n            });\n            this.map.set(key, options);\n        }\n        return options;\n    }\n}\nexport class DisableHighlightingInCommentsAction extends EditorAction {\n    constructor() {\n        super({\n            id: DisableHighlightingOfAmbiguousCharactersAction.ID,\n            label: nls.localize('action.unicodeHighlight.disableHighlightingInComments', 'Disable highlighting of characters in comments'),\n            alias: 'Disable highlighting of characters in comments',\n            precondition: undefined\n        });\n        this.shortLabel = nls.localize('unicodeHighlight.disableHighlightingInComments.shortLabel', 'Disable Highlight In Comments');\n    }\n    async run(accessor, editor, args) {\n        const configurationService = accessor?.get(IConfigurationService);\n        if (configurationService) {\n            this.runAction(configurationService);\n        }\n    }\n    async runAction(configurationService) {\n        await configurationService.updateValue(unicodeHighlightConfigKeys.includeComments, false, 2 /* ConfigurationTarget.USER */);\n    }\n}\nexport class DisableHighlightingInStringsAction extends EditorAction {\n    constructor() {\n        super({\n            id: DisableHighlightingOfAmbiguousCharactersAction.ID,\n            label: nls.localize('action.unicodeHighlight.disableHighlightingInStrings', 'Disable highlighting of characters in strings'),\n            alias: 'Disable highlighting of characters in strings',\n            precondition: undefined\n        });\n        this.shortLabel = nls.localize('unicodeHighlight.disableHighlightingInStrings.shortLabel', 'Disable Highlight In Strings');\n    }\n    async run(accessor, editor, args) {\n        const configurationService = accessor?.get(IConfigurationService);\n        if (configurationService) {\n            this.runAction(configurationService);\n        }\n    }\n    async runAction(configurationService) {\n        await configurationService.updateValue(unicodeHighlightConfigKeys.includeStrings, false, 2 /* ConfigurationTarget.USER */);\n    }\n}\nexport class DisableHighlightingOfAmbiguousCharactersAction extends EditorAction {\n    static { this.ID = 'editor.action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters'; }\n    constructor() {\n        super({\n            id: DisableHighlightingOfAmbiguousCharactersAction.ID,\n            label: nls.localize('action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters', 'Disable highlighting of ambiguous characters'),\n            alias: 'Disable highlighting of ambiguous characters',\n            precondition: undefined\n        });\n        this.shortLabel = nls.localize('unicodeHighlight.disableHighlightingOfAmbiguousCharacters.shortLabel', 'Disable Ambiguous Highlight');\n    }\n    async run(accessor, editor, args) {\n        const configurationService = accessor?.get(IConfigurationService);\n        if (configurationService) {\n            this.runAction(configurationService);\n        }\n    }\n    async runAction(configurationService) {\n        await configurationService.updateValue(unicodeHighlightConfigKeys.ambiguousCharacters, false, 2 /* ConfigurationTarget.USER */);\n    }\n}\nexport class DisableHighlightingOfInvisibleCharactersAction extends EditorAction {\n    static { this.ID = 'editor.action.unicodeHighlight.disableHighlightingOfInvisibleCharacters'; }\n    constructor() {\n        super({\n            id: DisableHighlightingOfInvisibleCharactersAction.ID,\n            label: nls.localize('action.unicodeHighlight.disableHighlightingOfInvisibleCharacters', 'Disable highlighting of invisible characters'),\n            alias: 'Disable highlighting of invisible characters',\n            precondition: undefined\n        });\n        this.shortLabel = nls.localize('unicodeHighlight.disableHighlightingOfInvisibleCharacters.shortLabel', 'Disable Invisible Highlight');\n    }\n    async run(accessor, editor, args) {\n        const configurationService = accessor?.get(IConfigurationService);\n        if (configurationService) {\n            this.runAction(configurationService);\n        }\n    }\n    async runAction(configurationService) {\n        await configurationService.updateValue(unicodeHighlightConfigKeys.invisibleCharacters, false, 2 /* ConfigurationTarget.USER */);\n    }\n}\nexport class DisableHighlightingOfNonBasicAsciiCharactersAction extends EditorAction {\n    static { this.ID = 'editor.action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters'; }\n    constructor() {\n        super({\n            id: DisableHighlightingOfNonBasicAsciiCharactersAction.ID,\n            label: nls.localize('action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters', 'Disable highlighting of non basic ASCII characters'),\n            alias: 'Disable highlighting of non basic ASCII characters',\n            precondition: undefined\n        });\n        this.shortLabel = nls.localize('unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters.shortLabel', 'Disable Non ASCII Highlight');\n    }\n    async run(accessor, editor, args) {\n        const configurationService = accessor?.get(IConfigurationService);\n        if (configurationService) {\n            this.runAction(configurationService);\n        }\n    }\n    async runAction(configurationService) {\n        await configurationService.updateValue(unicodeHighlightConfigKeys.nonBasicASCII, false, 2 /* ConfigurationTarget.USER */);\n    }\n}\nexport class ShowExcludeOptions extends EditorAction {\n    static { this.ID = 'editor.action.unicodeHighlight.showExcludeOptions'; }\n    constructor() {\n        super({\n            id: ShowExcludeOptions.ID,\n            label: nls.localize('action.unicodeHighlight.showExcludeOptions', \"Show Exclude Options\"),\n            alias: 'Show Exclude Options',\n            precondition: undefined\n        });\n    }\n    async run(accessor, editor, args) {\n        const { codePoint, reason, inString, inComment } = args;\n        const char = String.fromCodePoint(codePoint);\n        const quickPickService = accessor.get(IQuickInputService);\n        const configurationService = accessor.get(IConfigurationService);\n        function getExcludeCharFromBeingHighlightedLabel(codePoint) {\n            if (InvisibleCharacters.isInvisibleCharacter(codePoint)) {\n                return nls.localize('unicodeHighlight.excludeInvisibleCharFromBeingHighlighted', 'Exclude {0} (invisible character) from being highlighted', codePointToHex(codePoint));\n            }\n            return nls.localize('unicodeHighlight.excludeCharFromBeingHighlighted', 'Exclude {0} from being highlighted', `${codePointToHex(codePoint)} \"${char}\"`);\n        }\n        const options = [];\n        if (reason.kind === 0 /* UnicodeHighlighterReasonKind.Ambiguous */) {\n            for (const locale of reason.notAmbiguousInLocales) {\n                options.push({\n                    label: nls.localize(\"unicodeHighlight.allowCommonCharactersInLanguage\", \"Allow unicode characters that are more common in the language \\\"{0}\\\".\", locale),\n                    run: async () => {\n                        excludeLocaleFromBeingHighlighted(configurationService, [locale]);\n                    },\n                });\n            }\n        }\n        options.push({\n            label: getExcludeCharFromBeingHighlightedLabel(codePoint),\n            run: () => excludeCharFromBeingHighlighted(configurationService, [codePoint])\n        });\n        if (inComment) {\n            const action = new DisableHighlightingInCommentsAction();\n            options.push({ label: action.label, run: async () => action.runAction(configurationService) });\n        }\n        else if (inString) {\n            const action = new DisableHighlightingInStringsAction();\n            options.push({ label: action.label, run: async () => action.runAction(configurationService) });\n        }\n        if (reason.kind === 0 /* UnicodeHighlighterReasonKind.Ambiguous */) {\n            const action = new DisableHighlightingOfAmbiguousCharactersAction();\n            options.push({ label: action.label, run: async () => action.runAction(configurationService) });\n        }\n        else if (reason.kind === 1 /* UnicodeHighlighterReasonKind.Invisible */) {\n            const action = new DisableHighlightingOfInvisibleCharactersAction();\n            options.push({ label: action.label, run: async () => action.runAction(configurationService) });\n        }\n        else if (reason.kind === 2 /* UnicodeHighlighterReasonKind.NonBasicAscii */) {\n            const action = new DisableHighlightingOfNonBasicAsciiCharactersAction();\n            options.push({ label: action.label, run: async () => action.runAction(configurationService) });\n        }\n        else {\n            expectNever(reason);\n        }\n        const result = await quickPickService.pick(options, { title: configureUnicodeHighlightOptionsStr });\n        if (result) {\n            await result.run();\n        }\n    }\n}\nasync function excludeCharFromBeingHighlighted(configurationService, charCodes) {\n    const existingValue = configurationService.getValue(unicodeHighlightConfigKeys.allowedCharacters);\n    let value;\n    if ((typeof existingValue === 'object') && existingValue) {\n        value = existingValue;\n    }\n    else {\n        value = {};\n    }\n    for (const charCode of charCodes) {\n        value[String.fromCodePoint(charCode)] = true;\n    }\n    await configurationService.updateValue(unicodeHighlightConfigKeys.allowedCharacters, value, 2 /* ConfigurationTarget.USER */);\n}\nasync function excludeLocaleFromBeingHighlighted(configurationService, locales) {\n    const existingValue = configurationService.inspect(unicodeHighlightConfigKeys.allowedLocales).user?.value;\n    let value;\n    if ((typeof existingValue === 'object') && existingValue) {\n        // Copy value, as the existing value is read only\n        value = Object.assign({}, existingValue);\n    }\n    else {\n        value = {};\n    }\n    for (const locale of locales) {\n        value[locale] = true;\n    }\n    await configurationService.updateValue(unicodeHighlightConfigKeys.allowedLocales, value, 2 /* ConfigurationTarget.USER */);\n}\nfunction expectNever(value) {\n    throw new Error(`Unexpected value: ${value}`);\n}\nregisterEditorAction(DisableHighlightingOfAmbiguousCharactersAction);\nregisterEditorAction(DisableHighlightingOfInvisibleCharactersAction);\nregisterEditorAction(DisableHighlightingOfNonBasicAsciiCharactersAction);\nregisterEditorAction(ShowExcludeOptions);\nregisterEditorContribution(UnicodeHighlighter.ID, UnicodeHighlighter, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nHoverParticipantRegistry.register(UnicodeHighlighterHoverParticipant);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport * as nls from '../../../../nls.js';\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\nconst ignoreUnusualLineTerminators = 'ignoreUnusualLineTerminators';\nfunction writeIgnoreState(codeEditorService, model, state) {\n    codeEditorService.setModelProperty(model.uri, ignoreUnusualLineTerminators, state);\n}\nfunction readIgnoreState(codeEditorService, model) {\n    return codeEditorService.getModelProperty(model.uri, ignoreUnusualLineTerminators);\n}\nlet UnusualLineTerminatorsDetector = class UnusualLineTerminatorsDetector extends Disposable {\n    static { this.ID = 'editor.contrib.unusualLineTerminatorsDetector'; }\n    constructor(_editor, _dialogService, _codeEditorService) {\n        super();\n        this._editor = _editor;\n        this._dialogService = _dialogService;\n        this._codeEditorService = _codeEditorService;\n        this._isPresentingDialog = false;\n        this._config = this._editor.getOption(127 /* EditorOption.unusualLineTerminators */);\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(127 /* EditorOption.unusualLineTerminators */)) {\n                this._config = this._editor.getOption(127 /* EditorOption.unusualLineTerminators */);\n                this._checkForUnusualLineTerminators();\n            }\n        }));\n        this._register(this._editor.onDidChangeModel(() => {\n            this._checkForUnusualLineTerminators();\n        }));\n        this._register(this._editor.onDidChangeModelContent((e) => {\n            if (e.isUndoing) {\n                // skip checking in case of undoing\n                return;\n            }\n            this._checkForUnusualLineTerminators();\n        }));\n        this._checkForUnusualLineTerminators();\n    }\n    async _checkForUnusualLineTerminators() {\n        if (this._config === 'off') {\n            return;\n        }\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        if (!model.mightContainUnusualLineTerminators()) {\n            return;\n        }\n        const ignoreState = readIgnoreState(this._codeEditorService, model);\n        if (ignoreState === true) {\n            // this model should be ignored\n            return;\n        }\n        if (this._editor.getOption(92 /* EditorOption.readOnly */)) {\n            // read only editor => sorry!\n            return;\n        }\n        if (this._config === 'auto') {\n            // just do it!\n            model.removeUnusualLineTerminators(this._editor.getSelections());\n            return;\n        }\n        if (this._isPresentingDialog) {\n            // we're currently showing the dialog, which is async.\n            // avoid spamming the user\n            return;\n        }\n        let result;\n        try {\n            this._isPresentingDialog = true;\n            result = await this._dialogService.confirm({\n                title: nls.localize('unusualLineTerminators.title', \"Unusual Line Terminators\"),\n                message: nls.localize('unusualLineTerminators.message', \"Detected unusual line terminators\"),\n                detail: nls.localize('unusualLineTerminators.detail', \"The file '{0}' contains one or more unusual line terminator characters, like Line Separator (LS) or Paragraph Separator (PS).\\n\\nIt is recommended to remove them from the file. This can be configured via `editor.unusualLineTerminators`.\", basename(model.uri)),\n                primaryButton: nls.localize({ key: 'unusualLineTerminators.fix', comment: ['&& denotes a mnemonic'] }, \"&&Remove Unusual Line Terminators\"),\n                cancelButton: nls.localize('unusualLineTerminators.ignore', \"Ignore\")\n            });\n        }\n        finally {\n            this._isPresentingDialog = false;\n        }\n        if (!result.confirmed) {\n            // this model should be ignored\n            writeIgnoreState(this._codeEditorService, model, true);\n            return;\n        }\n        model.removeUnusualLineTerminators(this._editor.getSelections());\n    }\n};\nUnusualLineTerminatorsDetector = __decorate([\n    __param(1, IDialogService),\n    __param(2, ICodeEditorService)\n], UnusualLineTerminatorsDetector);\nexport { UnusualLineTerminatorsDetector };\nregisterEditorContribution(UnusualLineTerminatorsDetector.ID, UnusualLineTerminatorsDetector, 1 /* EditorContributionInstantiation.AfterFirstRender */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { USUAL_WORD_SEPARATORS } from '../../../common/core/wordHelper.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { DocumentHighlightKind } from '../../../common/languages.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nclass TextualDocumentHighlightProvider {\n    constructor() {\n        this.selector = { language: '*' };\n    }\n    provideDocumentHighlights(model, position, token) {\n        const result = [];\n        const word = model.getWordAtPosition({\n            lineNumber: position.lineNumber,\n            column: position.column\n        });\n        if (!word) {\n            return Promise.resolve(result);\n        }\n        if (model.isDisposed()) {\n            return;\n        }\n        const matches = model.findMatches(word.word, true, false, true, USUAL_WORD_SEPARATORS, false);\n        return matches.map(m => ({\n            range: m.range,\n            kind: DocumentHighlightKind.Text\n        }));\n    }\n    provideMultiDocumentHighlights(primaryModel, position, otherModels, token) {\n        const result = new ResourceMap();\n        const word = primaryModel.getWordAtPosition({\n            lineNumber: position.lineNumber,\n            column: position.column\n        });\n        if (!word) {\n            return Promise.resolve(result);\n        }\n        for (const model of [primaryModel, ...otherModels]) {\n            if (model.isDisposed()) {\n                continue;\n            }\n            const matches = model.findMatches(word.word, true, false, true, USUAL_WORD_SEPARATORS, false);\n            const highlights = matches.map(m => ({\n                range: m.range,\n                kind: DocumentHighlightKind.Text\n            }));\n            if (highlights) {\n                result.set(model.uri, highlights);\n            }\n        }\n        return result;\n    }\n}\nlet TextualMultiDocumentHighlightFeature = class TextualMultiDocumentHighlightFeature extends Disposable {\n    constructor(languageFeaturesService) {\n        super();\n        this._register(languageFeaturesService.documentHighlightProvider.register('*', new TextualDocumentHighlightProvider()));\n        this._register(languageFeaturesService.multiDocumentHighlightProvider.register('*', new TextualDocumentHighlightProvider()));\n    }\n};\nTextualMultiDocumentHighlightFeature = __decorate([\n    __param(0, ILanguageFeaturesService)\n], TextualMultiDocumentHighlightFeature);\nexport { TextualMultiDocumentHighlightFeature };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar WordHighlighter_1, WordHighlighterContribution_1;\nimport * as nls from '../../../../nls.js';\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { createCancelablePromise, Delayer, first } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { isDiffEditor } from '../../../browser/editorBrowser.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution, registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { shouldSynchronizeModel } from '../../../common/model.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { getHighlightDecorationOptions } from './highlightDecorations.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { matchesScheme, Schemas } from '../../../../base/common/network.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nimport { score } from '../../../common/languageSelector.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { TextualMultiDocumentHighlightFeature } from './textualHighlightProvider.js';\nimport { registerEditorFeature } from '../../../common/editorFeatures.js';\nconst ctxHasWordHighlights = new RawContextKey('hasWordHighlights', false);\nexport function getOccurrencesAtPosition(registry, model, position, token) {\n    const orderedByScore = registry.ordered(model);\n    // in order of score ask the occurrences provider\n    // until someone response with a good result\n    // (good = non undefined and non null value)\n    // (result of size == 0 is valid, no highlights is a valid/expected result -- not a signal to fall back to other providers)\n    return first(orderedByScore.map(provider => () => {\n        return Promise.resolve(provider.provideDocumentHighlights(model, position, token))\n            .then(undefined, onUnexpectedExternalError);\n    }), (result) => result !== undefined && result !== null).then(result => {\n        if (result) {\n            const map = new ResourceMap();\n            map.set(model.uri, result);\n            return map;\n        }\n        return new ResourceMap();\n    });\n}\nexport function getOccurrencesAcrossMultipleModels(registry, model, position, wordSeparators, token, otherModels) {\n    const orderedByScore = registry.ordered(model);\n    // in order of score ask the occurrences provider\n    // until someone response with a good result\n    // (good = non undefined and non null ResourceMap)\n    // (result of size == 0 is valid, no highlights is a valid/expected result -- not a signal to fall back to other providers)\n    return first(orderedByScore.map(provider => () => {\n        const filteredModels = otherModels.filter(otherModel => {\n            return shouldSynchronizeModel(otherModel);\n        }).filter(otherModel => {\n            return score(provider.selector, otherModel.uri, otherModel.getLanguageId(), true, undefined, undefined) > 0;\n        });\n        return Promise.resolve(provider.provideMultiDocumentHighlights(model, position, filteredModels, token))\n            .then(undefined, onUnexpectedExternalError);\n    }), (result) => result !== undefined && result !== null);\n}\nclass OccurenceAtPositionRequest {\n    constructor(_model, _selection, _wordSeparators) {\n        this._model = _model;\n        this._selection = _selection;\n        this._wordSeparators = _wordSeparators;\n        this._wordRange = this._getCurrentWordRange(_model, _selection);\n        this._result = null;\n    }\n    get result() {\n        if (!this._result) {\n            this._result = createCancelablePromise(token => this._compute(this._model, this._selection, this._wordSeparators, token));\n        }\n        return this._result;\n    }\n    _getCurrentWordRange(model, selection) {\n        const word = model.getWordAtPosition(selection.getPosition());\n        if (word) {\n            return new Range(selection.startLineNumber, word.startColumn, selection.startLineNumber, word.endColumn);\n        }\n        return null;\n    }\n    isValid(model, selection, decorations) {\n        const lineNumber = selection.startLineNumber;\n        const startColumn = selection.startColumn;\n        const endColumn = selection.endColumn;\n        const currentWordRange = this._getCurrentWordRange(model, selection);\n        let requestIsValid = Boolean(this._wordRange && this._wordRange.equalsRange(currentWordRange));\n        // Even if we are on a different word, if that word is in the decorations ranges, the request is still valid\n        // (Same symbol)\n        for (let i = 0, len = decorations.length; !requestIsValid && i < len; i++) {\n            const range = decorations.getRange(i);\n            if (range && range.startLineNumber === lineNumber) {\n                if (range.startColumn <= startColumn && range.endColumn >= endColumn) {\n                    requestIsValid = true;\n                }\n            }\n        }\n        return requestIsValid;\n    }\n    cancel() {\n        this.result.cancel();\n    }\n}\nclass SemanticOccurenceAtPositionRequest extends OccurenceAtPositionRequest {\n    constructor(model, selection, wordSeparators, providers) {\n        super(model, selection, wordSeparators);\n        this._providers = providers;\n    }\n    _compute(model, selection, wordSeparators, token) {\n        return getOccurrencesAtPosition(this._providers, model, selection.getPosition(), token).then(value => {\n            if (!value) {\n                return new ResourceMap();\n            }\n            return value;\n        });\n    }\n}\nclass MultiModelOccurenceRequest extends OccurenceAtPositionRequest {\n    constructor(model, selection, wordSeparators, providers, otherModels) {\n        super(model, selection, wordSeparators);\n        this._providers = providers;\n        this._otherModels = otherModels;\n    }\n    _compute(model, selection, wordSeparators, token) {\n        return getOccurrencesAcrossMultipleModels(this._providers, model, selection.getPosition(), wordSeparators, token, this._otherModels).then(value => {\n            if (!value) {\n                return new ResourceMap();\n            }\n            return value;\n        });\n    }\n}\nfunction computeOccurencesAtPosition(registry, model, selection, word, wordSeparators) {\n    return new SemanticOccurenceAtPositionRequest(model, selection, wordSeparators, registry);\n}\nfunction computeOccurencesMultiModel(registry, model, selection, word, wordSeparators, otherModels) {\n    return new MultiModelOccurenceRequest(model, selection, wordSeparators, registry, otherModels);\n}\nregisterModelAndPositionCommand('_executeDocumentHighlights', async (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const map = await getOccurrencesAtPosition(languageFeaturesService.documentHighlightProvider, model, position, CancellationToken.None);\n    return map?.get(model.uri);\n});\nlet WordHighlighter = class WordHighlighter {\n    static { WordHighlighter_1 = this; }\n    static { this.storedDecorationIDs = new ResourceMap(); }\n    static { this.query = null; }\n    constructor(editor, providers, multiProviders, contextKeyService, codeEditorService) {\n        this.toUnhook = new DisposableStore();\n        this.workerRequestTokenId = 0;\n        this.workerRequestCompleted = false;\n        this.workerRequestValue = new ResourceMap();\n        this.lastCursorPositionChangeTime = 0;\n        this.renderDecorationsTimer = -1;\n        this.runDelayer = this.toUnhook.add(new Delayer(50));\n        this.editor = editor;\n        this.providers = providers;\n        this.multiDocumentProviders = multiProviders;\n        this.codeEditorService = codeEditorService;\n        this._hasWordHighlights = ctxHasWordHighlights.bindTo(contextKeyService);\n        this._ignorePositionChangeEvent = false;\n        this.occurrencesHighlight = this.editor.getOption(81 /* EditorOption.occurrencesHighlight */);\n        this.model = this.editor.getModel();\n        this.toUnhook.add(editor.onDidChangeCursorPosition((e) => {\n            if (this._ignorePositionChangeEvent) {\n                // We are changing the position => ignore this event\n                return;\n            }\n            if (this.occurrencesHighlight === 'off') {\n                // Early exit if nothing needs to be done!\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\n                return;\n            }\n            this.runDelayer.trigger(() => { this._onPositionChanged(e); });\n        }));\n        this.toUnhook.add(editor.onDidFocusEditorText((e) => {\n            if (this.occurrencesHighlight === 'off') {\n                // Early exit if nothing needs to be done\n                return;\n            }\n            if (!this.workerRequest) {\n                this.runDelayer.trigger(() => { this._run(); });\n            }\n        }));\n        this.toUnhook.add(editor.onDidChangeModelContent((e) => {\n            if (!matchesScheme(this.model.uri, 'output')) {\n                this._stopAll();\n            }\n        }));\n        this.toUnhook.add(editor.onDidChangeModel((e) => {\n            if (!e.newModelUrl && e.oldModelUrl) {\n                this._stopSingular();\n            }\n            else {\n                if (WordHighlighter_1.query) {\n                    this._run();\n                }\n            }\n        }));\n        this.toUnhook.add(editor.onDidChangeConfiguration((e) => {\n            const newValue = this.editor.getOption(81 /* EditorOption.occurrencesHighlight */);\n            if (this.occurrencesHighlight !== newValue) {\n                this.occurrencesHighlight = newValue;\n                switch (newValue) {\n                    case 'off':\n                        this._stopAll();\n                        break;\n                    case 'singleFile':\n                        this._stopAll(WordHighlighter_1.query?.modelInfo?.model);\n                        break;\n                    case 'multiFile':\n                        if (WordHighlighter_1.query) {\n                            this._run(true);\n                        }\n                        break;\n                    default:\n                        console.warn('Unknown occurrencesHighlight setting value:', newValue);\n                        break;\n                }\n            }\n        }));\n        this.decorations = this.editor.createDecorationsCollection();\n        this.workerRequestTokenId = 0;\n        this.workerRequest = null;\n        this.workerRequestCompleted = false;\n        this.lastCursorPositionChangeTime = 0;\n        this.renderDecorationsTimer = -1;\n        // if there is a query already, highlight off that query\n        if (WordHighlighter_1.query) {\n            this._run();\n        }\n    }\n    hasDecorations() {\n        return (this.decorations.length > 0);\n    }\n    restore() {\n        if (this.occurrencesHighlight === 'off') {\n            return;\n        }\n        this.runDelayer.cancel();\n        this._run();\n    }\n    _getSortedHighlights() {\n        return (this.decorations.getRanges()\n            .sort(Range.compareRangesUsingStarts));\n    }\n    moveNext() {\n        const highlights = this._getSortedHighlights();\n        const index = highlights.findIndex((range) => range.containsPosition(this.editor.getPosition()));\n        const newIndex = ((index + 1) % highlights.length);\n        const dest = highlights[newIndex];\n        try {\n            this._ignorePositionChangeEvent = true;\n            this.editor.setPosition(dest.getStartPosition());\n            this.editor.revealRangeInCenterIfOutsideViewport(dest);\n            const word = this._getWord();\n            if (word) {\n                const lineContent = this.editor.getModel().getLineContent(dest.startLineNumber);\n                alert(`${lineContent}, ${newIndex + 1} of ${highlights.length} for '${word.word}'`);\n            }\n        }\n        finally {\n            this._ignorePositionChangeEvent = false;\n        }\n    }\n    moveBack() {\n        const highlights = this._getSortedHighlights();\n        const index = highlights.findIndex((range) => range.containsPosition(this.editor.getPosition()));\n        const newIndex = ((index - 1 + highlights.length) % highlights.length);\n        const dest = highlights[newIndex];\n        try {\n            this._ignorePositionChangeEvent = true;\n            this.editor.setPosition(dest.getStartPosition());\n            this.editor.revealRangeInCenterIfOutsideViewport(dest);\n            const word = this._getWord();\n            if (word) {\n                const lineContent = this.editor.getModel().getLineContent(dest.startLineNumber);\n                alert(`${lineContent}, ${newIndex + 1} of ${highlights.length} for '${word.word}'`);\n            }\n        }\n        finally {\n            this._ignorePositionChangeEvent = false;\n        }\n    }\n    _removeSingleDecorations() {\n        // return if no model\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        const currentDecorationIDs = WordHighlighter_1.storedDecorationIDs.get(this.editor.getModel().uri);\n        if (!currentDecorationIDs) {\n            return;\n        }\n        this.editor.removeDecorations(currentDecorationIDs);\n        WordHighlighter_1.storedDecorationIDs.delete(this.editor.getModel().uri);\n        if (this.decorations.length > 0) {\n            this.decorations.clear();\n            this._hasWordHighlights.set(false);\n        }\n    }\n    _removeAllDecorations(preservedModel) {\n        const currentEditors = this.codeEditorService.listCodeEditors();\n        const deleteURI = [];\n        // iterate over editors and store models in currentModels\n        for (const editor of currentEditors) {\n            if (!editor.hasModel() || isEqual(editor.getModel().uri, preservedModel?.uri)) {\n                continue;\n            }\n            const currentDecorationIDs = WordHighlighter_1.storedDecorationIDs.get(editor.getModel().uri);\n            if (!currentDecorationIDs) {\n                continue;\n            }\n            editor.removeDecorations(currentDecorationIDs);\n            deleteURI.push(editor.getModel().uri);\n            const editorHighlighterContrib = WordHighlighterContribution.get(editor);\n            if (!editorHighlighterContrib?.wordHighlighter) {\n                continue;\n            }\n            if (editorHighlighterContrib.wordHighlighter.decorations.length > 0) {\n                editorHighlighterContrib.wordHighlighter.decorations.clear();\n                editorHighlighterContrib.wordHighlighter.workerRequest = null;\n                editorHighlighterContrib.wordHighlighter._hasWordHighlights.set(false);\n            }\n        }\n        for (const uri of deleteURI) {\n            WordHighlighter_1.storedDecorationIDs.delete(uri);\n        }\n    }\n    _stopSingular() {\n        // Remove any existing decorations + a possible query, and re - run to update decorations\n        this._removeSingleDecorations();\n        if (this.editor.hasTextFocus()) {\n            if (this.editor.getModel()?.uri.scheme !== Schemas.vscodeNotebookCell && WordHighlighter_1.query?.modelInfo?.model.uri.scheme !== Schemas.vscodeNotebookCell) { // clear query if focused non-nb editor\n                WordHighlighter_1.query = null;\n                this._run(); // TODO: @Yoyokrazy -- investigate why we need a full rerun here. likely addressed a case/patch in the first iteration of this feature\n            }\n            else { // remove modelInfo to account for nb cell being disposed\n                if (WordHighlighter_1.query?.modelInfo) {\n                    WordHighlighter_1.query.modelInfo = null;\n                }\n            }\n        }\n        // Cancel any renderDecorationsTimer\n        if (this.renderDecorationsTimer !== -1) {\n            clearTimeout(this.renderDecorationsTimer);\n            this.renderDecorationsTimer = -1;\n        }\n        // Cancel any worker request\n        if (this.workerRequest !== null) {\n            this.workerRequest.cancel();\n            this.workerRequest = null;\n        }\n        // Invalidate any worker request callback\n        if (!this.workerRequestCompleted) {\n            this.workerRequestTokenId++;\n            this.workerRequestCompleted = true;\n        }\n    }\n    _stopAll(preservedModel) {\n        // Remove any existing decorations\n        // TODO: @Yoyokrazy -- this triggers as notebooks scroll, causing highlights to disappear momentarily.\n        // maybe a nb type check?\n        this._removeAllDecorations(preservedModel);\n        // Cancel any renderDecorationsTimer\n        if (this.renderDecorationsTimer !== -1) {\n            clearTimeout(this.renderDecorationsTimer);\n            this.renderDecorationsTimer = -1;\n        }\n        // Cancel any worker request\n        if (this.workerRequest !== null) {\n            this.workerRequest.cancel();\n            this.workerRequest = null;\n        }\n        // Invalidate any worker request callback\n        if (!this.workerRequestCompleted) {\n            this.workerRequestTokenId++;\n            this.workerRequestCompleted = true;\n        }\n    }\n    _onPositionChanged(e) {\n        // disabled\n        if (this.occurrencesHighlight === 'off') {\n            this._stopAll();\n            return;\n        }\n        // ignore typing & other\n        // need to check if the model is a notebook cell, should not stop if nb\n        if (e.reason !== 3 /* CursorChangeReason.Explicit */ && this.editor.getModel()?.uri.scheme !== Schemas.vscodeNotebookCell) {\n            this._stopAll();\n            return;\n        }\n        this._run();\n    }\n    _getWord() {\n        const editorSelection = this.editor.getSelection();\n        const lineNumber = editorSelection.startLineNumber;\n        const startColumn = editorSelection.startColumn;\n        if (this.model.isDisposed()) {\n            return null;\n        }\n        return this.model.getWordAtPosition({\n            lineNumber: lineNumber,\n            column: startColumn\n        });\n    }\n    getOtherModelsToHighlight(model) {\n        if (!model) {\n            return [];\n        }\n        // notebook case\n        const isNotebookEditor = model.uri.scheme === Schemas.vscodeNotebookCell;\n        if (isNotebookEditor) {\n            const currentModels = [];\n            const currentEditors = this.codeEditorService.listCodeEditors();\n            for (const editor of currentEditors) {\n                const tempModel = editor.getModel();\n                if (tempModel && tempModel !== model && tempModel.uri.scheme === Schemas.vscodeNotebookCell) {\n                    currentModels.push(tempModel);\n                }\n            }\n            return currentModels;\n        }\n        // inline case\n        // ? current works when highlighting outside of an inline diff, highlighting in.\n        // ? broken when highlighting within a diff editor. highlighting the main editor does not work\n        // ? editor group service could be useful here\n        const currentModels = [];\n        const currentEditors = this.codeEditorService.listCodeEditors();\n        for (const editor of currentEditors) {\n            if (!isDiffEditor(editor)) {\n                continue;\n            }\n            const diffModel = editor.getModel();\n            if (!diffModel) {\n                continue;\n            }\n            if (model === diffModel.modified) { // embedded inline chat diff would pass this, allowing highlights\n                //? currentModels.push(diffModel.original);\n                currentModels.push(diffModel.modified);\n            }\n        }\n        if (currentModels.length) { // no matching editors have been found\n            return currentModels;\n        }\n        // multi-doc OFF\n        if (this.occurrencesHighlight === 'singleFile') {\n            return [];\n        }\n        // multi-doc ON\n        for (const editor of currentEditors) {\n            const tempModel = editor.getModel();\n            const isValidModel = tempModel && tempModel !== model;\n            if (isValidModel) {\n                currentModels.push(tempModel);\n            }\n        }\n        return currentModels;\n    }\n    _run(multiFileConfigChange) {\n        let workerRequestIsValid;\n        const hasTextFocus = this.editor.hasTextFocus();\n        if (!hasTextFocus) { // new nb cell scrolled in, didChangeModel fires\n            if (!WordHighlighter_1.query) { // no previous query, nothing to highlight off of\n                this._stopAll();\n                return;\n            }\n        }\n        else { // has text focus\n            const editorSelection = this.editor.getSelection();\n            // ignore multiline selection\n            if (!editorSelection || editorSelection.startLineNumber !== editorSelection.endLineNumber) {\n                WordHighlighter_1.query = null;\n                this._stopAll();\n                return;\n            }\n            const startColumn = editorSelection.startColumn;\n            const endColumn = editorSelection.endColumn;\n            const word = this._getWord();\n            // The selection must be inside a word or surround one word at most\n            if (!word || word.startColumn > startColumn || word.endColumn < endColumn) {\n                // no previous query, nothing to highlight\n                WordHighlighter_1.query = null;\n                this._stopAll();\n                return;\n            }\n            // All the effort below is trying to achieve this:\n            // - when cursor is moved to a word, trigger immediately a findOccurrences request\n            // - 250ms later after the last cursor move event, render the occurrences\n            // - no flickering!\n            workerRequestIsValid = (this.workerRequest && this.workerRequest.isValid(this.model, editorSelection, this.decorations));\n            WordHighlighter_1.query = {\n                modelInfo: {\n                    model: this.model,\n                    selection: editorSelection,\n                },\n                word: word\n            };\n        }\n        // There are 4 cases:\n        // a) old workerRequest is valid & completed, renderDecorationsTimer fired\n        // b) old workerRequest is valid & completed, renderDecorationsTimer not fired\n        // c) old workerRequest is valid, but not completed\n        // d) old workerRequest is not valid\n        // For a) no action is needed\n        // For c), member 'lastCursorPositionChangeTime' will be used when installing the timer so no action is needed\n        this.lastCursorPositionChangeTime = (new Date()).getTime();\n        if (workerRequestIsValid) {\n            if (this.workerRequestCompleted && this.renderDecorationsTimer !== -1) {\n                // case b)\n                // Delay the firing of renderDecorationsTimer by an extra 250 ms\n                clearTimeout(this.renderDecorationsTimer);\n                this.renderDecorationsTimer = -1;\n                this._beginRenderDecorations();\n            }\n        }\n        else if (isEqual(this.editor.getModel().uri, WordHighlighter_1.query.modelInfo?.model.uri)) { // only trigger new worker requests from the primary model that initiated the query\n            // case d)\n            // check if the new queried word is contained in the range of a stored decoration for this model\n            if (!multiFileConfigChange) {\n                const currentModelDecorationRanges = this.decorations.getRanges();\n                for (const storedRange of currentModelDecorationRanges) {\n                    if (storedRange.containsPosition(this.editor.getPosition())) {\n                        return;\n                    }\n                }\n            }\n            // stop all previous actions if new word is highlighted\n            // if we trigger the run off a setting change -> multifile highlighting, we do not want to remove decorations from this model\n            this._stopAll(multiFileConfigChange ? this.model : undefined);\n            const myRequestId = ++this.workerRequestTokenId;\n            this.workerRequestCompleted = false;\n            const otherModelsToHighlight = this.getOtherModelsToHighlight(this.editor.getModel());\n            // when reaching here, there are two possible states.\n            // \t\t1) we have text focus, and a valid query was updated.\n            // \t\t2) we do not have text focus, and a valid query is cached.\n            // the query will ALWAYS have the correct data for the current highlight request, so it can always be passed to the workerRequest safely\n            if (!WordHighlighter_1.query || !WordHighlighter_1.query.modelInfo || WordHighlighter_1.query.modelInfo.model.isDisposed()) {\n                return;\n            }\n            this.workerRequest = this.computeWithModel(WordHighlighter_1.query.modelInfo.model, WordHighlighter_1.query.modelInfo.selection, WordHighlighter_1.query.word, otherModelsToHighlight);\n            this.workerRequest?.result.then(data => {\n                if (myRequestId === this.workerRequestTokenId) {\n                    this.workerRequestCompleted = true;\n                    this.workerRequestValue = data || [];\n                    this._beginRenderDecorations();\n                }\n            }, onUnexpectedError);\n        }\n    }\n    computeWithModel(model, selection, word, otherModels) {\n        if (!otherModels.length) {\n            return computeOccurencesAtPosition(this.providers, model, selection, word, this.editor.getOption(132 /* EditorOption.wordSeparators */));\n        }\n        else {\n            return computeOccurencesMultiModel(this.multiDocumentProviders, model, selection, word, this.editor.getOption(132 /* EditorOption.wordSeparators */), otherModels);\n        }\n    }\n    _beginRenderDecorations() {\n        const currentTime = (new Date()).getTime();\n        const minimumRenderTime = this.lastCursorPositionChangeTime + 250;\n        if (currentTime >= minimumRenderTime) {\n            // Synchronous\n            this.renderDecorationsTimer = -1;\n            this.renderDecorations();\n        }\n        else {\n            // Asynchronous\n            this.renderDecorationsTimer = setTimeout(() => {\n                this.renderDecorations();\n            }, (minimumRenderTime - currentTime));\n        }\n    }\n    renderDecorations() {\n        this.renderDecorationsTimer = -1;\n        // create new loop, iterate over current editors using this.codeEditorService.listCodeEditors(),\n        // if the URI of that codeEditor is in the map, then add the decorations to the decorations array\n        // then set the decorations for the editor\n        const currentEditors = this.codeEditorService.listCodeEditors();\n        for (const editor of currentEditors) {\n            const editorHighlighterContrib = WordHighlighterContribution.get(editor);\n            if (!editorHighlighterContrib) {\n                continue;\n            }\n            const newDecorations = [];\n            const uri = editor.getModel()?.uri;\n            if (uri && this.workerRequestValue.has(uri)) {\n                const oldDecorationIDs = WordHighlighter_1.storedDecorationIDs.get(uri);\n                const newDocumentHighlights = this.workerRequestValue.get(uri);\n                if (newDocumentHighlights) {\n                    for (const highlight of newDocumentHighlights) {\n                        if (!highlight.range) {\n                            continue;\n                        }\n                        newDecorations.push({\n                            range: highlight.range,\n                            options: getHighlightDecorationOptions(highlight.kind)\n                        });\n                    }\n                }\n                let newDecorationIDs = [];\n                editor.changeDecorations((changeAccessor) => {\n                    newDecorationIDs = changeAccessor.deltaDecorations(oldDecorationIDs ?? [], newDecorations);\n                });\n                WordHighlighter_1.storedDecorationIDs = WordHighlighter_1.storedDecorationIDs.set(uri, newDecorationIDs);\n                if (newDecorations.length > 0) {\n                    editorHighlighterContrib.wordHighlighter?.decorations.set(newDecorations);\n                    editorHighlighterContrib.wordHighlighter?._hasWordHighlights.set(true);\n                }\n            }\n        }\n    }\n    dispose() {\n        this._stopSingular();\n        this.toUnhook.dispose();\n    }\n};\nWordHighlighter = WordHighlighter_1 = __decorate([\n    __param(4, ICodeEditorService)\n], WordHighlighter);\nlet WordHighlighterContribution = class WordHighlighterContribution extends Disposable {\n    static { WordHighlighterContribution_1 = this; }\n    static { this.ID = 'editor.contrib.wordHighlighter'; }\n    static get(editor) {\n        return editor.getContribution(WordHighlighterContribution_1.ID);\n    }\n    constructor(editor, contextKeyService, languageFeaturesService, codeEditorService) {\n        super();\n        this._wordHighlighter = null;\n        const createWordHighlighterIfPossible = () => {\n            if (editor.hasModel() && !editor.getModel().isTooLargeForTokenization()) {\n                this._wordHighlighter = new WordHighlighter(editor, languageFeaturesService.documentHighlightProvider, languageFeaturesService.multiDocumentHighlightProvider, contextKeyService, codeEditorService);\n            }\n        };\n        this._register(editor.onDidChangeModel((e) => {\n            if (this._wordHighlighter) {\n                this._wordHighlighter.dispose();\n                this._wordHighlighter = null;\n            }\n            createWordHighlighterIfPossible();\n        }));\n        createWordHighlighterIfPossible();\n    }\n    get wordHighlighter() {\n        return this._wordHighlighter;\n    }\n    saveViewState() {\n        if (this._wordHighlighter && this._wordHighlighter.hasDecorations()) {\n            return true;\n        }\n        return false;\n    }\n    moveNext() {\n        this._wordHighlighter?.moveNext();\n    }\n    moveBack() {\n        this._wordHighlighter?.moveBack();\n    }\n    restoreViewState(state) {\n        if (this._wordHighlighter && state) {\n            this._wordHighlighter.restore();\n        }\n    }\n    dispose() {\n        if (this._wordHighlighter) {\n            this._wordHighlighter.dispose();\n            this._wordHighlighter = null;\n        }\n        super.dispose();\n    }\n};\nWordHighlighterContribution = WordHighlighterContribution_1 = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, ICodeEditorService)\n], WordHighlighterContribution);\nexport { WordHighlighterContribution };\nclass WordHighlightNavigationAction extends EditorAction {\n    constructor(next, opts) {\n        super(opts);\n        this._isNext = next;\n    }\n    run(accessor, editor) {\n        const controller = WordHighlighterContribution.get(editor);\n        if (!controller) {\n            return;\n        }\n        if (this._isNext) {\n            controller.moveNext();\n        }\n        else {\n            controller.moveBack();\n        }\n    }\n}\nclass NextWordHighlightAction extends WordHighlightNavigationAction {\n    constructor() {\n        super(true, {\n            id: 'editor.action.wordHighlight.next',\n            label: nls.localize('wordHighlight.next.label', \"Go to Next Symbol Highlight\"),\n            alias: 'Go to Next Symbol Highlight',\n            precondition: ctxHasWordHighlights,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 65 /* KeyCode.F7 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nclass PrevWordHighlightAction extends WordHighlightNavigationAction {\n    constructor() {\n        super(false, {\n            id: 'editor.action.wordHighlight.prev',\n            label: nls.localize('wordHighlight.previous.label', \"Go to Previous Symbol Highlight\"),\n            alias: 'Go to Previous Symbol Highlight',\n            precondition: ctxHasWordHighlights,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 65 /* KeyCode.F7 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nclass TriggerWordHighlightAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.wordHighlight.trigger',\n            label: nls.localize('wordHighlight.trigger.label', \"Trigger Symbol Highlight\"),\n            alias: 'Trigger Symbol Highlight',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 0,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        const controller = WordHighlighterContribution.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.restoreViewState(true);\n    }\n}\nregisterEditorContribution(WordHighlighterContribution.ID, WordHighlighterContribution, 0 /* EditorContributionInstantiation.Eager */); // eager because it uses `saveViewState`/`restoreViewState`\nregisterEditorAction(NextWordHighlightAction);\nregisterEditorAction(PrevWordHighlightAction);\nregisterEditorAction(TriggerWordHighlightAction);\nregisterEditorFeature(TextualMultiDocumentHighlightFeature);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { ReplaceCommand } from '../../../common/commands/replaceCommand.js';\nimport { EditorOptions } from '../../../common/config/editorOptions.js';\nimport { CursorState } from '../../../common/cursorCommon.js';\nimport { WordOperations } from '../../../common/cursor/cursorWordOperations.js';\nimport { getMapForWordSeparators } from '../../../common/core/wordCharacterClassifier.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport * as nls from '../../../../nls.js';\nimport { CONTEXT_ACCESSIBILITY_MODE_ENABLED } from '../../../../platform/accessibility/common/accessibility.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IsWindowsContext } from '../../../../platform/contextkey/common/contextkeys.js';\nexport class MoveWordCommand extends EditorCommand {\n    constructor(opts) {\n        super(opts);\n        this._inSelectionMode = opts.inSelectionMode;\n        this._wordNavigationType = opts.wordNavigationType;\n    }\n    runEditorCommand(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const wordSeparators = getMapForWordSeparators(editor.getOption(132 /* EditorOption.wordSeparators */), editor.getOption(131 /* EditorOption.wordSegmenterLocales */));\n        const model = editor.getModel();\n        const selections = editor.getSelections();\n        const hasMulticursor = selections.length > 1;\n        const result = selections.map((sel) => {\n            const inPosition = new Position(sel.positionLineNumber, sel.positionColumn);\n            const outPosition = this._move(wordSeparators, model, inPosition, this._wordNavigationType, hasMulticursor);\n            return this._moveTo(sel, outPosition, this._inSelectionMode);\n        });\n        model.pushStackElement();\n        editor._getViewModel().setCursorStates('moveWordCommand', 3 /* CursorChangeReason.Explicit */, result.map(r => CursorState.fromModelSelection(r)));\n        if (result.length === 1) {\n            const pos = new Position(result[0].positionLineNumber, result[0].positionColumn);\n            editor.revealPosition(pos, 0 /* ScrollType.Smooth */);\n        }\n    }\n    _moveTo(from, to, inSelectionMode) {\n        if (inSelectionMode) {\n            // move just position\n            return new Selection(from.selectionStartLineNumber, from.selectionStartColumn, to.lineNumber, to.column);\n        }\n        else {\n            // move everything\n            return new Selection(to.lineNumber, to.column, to.lineNumber, to.column);\n        }\n    }\n}\nexport class WordLeftCommand extends MoveWordCommand {\n    _move(wordSeparators, model, position, wordNavigationType, hasMulticursor) {\n        return WordOperations.moveWordLeft(wordSeparators, model, position, wordNavigationType, hasMulticursor);\n    }\n}\nexport class WordRightCommand extends MoveWordCommand {\n    _move(wordSeparators, model, position, wordNavigationType, hasMulticursor) {\n        return WordOperations.moveWordRight(wordSeparators, model, position, wordNavigationType);\n    }\n}\nexport class CursorWordStartLeft extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'cursorWordStartLeft',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordEndLeft extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordEndLeft',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordLeft extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 1 /* WordNavigationType.WordStartFast */,\n            id: 'cursorWordLeft',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED, IsWindowsContext)?.negate()),\n                primary: 2048 /* KeyMod.CtrlCmd */ | 15 /* KeyCode.LeftArrow */,\n                mac: { primary: 512 /* KeyMod.Alt */ | 15 /* KeyCode.LeftArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nexport class CursorWordStartLeftSelect extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'cursorWordStartLeftSelect',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordEndLeftSelect extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordEndLeftSelect',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordLeftSelect extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 1 /* WordNavigationType.WordStartFast */,\n            id: 'cursorWordLeftSelect',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED, IsWindowsContext)?.negate()),\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */,\n                mac: { primary: 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\n// Accessibility navigation commands should only be enabled on windows since they are tuned to what NVDA expects\nexport class CursorWordAccessibilityLeft extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 3 /* WordNavigationType.WordAccessibility */,\n            id: 'cursorWordAccessibilityLeft',\n            precondition: undefined\n        });\n    }\n    _move(wordCharacterClassifier, model, position, wordNavigationType, hasMulticursor) {\n        return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue, wordCharacterClassifier.intlSegmenterLocales), model, position, wordNavigationType, hasMulticursor);\n    }\n}\nexport class CursorWordAccessibilityLeftSelect extends WordLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 3 /* WordNavigationType.WordAccessibility */,\n            id: 'cursorWordAccessibilityLeftSelect',\n            precondition: undefined\n        });\n    }\n    _move(wordCharacterClassifier, model, position, wordNavigationType, hasMulticursor) {\n        return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue, wordCharacterClassifier.intlSegmenterLocales), model, position, wordNavigationType, hasMulticursor);\n    }\n}\nexport class CursorWordStartRight extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'cursorWordStartRight',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordEndRight extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordEndRight',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED, IsWindowsContext)?.negate()),\n                primary: 2048 /* KeyMod.CtrlCmd */ | 17 /* KeyCode.RightArrow */,\n                mac: { primary: 512 /* KeyMod.Alt */ | 17 /* KeyCode.RightArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nexport class CursorWordRight extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordRight',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordStartRightSelect extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'cursorWordStartRightSelect',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordEndRightSelect extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordEndRightSelect',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED, IsWindowsContext)?.negate()),\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */,\n                mac: { primary: 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nexport class CursorWordRightSelect extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordRightSelect',\n            precondition: undefined\n        });\n    }\n}\nexport class CursorWordAccessibilityRight extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 3 /* WordNavigationType.WordAccessibility */,\n            id: 'cursorWordAccessibilityRight',\n            precondition: undefined\n        });\n    }\n    _move(wordCharacterClassifier, model, position, wordNavigationType, hasMulticursor) {\n        return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue, wordCharacterClassifier.intlSegmenterLocales), model, position, wordNavigationType, hasMulticursor);\n    }\n}\nexport class CursorWordAccessibilityRightSelect extends WordRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 3 /* WordNavigationType.WordAccessibility */,\n            id: 'cursorWordAccessibilityRightSelect',\n            precondition: undefined\n        });\n    }\n    _move(wordCharacterClassifier, model, position, wordNavigationType, hasMulticursor) {\n        return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue, wordCharacterClassifier.intlSegmenterLocales), model, position, wordNavigationType, hasMulticursor);\n    }\n}\nexport class DeleteWordCommand extends EditorCommand {\n    constructor(opts) {\n        super(opts);\n        this._whitespaceHeuristics = opts.whitespaceHeuristics;\n        this._wordNavigationType = opts.wordNavigationType;\n    }\n    runEditorCommand(accessor, editor, args) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        if (!editor.hasModel()) {\n            return;\n        }\n        const wordSeparators = getMapForWordSeparators(editor.getOption(132 /* EditorOption.wordSeparators */), editor.getOption(131 /* EditorOption.wordSegmenterLocales */));\n        const model = editor.getModel();\n        const selections = editor.getSelections();\n        const autoClosingBrackets = editor.getOption(6 /* EditorOption.autoClosingBrackets */);\n        const autoClosingQuotes = editor.getOption(11 /* EditorOption.autoClosingQuotes */);\n        const autoClosingPairs = languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getAutoClosingPairs();\n        const viewModel = editor._getViewModel();\n        const commands = selections.map((sel) => {\n            const deleteRange = this._delete({\n                wordSeparators,\n                model,\n                selection: sel,\n                whitespaceHeuristics: this._whitespaceHeuristics,\n                autoClosingDelete: editor.getOption(9 /* EditorOption.autoClosingDelete */),\n                autoClosingBrackets,\n                autoClosingQuotes,\n                autoClosingPairs,\n                autoClosedCharacters: viewModel.getCursorAutoClosedCharacters(),\n            }, this._wordNavigationType);\n            return new ReplaceCommand(deleteRange, '');\n        });\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nexport class DeleteWordLeftCommand extends DeleteWordCommand {\n    _delete(ctx, wordNavigationType) {\n        const r = WordOperations.deleteWordLeft(ctx, wordNavigationType);\n        if (r) {\n            return r;\n        }\n        return new Range(1, 1, 1, 1);\n    }\n}\nexport class DeleteWordRightCommand extends DeleteWordCommand {\n    _delete(ctx, wordNavigationType) {\n        const r = WordOperations.deleteWordRight(ctx, wordNavigationType);\n        if (r) {\n            return r;\n        }\n        const lineCount = ctx.model.getLineCount();\n        const maxColumn = ctx.model.getLineMaxColumn(lineCount);\n        return new Range(lineCount, maxColumn, lineCount, maxColumn);\n    }\n}\nexport class DeleteWordStartLeft extends DeleteWordLeftCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: false,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'deleteWordStartLeft',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nexport class DeleteWordEndLeft extends DeleteWordLeftCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: false,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'deleteWordEndLeft',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nexport class DeleteWordLeft extends DeleteWordLeftCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: true,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'deleteWordLeft',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1 /* KeyCode.Backspace */,\n                mac: { primary: 512 /* KeyMod.Alt */ | 1 /* KeyCode.Backspace */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nexport class DeleteWordStartRight extends DeleteWordRightCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: false,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'deleteWordStartRight',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nexport class DeleteWordEndRight extends DeleteWordRightCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: false,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'deleteWordEndRight',\n            precondition: EditorContextKeys.writable\n        });\n    }\n}\nexport class DeleteWordRight extends DeleteWordRightCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: true,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'deleteWordRight',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 20 /* KeyCode.Delete */,\n                mac: { primary: 512 /* KeyMod.Alt */ | 20 /* KeyCode.Delete */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nexport class DeleteInsideWord extends EditorAction {\n    constructor() {\n        super({\n            id: 'deleteInsideWord',\n            precondition: EditorContextKeys.writable,\n            label: nls.localize('deleteInsideWord', \"Delete Word\"),\n            alias: 'Delete Word'\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const wordSeparators = getMapForWordSeparators(editor.getOption(132 /* EditorOption.wordSeparators */), editor.getOption(131 /* EditorOption.wordSegmenterLocales */));\n        const model = editor.getModel();\n        const selections = editor.getSelections();\n        const commands = selections.map((sel) => {\n            const deleteRange = WordOperations.deleteInsideWord(wordSeparators, model, sel);\n            return new ReplaceCommand(deleteRange, '');\n        });\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, commands);\n        editor.pushUndoStop();\n    }\n}\nregisterEditorCommand(new CursorWordStartLeft());\nregisterEditorCommand(new CursorWordEndLeft());\nregisterEditorCommand(new CursorWordLeft());\nregisterEditorCommand(new CursorWordStartLeftSelect());\nregisterEditorCommand(new CursorWordEndLeftSelect());\nregisterEditorCommand(new CursorWordLeftSelect());\nregisterEditorCommand(new CursorWordStartRight());\nregisterEditorCommand(new CursorWordEndRight());\nregisterEditorCommand(new CursorWordRight());\nregisterEditorCommand(new CursorWordStartRightSelect());\nregisterEditorCommand(new CursorWordEndRightSelect());\nregisterEditorCommand(new CursorWordRightSelect());\nregisterEditorCommand(new CursorWordAccessibilityLeft());\nregisterEditorCommand(new CursorWordAccessibilityLeftSelect());\nregisterEditorCommand(new CursorWordAccessibilityRight());\nregisterEditorCommand(new CursorWordAccessibilityRightSelect());\nregisterEditorCommand(new DeleteWordStartLeft());\nregisterEditorCommand(new DeleteWordEndLeft());\nregisterEditorCommand(new DeleteWordLeft());\nregisterEditorCommand(new DeleteWordStartRight());\nregisterEditorCommand(new DeleteWordEndRight());\nregisterEditorCommand(new DeleteWordRight());\nregisterEditorAction(DeleteInsideWord);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { WordPartOperations } from '../../../common/cursor/cursorWordOperations.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { DeleteWordCommand, MoveWordCommand } from '../../wordOperations/browser/wordOperations.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nexport class DeleteWordPartLeft extends DeleteWordCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: true,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'deleteWordPartLeft',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 1 /* KeyCode.Backspace */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _delete(ctx, wordNavigationType) {\n        const r = WordPartOperations.deleteWordPartLeft(ctx);\n        if (r) {\n            return r;\n        }\n        return new Range(1, 1, 1, 1);\n    }\n}\nexport class DeleteWordPartRight extends DeleteWordCommand {\n    constructor() {\n        super({\n            whitespaceHeuristics: true,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'deleteWordPartRight',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 20 /* KeyCode.Delete */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _delete(ctx, wordNavigationType) {\n        const r = WordPartOperations.deleteWordPartRight(ctx);\n        if (r) {\n            return r;\n        }\n        const lineCount = ctx.model.getLineCount();\n        const maxColumn = ctx.model.getLineMaxColumn(lineCount);\n        return new Range(lineCount, maxColumn, lineCount, maxColumn);\n    }\n}\nexport class WordPartLeftCommand extends MoveWordCommand {\n    _move(wordSeparators, model, position, wordNavigationType, hasMulticursor) {\n        return WordPartOperations.moveWordPartLeft(wordSeparators, model, position, hasMulticursor);\n    }\n}\nexport class CursorWordPartLeft extends WordPartLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'cursorWordPartLeft',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 15 /* KeyCode.LeftArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\n// Register previous id for compatibility purposes\nCommandsRegistry.registerCommandAlias('cursorWordPartStartLeft', 'cursorWordPartLeft');\nexport class CursorWordPartLeftSelect extends WordPartLeftCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 0 /* WordNavigationType.WordStart */,\n            id: 'cursorWordPartLeftSelect',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\n// Register previous id for compatibility purposes\nCommandsRegistry.registerCommandAlias('cursorWordPartStartLeftSelect', 'cursorWordPartLeftSelect');\nexport class WordPartRightCommand extends MoveWordCommand {\n    _move(wordSeparators, model, position, wordNavigationType, hasMulticursor) {\n        return WordPartOperations.moveWordPartRight(wordSeparators, model, position);\n    }\n}\nexport class CursorWordPartRight extends WordPartRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: false,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordPartRight',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 17 /* KeyCode.RightArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nexport class CursorWordPartRightSelect extends WordPartRightCommand {\n    constructor() {\n        super({\n            inSelectionMode: true,\n            wordNavigationType: 2 /* WordNavigationType.WordEnd */,\n            id: 'cursorWordPartRightSelect',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.textInputFocus,\n                primary: 0,\n                mac: { primary: 256 /* KeyMod.WinCtrl */ | 512 /* KeyMod.Alt */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n}\nregisterEditorCommand(new DeleteWordPartLeft());\nregisterEditorCommand(new DeleteWordPartRight());\nregisterEditorCommand(new CursorWordPartLeft());\nregisterEditorCommand(new CursorWordPartLeftSelect());\nregisterEditorCommand(new CursorWordPartRight());\nregisterEditorCommand(new CursorWordPartRightSelect());\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport * as nls from '../../../../nls.js';\nexport class ReadOnlyMessageController extends Disposable {\n    static { this.ID = 'editor.contrib.readOnlyMessageController'; }\n    constructor(editor) {\n        super();\n        this.editor = editor;\n        this._register(this.editor.onDidAttemptReadOnlyEdit(() => this._onDidAttemptReadOnlyEdit()));\n    }\n    _onDidAttemptReadOnlyEdit() {\n        const messageController = MessageController.get(this.editor);\n        if (messageController && this.editor.hasModel()) {\n            let message = this.editor.getOptions().get(93 /* EditorOption.readOnlyMessage */);\n            if (!message) {\n                if (this.editor.isSimpleWidget) {\n                    message = new MarkdownString(nls.localize('editor.simple.readonly', \"Cannot edit in read-only input\"));\n                }\n                else {\n                    message = new MarkdownString(nls.localize('editor.readonly', \"Cannot edit in read-only editor\"));\n                }\n            }\n            messageController.showMessage(message, this.editor.getPosition());\n        }\n    }\n}\nregisterEditorContribution(ReadOnlyMessageController.ID, ReadOnlyMessageController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { reverseOrder, compareBy, numberComparator } from '../../../../base/common/arrays.js';\nimport { observableValue, observableSignalFromEvent, autorunWithStore } from '../../../../base/common/observable.js';\nimport { HideUnchangedRegionsFeature } from '../../../browser/widget/diffEditor/features/hideUnchangedRegionsFeature.js';\nimport { DisposableCancellationTokenSource } from '../../../browser/widget/diffEditor/utils.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { IOutlineModelService } from '../../documentSymbols/browser/outlineModel.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Event } from '../../../../base/common/event.js';\nlet DiffEditorBreadcrumbsSource = class DiffEditorBreadcrumbsSource extends Disposable {\n    constructor(_textModel, _languageFeaturesService, _outlineModelService) {\n        super();\n        this._textModel = _textModel;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._outlineModelService = _outlineModelService;\n        this._currentModel = observableValue(this, undefined);\n        const documentSymbolProviderChanged = observableSignalFromEvent('documentSymbolProvider.onDidChange', this._languageFeaturesService.documentSymbolProvider.onDidChange);\n        const textModelChanged = observableSignalFromEvent('_textModel.onDidChangeContent', Event.debounce(e => this._textModel.onDidChangeContent(e), () => undefined, 100));\n        this._register(autorunWithStore(async (reader, store) => {\n            documentSymbolProviderChanged.read(reader);\n            textModelChanged.read(reader);\n            const src = store.add(new DisposableCancellationTokenSource());\n            const model = await this._outlineModelService.getOrCreate(this._textModel, src.token);\n            if (store.isDisposed) {\n                return;\n            }\n            this._currentModel.set(model, undefined);\n        }));\n    }\n    getBreadcrumbItems(startRange, reader) {\n        const m = this._currentModel.read(reader);\n        if (!m) {\n            return [];\n        }\n        const symbols = m.asListOfDocumentSymbols()\n            .filter(s => startRange.contains(s.range.startLineNumber) && !startRange.contains(s.range.endLineNumber));\n        symbols.sort(reverseOrder(compareBy(s => s.range.endLineNumber - s.range.startLineNumber, numberComparator)));\n        return symbols.map(s => ({ name: s.name, kind: s.kind, startLineNumber: s.range.startLineNumber }));\n    }\n};\nDiffEditorBreadcrumbsSource = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IOutlineModelService)\n], DiffEditorBreadcrumbsSource);\nHideUnchangedRegionsFeature.setBreadcrumbsSourceFactory((textModel, instantiationService) => {\n    return instantiationService.createInstance(DiffEditorBreadcrumbsSource, textModel);\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createSingleCallFunction } from '../../../../base/common/functional.js';\nimport { DisposableStore, MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { getCodeEditor, isDiffEditor } from '../../../browser/editorBrowser.js';\nimport { OverviewRulerLane } from '../../../common/model.js';\nimport { overviewRulerRangeHighlight } from '../../../common/core/editorColorRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nimport { status } from '../../../../base/browser/ui/aria/aria.js';\n/**\n * A reusable quick access provider for the editor with support\n * for adding decorations for navigating in the currently active file\n * (for example \"Go to line\", \"Go to symbol\").\n */\nexport class AbstractEditorNavigationQuickAccessProvider {\n    constructor(options) {\n        this.options = options;\n        //#endregion\n        //#region Decorations Utils\n        this.rangeHighlightDecorationId = undefined;\n    }\n    //#region Provider methods\n    provide(picker, token, runOptions) {\n        const disposables = new DisposableStore();\n        // Apply options if any\n        picker.canAcceptInBackground = !!this.options?.canAcceptInBackground;\n        // Disable filtering & sorting, we control the results\n        picker.matchOnLabel = picker.matchOnDescription = picker.matchOnDetail = picker.sortByLabel = false;\n        // Provide based on current active editor\n        const pickerDisposable = disposables.add(new MutableDisposable());\n        pickerDisposable.value = this.doProvide(picker, token, runOptions);\n        // Re-create whenever the active editor changes\n        disposables.add(this.onDidActiveTextEditorControlChange(() => {\n            // Clear old\n            pickerDisposable.value = undefined;\n            // Add new\n            pickerDisposable.value = this.doProvide(picker, token);\n        }));\n        return disposables;\n    }\n    doProvide(picker, token, runOptions) {\n        const disposables = new DisposableStore();\n        // With text control\n        const editor = this.activeTextEditorControl;\n        if (editor && this.canProvideWithTextEditor(editor)) {\n            const context = { editor };\n            // Restore any view state if this picker was closed\n            // without actually going to a line\n            const codeEditor = getCodeEditor(editor);\n            if (codeEditor) {\n                // Remember view state and update it when the cursor position\n                // changes even later because it could be that the user has\n                // configured quick access to remain open when focus is lost and\n                // we always want to restore the current location.\n                let lastKnownEditorViewState = editor.saveViewState() ?? undefined;\n                disposables.add(codeEditor.onDidChangeCursorPosition(() => {\n                    lastKnownEditorViewState = editor.saveViewState() ?? undefined;\n                }));\n                context.restoreViewState = () => {\n                    if (lastKnownEditorViewState && editor === this.activeTextEditorControl) {\n                        editor.restoreViewState(lastKnownEditorViewState);\n                    }\n                };\n                disposables.add(createSingleCallFunction(token.onCancellationRequested)(() => context.restoreViewState?.()));\n            }\n            // Clean up decorations on dispose\n            disposables.add(toDisposable(() => this.clearDecorations(editor)));\n            // Ask subclass for entries\n            disposables.add(this.provideWithTextEditor(context, picker, token, runOptions));\n        }\n        // Without text control\n        else {\n            disposables.add(this.provideWithoutTextEditor(picker, token));\n        }\n        return disposables;\n    }\n    /**\n     * Subclasses to implement if they can operate on the text editor.\n     */\n    canProvideWithTextEditor(editor) {\n        return true;\n    }\n    gotoLocation({ editor }, options) {\n        editor.setSelection(options.range, \"code.jump\" /* TextEditorSelectionSource.JUMP */);\n        editor.revealRangeInCenter(options.range, 0 /* ScrollType.Smooth */);\n        if (!options.preserveFocus) {\n            editor.focus();\n        }\n        const model = editor.getModel();\n        if (model && 'getLineContent' in model) {\n            status(`${model.getLineContent(options.range.startLineNumber)}`);\n        }\n    }\n    getModel(editor) {\n        return isDiffEditor(editor) ?\n            editor.getModel()?.modified :\n            editor.getModel();\n    }\n    addDecorations(editor, range) {\n        editor.changeDecorations(changeAccessor => {\n            // Reset old decorations if any\n            const deleteDecorations = [];\n            if (this.rangeHighlightDecorationId) {\n                deleteDecorations.push(this.rangeHighlightDecorationId.overviewRulerDecorationId);\n                deleteDecorations.push(this.rangeHighlightDecorationId.rangeHighlightId);\n                this.rangeHighlightDecorationId = undefined;\n            }\n            // Add new decorations for the range\n            const newDecorations = [\n                // highlight the entire line on the range\n                {\n                    range,\n                    options: {\n                        description: 'quick-access-range-highlight',\n                        className: 'rangeHighlight',\n                        isWholeLine: true\n                    }\n                },\n                // also add overview ruler highlight\n                {\n                    range,\n                    options: {\n                        description: 'quick-access-range-highlight-overview',\n                        overviewRuler: {\n                            color: themeColorFromId(overviewRulerRangeHighlight),\n                            position: OverviewRulerLane.Full\n                        }\n                    }\n                }\n            ];\n            const [rangeHighlightId, overviewRulerDecorationId] = changeAccessor.deltaDecorations(deleteDecorations, newDecorations);\n            this.rangeHighlightDecorationId = { rangeHighlightId, overviewRulerDecorationId };\n        });\n    }\n    clearDecorations(editor) {\n        const rangeHighlightDecorationId = this.rangeHighlightDecorationId;\n        if (rangeHighlightDecorationId) {\n            editor.changeDecorations(changeAccessor => {\n                changeAccessor.deltaDecorations([\n                    rangeHighlightDecorationId.overviewRulerDecorationId,\n                    rangeHighlightDecorationId.rangeHighlightId\n                ], []);\n            });\n            this.rangeHighlightDecorationId = undefined;\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { getCodeEditor } from '../../../browser/editorBrowser.js';\nimport { AbstractEditorNavigationQuickAccessProvider } from './editorNavigationQuickAccess.js';\nimport { localize } from '../../../../nls.js';\nexport class AbstractGotoLineQuickAccessProvider extends AbstractEditorNavigationQuickAccessProvider {\n    static { this.PREFIX = ':'; }\n    constructor() {\n        super({ canAcceptInBackground: true });\n    }\n    provideWithoutTextEditor(picker) {\n        const label = localize('cannotRunGotoLine', \"Open a text editor first to go to a line.\");\n        picker.items = [{ label }];\n        picker.ariaLabel = label;\n        return Disposable.None;\n    }\n    provideWithTextEditor(context, picker, token) {\n        const editor = context.editor;\n        const disposables = new DisposableStore();\n        // Goto line once picked\n        disposables.add(picker.onDidAccept(event => {\n            const [item] = picker.selectedItems;\n            if (item) {\n                if (!this.isValidLineNumber(editor, item.lineNumber)) {\n                    return;\n                }\n                this.gotoLocation(context, { range: this.toRange(item.lineNumber, item.column), keyMods: picker.keyMods, preserveFocus: event.inBackground });\n                if (!event.inBackground) {\n                    picker.hide();\n                }\n            }\n        }));\n        // React to picker changes\n        const updatePickerAndEditor = () => {\n            const position = this.parsePosition(editor, picker.value.trim().substr(AbstractGotoLineQuickAccessProvider.PREFIX.length));\n            const label = this.getPickLabel(editor, position.lineNumber, position.column);\n            // Picker\n            picker.items = [{\n                    lineNumber: position.lineNumber,\n                    column: position.column,\n                    label\n                }];\n            // ARIA Label\n            picker.ariaLabel = label;\n            // Clear decorations for invalid range\n            if (!this.isValidLineNumber(editor, position.lineNumber)) {\n                this.clearDecorations(editor);\n                return;\n            }\n            // Reveal\n            const range = this.toRange(position.lineNumber, position.column);\n            editor.revealRangeInCenter(range, 0 /* ScrollType.Smooth */);\n            // Decorate\n            this.addDecorations(editor, range);\n        };\n        updatePickerAndEditor();\n        disposables.add(picker.onDidChangeValue(() => updatePickerAndEditor()));\n        // Adjust line number visibility as needed\n        const codeEditor = getCodeEditor(editor);\n        if (codeEditor) {\n            const options = codeEditor.getOptions();\n            const lineNumbers = options.get(68 /* EditorOption.lineNumbers */);\n            if (lineNumbers.renderType === 2 /* RenderLineNumbersType.Relative */) {\n                codeEditor.updateOptions({ lineNumbers: 'on' });\n                disposables.add(toDisposable(() => codeEditor.updateOptions({ lineNumbers: 'relative' })));\n            }\n        }\n        return disposables;\n    }\n    toRange(lineNumber = 1, column = 1) {\n        return {\n            startLineNumber: lineNumber,\n            startColumn: column,\n            endLineNumber: lineNumber,\n            endColumn: column\n        };\n    }\n    parsePosition(editor, value) {\n        // Support line-col formats of `line,col`, `line:col`, `line#col`\n        const numbers = value.split(/,|:|#/).map(part => parseInt(part, 10)).filter(part => !isNaN(part));\n        const endLine = this.lineCount(editor) + 1;\n        return {\n            lineNumber: numbers[0] > 0 ? numbers[0] : endLine + numbers[0],\n            column: numbers[1]\n        };\n    }\n    getPickLabel(editor, lineNumber, column) {\n        // Location valid: indicate this as picker label\n        if (this.isValidLineNumber(editor, lineNumber)) {\n            if (this.isValidColumn(editor, lineNumber, column)) {\n                return localize('gotoLineColumnLabel', \"Go to line {0} and character {1}.\", lineNumber, column);\n            }\n            return localize('gotoLineLabel', \"Go to line {0}.\", lineNumber);\n        }\n        // Location invalid: show generic label\n        const position = editor.getPosition() || { lineNumber: 1, column: 1 };\n        const lineCount = this.lineCount(editor);\n        if (lineCount > 1) {\n            return localize('gotoLineLabelEmptyWithLimit', \"Current Line: {0}, Character: {1}. Type a line number between 1 and {2} to navigate to.\", position.lineNumber, position.column, lineCount);\n        }\n        return localize('gotoLineLabelEmpty', \"Current Line: {0}, Character: {1}. Type a line number to navigate to.\", position.lineNumber, position.column);\n    }\n    isValidLineNumber(editor, lineNumber) {\n        if (!lineNumber || typeof lineNumber !== 'number') {\n            return false;\n        }\n        return lineNumber > 0 && lineNumber <= this.lineCount(editor);\n    }\n    isValidColumn(editor, lineNumber, column) {\n        if (!column || typeof column !== 'number') {\n            return false;\n        }\n        const model = this.getModel(editor);\n        if (!model) {\n            return false;\n        }\n        const positionCandidate = { lineNumber, column };\n        return model.validatePosition(positionCandidate).equals(positionCandidate);\n    }\n    lineCount(editor) {\n        return this.getModel(editor)?.getLineCount() ?? 0;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar AbstractGotoSymbolQuickAccessProvider_1;\nimport { DeferredPromise } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { pieceToQuery, prepareQuery, scoreFuzzy2 } from '../../../../base/common/fuzzyScorer.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { format, trim } from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nimport { SymbolKinds, getAriaLabelForSymbol } from '../../../common/languages.js';\nimport { IOutlineModelService } from '../../documentSymbols/browser/outlineModel.js';\nimport { AbstractEditorNavigationQuickAccessProvider } from './editorNavigationQuickAccess.js';\nimport { localize } from '../../../../nls.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { findLast } from '../../../../base/common/arraysFind.js';\nlet AbstractGotoSymbolQuickAccessProvider = class AbstractGotoSymbolQuickAccessProvider extends AbstractEditorNavigationQuickAccessProvider {\n    static { AbstractGotoSymbolQuickAccessProvider_1 = this; }\n    static { this.PREFIX = '@'; }\n    static { this.SCOPE_PREFIX = ':'; }\n    static { this.PREFIX_BY_CATEGORY = `${this.PREFIX}${this.SCOPE_PREFIX}`; }\n    constructor(_languageFeaturesService, _outlineModelService, options = Object.create(null)) {\n        super(options);\n        this._languageFeaturesService = _languageFeaturesService;\n        this._outlineModelService = _outlineModelService;\n        this.options = options;\n        this.options.canAcceptInBackground = true;\n    }\n    provideWithoutTextEditor(picker) {\n        this.provideLabelPick(picker, localize('cannotRunGotoSymbolWithoutEditor', \"To go to a symbol, first open a text editor with symbol information.\"));\n        return Disposable.None;\n    }\n    provideWithTextEditor(context, picker, token, runOptions) {\n        const editor = context.editor;\n        const model = this.getModel(editor);\n        if (!model) {\n            return Disposable.None;\n        }\n        // Provide symbols from model if available in registry\n        if (this._languageFeaturesService.documentSymbolProvider.has(model)) {\n            return this.doProvideWithEditorSymbols(context, model, picker, token, runOptions);\n        }\n        // Otherwise show an entry for a model without registry\n        // But give a chance to resolve the symbols at a later\n        // point if possible\n        return this.doProvideWithoutEditorSymbols(context, model, picker, token);\n    }\n    doProvideWithoutEditorSymbols(context, model, picker, token) {\n        const disposables = new DisposableStore();\n        // Generic pick for not having any symbol information\n        this.provideLabelPick(picker, localize('cannotRunGotoSymbolWithoutSymbolProvider', \"The active text editor does not provide symbol information.\"));\n        // Wait for changes to the registry and see if eventually\n        // we do get symbols. This can happen if the picker is opened\n        // very early after the model has loaded but before the\n        // language registry is ready.\n        // https://github.com/microsoft/vscode/issues/70607\n        (async () => {\n            const result = await this.waitForLanguageSymbolRegistry(model, disposables);\n            if (!result || token.isCancellationRequested) {\n                return;\n            }\n            disposables.add(this.doProvideWithEditorSymbols(context, model, picker, token));\n        })();\n        return disposables;\n    }\n    provideLabelPick(picker, label) {\n        picker.items = [{ label, index: 0, kind: 14 /* SymbolKind.String */ }];\n        picker.ariaLabel = label;\n    }\n    async waitForLanguageSymbolRegistry(model, disposables) {\n        if (this._languageFeaturesService.documentSymbolProvider.has(model)) {\n            return true;\n        }\n        const symbolProviderRegistryPromise = new DeferredPromise();\n        // Resolve promise when registry knows model\n        const symbolProviderListener = disposables.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(() => {\n            if (this._languageFeaturesService.documentSymbolProvider.has(model)) {\n                symbolProviderListener.dispose();\n                symbolProviderRegistryPromise.complete(true);\n            }\n        }));\n        // Resolve promise when we get disposed too\n        disposables.add(toDisposable(() => symbolProviderRegistryPromise.complete(false)));\n        return symbolProviderRegistryPromise.p;\n    }\n    doProvideWithEditorSymbols(context, model, picker, token, runOptions) {\n        const editor = context.editor;\n        const disposables = new DisposableStore();\n        // Goto symbol once picked\n        disposables.add(picker.onDidAccept(event => {\n            const [item] = picker.selectedItems;\n            if (item && item.range) {\n                this.gotoLocation(context, { range: item.range.selection, keyMods: picker.keyMods, preserveFocus: event.inBackground });\n                runOptions?.handleAccept?.(item);\n                if (!event.inBackground) {\n                    picker.hide();\n                }\n            }\n        }));\n        // Goto symbol side by side if enabled\n        disposables.add(picker.onDidTriggerItemButton(({ item }) => {\n            if (item && item.range) {\n                this.gotoLocation(context, { range: item.range.selection, keyMods: picker.keyMods, forceSideBySide: true });\n                picker.hide();\n            }\n        }));\n        // Resolve symbols from document once and reuse this\n        // request for all filtering and typing then on\n        const symbolsPromise = this.getDocumentSymbols(model, token);\n        // Set initial picks and update on type\n        let picksCts = undefined;\n        const updatePickerItems = async (positionToEnclose) => {\n            // Cancel any previous ask for picks and busy\n            picksCts?.dispose(true);\n            picker.busy = false;\n            // Create new cancellation source for this run\n            picksCts = new CancellationTokenSource(token);\n            // Collect symbol picks\n            picker.busy = true;\n            try {\n                const query = prepareQuery(picker.value.substr(AbstractGotoSymbolQuickAccessProvider_1.PREFIX.length).trim());\n                const items = await this.doGetSymbolPicks(symbolsPromise, query, undefined, picksCts.token, model);\n                if (token.isCancellationRequested) {\n                    return;\n                }\n                if (items.length > 0) {\n                    picker.items = items;\n                    if (positionToEnclose && query.original.length === 0) {\n                        const candidate = findLast(items, item => Boolean(item.type !== 'separator' && item.range && Range.containsPosition(item.range.decoration, positionToEnclose)));\n                        if (candidate) {\n                            picker.activeItems = [candidate];\n                        }\n                    }\n                }\n                else {\n                    if (query.original.length > 0) {\n                        this.provideLabelPick(picker, localize('noMatchingSymbolResults', \"No matching editor symbols\"));\n                    }\n                    else {\n                        this.provideLabelPick(picker, localize('noSymbolResults', \"No editor symbols\"));\n                    }\n                }\n            }\n            finally {\n                if (!token.isCancellationRequested) {\n                    picker.busy = false;\n                }\n            }\n        };\n        disposables.add(picker.onDidChangeValue(() => updatePickerItems(undefined)));\n        updatePickerItems(editor.getSelection()?.getPosition());\n        // Reveal and decorate when active item changes\n        disposables.add(picker.onDidChangeActive(() => {\n            const [item] = picker.activeItems;\n            if (item && item.range) {\n                // Reveal\n                editor.revealRangeInCenter(item.range.selection, 0 /* ScrollType.Smooth */);\n                // Decorate\n                this.addDecorations(editor, item.range.decoration);\n            }\n        }));\n        return disposables;\n    }\n    async doGetSymbolPicks(symbolsPromise, query, options, token, model) {\n        const symbols = await symbolsPromise;\n        if (token.isCancellationRequested) {\n            return [];\n        }\n        const filterBySymbolKind = query.original.indexOf(AbstractGotoSymbolQuickAccessProvider_1.SCOPE_PREFIX) === 0;\n        const filterPos = filterBySymbolKind ? 1 : 0;\n        // Split between symbol and container query\n        let symbolQuery;\n        let containerQuery;\n        if (query.values && query.values.length > 1) {\n            symbolQuery = pieceToQuery(query.values[0]); // symbol: only match on first part\n            containerQuery = pieceToQuery(query.values.slice(1)); // container: match on all but first parts\n        }\n        else {\n            symbolQuery = query;\n        }\n        // Convert to symbol picks and apply filtering\n        let buttons;\n        const openSideBySideDirection = this.options?.openSideBySideDirection?.();\n        if (openSideBySideDirection) {\n            buttons = [{\n                    iconClass: openSideBySideDirection === 'right' ? ThemeIcon.asClassName(Codicon.splitHorizontal) : ThemeIcon.asClassName(Codicon.splitVertical),\n                    tooltip: openSideBySideDirection === 'right' ? localize('openToSide', \"Open to the Side\") : localize('openToBottom', \"Open to the Bottom\")\n                }];\n        }\n        const filteredSymbolPicks = [];\n        for (let index = 0; index < symbols.length; index++) {\n            const symbol = symbols[index];\n            const symbolLabel = trim(symbol.name);\n            const symbolLabelWithIcon = `$(${SymbolKinds.toIcon(symbol.kind).id}) ${symbolLabel}`;\n            const symbolLabelIconOffset = symbolLabelWithIcon.length - symbolLabel.length;\n            let containerLabel = symbol.containerName;\n            if (options?.extraContainerLabel) {\n                if (containerLabel) {\n                    containerLabel = `${options.extraContainerLabel} • ${containerLabel}`;\n                }\n                else {\n                    containerLabel = options.extraContainerLabel;\n                }\n            }\n            let symbolScore = undefined;\n            let symbolMatches = undefined;\n            let containerScore = undefined;\n            let containerMatches = undefined;\n            if (query.original.length > filterPos) {\n                // First: try to score on the entire query, it is possible that\n                // the symbol matches perfectly (e.g. searching for \"change log\"\n                // can be a match on a markdown symbol \"change log\"). In that\n                // case we want to skip the container query altogether.\n                let skipContainerQuery = false;\n                if (symbolQuery !== query) {\n                    [symbolScore, symbolMatches] = scoreFuzzy2(symbolLabelWithIcon, { ...query, values: undefined /* disable multi-query support */ }, filterPos, symbolLabelIconOffset);\n                    if (typeof symbolScore === 'number') {\n                        skipContainerQuery = true; // since we consumed the query, skip any container matching\n                    }\n                }\n                // Otherwise: score on the symbol query and match on the container later\n                if (typeof symbolScore !== 'number') {\n                    [symbolScore, symbolMatches] = scoreFuzzy2(symbolLabelWithIcon, symbolQuery, filterPos, symbolLabelIconOffset);\n                    if (typeof symbolScore !== 'number') {\n                        continue;\n                    }\n                }\n                // Score by container if specified\n                if (!skipContainerQuery && containerQuery) {\n                    if (containerLabel && containerQuery.original.length > 0) {\n                        [containerScore, containerMatches] = scoreFuzzy2(containerLabel, containerQuery);\n                    }\n                    if (typeof containerScore !== 'number') {\n                        continue;\n                    }\n                    if (typeof symbolScore === 'number') {\n                        symbolScore += containerScore; // boost symbolScore by containerScore\n                    }\n                }\n            }\n            const deprecated = symbol.tags && symbol.tags.indexOf(1 /* SymbolTag.Deprecated */) >= 0;\n            filteredSymbolPicks.push({\n                index,\n                kind: symbol.kind,\n                score: symbolScore,\n                label: symbolLabelWithIcon,\n                ariaLabel: getAriaLabelForSymbol(symbol.name, symbol.kind),\n                description: containerLabel,\n                highlights: deprecated ? undefined : {\n                    label: symbolMatches,\n                    description: containerMatches\n                },\n                range: {\n                    selection: Range.collapseToStart(symbol.selectionRange),\n                    decoration: symbol.range\n                },\n                uri: model.uri,\n                symbolName: symbolLabel,\n                strikethrough: deprecated,\n                buttons\n            });\n        }\n        // Sort by score\n        const sortedFilteredSymbolPicks = filteredSymbolPicks.sort((symbolA, symbolB) => filterBySymbolKind ?\n            this.compareByKindAndScore(symbolA, symbolB) :\n            this.compareByScore(symbolA, symbolB));\n        // Add separator for types\n        // - @  only total number of symbols\n        // - @: grouped by symbol kind\n        let symbolPicks = [];\n        if (filterBySymbolKind) {\n            let lastSymbolKind = undefined;\n            let lastSeparator = undefined;\n            let lastSymbolKindCounter = 0;\n            function updateLastSeparatorLabel() {\n                if (lastSeparator && typeof lastSymbolKind === 'number' && lastSymbolKindCounter > 0) {\n                    lastSeparator.label = format(NLS_SYMBOL_KIND_CACHE[lastSymbolKind] || FALLBACK_NLS_SYMBOL_KIND, lastSymbolKindCounter);\n                }\n            }\n            for (const symbolPick of sortedFilteredSymbolPicks) {\n                // Found new kind\n                if (lastSymbolKind !== symbolPick.kind) {\n                    // Update last separator with number of symbols we found for kind\n                    updateLastSeparatorLabel();\n                    lastSymbolKind = symbolPick.kind;\n                    lastSymbolKindCounter = 1;\n                    // Add new separator for new kind\n                    lastSeparator = { type: 'separator' };\n                    symbolPicks.push(lastSeparator);\n                }\n                // Existing kind, keep counting\n                else {\n                    lastSymbolKindCounter++;\n                }\n                // Add to final result\n                symbolPicks.push(symbolPick);\n            }\n            // Update last separator with number of symbols we found for kind\n            updateLastSeparatorLabel();\n        }\n        else if (sortedFilteredSymbolPicks.length > 0) {\n            symbolPicks = [\n                { label: localize('symbols', \"symbols ({0})\", filteredSymbolPicks.length), type: 'separator' },\n                ...sortedFilteredSymbolPicks\n            ];\n        }\n        return symbolPicks;\n    }\n    compareByScore(symbolA, symbolB) {\n        if (typeof symbolA.score !== 'number' && typeof symbolB.score === 'number') {\n            return 1;\n        }\n        else if (typeof symbolA.score === 'number' && typeof symbolB.score !== 'number') {\n            return -1;\n        }\n        if (typeof symbolA.score === 'number' && typeof symbolB.score === 'number') {\n            if (symbolA.score > symbolB.score) {\n                return -1;\n            }\n            else if (symbolA.score < symbolB.score) {\n                return 1;\n            }\n        }\n        if (symbolA.index < symbolB.index) {\n            return -1;\n        }\n        else if (symbolA.index > symbolB.index) {\n            return 1;\n        }\n        return 0;\n    }\n    compareByKindAndScore(symbolA, symbolB) {\n        const kindA = NLS_SYMBOL_KIND_CACHE[symbolA.kind] || FALLBACK_NLS_SYMBOL_KIND;\n        const kindB = NLS_SYMBOL_KIND_CACHE[symbolB.kind] || FALLBACK_NLS_SYMBOL_KIND;\n        // Sort by type first if scoped search\n        const result = kindA.localeCompare(kindB);\n        if (result === 0) {\n            return this.compareByScore(symbolA, symbolB);\n        }\n        return result;\n    }\n    async getDocumentSymbols(document, token) {\n        const model = await this._outlineModelService.getOrCreate(document, token);\n        return token.isCancellationRequested ? [] : model.asListOfDocumentSymbols();\n    }\n};\nAbstractGotoSymbolQuickAccessProvider = AbstractGotoSymbolQuickAccessProvider_1 = __decorate([\n    __param(0, ILanguageFeaturesService),\n    __param(1, IOutlineModelService)\n], AbstractGotoSymbolQuickAccessProvider);\nexport { AbstractGotoSymbolQuickAccessProvider };\n// #region NLS Helpers\nconst FALLBACK_NLS_SYMBOL_KIND = localize('property', \"properties ({0})\");\nconst NLS_SYMBOL_KIND_CACHE = {\n    [5 /* SymbolKind.Method */]: localize('method', \"methods ({0})\"),\n    [11 /* SymbolKind.Function */]: localize('function', \"functions ({0})\"),\n    [8 /* SymbolKind.Constructor */]: localize('_constructor', \"constructors ({0})\"),\n    [12 /* SymbolKind.Variable */]: localize('variable', \"variables ({0})\"),\n    [4 /* SymbolKind.Class */]: localize('class', \"classes ({0})\"),\n    [22 /* SymbolKind.Struct */]: localize('struct', \"structs ({0})\"),\n    [23 /* SymbolKind.Event */]: localize('event', \"events ({0})\"),\n    [24 /* SymbolKind.Operator */]: localize('operator', \"operators ({0})\"),\n    [10 /* SymbolKind.Interface */]: localize('interface', \"interfaces ({0})\"),\n    [2 /* SymbolKind.Namespace */]: localize('namespace', \"namespaces ({0})\"),\n    [3 /* SymbolKind.Package */]: localize('package', \"packages ({0})\"),\n    [25 /* SymbolKind.TypeParameter */]: localize('typeParameter', \"type parameters ({0})\"),\n    [1 /* SymbolKind.Module */]: localize('modules', \"modules ({0})\"),\n    [6 /* SymbolKind.Property */]: localize('property', \"properties ({0})\"),\n    [9 /* SymbolKind.Enum */]: localize('enum', \"enumerations ({0})\"),\n    [21 /* SymbolKind.EnumMember */]: localize('enumMember', \"enumeration members ({0})\"),\n    [14 /* SymbolKind.String */]: localize('string', \"strings ({0})\"),\n    [0 /* SymbolKind.File */]: localize('file', \"files ({0})\"),\n    [17 /* SymbolKind.Array */]: localize('array', \"arrays ({0})\"),\n    [15 /* SymbolKind.Number */]: localize('number', \"numbers ({0})\"),\n    [16 /* SymbolKind.Boolean */]: localize('boolean', \"booleans ({0})\"),\n    [18 /* SymbolKind.Object */]: localize('object', \"objects ({0})\"),\n    [19 /* SymbolKind.Key */]: localize('key', \"keys ({0})\"),\n    [7 /* SymbolKind.Field */]: localize('field', \"fields ({0})\"),\n    [13 /* SymbolKind.Constant */]: localize('constant', \"constants ({0})\")\n};\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { stripIcons } from '../../../../base/common/iconLabels.js';\nimport { isLocalizedString } from '../../../../platform/action/common/action.js';\nimport { AbstractCommandsQuickAccessProvider } from '../../../../platform/quickinput/browser/commandsQuickAccess.js';\nexport class AbstractEditorCommandsQuickAccessProvider extends AbstractCommandsQuickAccessProvider {\n    constructor(options, instantiationService, keybindingService, commandService, telemetryService, dialogService) {\n        super(options, instantiationService, keybindingService, commandService, telemetryService, dialogService);\n    }\n    getCodeEditorCommandPicks() {\n        const activeTextEditorControl = this.activeTextEditorControl;\n        if (!activeTextEditorControl) {\n            return [];\n        }\n        const editorCommandPicks = [];\n        for (const editorAction of activeTextEditorControl.getSupportedActions()) {\n            let commandDescription;\n            if (editorAction.metadata?.description) {\n                if (isLocalizedString(editorAction.metadata.description)) {\n                    commandDescription = editorAction.metadata.description;\n                }\n                else {\n                    commandDescription = { original: editorAction.metadata.description, value: editorAction.metadata.description };\n                }\n            }\n            editorCommandPicks.push({\n                commandId: editorAction.id,\n                commandAlias: editorAction.alias,\n                commandDescription,\n                label: stripIcons(editorAction.label) || editorAction.id,\n            });\n        }\n        return editorCommandPicks;\n    }\n}\n"],"names":["alert","Button","status","renderLabelWithIcons","Widget","ActionViewItem","KeybindingLabel","unthemedKeybindingLabelOptions","ResizableHTMLElement","HoverWidget","getHoverAccessibleViewHint","HoverAction","ClickAction","KeyDownAction","Sash","ActionBar","IconLabel","CountBadge","HighlightedLabel","SplitView","Sizing","createInstantHoverDelegate","CaseSensitiveToggle","WholeWordsToggle","RegexToggle","Toggle","getDefaultHoverDelegate","DomScrollableElement","List","ScrollableElement","getBaseLayerHoverDelegate","renderIcon","localize","LinkedList","CancellationTokenSource","DisposableStore","format","Iterable","assertType","URI","CancellationToken","onUnexpectedExternalError","isNonEmptyArray","asArray","MarkdownString","KeyChord","Disposable","RunOnceScheduler","localize2","Mimes","HierarchicalKind","coalesce","relativePath","UriList","Schemas","noBreakWhitespace","ThemeIcon","Codicon","MutableDisposable","disposableTimeout","isMarkdownString","Event","toDisposable","toAction","toErrorMessage","isCancellationError","isWindows","generateUuid","createCancelablePromise","matchesMimeType","DeferredPromise","CancellationError","createStringDataTransferItem","raceCancellation","isNative","isWeb","illegalArgument","equals","Lazy","Emitter","StopWatch","TimeoutTimer","isEqual","onUnexpectedError","escapeRegExpCharacters","LRUCache","Color","RGBA","HSVA","AsyncIterableObject","Action","autorun","Separator","OS","observableFromEvent","derived","autorunWithStore","derivedWithStore","derivedObservableWithCache","createCancelableAsyncIterable","isEmptyMarkdownString","compareBy","numberComparator","isMacintosh","IdGenerator","deepClone","mixin","extUri","dispose","commonPrefixLength","ResourceMap","basename","defaultGenerator","createMatches","dirname","FuzzyScore","basenameOrAuthority","combinedDisposable","matchesSomeScheme","BugIndicatingError","firstNonWhitespaceIndex","SubmenuAction","isIOS","VSDataTransfer","buildReplaceStringWithCasePreserved","findFirstIdxMonotonousOrArrLen","Delayer","isLinux","assertIsDefined","hash","isUndefined","isObject","isNumber","isString","splitLines","autorunOpts","observableValue","observableSignalFromEvent","containsRTL","isBasicASCII","SetMap","assertNever","getLeadingWhitespace","LcsDiff","disposableObservableValue","transaction","equalsIfDefined","derivedOpts","matchesSubString","itemEquals","isDisposable","basename$1","dirname$1","isFalsyOrWhitespace","normalizeDriveLetter","groupBy","observableSignal","derivedHandleChanges","itemsEquals","isDefined","recomputeInitiallyAndOnChange","subtransaction","mapFindFirst","Permutation","splitLinesIncludeSeparators","TernarySearchTree","isFalsyOrEmpty","binarySearch","FuzzyScoreOptions","fuzzyScore","fuzzyScoreGracefulAggressive","compareIgnoreCase","anyScore","quickSelect","isLowSurrogate","isHighSurrogate","PauseableEmitter","clamp","KeyCodeChord","extname","findFirstMax","derivedDisposable","mapObservableArrayCached","constObservable","timeout","cancelOnDispose","waitForState","asyncTransaction","compare","lastNonWhitespaceIndex","commonSuffixLength","first","originalFSPath","joinPath","ObservablePromise","structuralEquals","derivedWithSetter","readHotReloadableExport","distinct","isLowerAsciiLetter","isUpperAsciiLetter","RefCountedDisposable","language","InvisibleCharacters","matchesScheme","reverseOrder","createSingleCallFunction","pieceToQuery","trim","scoreFuzzy2","prepareQuery","findLast","stripIcons","registerEditorCommand","EditorCommand","StableEditorScrollState","isCodeEditor","registerEditorContribution","registerEditorAction","EditorAction","ResourceTextEdit","openLinkFromMarkdown","IBulkEditService","toVSDataTransfer","toExternalVSDataTransfer","ClipboardEventUtils","MultiCommand","ICodeEditorService","InMemoryClipboardMetadataManager","CopyOptions","DynamicCssRules","registerModelAndPositionCommand","MarkdownRenderer","EmbeddedCodeEditorWidget","EditorAction2","registerMultiEditorAction","MultiEditorAction","registerInstantiatedEditorAction","applyFontInfo","observableCodeEditor","reactToChange","CoreEditingCommands","reactToChangeWithStore","diffDeleteDecoration","diffLineDeleteDecorationBackgroundWithIndicator","IDiffProviderFactoryService","diffLineAddDecorationBackgroundWithIndicator","diffWholeLineDeleteDecoration","diffWholeLineAddDecoration","diffDeleteDecorationEmpty","diffAddDecorationEmpty","diffAddDecoration","EditorExtensionsRegistry","applyStyle","appendRemoveOnDispose","getColumnOfNodeOffset","TabFocus","isDiffEditor","HideUnchangedRegionsFeature","DisposableCancellationTokenSource","getCodeEditor","Range","EditOperation","ITextModelService","IEditorWorkerService","ILanguageFeaturesService","Position","Selection","EditorContextKeys","ModelDecorationOptions","OverviewRulerLane","MoveOperations","ReplaceCommand","DocumentPasteTriggerKind","IModelService","GlyphMarginLane","computeIndentLevel","ShowLightbulbIconMode","editorConfigurationBaseNode","ILanguageFeatureDebounceService","EDITOR_FONT_DEFAULTS","registerEditorFeature","InlineCompletionTriggerKind","ILanguageService","HoverVerbosityAction","TextModel","PLAINTEXT_LANGUAGE_ID","isLocationLink","Command","ModelDecorationInjectedTextOptions","InjectedTextCursorStops","InlayHintKind","TokenizationRegistry","ILanguageConfigurationService","DraggedTreeItemsIdentifier","ITreeViewsDnDService","SearchParams","ReplaceCommandThatPreservesSelection","overviewRulerRangeHighlight","countEOL","FoldingRangeKind","EditorZoom","CharacterSet","CursorColumns","TextEdit","SingleTextEdit","StringBuilder","LineTokens","renderViewLine","RenderLineInput","EditorFontLigatures","LineDecoration","fixBracketsInLine","TextLength","CompletionItemKinds","getIconClasses","SelectedSuggestionInfo","IMarkerDecorationsService","ProcessedIndentRulesSupport","normalizeIndentation","ShiftCommand","getGoodIndentForLine","getIndentMetadata","getStandardTokenTypeAtPosition","CursorMoveCommands","IndentAction","getEnterAction","TrimTrailingWhitespaceCommand","ReplaceCommandThatSelectsText","TypeOperations","EnterOperation","DocumentHighlightKind","InlineEditTriggerKind","LineRange","SignatureHelpTriggerKind","ghostTextForeground","NewSymbolNameTriggerKind","NewSymbolNameTag","ITextResourceConfigurationService","encodeSemanticTokensDto","ISemanticTokensStylingService","toMultilineTokens2","inUntrustedWorkspace","isModelDecorationVisible","isModelDecorationInString","isModelDecorationInComment","UnicodeTextModelHighlighter","unicodeHighlightConfigKeys","USUAL_WORD_SEPARATORS","shouldSynchronizeModel","score","getMapForWordSeparators","EditorOptions","WordOperations","CursorState$1","WordPartOperations","SymbolKinds","getAriaLabelForSymbol","createDecorator","RawContextKey","registerSingleton","IContextKeyService","CommandsRegistry","ExtensionIdentifierSet","IInstantiationService","ILogService","IAccessibilitySignalService","AccessibilitySignal","themeColorFromId","MenuRegistry","MenuId","IWorkspaceContextService","IOpenerService","IContextMenuService","IKeybindingService","INotificationService","IClipboardService","IQuickInputService","IProgressService","ContextKeyExpr","Progress","ICommandService","ITelemetryService","foreground","registerIcon","IMarkerService","IEditorProgressService","IConfigurationService","IActionWidgetService","registerThemingParticipant","editorFindMatchHighlight","editorFindMatchHighlightBorder","isHighContrast","Registry","Extensions","IStorageService","WillSaveStateReason","editorHoverBackground","IThemeService","MenuItemAction","IMenuService","MenuEntryActionViewItem","WorkbenchToolBar","createAndFillInActionBarActions","IAccessibilityService","IHoverService","WorkbenchHoverDelegate","editorForeground","contrastBorder","editorInfoForeground","activeContrastBorder","createActionViewItem","ILabelService","defaultCountBadgeStyles","WorkbenchAsyncDataTree","KeybindingsRegistry","InputFocusedContext","IListService","WorkbenchListFocusContextKey","WorkbenchTreeElementCanCollapse","WorkbenchTreeElementCanExpand","registerAction2","IsWebContext","isIMenuItem","Severity","editorActiveLinkForeground","editorInlayHintParameterBackground","editorInlayHintParameterForeground","editorInlayHintTypeBackground","editorInlayHintTypeForeground","editorInlayHintBackground","editorInlayHintForeground","SubmenuItemAction","isStandaloneEditorWorkspace","IContextViewService","LocalSelectionTransfer","minimapFindMatch","overviewRulerFindMatchForeground","asCssVariable","inputActiveOptionBackground","inputActiveOptionForeground","inputActiveOptionBorder","ContextScopedFindInput","defaultToggleStyles","defaultInputBoxStyles","showHistoryKeybindingHint","widgetClose","ContextScopedReplaceInput","editorFindRangeHighlightBorder","editorFindMatchForeground","editorFindMatchHighlightForeground","transparent","editorSelectionBackground","iconForeground","historyNavigationVisible","toWorkspaceIdentifier","isEmptyWorkspaceIdentifier","isSingleFolderWorkspaceIdentifier","WORKSPACE_EXTENSION","IEnvironmentService","TextOnlyMenuEntryActionViewItem","FileKind","editorWidgetBackground","editorWidgetBorder","quickInputListFocusForeground","quickInputListFocusIconForeground","quickInputListFocusBackground","listHighlightForeground","listFocusHighlightForeground","getListStyles","Action2","AccessibleViewRegistry","MarkerSeverity","SeverityIcon","oneOf","editorErrorBorder","editorErrorForeground","editorWarningBorder","editorWarningForeground","editorInfoBorder","editorBackground","IMarkerData","editorHoverBorder","overviewRulerSelectionHighlightForeground","minimapSelectionOccurrenceHighlight","editorSelectionHighlight","observableConfigValue","bindContextKey","wrapInReloadableClass1","widgetShadow","widgetBorder","inputForeground","inputBorder","inputBackground","Categories","Link$1","IWorkspaceTrustManagementService","IDialogService","CONTEXT_ACCESSIBILITY_MODE_ENABLED","IsWindowsContext","AbstractCommandsQuickAccessProvider","isLocalizedString","isFirefox","mainWindow","GlobalPointerMoveMonitor","createTrustedTypesPolicy","DEFAULT_FONT_FAMILY","StandardMouseEvent","$$6","addDisposableListener","EventType","isAncestor","getActiveElement","getDomNodePagePosition","getActiveDocument","addStandardDisposableGenericMouseDownListener","runWhenWindowIdle","reset","getWindow","append","Dimension","h","getClientArea","trackFocus","getTotalHeight","getTotalWidth","removeCSSRulesContainingSelector","createCSSRule","addStandardDisposableListener","clearNode","show","hide","ModifierKeyEmitter","isHTMLElement","getShadowRoot","getTopLeftOffset","getComputedStyle","size","runAtThisOrScheduleAtNextAnimationFrame","WindowIdleValue","createStyleSheetFromObservable","createStyleSheet2","svgElem","EventHelper","PixelRatio","Gesture","StandardKeyboardEvent","renderMarkdown","IEditorCancellationTokens","ctxCancellableOperation","editor","cts","data","accessor","key","tokens","removeFn","EditorKeybindingCancellationTokenSource","parent","EditorState$1","EditorState","flags","model","strings.format","other","state","EditorStateCancellationTokenSource","range","e","_","TextModelCancellationTokenSource","FormattingEdit","edits","newEol","singleEdits","edit","editRange","_edits","addUndoStops","scrollState","getRealAndSyntheticDocumentFormattersOrdered","documentFormattingEditProvider","documentRangeFormattingEditProvider","result","seen","docFormatter","formatter","rangeFormatter","options","token","_FormattingConflicts","selector","document","mode","kind","FormattingConflicts","formatDocumentRangesWithSelectedProvider","editorOrModel","rangeOrRanges","progress","userGesture","instaService","documentRangeFormattingEditProviderRegistry","provider","selected","formatDocumentRangesWithProvider","_a","_b","workerService","logService","accessibilitySignalService","ranges","len","computeEdits","hasIntersectingEdit","a","b","mergedA","acc","val","x","otherEdit","allEdits","rawEditsList","i","j","mergedRange","rawEdits","minimalEdits","initialSelection","undoEdits","formatDocumentWithSelectedProvider","languageFeaturesService","formatDocumentWithProvider","getDocumentRangeFormattingEditsUntilResult","providers","getDocumentFormattingEditsUntilResult","getOnTypeFormattingEdits","position","ch","args","resource","resolverService","reference","__decorate","decorators","target","desc","c","r","d","__param","paramIndex","decorator","SelectionAnchorController_1","SelectionAnchorSet","SelectionAnchorController","contextKeyService","anchorPosition","start","end","decorationId","SetSelectionAnchor","_accessor","GoToSelectionAnchor","SelectFromAnchorToCursor","CancelSelectionAnchor","overviewRulerBracketMatchForeground","registerColor","nls.localize","JumpToBracketAction","BracketMatchingController","SelectToBracketAction","nls.localize2","selectBrackets","RemoveBracketsAction","BracketsData","brackets","_BracketMatchingController","newSelections","selection","newCursorPosition","enclosingBrackets","nextBracket","selectFrom","selectTo","open","close","tmp","editSource","newDecorations","newDecorationsLen","bracketData","selections","versionId","previousData","positions","positionsLen","newData","newDataLen","previousIndex","previousLen","MoveCaretCommand","isMovingLeft","builder","lineNumber","startColumn","endColumn","rangeBefore","charBefore","rangeAfter","charAfter","helper","MoveCaretAction","left","opts","commands","MoveCaretLeftAction","MoveCaretRightAction","TransposeLettersAction","column","lastColumn","endPosition","middlePosition","beginPosition","leftChar","rightChar","replaceRange","SimplePasteAndDropProvider","_model","_ranges","dataTransfer","context","_position","_DefaultTextPasteOrDropEditProvider","_token","textEntry","insertText","DefaultTextPasteOrDropEditProvider","PathProvider","entries","extractUriList","uriCount","uri","originalText","label","RelativePathProvider","_workspaceContextService","relativeUris","root","PasteHtmlProvider","entry","htmlText","urlListEntry","strUriList","DefaultDropProvidersFeature","workspaceContextService","DefaultPasteProvidersFeature","_Scanner","value","pos","type","Scanner","Marker","child","Text","others","idx","newChildren","_fixParent","children","candidate","TextmateSnippet","prev","cur","TransformableMarker","Placeholder","index","Choice","ret","marker","Transform","_this","didMatch","FormatString","groups","shorthandName","ifValue","elseValue","match","word","Variable","name","resolver","walk","visitor","stack","all","last","found","placeholder","SnippetParser","template","insertFinalTabstop","enforceFinalTabstop","snippet","offset","placeholderDefaultValues","incompletePlaceholders","fillInIncompletePlaceholder","defaultValues","clone","newChild","p","nextToken","choice","values","variable","transform","regexValue","regexOptions","escaped","complex","shorthand","createCombinedWorkspaceEdit","sortEditsByYieldTo","yieldsTo","yTo","yieldsToMap","arr","visited","tempStack","visit","nodes","node","pre","inlineProgressDecoration","_InlineProgressWidget","typeId","title","delegate","dom.$","iconElement","updateSize","lineHeight","dom.addDisposableListener","dom.EventType","InlineProgressWidget","InlineProgressManager","id","_editor","_instantiationService","promise","delayOverride","operationId","MessageController_1","MessageController","_openerService","message","url","MessageWidget","event","dom.isAncestor","dom.getActiveElement","bounds","MessageCommand","MessageWidget$1","messageWidget","handle","text","anchorTop","anchorBottom","PostEditWidget_1","PostEditWidget","visibleContext","showCommand","onSelectNewEdit","_contextMenuService","_keybindingService","binding","dom.getDomNodePagePosition","PostEditWidgetManager","_id","_visibleContext","_showCommand","_bulkEditService","_notificationService","canShowWidget","resolve","onDidSelectEdit","newEditIndex","handleError","resolvedEdit","combinedWorkspaceEdit","primaryRange","editTrackingDecoration","editResult","CopyPasteController_1","changePasteTypeCommandId","pasteWidgetVisibleCtx","vscodeClipboardMime","CopyPasteController","instantiationService","_clipboardService","_languageFeaturesService","_quickInputService","_progressService","container","preferred","_c","_d","enableEmptySelectionClipboard","wasFromEmptySelection","toCopy","platform.isWindows","defaultPastePayload","providerCopyMimeTypes","results","err","mime","metadata","allPotentialMimeTypes","allProviders","preference","clipboardEvent","editorStateCts","pToken","disposables","supportedProviders","editSession","reject","resolveP","showP","resolved","tokenSource","pickedEdit","rawMetadata","toMergeDataTransfer","resources","textDataTransfer","payload","providedKind","CLIPBOARD_CONTEXT_MENU_GROUP","supportsCut","platform.isNative","supportsCopy","supportsPaste","browser.isFirefox","registerCommand","command","CutAction","CopyAction","PasteAction","ExecCommandCopyWithSyntaxHighlightingAction","registerExecCommandImpl","browserCommand","focusedEditor","emptySelectionClipboard","codeEditorService","clipboardService","platform.isWeb","clipboardText","pasteOnNewLine","multicursorText","CodeActionKind","CodeActionTriggerSource","mayIncludeActionsOfKind","filter","exclude","excludesAction","filtersAction","action","actionKind","include","CodeActionCommandArgs","arg","defaults","defaultAutoApply","defaultKind","apply","CodeActionItem","highlightRange","codeActionCommandId","quickFixCommandId","autoFixCommandId","refactorCommandId","sourceActionCommandId","organizeImportsCommandId","fixAllCommandId","ManagedCodeActionSet","actions","documentation","fix","emptyCodeActionsResponse","getCodeActions","registry","rangeOrSelection","trigger","notebookFilter","codeActionContext","excludeNotebookCodeActions","getCodeActionProviders","promises","providedCodeActions","filteredActions","getDocumentationFromProvider","listener","newProviders","allActions","allDocumentation","getAdditionalDocumentationForShowingActions","actionsToShow","item","only","currentBest","ApplyCodeActionReason","applyCodeAction","codeActionReason","bulkEditService","commandService","telemetryService","notificationService","asMessage","itemResolveCount","codeActionProvider","validatedRangeOrSelection","codeActionSet","resolving","resolveCount","CodeActionKeybindingResolver_1","CodeActionKeybindingResolver","keybindingService","allCodeActionBindings","commandArgs","candidates","uncategorizedCodeActionGroup","codeActionGroups","toMenuItems","inputCodeActions","showHeaders","keybindingResolver","menuEntries","group","menuEntry","allMenuItems","LightBulbWidget_1","GUTTER_LIGHTBULB_ICON","GUTTER_LIGHTBULB_AUTO_FIX_ICON","GUTTER_LIGHTBULB_AIFIX_ICON","GUTTER_LIGHTBULB_AIFIX_AUTO_FIX_ICON","GUTTER_SPARKLE_FILLED_ICON","LightBulbState","Showing","editorPosition","widgetPosition","LightBulbWidget","editorModel","dom.addStandardDisposableGenericMouseDownListener","top","height","pad","cls","atPosition","tabSize","fontInfo","lineContent","indent","lineHasSpace","isFolded","currLineDecorations","hasDecoration","decoration","glyphClass","className","effectiveLineNumber","effectiveColumnNumber","isLineEmptyOrIndented","lineCount","endLine","prevLineEmptyOrIndented","nextLineEmptyOrIndented","currLineEmptyOrIndented","notEmpty","validActions","icon","autoRun","GUTTER_DECORATION","autoFix","SUPPORTED_CODE_ACTIONS","APPLY_FIX_ALL_COMMAND_ID","CodeActionOracle","_markerService","_signalChange","_delay","enabled","line","CodeActionsState","Triggered","_cancellablePromise","emptyCodeActionSet","CodeActionModel","_registry","_configurationService","_telemetryService","supportedActions","startPosition","_e","_f","_g","_h","_i","_j","allCodeActions","foundQuickfix","allMarkers","currPosition","trackedPosition","distance","currentActions","col","row","startRow","newCodeActionTrigger","selectionAsPosition","actionsAtMarker","self","sw","codeActions","newState","isManualToAutoTransition","skipNotify","CodeActionController_1","DECORATION_CLASS_NAME","CodeActionController","markerService","progressService","_commandService","_actionWidgetService","widget","at","actionItem","_trigger","notAvailableMessage","triggerAction","autoApply","triggerPosition","retrigger","preview","actionReason","validActionToApply","invalidAction","includeDisabledActions","currentDecorations","editorDom","anchor","didCancel","canPreview","hierarchicalKind","refactorKind","diagnostics","decorations","diagnostic","selectionText","aria.status","cursorCoords","editorCoords","y","resultActions","theme","collector","color","findMatchHighlightBorder","contextKeyForSupportedActions","argsSchema","triggerCodeActionsForEditorSelection","controller","QuickFixAction","CodeActionCommand","userArgs","RefactorAction","SourceAction","OrganizeImportsAction","FixAllAction","AutoFixAction","CodeLensModel","list","symbol","getCodeLensModel","providerRanks","codeLensProvider","ICodeLensCache","CacheItem","CodeLensCache","storageService","oldkey","raw","onWillSaveStateBecauseOfShutdown","copyItems","copyModel","lines","element","lenses","CodeLensViewZone","afterLineNumber","heightInPx","onHeight","_CodeLensContentWidget","animate","hasSymbol","lens","dom.reset","link","CodeLensContentWidget","CodeLensHelper","callback","changeAccessor","resultingDecorations","codeLensDecorationOptions","CodeLensWidget","viewZoneChangeAccessor","updateCallback","codeLensData","symbols","CodeLensContribution","debounceService","_codeLensCache","lineHeightFactor","fontSize","codeLensHeight","fontFamily","editorFontInfo","style","cachedLenses","cachedLensesNow","registration","scheduler","t1","newDelay","decorationsAccessor","viewZonesAccessor","toDispose","lastLensLineNumber","l","decChangeAccessor","maxLineNumber","lastGroup","layoutInfo","viewZoneAccessor","codeLensIndex","groupsIndex","symbolsLineNumber","codeLensLineNumber","toResolve","request","resolvePromise","resolvedSymbols","quickInputService","codelensController","items","newModel","newLens","DefaultDocumentColorProvider","_editorWorkerService","colorInfo","colorFromInfo","alpha","rgb","hsl","hex","colorPresentations","DefaultDocumentColorProviderFeature","editorWorkerService","getColors","colorProviderRegistry","isDefaultColorDecoratorsEnabled","_findColorData","ColorDataCollector","getColorPresentations","colors","documentColors","ExtColorDataCollector","ColorPresentationsCollector","validDocumentColorProviderFound","defaultProvider","colorData","documentColorProviders","_setupColorCommand","red","green","blue","ColorDetector_1","ColorDecorationInjectedTextMarker","ColorDetector","languageFeatureDebounceService","DecoratorLimitReporter","prevIsEnabled","updatedColorDecoratorsSetting","updatedDefaultColorDecoratorsSetting","languageId","deprecatedConfig","colorDecorators","colorDatas","limit","rgba","ref","limited","computed","ColorPickerModel","availableColorPresentations","presentationIndex","originalTextPrefix","$","ColorPickerHeader","themeService","showingStandaloneColorPicker","dom.append","tooltip","CloseButton","innerDiv","ColorPickerBody","pixelRatio","isStandaloneColorPicker","SaturationBox","OpacityStrip","HueStrip","InsertButton","s","v","hsva","origin","pointerUpListener","saturatedColor","ctx","whiteGradient","blackGradient","Strip","monitor","g","opaque","ColorPickerWidget","standaloneColorPicker","dom.getWindow","HoverRangeAnchor","priority","initialMousePosX","initialMousePosY","lastAnchor","showAtPosition","HoverForeignElementAnchor","owner","supportsMarkerHover","RenderedHoverParts","renderedHoverParts","part","HoverParticipantRegistry","ctor","ColorHover","ColorHoverParticipant","_themeService","_anchor","_lineDecorations","lineDecorations","colorDetector","_createColorHover","hoverParts","renderedPart","renderHoverParts","renderedHoverPart","StandaloneColorPickerHover","StandaloneColorPickerParticipant","defaultColorInfo","defaultColorProvider","foundColorInfo","foundColorProvider","colorProvider","foundInEditor","colorHoverData","colorPickerModel","_updateColorPresentations","_updateEditorModel","participant","minimumHeight","colorHover","colorPicker","editorUpdatedByColorPicker","textEdits","trackedRange","SHOW_OR_FOCUS_HOVER_ACTION_ID","SHOW_DEFINITION_PREVIEW_HOVER_ACTION_ID","SCROLL_UP_HOVER_ACTION_ID","SCROLL_DOWN_HOVER_ACTION_ID","SCROLL_LEFT_HOVER_ACTION_ID","SCROLL_RIGHT_HOVER_ACTION_ID","PAGE_UP_HOVER_ACTION_ID","PAGE_DOWN_HOVER_ACTION_ID","GO_TO_TOP_HOVER_ACTION_ID","GO_TO_BOTTOM_HOVER_ACTION_ID","INCREASE_HOVER_VERBOSITY_ACTION_ID","INCREASE_HOVER_VERBOSITY_ACTION_LABEL","DECREASE_HOVER_VERBOSITY_ACTION_ID","DECREASE_HOVER_VERBOSITY_ACTION_LABEL","inlineSuggestCommitId","showPreviousInlineSuggestionActionId","showNextInlineSuggestionActionId","InlineSuggestionHintsContentWidget_1","InlineCompletionsHintsWidget","reader","ghostText","firstColumn","store","contentWidgetValue","contentWidget","InlineSuggestionHintsContentWidget","hadPosition","lastValue","inlineSuggestionHintsNextIcon","inlineSuggestionHintsPreviousIcon","commandId","iconClassName","kb","withBorder","_currentSuggestionIdx","_suggestionCount","_extraCommands","_contextKeyService","_menuService","CustomizedMenuWorkbenchToolBar","StatusBarViewItem","ActionViewItemWithClassName","suggestionCount","currentSuggestionIdx","extraActions","div","menuId","options2","menuService","contextMenuService","primary","secondary","isMousePositionWithinElement","posx","posy","elementRect","HoverResult$1","isComplete","hasLoadingMessage","HoverOperation","_computer","fireResult","HoverResult","TOP_HEIGHT","BOTTOM_HEIGHT","ResizableContentWidget","minimumSize","dom.Dimension","editorDomNode","mouseBox","editorBox","bodyBox","dom.getClientArea","mouseBottom","widgetHeight","maxHeightBelow","maxHeightAbove","maxHeight","renderingAbove","dimension","ContentHoverWidget_1","HORIZONTAL_SCROLLING_BY","CONTAINER_HEIGHT_PADDING","ContentHoverWidget","_accessibilityService","minimumWidth","focusTracker","dom.trackFocus","width","transformedWidth","transformedHeight","contentsDomNode","containerDomNode","maxRenderingWidth","maxRenderingHeight","availableSpace","maximumHeight","hoverPart","overflowing","hoverElement","initialWidth","widgetRect","computeDistanceFromPointToRectangle","renderedHover","dom.getTotalHeight","accessibleViewHint","hoverStoleFocus","dimensions","dom.getTotalWidth","scrollTop","scrollLeft","scrollHeight","pointX","pointY","dx","dy","ContentHoverComputer","_participants","maxColumn","filteredHoverParts","m","FilteredHoverResult","original","messages","EditorHoverStatusBar","actionOptions","keybinding","keybindingLabel","HoverProviderResult","hover","ordinal","executeProvider","isValid","getHoverProviderResultsAsAsyncIterable","recursive","getHoversPromise","hasRange","hasHtmlContent","increaseHoverVerbosityIcon","decreaseHoverVerbosityIcon","MarkdownHover","contents","isBeforeContent","source","HoverSource","hoverProvider","hoverPosition","hoverVerbosityAction","MarkdownHoverParticipant","_languageService","_hoverService","lineLength","stopRenderingLineAfter","maxTokenizationLineLength","stopRenderingMessage","hoverMessage","hoverProviderRegistry","hoverSource","MarkdownRenderedHoverParts","focus","RenderedMarkdownHoverPart","hoverPartsContainer","_hoverParticipant","_onFinishedRendering","operation","onFinishedRendering","renderedMarkdownPart","renderedMarkdownElement","canIncreaseVerbosity","canDecreaseVerbosity","actionsContainer","markdownHover","renderMarkdownInContainer","actionEnabled","isActionIncrease","actionElement","hoverDelegate","labelForHoverVerbosityAction","actionFunction","hoverRenderedPart","newHover","newHoverSource","initialHoverPart","newHoverPart","newHoverRenderedPart","verbosityDelta","ongoingHoverOperation","currentRenderedHoverPart","currentRenderedMarkdown","renderedMarkdown","renderedChildrenElements","newRenderedHoverPart","renderMarkdownHovers","markdownHovers","languageService","openerService","renderedMarkdownContents","markdownStrings","markdownString","markdownHoverElement","hoverContentsElement","renderer","renderedContents","hasModifier","modifier","ClickLinkMouseEvent","ClickLinkKeyboardEvent","ClickLinkOptions","triggerKey","triggerModifier","triggerSideBySideKey","triggerSideBySideModifier","createOptions","multiCursorModifier","platform.isMacintosh","ClickLinkGesture","newOpts","mouseEvent","currentLineNumber","InlayHintAnchor","direction","InlayHintItem","hint","delta","newHint","_InlayHintsFragments","wordRange","InlayHintsFragments","asCommandLink","defaultColor","defaultOptions","WIDGET_ID","ViewZoneDelegate","domNode","afterColumn","heightInLines","onDomNodeTop","onComputedHeight","showInHiddenAreas","OverlayWidgetDelegate","_Arrow","dom.removeCSSRulesContainingSelector","dom.createCSSRule","where","Arrow","ZoneWidget","objects.deepClone","objects.mixin","info","styles","frameColor","arrowColor","containerHeight","rangeOrPos","arrowHeight","frameThickness","viewZoneDomNode","maxHeightInLines","isLastLine","classToReplace","widthInPixel","heightInPixel","newHeightInLines","evt","lineDelta","roundedLineDelta","IPeekViewService","existing","remove","PeekContext","PeekContextController","getOuterEditor","PeekViewWidget","noCloseAction","dom.addStandardDisposableListener","actionBarOptions","primaryHeading","secondaryHeading","dom.clearNode","dom.show","dom.hide","headHeight","bodyHeight","peekViewTitleBackground","peekViewTitleForeground","peekViewTitleInfoForeground","peekViewBorder","peekViewResultsBackground","peekViewEditorBackground","OneReference","isProviderFirst","_rangeCallback","FilePreview","_modelReference","n","startLineNumber","endLineNumber","beforeRange","afterRange","before","inside","after","FileReferences","textModelResolverService","ReferencesModel","links","providersFirst","current","oneRef","next","childCount","groupCount","nearest","strings.commonPrefixLength","FileReferencesRenderer_1","DataSource","_resolverService","Delegate","FileReferencesRenderer","OneReferenceRenderer","StringRepresentationProvider","parts","IdentityProvider","FileReferencesTemplate","_labelService","matches","templateData","OneReferenceTemplate","highlight","_OneReferenceRenderer","AccessibilityProvider","_DecorationsManager","newDecorationsActualIndex","oneReference","toRemove","newRange","ignore","newLineLength","DecorationsManager","LayoutData","ratio","ReferencesTree","ReferenceWidget","peekView.PeekViewWidget","_defaultTreeKeyboardSupport","layoutData","_textModelResolverService","_peekViewService","_uriLabel","borderColor","peekView.peekViewBorder","peekView.peekViewTitleBackground","peekView.peekViewTitleForeground","peekView.peekViewTitleInfoForeground","containerElement","treeOptions","peekView.peekViewResultsBackground","onEvent","revealParent","scrollType","sel","peekView.IPeekViewService","ReferencesController_1","ctxReferenceSearchVisible","ReferencesController","_editorService","_storageService","modelPromise","peekMode","storageKey","requestId","error","fwd","currentPosition","editorFocus","previewEditorFocus","focusEditor","pinned","openedEditor","sideBySide","withController","fn","outerEditor","ctxHasSymbols","ISymbolNavigationService","SymbolNavigationService","refModel","editorState","seenUri","seenPosition","editorService","shouldIncludeLocationLink","sourceModel","loc","getLocationLinks","provide","getDefinitionsAtPosition","getDeclarationsAtPosition","getImplementationsAtPosition","getTypeDefinitionsAtPosition","getReferencesAtPosition","compact","resultWithoutDeclaration","_sortedAndDeduped","rawLinks","modelLinks","SymbolNavigationAnchor","thing","corePosition.Position","_SymbolNavigationAction","configuration","symbolNavService","references","altAction","altActionId","referenceCount","gotoLocation","peek","targetEditor","modelNow","SymbolNavigationAction","DefinitionAction","DeclarationAction","TypeDefinitionAction","ImplementationAction","ReferencesAction","GenericGoToLocationAction","config","_references","_gotoMultipleBehaviour","multiple","noResultsMessage","openInPeek","control","showGoToContextMenu","location","menuActions","symbolAnchor","useShadowDOM","box","goToDefinitionWithLocation","openToSide","isInPeek","canPeek","InlayHintsController_1","InlayHintsCache","IInlayHintsCache","RenderedInlayHintLabelPart","ActiveInlayHintInfo","hasTriggerModifier","InlayHintsController","_featureDebounce","_inlayHintsCache","_instaService","defaultMode","altMode","newRenderMode","copies","cached","watchedProviders","myToken","inlayHints","delay","gesture","sessionStore","labelPart","lineHints","languages.Command","updateInlayHints","hints","obj","copy","visibleRanges","extendedRange","newDecorationsData","addInjectedText","content","cursorStops","attachedData","addInjectedWhitespace","isLast","marginRule","padding","isUniform","fontFamilyVar","currentLineInfo","isFirst","cssProperties","colors.editorActiveLinkForeground","textlabel","tooLong","over","fixSpace","decorationIdsToReplace","newDecorationIds","props","languages.InlayHintKind","colors.editorInlayHintParameterBackground","colors.editorInlayHintParameterForeground","colors.editorInlayHintTypeBackground","colors.editorInlayHintTypeForeground","colors.editorInlayHintBackground","colors.editorInlayHintForeground","editorFontSize","editorFontFamily","str","inlayHintsProvider","InlayHintsHoverAnchor","InlayHintsHover","hoverService","configurationService","executor","itemTooltip","partTooltip","linkHint","iterable","RenderedContentHover","hoverResult","participants","computer","RenderedContentHoverParts","showAtSecondaryPosition","anchorRange","startColumnBoundary","viewModel","coordinatesConverter","anchorViewRange","anchorViewMinColumn","anchorViewRangeStart","anchorStartLineNumber","secondaryPositionColumn","forceShowAtRange","hoverPartRange","hoverPartRangeOnAnchorStartLine","hoverPartRangeOnAnchorEndLine","hoverPartStartColumn","minSecondaryPositionColumn","forceShowAtPosition","RenderedStatusBar","fragment","_statusBar","_RenderedContentHoverParts","highlightDecoration","hoverContext","statusBar","hoverRenderingContext","renderedStatusBar","hoverPartsForParticipant","markdownHoverParticipant","normalizedMarkdownHoverIndex","firstIndexOfMarkdownHovers","ContentHoverWidgetWrapper","participantInstance","p1","p2","contentHoverWidgetNode","isHoverSticky","isMouseGettingCloser","insistOnKeepingHoverVisible","currentHoverResult","loadingMessage","currentHoverResultIsEmpty","insistOnKeepingPreviousHoverVisible","anchorCandidates","epsilon","ContentHoverController_1","ContentHoverController","hoverOpts","contentWidgetNode","isMouseOnStickyContentHoverWidget","isMouseOnContentHoverWidget","isMouseOnColorPicker","isColorPickerVisible","isTextSelectedWithinContentHoverWidget","sticky","hidingDelay","mouseOnDecorator","decoratorActivatedOn","activatedByDecoratorClick","resolvedKeyboardEvent","shouldKeepHoverVisible","activatedByColorDecoratorClick","_ColorContribution","colorDecoratorsActivatedOn","hoverController","ColorContribution","StandaloneColorPickerController_1","StandaloneColorPickerWidget_1","StandaloneColorPickerController","StandaloneColorPickerWidget","PADDING","CLOSE_BUTTON_WIDTH","_standaloneColorPickerVisible","_standaloneColorPickerFocused","editorSelection","classList","positionPreference","computeAsyncResult","StandaloneColorPickerResult","colorHoverResult","colorPickerBody","saturationBoxWidth","widthOfOriginalColorBox","enterButton","colorPickerHeader","pickedColorNode","originalColorNode","closeButton","ShowOrFocusStandaloneColorPicker","HideStandaloneColorPicker","InsertColorWithStandaloneColorPicker","BlockCommentCommand","insertSpace","languageConfigurationService","haystack","needle","needleLength","haystackLength","codeA","codeB","startToken","endToken","startLineText","endLineText","startTokenIndex","endTokenIndex","startLineAfterStartToken","endLineBeforeEndToken","ops","op","res","inverseEditOperations","startTokenEditOperation","endTokenEditOperation","srcRange","deltaColumn","LineCommentCommand","indentSize","ignoreEmptyLines","ignoreFirstLine","commentStr","onlyWhitespaceLines","shouldRemoveComments","lineData","lineContentStartOffset","strings.firstNonWhitespaceIndex","commentStrEndOffset","cursorPosition","startTokenAllowedBeforeColumn","afterCommentStr","currentVisibleColumn","isTab","columnSize","minVisibleColumn","lenJ","CommentLineAction","modelOptions","commentsOptions","curr","ToggleCommentLineAction","AddLineCommentAction","RemoveLineCommentAction","BlockCommentAction","ContextMenuController_1","ContextMenuController","_contextViewService","view","dom.getShadowRoot","hasSelectionAtPosition","addedItems","subActions","oldHoverSetting","customActionViewItem","wasCancelled","minimapOptions","lastId","createAction","createSubmenuAction","createEnumAction","configName","configuredValue","createRunner","option","ShowContextMenu","CursorState","thisLen","otherLen","StackElement","cursorState","_CursorUndoRedoController","prevState","stackElement","CursorUndoRedoController","CursorUndo","CursorRedo","DragAndDropCommand","targetPosition","_DragAndDropController","possibleSelections","primarySelection","selectionStartLineNumber","selectionStartColumn","DragAndDropController","DropIntoEditorController_1","defaultProviderConfig","changeDropTypeCommandId","dropWidgetVisibleCtx","DropIntoEditorController","_configService","_treeViewsDragAndDropService","dragEvent","ourDataTransfer","activeEditIndex","preferredProviders","configMime","desiredKindStr","desiredKind","editIndex","treeDataTransfer","_args","ConfigurationExtensions","_FindDecorations","scopes","findScopeDecorationId","newStartPosition","desiredRange","candidateOpts","nextMatch","newCurrentDecorationId","matchPosition","rng","lineBeforeEnd","lineBeforeEndMaxColumn","findMatches","findScopes","findMatchesOptions","newOverviewRulerApproximateDecorations","approxPixelsPerLine","mergeLinesDelta","prevStartLineNumber","prevEndLineNumber","newFindMatchesDecorations","findScope","FindDecorations","ReplaceAllCommand","replaceStrings","o1","o2","resultOps","previousOp","StaticValueReplacePattern","staticValue","DynamicPiecesReplacePattern","pieces","ReplacePattern","ReplacePiece","preserveCase","piece","repl","lenOps","opIdx","matchIndex","remainder","caseOps","ReplacePieceBuilder","toCharIndex","parseReplaceString","replaceString","chCode","nextChCode","nextNextChCode","CONTEXT_FIND_WIDGET_VISIBLE","CONTEXT_FIND_INPUT_FOCUSED","CONTEXT_REPLACE_INPUT_FOCUSED","ToggleCaseSensitiveKeybinding","ToggleWholeWordKeybinding","ToggleRegexKeybinding","ToggleSearchScopeKeybinding","TogglePreserveCaseKeybinding","FIND_IDS","MATCHES_LIMIT","RESEARCH_DELAY","FindModelBoundToEditorModel","moveCursor","newFindScope","currentMatchesPosition","matchAfterSelection","matchesPosition","isUsingLineStops","isRecursed","nextMatchRange","prevMatchRange","searchRange","prevMatch","captureMatches","forceMove","decorationRange","replacePattern","limitResultCount","searchRanges","scope","searchData","searchRegex","mod","modelText","fullModelRange","resultText","_FindOptionsWidget","toggleStyles","somethingChanged","actionId","FindOptionsWidget","effectiveOptionValue","override","FindReplaceState","matchesCount","currentMatch","changeEvent","updateHistory","oldEffectiveIsRegex","oldEffectiveWholeWords","oldEffectiveMatchCase","oldEffectivePreserveCase","newSearchScope","existingSearchScope","findCollapsedIcon","findExpandedIcon","findSelectionIcon","findReplaceIcon","findReplaceAllIcon","findPreviousMatchIcon","findNextMatchIcon","NLS_FIND_DIALOG_LABEL","NLS_FIND_INPUT_LABEL","NLS_FIND_INPUT_PLACEHOLDER","NLS_PREVIOUS_MATCH_BTN_LABEL","NLS_NEXT_MATCH_BTN_LABEL","NLS_TOGGLE_SELECTION_FIND_TITLE","NLS_CLOSE_BTN_LABEL","NLS_REPLACE_INPUT_LABEL","NLS_REPLACE_INPUT_PLACEHOLDER","NLS_REPLACE_BTN_LABEL","NLS_REPLACE_ALL_BTN_LABEL","NLS_TOGGLE_REPLACE_MODE_BTN_LABEL","NLS_MATCHES_COUNT_LIMIT_TITLE","NLS_MATCHES_LOCATION","NLS_NO_RESULTS","FIND_WIDGET_INITIAL_WIDTH","PART_WIDTH","FIND_INPUT_AREA_WIDTH","MAX_MATCHES_COUNT_WIDTH","FIND_INPUT_AREA_HEIGHT","ctrlEnterReplaceAllWarningPromptedKey","ctrlKeyMod","FindWidgetViewZone","stopPropagationForMultiLineUpwards","textarea","isMultiline","stopPropagationForMultiLineDownwards","_FindWidget","codeEditor","contextViewProvider","supportLoop","addExtraSpaceOnTop","globalBufferTerm","showRedOutline","alertFn","searchString","ariaLabel","isSelection","isChecked","findInputIsNonEmpty","canReplace","isSelectionMultipleLine","adjustEditorScrollTop","startCoords","startLeft","startTop","leftOfFindWidget","dom.getTopLeftOffset","endCoords","focusTheEditor","targetScrollTop","viewZone","adjustScroll","newHeight","scrollAdjustment","editorWidth","minimapWidth","collapsedFindWidget","reducedFindWidget","narrowFindWidget","findInputWidth","totalheight","totalHeight","_sash","platform.isLinux","SimpleButton","findPart","replaceHoverDelegate","replacePart","replaceActionsContainer","originalWidth","maxWidth","dom.getComputedStyle","currentWidth","FindWidget","expanded","findRangeHighlightBorder","hcBorder","findMatchForeground","findMatchHighlightForeground","CommonFindController_1","SEARCH_STRING_MAX_LENGTH","getSelectionSearchString","seedSearchStringFromSelection","seedSearchStringFromNonEmptySelection","wordAtPosition","CommonFindController","shouldRestartFind","strings.escapeRegExpCharacters","ignoreWhenVisible","stateChanges","selectionSearchString","currentSelections","FindController","updateSearchScope","StartFindAction","findArgDescription","StartFindWithArgsAction","StartFindWithSelectionAction","MatchFindAction","NextMatchFindAction","PreviousMatchFindAction","MoveToMatchFindAction","inputBox","toFindMatchIndex","matchCount","updatePickerAndEditor","SelectionMatchFindAction","NextSelectionMatchFindAction","PreviousSelectionMatchFindAction","StartFindReplaceAction","currentSelection","findInputFocused","shouldFocus","FindCommand","foldSourceAbbr","MAX_FOLDING_REGIONS","MAX_LINE_NUMBER","MASK_INDENT","BitField","numWords","arrayIndex","bit","FoldingRegions","startIndexes","endIndexes","types","parentIndexes","isInsideLast","parentIndex","hasChanged","FoldingRegion","low","high","mid","rangesLength","gotTypes","regions","rangesA","rangesB","getIndexedFunction","getA","getB","indexA","indexB","nextA","nextB","stackedRanges","topStackedRange","prevLineNumber","resultRanges","useRange","scanIndex","prescanB","FoldingModel","textModel","decorationProvider","toggledRegions","r1","r2","processed","k","dirtyRegionEndLine","lastHiddenLine","updateDecorationsUntil","isCollapsed","isManual","region","editorDecorationId","newCollapseState","newFoldingRanges","intersects","foldRange","newRegions","foldedOrManualRanges","newRanges","newEditorDecorations","foldedRanges","decRange","checksum","rangesToRestore","lineNumber1","lineNumber2","level","levelStack","toggleCollapseState","foldingModel","levels","lineNumbers","toToggle","doCollapse","regionsInside","setCollapseStateLevelsDown","setCollapseStateLevelsUp","setCollapseStateUp","setCollapseStateAtLevel","foldLevel","blockedLineNumbers","setCollapseStateForRest","filteredRegions","filteredRegion","setCollapseStateForMatchingLines","regExp","setCollapseStateForType","getParentFoldLine","foldingRegion","parentFoldingIdx","getPreviousFoldLine","expectedParentIndex","minLineNumber","getNextFoldLine","HiddenRangeModel","change","updateHiddenAreas","newHiddenAreas","lastCollapsedStart","lastCollapsedEnd","findRange","hasChanges","lastRange","adjustLine","isInside","adjustedStartLine","adjustedEndLine","MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT","ID_INDENT_PROVIDER","IndentRangeProvider","foldingRangesLimit","cancelationToken","foldingRules","offSide","markers","computeRanges","RangesCollector$1","maxIndent","startIndex","foldingRangesLimitDefault","RangesCollector","pattern","previousRegions","previous","foldBackground","foldingExpandedIcon","foldingCollapsedIcon","foldingManualCollapsedIcon","foldingManualExpandedIcon","foldedBackgroundMinimap","collapsed","_FoldingDecorationProvider","isHidden","decorationIds","FoldingDecorationProvider","foldingContext","ID_SYNTAX_PROVIDER","SyntaxRangeProvider","handleFoldingRangesChange","fallbackRangeProvider","cancellationToken","collectSyntaxRanges","sanitizeRanges","rangeData","nLines","nestingLevel","maxLevel","sorted","d1","d2","diff","FoldingController_1","CONTEXT_FOLDING_ENABLED","FoldingController","foldingRangeProviders","RangesLimitReporter","collapsedRegions","hr","indentRangeProvider","selectedProviders","foldingRegionPromise","foldingRanges","toSelectedLines","newValue","hiddenRanges","iconClicked","offsetLeftInGutter","surrounding","otherRegion","toMaybeToggle","FoldingAction","foldingController","foldingModelPromise","startLine","foldingArgumentsConstraint","types.isUndefined","types.isObject","foldingArgs","types.isNumber","types.isString","UnfoldAction","_foldingController","UnFoldRecursivelyAction","FoldAction","ToggleFoldAction","selectedLines","FoldRecursivelyAction","ToggleFoldRecursivelyAction","FoldAllBlockCommentsAction","comments","FoldAllRegionsAction","UnfoldAllRegionsAction","FoldAllExceptAction","UnfoldAllExceptAction","FoldAllAction","UnfoldAllAction","_FoldLevelAction","FoldLevelAction","GotoParentFoldAction","GotoPreviousFoldAction","GotoNextFoldAction","FoldRangeFromSelectionAction","collapseRanges","RemoveFoldRangeFromSelectionAction","strategy","foldingLimitReporter","rangeProvider","EditorFontZoomIn","EditorFontZoomOut","EditorFontZoomReset","FormatOnType","_workerService","_accessibilitySignalService","support","triggerChars","lastCharCode","unbind","FormatOnPaste","FormatDocumentAction","FormatSelectionAction","TreeElement","candidateId","OutlineElement","OutlineGroup","order","OutlineModel","newProvider","childInfo","count","roots","bucket","overrideContainerLabel","IOutlineModelService","OutlineModelService","debounces","modelService","now","outlineModel","_err","outlineService","_InlineCompletionContextKeys","isInlineCompletionVisible","startsWithIndentation","startsWithIndentationLessThanTabSize","firstLine","indentationEndColumn","firstNonWsIdx","InlineCompletionContextKeys","GhostText","lineText","lastPart","cappedLineText","GhostTextPart","GhostTextReplacement","columnRange","additionalReservedLineCount","_lineText","ghostTextsOrReplacementsEqual","ghostTextOrReplacementEquals","array","getReadonlyEmptyArray","ColumnRange","endColumnExclusive","applyObservableDecorations","decorationsCollection","addPositions","pos1","pos2","subtractPositions","GHOST_TEXT_DESCRIPTION","GhostTextView","replacedRange","inlineTexts","additionalLines","addToAdditionalLines","lastLine","textBufferLine","hiddenTextStartColumn","lastIdx","hiddenRange","uiState","AdditionalLinesWidget","viewZoneId","languageIdCodec","minReservedLineCount","renderLines","disableMonospaceOptimizations","renderWhitespace","renderControlCharacters","fontLigatures","sb","strings.isBasicASCII","strings.containsRTL","lineTokens","html","trustedhtml","ttPolicy","provideInlineCompletions","positionOrRange","defaultReplaceRange","getDefaultRange","multiMap","getPreferredProviders","groupId","states","findPreferredProviderCircle","processProvider","circle","deferredPromise","providerResults","itemsByHash","lists","completions","InlineCompletionList","inlineCompletionItem","InlineCompletionItem","InlineCompletionProviderResult","hashs","inlineCompletions","inlineCompletion","snippetInfo","closeBrackets","preBracketCompletionLength","filterText","additionalTextEdits","sourceInlineCompletion","updatedRange","newLine","newTokens","slicedTokens","singleTextRemoveCommonPrefix","validModelRange","modelRange","valueToReplace","commonPrefixLen","singleTextEditAugments","base","rangeExtends","computeGhostText","previewSuffixLength","sourceLine","sourceIndentationLength","suggestionAddedIndentationLength","replacedIndentation","rangeThatDoesNotReplaceIndentation","suggestionWithoutIndentationChange","valueToBeReplaced","changes","cachingDiff","filteredChanges","previewStartInCompletionText","insertColumn","modifiedEnd","nonPreviewTextEnd","nonPreviewText","italicText","extendingRange","rangeToExtend","lastRequest","originalValue","smartDiff","deletedChars","deletedCharacters","newChanges","sum","smartBracketMatching","getMaxCharCode","maxCharCode","charCode","getUniqueCharCode","getElements","characters","elements1","elements2","InlineCompletionsSource","_debounceValue","activeInlineCompletion","UpdateRequest","updateOngoing","wait","startTime","updatedCompletions","endTime","UpToDateInlineCompletions","asInlineCompletion","tx","updateOperation","UpdateOperation","ms","cancellationTokenSource","inlineCompletionProviderResult","_textModel","_versionId","ids","InlineCompletionWithUpdatedRange","addRefToSource","_modelVersion","emptyRange","minimizedReplacement","cursorPosIndex","filterTextBefore","filterTextAfter","originalValueBefore","originalValueAfter","originalValueIndent","Context","suggestWidgetStatusbarMenu","CompletionItem","completion","sub","_CompletionOptions","snippetSortOrder","kindFilter","providerFilter","providerItemsToReuse","showDeprecated","CompletionOptions","CompletionItemModel","needsClipboard","durations","disposable","provideSuggestionItems","defaultRange","onCompletionList","didAddResult","suggestion","snippetCompletions","providerGroup","getSuggestionComparator","defaultComparator","snippetUpComparator","snippetDownComparator","_snippetComparators","snippetConfig","triggerCharacter","maxItemsToResolve","completionProvider","actualPosition","showSimpleSuggestions","QuickSuggestionsOptions","tokenType","CompositeSnippetVariableResolver","_delegates","SelectionBasedVariableResolver","_selection","_selectionIdx","_overtypingCapturer","lineLeadingWhitespace","varLeadingWhitespace","whitespaceCommonLength","newline","rest","ModelBasedVariableResolver","path.basename","path.dirname","ClipboardBasedVariableResolver","_readClipboardText","_selectionCount","_spread","CommentBasedVariableResolver","_languageConfigurationService","langId","_TimeBasedVariableResolver","rawTimeOffset","sign","hours","hoursString","minutes","minutesString","TimeBasedVariableResolver","WorkspaceBasedVariableResolver","_workspaceService","workspaceIdentifier","filename","folderpath","RandomBasedVariableResolver","SnippetSession_1","_OneSnippet","_snippet","_snippetLineLeadingWhitespace","textChange","placeholderOffset","placeholderLen","operations","currentValue","transformedValueLines","couldSkipThisPlaceholder","activePlaceholders","enclosingPlaceholder","placeholdersWithEqualIndex","nested","indexLastPlaceholder","nestedPlaceholder","OneSnippet","_defaultOptions","SnippetSession","adjustIndentation","snippetTextString","prevChar","overwriteBefore","overwriteAfter","positionLineNumber","positionColumn","positionColumnBefore","positionColumnAfter","adjustWhitespace","overtypingCapturer","snippets","workspaceService","modelBasedVariableResolver","readClipboardText","firstBeforeText","firstAfterText","firstLineFirstNonWhitespace","indexedSelections","extensionBefore","extensionAfter","snippetSelection","snippetLineLeadingWhitespace","snippetEdits","parser","textRange","textNode","newNodes","snippetText","snippetFragmentText","_template","_options","_undoEdits","isTrivialSnippet","oneSelection","allPossibleSelections","SnippetController2_1","SnippetController2","_logService","activeChoice","isAnyOfOptions","o","suggestions","isRegistered","disable","enable","resetSelection","CommandCtor","ctrl","InlineCompletionsModel","selectedSuggestItem","_textModelVersionId","_positions","_suggestPreviewEnabled","_suggestPreviewMode","_inlineSuggestMode","_enabled","VersionIdChangeReason","changeSummary","suggestWidgetInlineCompletions","suggestItem","itemToPreserveCandidate","itemToPreserve","selectedInlineCompletionId","filteredCompletions","suggestCompletionEdit","augmentation","fullEdit","fullEditPreviewLength","getSecondaryEdits","ghostTexts","primaryGhostText","replacement","lastItem","src","suggestCompletion","candidateInlineCompletions","newIdx","getEndPositionsAfterApplying","wordRegExp","m1","acceptUntilIndexExclusive","m2","getAcceptUntilIndex","firstPart","ghostTextPos","ghostTextVal","partialGhostTextVal","newText","primaryEdit","acceptedRange","itemEdit","augmentedCompletion","primaryPosition","secondaryPositions","primaryEditStartPosition","primaryEditEndPosition","replacedTextAfterPrimaryCursor","positionWithinTextEdit","secondaryEditText","substringPos","posEnd","textAfterSecondaryCursor","subtext","sortPerm","sortedNewRanges","SuggestMemoryService_1","Memory","topScore","NoMemory","LRUMemory","lineSuffix","indexPreselect","indexRecency","seq","PrefixMemory","SuggestMemoryService","ISuggestMemoryService","WordContextKey_1","WordContextKey","checkForWordEnd","SuggestAlternatives_1","SuggestAlternatives","acceptNext","newIndex","rounds","CommitCharacterController","accept","acceptCharacters","_BracketSelectionRangeProvider","round","counts","bracket","closing","innerBracket","outerBracket","aboveLine","BracketSelectionRangeProvider","_WordDistance","service","wordRanges","wordUntilPos","wordLines","bestWordRange","blockDistance","WordDistance","LineContext$1","leadingLineContent","characterCountDelta","CompletionModel","lineContext","wordDistance","snippetSuggestions","fuzzyScoreOptions","labelLengths","wordLow","scoreFn","wordLen","wordPos","SuggestModel_1","LineContext","triggerOptions","canShowQuickSuggest","suppressSuggestions","canShowSuggestOnTriggerCharacters","SuggestModel","_envService","editorIsComposing","supportsByTriggerCharacter","set","checkTriggerCharacter","lastChar","supports","prevSelection","suggestCtx","itemKindFilter","completionOptions","fuzzySearchOptions","suggestOptions","map","oldLineContext","isFrozen","shouldAutoTrigger","_OvertypingCapturer","suggestModel","selectionsLength","willOvertype","OvertypingCapturer","SuggestWidgetStatus","_menuId","actionViewItemProvider","menu","renderMenu","right","canExpandCompletionItem","SuggestDetailsWidget","fontWeight","fontSizePx","lineHeightPx","borderWidth","borderHeight","explainMode","detail","md","cappedDetail","newSize","dom.size","much","SuggestDetailsOverlay","topLeftNow","sizeNow","deltaTop","deltaLeft","updateTopLeft","sessionEnded","preferAlignAtTop","anchorBox","defaultMinSize","defaultTop","eastPlacement","maxSizeTop","maxSizeBottom","westPlacement","southPacement","placements","placement","bottom","alignAtTop","maxSize","editorBoundingBox","topLeft","getAriaId","suggestMoreInfoIcon","_completionItemColor","out","ItemRenderer","_modelService","colorspan","main","iconContainer","iconLabel","parametersLabel","qualifierLabel","detailsLabel","readMore","fontFeatureSettings","letterSpacing","letterSpacingPx","labelOptions","labelClasses","detailClasses","stripNewLines","SuggestWidget_1","editorSuggestWidgetForeground","editorSuggestWidgetSelectedBackground","PersistedWidgetSize","_service","SuggestWidget","SuggestContentWidget","ResizeState","persistedSize","currentSize","persistHeight","persistWidth","itemHeight","defaultSize","threshold","details","applyIconStyle","_element","description","docs","applyStatusBarStyle","t","SuggestContext","completionModel","loading","auto","selectionIndex","isAuto","noFocus","visibleCount","isEmpty","dom.runAtThisOrScheduleAtNextAnimationFrame","dim","minPersistedHeight","preferredWidth","fullHeight","minHeight","cursorBox","cursorBottom","availableSpaceAbove","statusBarHeight","_widget","horizontalPadding","SuggestController_1","LineSuffix","SuggestController","_memoryService","PriorityRegistry","ctxInsertMode","commitCharacterController","ctxMakesTextEdit","ctxHasInsertAndReplace","ctxCanResolve","acceptSuggestionsOnEnter","updateFromConfig","acceptSuggestionOnEnter","snippetController","modelVersionNow","tasks","isResolved","_commandExectionDuration","_additionalEditsAppliedAsync","columnDelta","startColumnDelta","endColumnDelta","docListener","thisPosition","oldFlags","didType","typeListener","applied","TriggerSuggestAction","itemResolved","commandExectionDuration","additionalEditsAppliedAsync","completionItems","labelMap","firstIndexArray","firstIndex","toggleMode","replace","suffixDelta","msg","onlyFrom","noFilter","positionNow","fallback","makesTextEdit","keepAlternativeSuggestions","alternativeOverwriteConfig","prioritySelector","s1","s2","_TriggerSuggestAction","weight","SuggestCommand","SuggestWidgetAdaptor","suggestControllerPreselector","onWillAccept","suggestController","suggestItems","itemToPreselect","suggestItemInfo","SuggestItemInfo","suggestItemTextEdit","valid","isBoundToSuggestWidget","bindToSuggestWidget","newActive","newInlineCompletion","suggestItemInfoEquals","focusedItem","isSnippetText","completionItemKind","InlineCompletionsController_1","InlineCompletionsController","_debounceService","_tx","cb","convertItemsToStableObservables","_value","_changes","currentInlineCompletionBySemanticId","_deltas","accessibleViewShowing","accessibleViewKeybinding","innerObservables","itemsValue","_ShowNextInlineSuggestionAction","ShowNextInlineSuggestionAction","_ShowPreviousInlineSuggestionAction","ShowPreviousInlineSuggestionAction","TriggerInlineSuggestionAction","AcceptNextWordOfInlineCompletion","AcceptNextLineOfInlineCompletion","AcceptInlineCompletion","_HideInlineCompletion","HideInlineCompletion","_ToggleAlwaysShowInlineSuggestionToolbar","configService","ToggleAlwaysShowInlineSuggestionToolbar","InlineCompletionsHover","InlineCompletionsHoverParticipant","accessibilityService","viewZoneData","w","widgetNode","render","code","inlineSuggestionAvailable","InlineCompletionsAccessibleView","GotoDefinitionAtPositionEditorContribution_1","GotoDefinitionAtPositionEditorContribution","linkGesture","keyboardEvent","withKey","linkRange","combinedRange","originSelectionRange","textEditorModel","previewValue","rangeToUse","previewRange","minIndent","endIndent","startIndent","MarkerCoordinate","total","MarkerList","resourceFilter","compareOrder","compareMarker","updateMarker","uris","oldIdx","IMarkerNavigationService","MarkerNavigationService","MarkerNavigationWidget_1","onRelatedInformation","related","relatedInformation","sourceAndCodeLength","lastLineElement","detailsElement","sourceElement","codeElement","relatedInformationNode","relatedResource","relatedMessage","scrollWidth","severityLabel","MarkerNavigationWidget","editorMarkerNavigationBackground","colorId","editorMarkerNavigationError","headerBackground","editorMarkerNavigationErrorHeader","editorMarkerNavigationWarning","editorMarkerNavigationWarningHeader","editorMarkerNavigationInfo","editorMarkerNavigationInfoHeader","headerBg","markerIdx","markerCount","errorDefault","warningDefault","infoDefault","MarkerController_1","MarkerController","_markerNavigationService","CONTEXT_MARKERS_NAVIGATION_VISIBLE","reusePosition","multiFile","otherEditor","MarkerNavigationAction","_next","_multiFile","_NextMarkerAction","NextMarkerAction","_PrevMarkerAction","PrevMarkerAction","NextMarkerInFilesAction","PrevMarkerInFilesAction","MarkerCommand","HoverFocusBehavior","ShowOrFocusHoverAction","focusArgument","focusOption","showContentHover","accessibilitySupportEnabled","ShowDefinitionPreviewHoverAction","goto","ScrollUpHoverAction","ScrollDownHoverAction","ScrollLeftHoverAction","ScrollRightHoverAction","PageUpHoverAction","PageDownHoverAction","GoToTopHoverAction","GoToBottomHoverAction","IncreaseHoverVerbosityLevel","DecreaseHoverVerbosityLevel","MarkerHover","markerCodeActionTrigger","MarkerHoverParticipant","_markerDecorationsService","renderedMarkerHover","markerHoverForStatusbar","markerHover","markerElement","messageElement","sourceAndCodeElement","codeLink","relatedInfoContainer","editorOptions","markerController","quickfixPlaceholderElement","updatePlaceholderDisposable","codeActionsPromise","showing","elementPosition","MarginHoverComputer","toHoverMessage","isLineHover","lane","MarginHoverWidget_1","MarginHoverWidget","laneOrLine","editorLayout","topForLineNumber","editorScrollTop","nodeHeight","MarginHoverController","marginHoverWidgetNode","isMouseOnMarginHoverWidget","HoverAccessibleView","HoverAccessibilityHelp","ExtHoverAccessibleView","hoverBorder","getSpaceCnt","spacesCnt","generateIndent","insertSpaces","tabsCnt","getReindentEditOperations","indentationRulesSupport","processedIndentRulesSupport","shiftIndent","indentation","unshiftIndent","indentEdits","currentLineText","globalIndent","strings.getLeadingWhitespace","idealIndentForNextLine","doesLineStartWithString","oldIndentation","currentIdealIndent","_IndentationToSpacesAction","modelOpts","IndentationToSpacesCommand","IndentationToSpacesAction","_IndentationToTabsAction","IndentationToTabsCommand","IndentationToTabsAction","ChangeIndentationSizeAction","displaySizeOnly","creationOpts","picks","autoFocusIndex","pick","pickedVal","_IndentUsingTabs","IndentUsingTabs","_IndentUsingSpaces","IndentUsingSpaces","_ChangeTabDisplaySize","ChangeTabDisplaySize","_DetectIndentation","DetectIndentation","ReindentLinesAction","ReindentSelectedLinesAction","editOperations","AutoIndentOnPasteCommand","selectionIsSet","AutoIndentOnPaste","isStartOrEndInString","autoIndent","indentConverter","firstLineText","indentOfFirstLine","newSpaceCnt","indentUtils.getSpaceCnt","oldSpaceCnt","newIndent","indentUtils.generateIndent","indentMetadata","firstLineNumber","indentOfSecondLine","newSpaceCntOfSecondLine","oldSpaceCntOfSecondLine","spaceCntOffset","originalIndent","newSpacesCnt","cmd","lineContainsOnlyWhitespace","containsOnlyWhitespace","linePart","nonWhitespaceColumn","firstNonWhitespaceTokenIndex","isPositionInString","getIndentationEditOperations","tabsToSpaces","spaces","spacesRegExp","lastIndentationColumn","originalIndentationRange","originalIndentation","newIndentation","InPlaceReplaceCommand","originalSelection","InPlaceReplaceController_1","InPlaceReplaceController","up","modelURI","InPlaceReplaceUp","InPlaceReplaceDown","ExpandLineSelectionAction","CopyLinesCommand","isCopyingDown","noop","sourceLines","sourceText","MoveLinesCommand","isMovingDown","getLanguageId","getLanguageIdAtPosition","modelLineCount","otherLineNumber","movingLineNumber","movingLineText","insertingText","movingLineMatchResult","virtualModel","indentOfMovingLine","newIndentatOfMovingBlock","oldIndent","enter","enterPrefix","indentMetadataOfMovelingLine","futureAboveLineNumber","futureAboveLineText","strings.lastNonWhitespaceIndex","validPrecedingLine","oneLineAbove","previousLineText","languageAtSelectionStart","languageAtSelectionEnd","_SortLinesCommand","descending","sortLines","getSortData","SortLinesCommand","linesToSort","AbstractCopyLinesAction","down","CopyLinesUpAction","CopyLinesDownAction","DuplicateSelectionAction","insertSelection","AbstractMoveLinesAction","MoveLinesUpAction","MoveLinesDownAction","AbstractSortLinesAction","SortLinesAscendingAction","SortLinesDescendingAction","DeleteDuplicateLinesAction","endCursorState","linesDeleted","updateSelection","uniqueLines","selectionToReplace","adjustedSelectionStart","finalSelection","_TrimTrailingWhitespaceAction","cursors","trimInRegexAndStrings","TrimTrailingWhitespaceAction","DeleteLinesAction","mergedOperations","previousOperation","IndentLinesAction","OutdentLinesAction","InsertLineBeforeAction","InsertLineAfterAction","AbstractDeleteAllToBoundaryAction","primaryCursor","rangesToDelete","effectiveRanges","nextRange","DeleteAllLeftAction","endPrimaryCursor","deletedLines","endCursor","newStartLine","deleteFromLine","deleteFromColumn","DeleteAllRightAction","JoinLinesAction","reducedSelections","lastSelection","previousValue","lineOffset","columnDeltaOffset","selectionEndPositionOffset","trimmedLinesContent","firstNonWhitespaceIdx","lineTextWithoutIndent","deleteSelection","resultSelection","TransposeAction","cursor","chars","AbstractCaseAction","wordSeparators","UpperCaseAction","LowerCaseAction","BackwardsCompatibleRegExp","_pattern","_flags","_TitleCaseAction","titleBoundary","TitleCaseAction","_SnakeCaseAction","caseBoundary","singleLetters","SnakeCaseAction","_CamelCaseAction","wordBoundary","words","CamelCaseAction","_PascalCaseAction","wordBoundaryToMaintain","PascalCaseAction","_KebabCaseAction","regexp","underscoreBoundary","KebabCaseAction","LinkedEditingContribution_1","CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE","LinkedEditingContribution","forceRefresh","isEnabled","rangeUpdateScheduler","triggerRangeUpdate","rangeSyncScheduler","triggerRangeSync","referenceRange","referenceValue","mirrorRange","oldValue","rangeStartColumn","rangeEndColumn","strings.commonSuffixLength","prevEditOperationType","force","modelVersionId","currentRequestCts","response","getLinkedEditingRanges","foundReferenceRange","LinkedEditingAction","LinkedEditingCommand","orderedByScore","arrays.isNonEmptyArray","linkedEditingRangeProvider","Link","LinksList","tuples","newLinks","oldLinks","oldIndex","oldLen","newLen","oldLink","newLink","getLinks","linkProvider","LinkDetector_1","LinkDetector","clickLinkGesture","useMetaKey","oldDecorations","keys","occurence","LinkOccurrence","occurrence","fromUserGesture","modelUri","parsedUri","fsPath","resources.originalFSPath","resources.joinPath","messageOrError","currentOccurrence","isActive","getHoverMessage","executeCmd","nativeLabel","OpenLinkAction","linkDetector","_LongLinesHelper","LongLinesHelper","wordHighlightBackground","wordHighlightBorder","overviewRulerWordHighlightForeground","overviewRulerWordHighlightStrongForeground","overviewRulerWordHighlightTextForeground","_WRITE_OPTIONS","_TEXT_OPTIONS","_SELECTION_HIGHLIGHT_OPTIONS","_SELECTION_HIGHLIGHT_OPTIONS_NO_OVERVIEW","_REGULAR_OPTIONS","getHighlightDecorationOptions","getSelectionHighlightDecorationOptions","hasSemanticHighlights","selectionHighlight","SelectionHighlighter_1","announceCursorChange","previousCursorState","cursorDiff","cs","pcs","cursorPositions","InsertCursorAbove","useLogicalLine","InsertCursorBelow","InsertCursorAtEndOfEachLineSelected","currentLineMaxColumn","InsertCursorAtEndOfLineSelected","InsertCursorAtTopOfLineSelected","MultiCursorSessionResult","revealRange","revealScrollType","MultiCursorSession","findController","findState","isDisconnectedFromFindController","wholeWord","matchCase","searchText","allSelections","lastAddedSelection","previousMatch","searchScope","_MultiCursorSelectionController","session","modelRangesContainSameText","resultingSelections","MultiCursorSelectionController","MultiCursorSelectionControllerAction","multiCursorController","newFindController","AddSelectionToNextFindMatchAction","AddSelectionToPreviousFindMatchAction","MoveSelectionToNextFindMatchAction","MoveSelectionToPreviousFindMatchAction","SelectHighlightsAction","CompatChangeAll","SelectionHighlighterState","_searchText","_matchCase","_wordSeparators","SelectionHighlighter","oldState","caseSensitive","findStateSearchString","mySearchString","allMatches","cmp","occurrenceHighlighting","selectedText","getValueInRange","thisSelectedText","toLowerCase","FocusNextCursor","firstCursor","FocusPreviousCursor","inlineEditAcceptId","inlineEditRejectId","inlineEditJumpToId","inlineEditJumpBackId","INLINE_EDIT_DESCRIPTION","GhostTextWidget","isSingleLine","isPureRemove","firstNonWhitespace","lastNonWhitespace","InlineEditHintsContentWidget_1","InlineEditHintsWidget","InlineEditHintsContentWidget","InlineEditSideBySideWidget_1","InlineEditSideBySideContentWidget_1","step","removeIndentation","length","InlineEditSideBySideWidget","_diffProviderFactoryService","lengths","lineOfMaxColumn","modifiedText","InlineEditSideBySideContentWidget","_text","_shift","_diff","originalDecorations","modifiedDecorations","shift","moveRange","visibPos","InlineEditController_1","InlineEditController","textToDisplay","isPureRemoval","modelChangedSignal","currentEdit","editorBlurSingal","editorFocusSignal","styleElement","gt","modelVersion","triggerKind","sendRejection","TriggerInlineEdit","activeExpr","JumpToInlineEdit","JumpBackInlineEdit","RejectInlineEdit","AcceptInlineEdit","showPreviousInlineEditActionId","showNextInlineEditActionId","inlineEditVisible","isPinnedContextKey","_PlaceholderTextContribution","isOrWasTrue","shouldBeVisibile","PlaceholderTextContribution","InlineEdit","newLines","InlineEditsWidget","_edit","_userPrompt","inlineEdit","maxLeft","selectionTop","selectionBottom","topCode","Point","bottomCode","codeHeight","codeEditDist","editHeight","difference","topEdit","bottomEdit","visible","straightWidthCode","straightWidthEdit","bezierDist","path","PathBuilder","createTwoWaySync","mapSettableObservable","isFocused","obs","fn1","fn2","point","cp1","cp2","to","InlineEditsModel_1","InlineEditsModel","TrackedRange","existingLines","InlineEditData","mapValue","deco","InlineEditsController_1","InlineEditsController","flattenSettableObservable","labelAndAlias","_ShowNextInlineEditAction","ShowNextInlineEditAction","_ShowPreviousInlineEditAction","ShowPreviousInlineEditAction","TriggerInlineEditAction","_HideInlineEdit","HideInlineEdit","provideSignatureHelp","languages.SignatureHelpTriggerKind","ParameterHintState","Pending","previouslyActiveHints","Active","_ParameterHintsModel","silent","triggerId","activeSignature","cycle","isRetrigger","activeSignatureHelp","mergeTriggerContexts","triggerContext","lastCharIndex","triggerCharCode","ParameterHintsModel","ParameterHintsWidget_1","parameterHintsNextIcon","parameterHintsPreviousIcon","ParameterHintsWidget","wrapper","controls","overloads","dom.EventHelper","body","scrollbar","signature","updateFont","hasParameters","activeParameterIndex","activeParameter","hasDocs","labelToAnnounce","param","aria.alert","markdown","stopWatch","renderDuration","beforeSpan","paramSpan","afterSpan","paramIdx","regex","ParameterHintsController_1","ParameterHintsController","newParameterHints","TriggerParameterHintsAction","ParameterHintsCommand","CONTEXT_RENAME_INPUT_VISIBLE","RenameWidget","_acceptKeybindings","InputWithButton","RenameCandidateListView","newSymbolName","widgetShadowColor","widgetBorderColor","border","cursorBoxTop","candidateViewHeight","RenameCandidateView","inputBoxHeight","labelHeight","totalHeightAvailable","wantsPreview","caller","currentName","supportPreview","requestRenameCandidates","selectionStart","selectionEnd","disposeOnDone","keyEvent","inputResult","nRenameSuggestions","newName","focusedCandidate","isManuallyTriggered","trace","namesListResults","newNames","namesListResult","distinctNames","arrays.distinct","validDistinctNames","firstLineInViewport","selectedElement","focusedElement","focusedIxs","focused","nCandidates","heightToFitAllCandidates","longestCandidateWidth","virtualDelegate","_RenameCandidateView","domFontInfo.applyFontInfo","isAIGenerated","RenameController_1","RenameSkeleton","rejects","rename","skeleton","RenameController","cts1","resolveLocationOperation","cts2","newSymbolNamesProviders","resolvedNewSymbolnamesProviders","requestRenameSuggestions","supportsAutomatic","inputFieldResult","renameOperation","renameResult","nRenameSuggestionProviders","RenameAction","RenameCommand","currentEditor","renameProvider","SectionHeaderDetector","editorLanguageId","minimap","commentsConfiguration","sectionHeaders","sectionHeader","validRange","isSemanticTokens","isSemanticTokensEdits","DocumentSemanticTokensResult","hasDocumentSemanticTokensProvider","getDocumentSemanticTokensProviders","getDocumentSemanticTokens","lastProvider","lastResultId","_getDocumentSemanticTokensProviderHighestGroup","DocumentRangeSemanticTokensResult","hasDocumentRangeSemanticTokensProvider","getDocumentRangeSemanticTokensProviders","getDocumentRangeSemanticTokens","documentSemanticTokensProvider","buff","documentRangeSemanticTokensProvider","SEMANTIC_HIGHLIGHTING_SETTING_ID","isSemanticColoringEnabled","setting","ModelSemanticColoring_1","DocumentSemanticTokensFeature","semanticTokensStylingService","register","ModelSemanticColoring","deregister","modelSemanticColoring","handleSettingOrThemeChange","watcher","_semanticTokensStylingService","bindDocumentChangeListeners","pendingChanges","contentChangeListener","styling","errors.isCancellationError","errors.onUnexpectedError","srcOffset","dest","destOffset","currentResponse","rescheduleIfNeeded","deltaLength","srcData","destData","srcLastStart","destLastStart","copyCount","SemanticTokensResponse","area","singleChange","resultId","ViewportSemanticTokensContribution","scheduleTokenizeViewport","req","requestVersionId","WordSelectionRangeProvider","selectSubwords","lastCh","SmartSelectController_1","SelectionRanges","SmartSelectController","forward","provideSelectionRanges","arrays.equals","AbstractSmartSelect","GrowSelectionAction","ShrinkSelectionAction","work","allRawRanges","allProviderRanges","oneProviderRanges","oneRawRanges","oneRanges","oneRangesWithTrivia","rangeNoWhitespace","rangeFull","StickyScrollWidgetState","startLineNumbers","endLineNumbers","lastLineRelativePosition","showEndForLine","_ttPolicy","STICKY_INDEX_ATTR","STICKY_IS_LINE_ATTR","STICKY_IS_LINE_NUMBER_ATTR","STICKY_IS_FOLDING_ICON_ATTR","StickyScrollWidget","updateScrollLeftPosition","stickyLine","_state","_rebuildFromLine","isWidgetHeightZero","rebuildFromLine","futureWidgetHeight","previousState","indexOfLinesAlreadyRendered","lineNumbersWidth","clearFromLine","requireTransitions","allVisible","foldingIcon","linesToRender","viewLineNumber","lineRenderingData","lineNumberOption","actualInlineDecorations","renderLineInput","renderOutput","lineHTMLNode","lineNumberHTMLNode","innerLineNumberHTML","renderedLine","RenderedStickyLine","lastLineZIndex","intermediateLineZIndex","lastLineTop","intermediateLineTop","showFoldingControls","foldingRegions","indexOfFoldingRegion","StickyFoldingIcon","spanDomNode","renderedStickyLine","lineIndex","attribute","lineDomNode","lineNumberDomNode","characterMapping","foldingStartLine","foldingEndLine","StickyRange","StickyElement","StickyModel","version","outlineProviderId","ModelProvider","Status","StickyModelProvider","onProviderUpdate","StickyModelFromCandidateOutlineProvider","StickyModelFromCandidateSyntaxFoldingProvider","StickyModelFromCandidateIndentationFoldingProvider","modelProvider","statusPromise","StickyModelCandidateProvider","providerModelPromise","providerModel","stickyOutlineElement","providerID","preferredProvider","outlineElements","outlineGroupOfModel","tempID","maxTotalSumOfRanges","optimalOutlineGroup","_key","outlineGroup","totalSumRanges","stickyChildren","outlineElementsArray","element1","element2","range1","range2","outlineElement","previousStartLine","subchild","child1","child2","outline","StickyModelFromCandidateFoldingProvider","foldingElement","orderedStickyElements","parentNode","StickyLineCandidate","nestingDepth","StickyLineCandidateProvider","depth","lastStartLineNumber","childrenStartLines","lowerBound","upperBound","childStartLine","childEndLine","stickyLineCandidates","StickyScrollController_1","StickyScrollController","_languageFeatureDebounceService","stickyScrollDomNode","revealFunction","getMouseEventTarget","mouseTargetElement","stickyScrollWidgetDomNode","currentEndForLineIndex","_keyboardEvent","mouseTarget","textElement","currentHTMLChild","candidateDefinitions","childHTML","targetWindow","stickyLineNumbers","stickyLineNumber","theoreticalLines","nextRebuildFromLine","stickyWidgetVersion","focusedStickyElementLineNumber","minRebuildFromLineOrInfinity","stickyWidgetHasLines","maxNumberStickyLines","arrayVisibleRanges","fullVisibleRange","candidateRanges","topOfElementAtDepth","bottomOfElementAtDepth","bottomOfBeginningLine","topOfEndLine","bottomOfEndLine","ToggleStickyScroll","FocusStickyScroll","SelectNextStickyScrollLine","SelectPreviousStickyScrollLine","GoToStickyScrollLine","SelectEditor","SuggestInlineCompletion","InlineCompletionResults","_suggestMemoryService","selectedIndex","second","SuggestInlineCompletions","_languageFeatureService","wordInfo","triggerCharacterInfo","leadingLineContents","newLineContext","_completions","ForceRetokenizeAction","_ToggleTabFocusModeAction","ToggleTabFocusModeAction","BANNER_ELEMENT_HEIGHT","BannerController","Banner","messageContainer","actionBarContainer","warningIcon","UnicodeHighlighter","_workspaceTrustService","max","DisableHighlightingOfNonBasicAsciiCharactersAction","DisableHighlightingOfAmbiguousCharactersAction","DisableHighlightingOfInvisibleCharactersAction","resolveOptions","highlightOptions","locale","platform.language","DocumentUnicodeHighlighter","ViewportUnicodeHighlighter","trusted","_updateState","Decorations","computeReason","totalResult","configureUnicodeHighlightOptionsStr","UnicodeHighlighterHoverParticipant","unicodeHighlighter","existedReason","highlightInfo","codePoint","codePointStr","formatCodePointMarkdown","reason","adjustSettingsArgs","adjustSettings","ShowExcludeOptions","codePointToHex","renderCodePointAsInlineCode","char","_Decorations","hideInComments","hideInStrings","DisableHighlightingInCommentsAction","DisableHighlightingInStringsAction","_DisableHighlightingOfAmbiguousCharactersAction","_DisableHighlightingOfInvisibleCharactersAction","_DisableHighlightingOfNonBasicAsciiCharactersAction","_ShowExcludeOptions","inString","inComment","quickPickService","getExcludeCharFromBeingHighlightedLabel","excludeLocaleFromBeingHighlighted","excludeCharFromBeingHighlighted","expectNever","charCodes","existingValue","locales","ignoreUnusualLineTerminators","writeIgnoreState","readIgnoreState","UnusualLineTerminatorsDetector","_dialogService","_codeEditorService","TextualDocumentHighlightProvider","primaryModel","otherModels","highlights","TextualMultiDocumentHighlightFeature","WordHighlighter_1","WordHighlighterContribution_1","ctxHasWordHighlights","getOccurrencesAtPosition","getOccurrencesAcrossMultipleModels","filteredModels","otherModel","OccurenceAtPositionRequest","currentWordRange","requestIsValid","SemanticOccurenceAtPositionRequest","MultiModelOccurenceRequest","computeOccurencesAtPosition","computeOccurencesMultiModel","WordHighlighter","multiProviders","currentDecorationIDs","preservedModel","currentEditors","deleteURI","editorHighlighterContrib","WordHighlighterContribution","currentModels","tempModel","diffModel","multiFileConfigChange","workerRequestIsValid","currentModelDecorationRanges","storedRange","myRequestId","otherModelsToHighlight","currentTime","minimumRenderTime","oldDecorationIDs","newDocumentHighlights","newDecorationIDs","createWordHighlighterIfPossible","WordHighlightNavigationAction","NextWordHighlightAction","PrevWordHighlightAction","TriggerWordHighlightAction","MoveWordCommand","hasMulticursor","inPosition","outPosition","from","inSelectionMode","WordLeftCommand","wordNavigationType","WordRightCommand","CursorWordStartLeft","CursorWordEndLeft","CursorWordLeft","CursorWordStartLeftSelect","CursorWordEndLeftSelect","CursorWordLeftSelect","CursorWordAccessibilityLeft","wordCharacterClassifier","CursorWordAccessibilityLeftSelect","CursorWordStartRight","CursorWordEndRight","CursorWordRight","CursorWordStartRightSelect","CursorWordEndRightSelect","CursorWordRightSelect","CursorWordAccessibilityRight","CursorWordAccessibilityRightSelect","DeleteWordCommand","autoClosingBrackets","autoClosingQuotes","autoClosingPairs","deleteRange","DeleteWordLeftCommand","DeleteWordRightCommand","DeleteWordStartLeft","DeleteWordEndLeft","DeleteWordLeft","DeleteWordStartRight","DeleteWordEndRight","DeleteWordRight","DeleteInsideWord","DeleteWordPartLeft","DeleteWordPartRight","WordPartLeftCommand","CursorWordPartLeft","CursorWordPartLeftSelect","WordPartRightCommand","CursorWordPartRight","CursorWordPartRightSelect","_ReadOnlyMessageController","messageController","ReadOnlyMessageController","DiffEditorBreadcrumbsSource","_outlineModelService","documentSymbolProviderChanged","textModelChanged","startRange","AbstractEditorNavigationQuickAccessProvider","picker","runOptions","pickerDisposable","lastKnownEditorViewState","deleteDecorations","rangeHighlightId","overviewRulerDecorationId","rangeHighlightDecorationId","_AbstractGotoLineQuickAccessProvider","numbers","positionCandidate","AbstractGotoLineQuickAccessProvider","AbstractGotoSymbolQuickAccessProvider_1","AbstractGotoSymbolQuickAccessProvider","symbolProviderRegistryPromise","symbolProviderListener","symbolsPromise","picksCts","updatePickerItems","positionToEnclose","query","filterBySymbolKind","filterPos","symbolQuery","containerQuery","buttons","openSideBySideDirection","filteredSymbolPicks","symbolLabel","symbolLabelWithIcon","symbolLabelIconOffset","containerLabel","symbolScore","symbolMatches","containerScore","containerMatches","skipContainerQuery","deprecated","sortedFilteredSymbolPicks","symbolA","symbolB","symbolPicks","updateLastSeparatorLabel","lastSeparator","lastSymbolKind","lastSymbolKindCounter","NLS_SYMBOL_KIND_CACHE","FALLBACK_NLS_SYMBOL_KIND","symbolPick","kindA","kindB","AbstractEditorCommandsQuickAccessProvider","dialogService","activeTextEditorControl","editorCommandPicks","editorAction","commandDescription"],"mappings":"AAAA,OAAA,KAAAA,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,OAAA,qDAAA,OAAA,MAAAC,EAAA,KAAAC,GAAA,MAAAC,GAAA,KAAAC,EAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,EAAA,KAAAC,GAAA,MAAAC,EAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,EAAA,MAAAC,GAAA,MAAAC,EAAA,KAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,KAAAC,EAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,KAAAC,EAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,EAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,EAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,OAAA,0CAAA,OAAA,KAAAC,EAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,EAAA,KAAAC,EAAA,KAAAC,EAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,OAAA,oDAAA,OAAA,KAAAC,EAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,KAAAC,EAAA,KAAAC,EAAA,KAAAC,EAAA,KAAAC,EAAA,MAAAC,EAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,OAAA,mDAAA,OAAA,KAAAC,GAAA,MAAAC,EAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,KAAAC,EAAA,KAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,EAAA,MAAAC,GAAA,KAAAC,GAAA,KAAAC,EAAA,MAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,EAAA,MAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,OAAA,8CAAA,OAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,OAAA,kDAAA,OAAA,KAAAC,EAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,EAAA,KAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,KAAAC,GAAA,MAAAC,GAAA,MAAAC,GAAA,M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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209]}