import{c as d}from"./monaco-editor-esm-vs-base-browser-DUVYE87s.js";import{l as m,c as p,t as k,o as h,C as y,d as W,g as b,e as w,S as E,F as L}from"./monaco-editor-esm-vs-base-YIFfhEJQ.js";let u;typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope"&&globalThis.workerttPolicy!==void 0?u=globalThis.workerttPolicy:u=d("defaultWorkerFactory",{createScriptURL:t=>t});function S(t,e){const r=globalThis.MonacoEnvironment;if(r){if(typeof r.getWorker=="function")return r.getWorker("workerMain.js",e);if(typeof r.getWorkerUrl=="function"){const o=r.getWorkerUrl("workerMain.js",e);return new Worker(u?u.createScriptURL(o):o,{name:e,type:"module"})}}if(t){const o=T(e,t.toString(!0)),n=new Worker(u?u.createScriptURL(o):o,{name:e,type:"module"});return _(n)}throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}function T(t,e,r){if(!(/^((http:)|(https:)|(file:)|(vscode-file:))/.test(e)&&e.substring(0,globalThis.origin.length)!==globalThis.origin)){const s=e.lastIndexOf("?"),c=e.lastIndexOf("#",s),a=s>0?new URLSearchParams(e.substring(s+1,~c?c:void 0)):new URLSearchParams;y.addSearchParam(a,!0,!0),a.toString()?e=`${e}?${a.toString()}#${t}`:e=`${e}#${t}`}const n=new Blob([W([`/*${t}*/`,void 0,`globalThis._VSCODE_NLS_MESSAGES = ${JSON.stringify(b())};`,`globalThis._VSCODE_NLS_LANGUAGE = ${JSON.stringify(w())};`,`globalThis._VSCODE_FILE_ROOT = '${globalThis._VSCODE_FILE_ROOT}';`,"const ttPolicy = globalThis.trustedTypes?.createPolicy('defaultWorkerFactory', { createScriptURL: value => value });","globalThis.workerttPolicy = ttPolicy;",`await import(ttPolicy?.createScriptURL('${e}') ?? '${e}');`,"globalThis.postMessage({ type: 'vscode-worker-ready' });",`/*${t}*/`]).join("")],{type:"application/javascript"});return URL.createObjectURL(n)}function _(t){return new Promise((e,r)=>{t.onmessage=function(o){o.data.type==="vscode-worker-ready"&&(t.onmessage=null,e(t))},t.onerror=r})}function O(t){return typeof t.then=="function"}class P extends p{constructor(e,r,o,n,s,c){super(),this.id=o,this.label=n;const a=S(e,n);O(a)?this.worker=a:this.worker=Promise.resolve(a),this.postMessage(r,[]),this.worker.then(i=>{i.onmessage=function(l){s(l.data)},i.onmessageerror=c,typeof i.addEventListener=="function"&&i.addEventListener("error",c)}),this._register(k(()=>{var i;(i=this.worker)==null||i.then(l=>{l.onmessage=null,l.onmessageerror=null,l.removeEventListener("error",c),l.terminate()}),this.worker=null}))}getId(){return this.id}postMessage(e,r){var o;(o=this.worker)==null||o.then(n=>{try{n.postMessage(e,r)}catch(s){h(s),h(new Error(`FAILED to post message to '${this.label}'-worker`,{cause:s}))}})}}class R{constructor(e,r){this.amdModuleId=e,this.label=r,this.esmModuleLocation=L.asBrowserUri(`${e}.esm.js`)}}const f=class f{constructor(){this._webWorkerFailedBeforeError=!1}create(e,r,o){const n=++f.LAST_WORKER_ID;if(this._webWorkerFailedBeforeError)throw this._webWorkerFailedBeforeError;return new P(e.esmModuleLocation,e.amdModuleId,n,e.label||"anonymous"+n,r,s=>{m(s),this._webWorkerFailedBeforeError=s,o(s)})}};f.LAST_WORKER_ID=0;let g=f;function $(t,e){const r=typeof t=="string"?new R(t,e):t;return new E(new g,r)}export{$ as c};
//# sourceMappingURL=monaco-editor-esm-vs-base-browser-defaultWorkerFactory-BatFPzyW.js.map
