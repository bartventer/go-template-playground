import{f as h,o as l}from"./monaco-editor-esm-vs-base-browser-dom-CW6twH0t.js";import{Q as s,j as d,c as a,E as r}from"./monaco-editor-esm-vs-base-YIFfhEJQ.js";class c extends a{constructor(e){super(),this._onDidChange=this._register(new r),this.onDidChange=this._onDidChange.event,this._listener=()=>this._handleChange(e,!0),this._mediaQueryList=null,this._handleChange(e,!1)}_handleChange(e,i){var t;(t=this._mediaQueryList)==null||t.removeEventListener("change",this._listener),this._mediaQueryList=e.matchMedia(`(resolution: ${e.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),i&&this._onDidChange.fire()}}class g extends a{get value(){return this._value}constructor(e){super(),this._onDidChange=this._register(new r),this.onDidChange=this._onDidChange.event,this._value=this._getPixelRatio(e);const i=this._register(new c(e));this._register(i.onDidChange(()=>{this._value=this._getPixelRatio(e),this._onDidChange.fire(this._value)}))}_getPixelRatio(e){const i=document.createElement("canvas").getContext("2d"),t=e.devicePixelRatio||1,o=i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1;return t/o}}class _{constructor(){this.mapWindowIdToPixelRatioMonitor=new Map}_getOrCreatePixelRatioMonitor(e){const i=h(e);let t=this.mapWindowIdToPixelRatioMonitor.get(i);return t||(t=s(new g(e)),this.mapWindowIdToPixelRatioMonitor.set(i,t),s(d.once(l)(({vscodeWindowId:o})=>{o===i&&(t==null||t.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(i))}))),t}getInstance(e){return this._getOrCreatePixelRatioMonitor(e)}}const m=new _;export{m as P};
//# sourceMappingURL=monaco-editor-esm-vs-base-browser-pixelRatio-Bpk22H8X.js.map
